(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function XN(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var iE={exports:{}},sh={},oE={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lc=Symbol.for("react.element"),YN=Symbol.for("react.portal"),JN=Symbol.for("react.fragment"),ZN=Symbol.for("react.strict_mode"),eA=Symbol.for("react.profiler"),tA=Symbol.for("react.provider"),nA=Symbol.for("react.context"),rA=Symbol.for("react.forward_ref"),sA=Symbol.for("react.suspense"),iA=Symbol.for("react.memo"),oA=Symbol.for("react.lazy"),h0=Symbol.iterator;function aA(t){return t===null||typeof t!="object"?null:(t=h0&&t[h0]||t["@@iterator"],typeof t=="function"?t:null)}var aE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lE=Object.assign,cE={};function aa(t,e,n){this.props=t,this.context=e,this.refs=cE,this.updater=n||aE}aa.prototype.isReactComponent={};aa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};aa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function uE(){}uE.prototype=aa.prototype;function rg(t,e,n){this.props=t,this.context=e,this.refs=cE,this.updater=n||aE}var sg=rg.prototype=new uE;sg.constructor=rg;lE(sg,aa.prototype);sg.isPureReactComponent=!0;var f0=Array.isArray,dE=Object.prototype.hasOwnProperty,ig={current:null},hE={key:!0,ref:!0,__self:!0,__source:!0};function fE(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)dE.call(e,r)&&!hE.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:lc,type:t,key:i,ref:o,props:s,_owner:ig.current}}function lA(t,e){return{$$typeof:lc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function og(t){return typeof t=="object"&&t!==null&&t.$$typeof===lc}function cA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var m0=/\/+/g;function gf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?cA(""+t.key):e.toString(36)}function Tu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case lc:case YN:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+gf(o,0):r,f0(s)?(n="",t!=null&&(n=t.replace(m0,"$&/")+"/"),Tu(s,e,n,"",function(d){return d})):s!=null&&(og(s)&&(s=lA(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(m0,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",f0(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+gf(i,a);o+=Tu(i,e,n,c,s)}else if(c=aA(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+gf(i,a++),o+=Tu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Wc(t,e,n){if(t==null)return t;var r=[],s=0;return Tu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function uA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qt={current:null},bu={transition:null},dA={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:bu,ReactCurrentOwner:ig};function mE(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:Wc,forEach:function(t,e,n){Wc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Wc(t,function(){e++}),e},toArray:function(t){return Wc(t,function(e){return e})||[]},only:function(t){if(!og(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xe.Component=aa;xe.Fragment=JN;xe.Profiler=eA;xe.PureComponent=rg;xe.StrictMode=ZN;xe.Suspense=sA;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dA;xe.act=mE;xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lE({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=ig.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)dE.call(e,c)&&!hE.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:lc,type:t.type,key:s,ref:i,props:r,_owner:o}};xe.createContext=function(t){return t={$$typeof:nA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tA,_context:t},t.Consumer=t};xe.createElement=fE;xe.createFactory=function(t){var e=fE.bind(null,t);return e.type=t,e};xe.createRef=function(){return{current:null}};xe.forwardRef=function(t){return{$$typeof:rA,render:t}};xe.isValidElement=og;xe.lazy=function(t){return{$$typeof:oA,_payload:{_status:-1,_result:t},_init:uA}};xe.memo=function(t,e){return{$$typeof:iA,type:t,compare:e===void 0?null:e}};xe.startTransition=function(t){var e=bu.transition;bu.transition={};try{t()}finally{bu.transition=e}};xe.unstable_act=mE;xe.useCallback=function(t,e){return qt.current.useCallback(t,e)};xe.useContext=function(t){return qt.current.useContext(t)};xe.useDebugValue=function(){};xe.useDeferredValue=function(t){return qt.current.useDeferredValue(t)};xe.useEffect=function(t,e){return qt.current.useEffect(t,e)};xe.useId=function(){return qt.current.useId()};xe.useImperativeHandle=function(t,e,n){return qt.current.useImperativeHandle(t,e,n)};xe.useInsertionEffect=function(t,e){return qt.current.useInsertionEffect(t,e)};xe.useLayoutEffect=function(t,e){return qt.current.useLayoutEffect(t,e)};xe.useMemo=function(t,e){return qt.current.useMemo(t,e)};xe.useReducer=function(t,e,n){return qt.current.useReducer(t,e,n)};xe.useRef=function(t){return qt.current.useRef(t)};xe.useState=function(t){return qt.current.useState(t)};xe.useSyncExternalStore=function(t,e,n){return qt.current.useSyncExternalStore(t,e,n)};xe.useTransition=function(){return qt.current.useTransition()};xe.version="18.3.1";oE.exports=xe;var j=oE.exports;const hA=XN(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fA=j,mA=Symbol.for("react.element"),pA=Symbol.for("react.fragment"),gA=Object.prototype.hasOwnProperty,yA=fA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vA={key:!0,ref:!0,__self:!0,__source:!0};function pE(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)gA.call(e,r)&&!vA.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:mA,type:t,key:i,ref:o,props:s,_owner:yA.current}}sh.Fragment=pA;sh.jsx=pE;sh.jsxs=pE;iE.exports=sh;var u=iE.exports,Em={},gE={exports:{}},pn={},yE={exports:{}},vE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,F){var G=B.length;B.push(F);e:for(;0<G;){var Y=G-1>>>1,X=B[Y];if(0<s(X,F))B[Y]=F,B[G]=X,G=Y;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var F=B[0],G=B.pop();if(G!==F){B[0]=G;e:for(var Y=0,X=B.length,he=X>>>1;Y<he;){var ue=2*(Y+1)-1,Se=B[ue],_e=ue+1,ke=B[_e];if(0>s(Se,G))_e<X&&0>s(ke,Se)?(B[Y]=ke,B[_e]=G,Y=_e):(B[Y]=Se,B[ue]=G,Y=ue);else if(_e<X&&0>s(ke,G))B[Y]=ke,B[_e]=G,Y=_e;else break e}}return F}function s(B,F){var G=B.sortIndex-F.sortIndex;return G!==0?G:B.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,m=null,p=3,_=!1,A=!1,C=!1,R=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(B){for(var F=n(d);F!==null;){if(F.callback===null)r(d);else if(F.startTime<=B)r(d),F.sortIndex=F.expirationTime,e(c,F);else break;F=n(d)}}function N(B){if(C=!1,w(B),!A)if(n(c)!==null)A=!0,K(D);else{var F=n(d);F!==null&&we(N,F.startTime-B)}}function D(B,F){A=!1,C&&(C=!1,E(y),y=-1),_=!0;var G=p;try{for(w(F),m=n(c);m!==null&&(!(m.expirationTime>F)||B&&!T());){var Y=m.callback;if(typeof Y=="function"){m.callback=null,p=m.priorityLevel;var X=Y(m.expirationTime<=F);F=t.unstable_now(),typeof X=="function"?m.callback=X:m===n(c)&&r(c),w(F)}else r(c);m=n(c)}if(m!==null)var he=!0;else{var ue=n(d);ue!==null&&we(N,ue.startTime-F),he=!1}return he}finally{m=null,p=G,_=!1}}var O=!1,x=null,y=-1,b=5,k=-1;function T(){return!(t.unstable_now()-k<b)}function P(){if(x!==null){var B=t.unstable_now();k=B;var F=!0;try{F=x(!0,B)}finally{F?S():(O=!1,x=null)}}else O=!1}var S;if(typeof v=="function")S=function(){v(P)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ae=te.port2;te.port1.onmessage=P,S=function(){ae.postMessage(null)}}else S=function(){R(P,0)};function K(B){x=B,O||(O=!0,S())}function we(B,F){y=R(function(){B(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){A||_||(A=!0,K(D))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(B){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var G=p;p=F;try{return B()}finally{p=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,F){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var G=p;p=B;try{return F()}finally{p=G}},t.unstable_scheduleCallback=function(B,F,G){var Y=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?Y+G:Y):G=Y,B){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=G+X,B={id:h++,callback:F,priorityLevel:B,startTime:G,expirationTime:X,sortIndex:-1},G>Y?(B.sortIndex=G,e(d,B),n(c)===null&&B===n(d)&&(C?(E(y),y=-1):C=!0,we(N,G-Y))):(B.sortIndex=X,e(c,B),A||_||(A=!0,K(D))),B},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(B){var F=p;return function(){var G=p;p=F;try{return B.apply(this,arguments)}finally{p=G}}}})(vE);yE.exports=vE;var _A=yE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xA=j,fn=_A;function W(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _E=new Set,kl={};function Vi(t,e){Po(t,e),Po(t+"Capture",e)}function Po(t,e){for(kl[t]=e,t=0;t<e.length;t++)_E.add(e[t])}var Er=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Im=Object.prototype.hasOwnProperty,wA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p0={},g0={};function EA(t){return Im.call(g0,t)?!0:Im.call(p0,t)?!1:wA.test(t)?g0[t]=!0:(p0[t]=!0,!1)}function IA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function TA(t,e,n,r){if(e===null||typeof e>"u"||IA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ht(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var At={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){At[t]=new Ht(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];At[e]=new Ht(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){At[t]=new Ht(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){At[t]=new Ht(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){At[t]=new Ht(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){At[t]=new Ht(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){At[t]=new Ht(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){At[t]=new Ht(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){At[t]=new Ht(t,5,!1,t.toLowerCase(),null,!1,!1)});var ag=/[\-:]([a-z])/g;function lg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ag,lg);At[e]=new Ht(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ag,lg);At[e]=new Ht(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ag,lg);At[e]=new Ht(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){At[t]=new Ht(t,1,!1,t.toLowerCase(),null,!1,!1)});At.xlinkHref=new Ht("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){At[t]=new Ht(t,1,!1,t.toLowerCase(),null,!0,!0)});function cg(t,e,n,r){var s=At.hasOwnProperty(e)?At[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(TA(e,n,s,r)&&(n=null),r||s===null?EA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var jr=xA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Kc=Symbol.for("react.element"),oo=Symbol.for("react.portal"),ao=Symbol.for("react.fragment"),ug=Symbol.for("react.strict_mode"),Tm=Symbol.for("react.profiler"),xE=Symbol.for("react.provider"),wE=Symbol.for("react.context"),dg=Symbol.for("react.forward_ref"),bm=Symbol.for("react.suspense"),Sm=Symbol.for("react.suspense_list"),hg=Symbol.for("react.memo"),Xr=Symbol.for("react.lazy"),EE=Symbol.for("react.offscreen"),y0=Symbol.iterator;function ja(t){return t===null||typeof t!="object"?null:(t=y0&&t[y0]||t["@@iterator"],typeof t=="function"?t:null)}var Xe=Object.assign,yf;function Xa(t){if(yf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);yf=e&&e[1]||""}return`
`+yf+t}var vf=!1;function _f(t,e){if(!t||vf)return"";vf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{vf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xa(t):""}function bA(t){switch(t.tag){case 5:return Xa(t.type);case 16:return Xa("Lazy");case 13:return Xa("Suspense");case 19:return Xa("SuspenseList");case 0:case 2:case 15:return t=_f(t.type,!1),t;case 11:return t=_f(t.type.render,!1),t;case 1:return t=_f(t.type,!0),t;default:return""}}function Nm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ao:return"Fragment";case oo:return"Portal";case Tm:return"Profiler";case ug:return"StrictMode";case bm:return"Suspense";case Sm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case wE:return(t.displayName||"Context")+".Consumer";case xE:return(t._context.displayName||"Context")+".Provider";case dg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hg:return e=t.displayName||null,e!==null?e:Nm(t.type)||"Memo";case Xr:e=t._payload,t=t._init;try{return Nm(t(e))}catch{}}return null}function SA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Nm(e);case 8:return e===ug?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function bs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function IE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function NA(t){var e=IE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Qc(t){t._valueTracker||(t._valueTracker=NA(t))}function TE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=IE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function td(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Am(t,e){var n=e.checked;return Xe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function v0(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=bs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bE(t,e){e=e.checked,e!=null&&cg(t,"checked",e,!1)}function Cm(t,e){bE(t,e);var n=bs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?km(t,e.type,n):e.hasOwnProperty("defaultValue")&&km(t,e.type,bs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _0(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function km(t,e,n){(e!=="number"||td(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ya=Array.isArray;function xo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+bs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Rm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(W(91));return Xe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function x0(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(W(92));if(Ya(n)){if(1<n.length)throw Error(W(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:bs(n)}}function SE(t,e){var n=bs(e.value),r=bs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function w0(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function NE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?NE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Xc,AE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Xc=Xc||document.createElement("div"),Xc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Rl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ll={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AA=["Webkit","ms","Moz","O"];Object.keys(ll).forEach(function(t){AA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ll[e]=ll[t]})});function CE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ll.hasOwnProperty(t)&&ll[t]?(""+e).trim():e+"px"}function kE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=CE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var CA=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jm(t,e){if(e){if(CA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(W(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(W(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(W(61))}if(e.style!=null&&typeof e.style!="object")throw Error(W(62))}}function Dm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vm=null;function fg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Mm=null,wo=null,Eo=null;function E0(t){if(t=dc(t)){if(typeof Mm!="function")throw Error(W(280));var e=t.stateNode;e&&(e=ch(e),Mm(t.stateNode,t.type,e))}}function RE(t){wo?Eo?Eo.push(t):Eo=[t]:wo=t}function PE(){if(wo){var t=wo,e=Eo;if(Eo=wo=null,E0(t),e)for(t=0;t<e.length;t++)E0(e[t])}}function jE(t,e){return t(e)}function DE(){}var xf=!1;function VE(t,e,n){if(xf)return t(e,n);xf=!0;try{return jE(t,e,n)}finally{xf=!1,(wo!==null||Eo!==null)&&(DE(),PE())}}function Pl(t,e){var n=t.stateNode;if(n===null)return null;var r=ch(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(W(231,e,typeof n));return n}var Om=!1;if(Er)try{var Da={};Object.defineProperty(Da,"passive",{get:function(){Om=!0}}),window.addEventListener("test",Da,Da),window.removeEventListener("test",Da,Da)}catch{Om=!1}function kA(t,e,n,r,s,i,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var cl=!1,nd=null,rd=!1,Lm=null,RA={onError:function(t){cl=!0,nd=t}};function PA(t,e,n,r,s,i,o,a,c){cl=!1,nd=null,kA.apply(RA,arguments)}function jA(t,e,n,r,s,i,o,a,c){if(PA.apply(this,arguments),cl){if(cl){var d=nd;cl=!1,nd=null}else throw Error(W(198));rd||(rd=!0,Lm=d)}}function Mi(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ME(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function I0(t){if(Mi(t)!==t)throw Error(W(188))}function DA(t){var e=t.alternate;if(!e){if(e=Mi(t),e===null)throw Error(W(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return I0(s),t;if(i===r)return I0(s),e;i=i.sibling}throw Error(W(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(W(189))}}if(n.alternate!==r)throw Error(W(190))}if(n.tag!==3)throw Error(W(188));return n.stateNode.current===n?t:e}function OE(t){return t=DA(t),t!==null?LE(t):null}function LE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=LE(t);if(e!==null)return e;t=t.sibling}return null}var FE=fn.unstable_scheduleCallback,T0=fn.unstable_cancelCallback,VA=fn.unstable_shouldYield,MA=fn.unstable_requestPaint,rt=fn.unstable_now,OA=fn.unstable_getCurrentPriorityLevel,mg=fn.unstable_ImmediatePriority,UE=fn.unstable_UserBlockingPriority,sd=fn.unstable_NormalPriority,LA=fn.unstable_LowPriority,zE=fn.unstable_IdlePriority,ih=null,tr=null;function FA(t){if(tr&&typeof tr.onCommitFiberRoot=="function")try{tr.onCommitFiberRoot(ih,t,void 0,(t.current.flags&128)===128)}catch{}}var Dn=Math.clz32?Math.clz32:$A,UA=Math.log,zA=Math.LN2;function $A(t){return t>>>=0,t===0?32:31-(UA(t)/zA|0)|0}var Yc=64,Jc=4194304;function Ja(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function id(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Ja(a):(i&=o,i!==0&&(r=Ja(i)))}else o=n&~s,o!==0?r=Ja(o):i!==0&&(r=Ja(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Dn(e),s=1<<n,r|=t[n],e&=~s;return r}function BA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Dn(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=BA(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function Fm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $E(){var t=Yc;return Yc<<=1,!(Yc&4194240)&&(Yc=64),t}function wf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function cc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Dn(e),t[e]=n}function HA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Dn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function pg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Dn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var je=0;function BE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qE,gg,HE,GE,WE,Um=!1,Zc=[],hs=null,fs=null,ms=null,jl=new Map,Dl=new Map,Jr=[],GA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function b0(t,e){switch(t){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":jl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dl.delete(e.pointerId)}}function Va(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=dc(e),e!==null&&gg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function WA(t,e,n,r,s){switch(e){case"focusin":return hs=Va(hs,t,e,n,r,s),!0;case"dragenter":return fs=Va(fs,t,e,n,r,s),!0;case"mouseover":return ms=Va(ms,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return jl.set(i,Va(jl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Dl.set(i,Va(Dl.get(i)||null,t,e,n,r,s)),!0}return!1}function KE(t){var e=ii(t.target);if(e!==null){var n=Mi(e);if(n!==null){if(e=n.tag,e===13){if(e=ME(n),e!==null){t.blockedOn=e,WE(t.priority,function(){HE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Su(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=zm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Vm=r,n.target.dispatchEvent(r),Vm=null}else return e=dc(n),e!==null&&gg(e),t.blockedOn=n,!1;e.shift()}return!0}function S0(t,e,n){Su(t)&&n.delete(e)}function KA(){Um=!1,hs!==null&&Su(hs)&&(hs=null),fs!==null&&Su(fs)&&(fs=null),ms!==null&&Su(ms)&&(ms=null),jl.forEach(S0),Dl.forEach(S0)}function Ma(t,e){t.blockedOn===e&&(t.blockedOn=null,Um||(Um=!0,fn.unstable_scheduleCallback(fn.unstable_NormalPriority,KA)))}function Vl(t){function e(s){return Ma(s,t)}if(0<Zc.length){Ma(Zc[0],t);for(var n=1;n<Zc.length;n++){var r=Zc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(hs!==null&&Ma(hs,t),fs!==null&&Ma(fs,t),ms!==null&&Ma(ms,t),jl.forEach(e),Dl.forEach(e),n=0;n<Jr.length;n++)r=Jr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jr.length&&(n=Jr[0],n.blockedOn===null);)KE(n),n.blockedOn===null&&Jr.shift()}var Io=jr.ReactCurrentBatchConfig,od=!0;function QA(t,e,n,r){var s=je,i=Io.transition;Io.transition=null;try{je=1,yg(t,e,n,r)}finally{je=s,Io.transition=i}}function XA(t,e,n,r){var s=je,i=Io.transition;Io.transition=null;try{je=4,yg(t,e,n,r)}finally{je=s,Io.transition=i}}function yg(t,e,n,r){if(od){var s=zm(t,e,n,r);if(s===null)Rf(t,e,r,ad,n),b0(t,r);else if(WA(s,t,e,n,r))r.stopPropagation();else if(b0(t,r),e&4&&-1<GA.indexOf(t)){for(;s!==null;){var i=dc(s);if(i!==null&&qE(i),i=zm(t,e,n,r),i===null&&Rf(t,e,r,ad,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Rf(t,e,r,null,n)}}var ad=null;function zm(t,e,n,r){if(ad=null,t=fg(r),t=ii(t),t!==null)if(e=Mi(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ME(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ad=t,null}function QE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(OA()){case mg:return 1;case UE:return 4;case sd:case LA:return 16;case zE:return 536870912;default:return 16}default:return 16}}var cs=null,vg=null,Nu=null;function XE(){if(Nu)return Nu;var t,e=vg,n=e.length,r,s="value"in cs?cs.value:cs.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Nu=s.slice(t,1<r?1-r:void 0)}function Au(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function eu(){return!0}function N0(){return!1}function gn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?eu:N0,this.isPropagationStopped=N0,this}return Xe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=eu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=eu)},persist:function(){},isPersistent:eu}),e}var la={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},_g=gn(la),uc=Xe({},la,{view:0,detail:0}),YA=gn(uc),Ef,If,Oa,oh=Xe({},uc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Oa&&(Oa&&t.type==="mousemove"?(Ef=t.screenX-Oa.screenX,If=t.screenY-Oa.screenY):If=Ef=0,Oa=t),Ef)},movementY:function(t){return"movementY"in t?t.movementY:If}}),A0=gn(oh),JA=Xe({},oh,{dataTransfer:0}),ZA=gn(JA),e2=Xe({},uc,{relatedTarget:0}),Tf=gn(e2),t2=Xe({},la,{animationName:0,elapsedTime:0,pseudoElement:0}),n2=gn(t2),r2=Xe({},la,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),s2=gn(r2),i2=Xe({},la,{data:0}),C0=gn(i2),o2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},a2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},l2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c2(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=l2[t])?!!e[t]:!1}function xg(){return c2}var u2=Xe({},uc,{key:function(t){if(t.key){var e=o2[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Au(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?a2[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xg,charCode:function(t){return t.type==="keypress"?Au(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Au(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),d2=gn(u2),h2=Xe({},oh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),k0=gn(h2),f2=Xe({},uc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xg}),m2=gn(f2),p2=Xe({},la,{propertyName:0,elapsedTime:0,pseudoElement:0}),g2=gn(p2),y2=Xe({},oh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),v2=gn(y2),_2=[9,13,27,32],wg=Er&&"CompositionEvent"in window,ul=null;Er&&"documentMode"in document&&(ul=document.documentMode);var x2=Er&&"TextEvent"in window&&!ul,YE=Er&&(!wg||ul&&8<ul&&11>=ul),R0=" ",P0=!1;function JE(t,e){switch(t){case"keyup":return _2.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var lo=!1;function w2(t,e){switch(t){case"compositionend":return ZE(e);case"keypress":return e.which!==32?null:(P0=!0,R0);case"textInput":return t=e.data,t===R0&&P0?null:t;default:return null}}function E2(t,e){if(lo)return t==="compositionend"||!wg&&JE(t,e)?(t=XE(),Nu=vg=cs=null,lo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return YE&&e.locale!=="ko"?null:e.data;default:return null}}var I2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function j0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!I2[t.type]:e==="textarea"}function e1(t,e,n,r){RE(r),e=ld(e,"onChange"),0<e.length&&(n=new _g("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var dl=null,Ml=null;function T2(t){d1(t,0)}function ah(t){var e=ho(t);if(TE(e))return t}function b2(t,e){if(t==="change")return e}var t1=!1;if(Er){var bf;if(Er){var Sf="oninput"in document;if(!Sf){var D0=document.createElement("div");D0.setAttribute("oninput","return;"),Sf=typeof D0.oninput=="function"}bf=Sf}else bf=!1;t1=bf&&(!document.documentMode||9<document.documentMode)}function V0(){dl&&(dl.detachEvent("onpropertychange",n1),Ml=dl=null)}function n1(t){if(t.propertyName==="value"&&ah(Ml)){var e=[];e1(e,Ml,t,fg(t)),VE(T2,e)}}function S2(t,e,n){t==="focusin"?(V0(),dl=e,Ml=n,dl.attachEvent("onpropertychange",n1)):t==="focusout"&&V0()}function N2(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ah(Ml)}function A2(t,e){if(t==="click")return ah(e)}function C2(t,e){if(t==="input"||t==="change")return ah(e)}function k2(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var On=typeof Object.is=="function"?Object.is:k2;function Ol(t,e){if(On(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Im.call(e,s)||!On(t[s],e[s]))return!1}return!0}function M0(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function O0(t,e){var n=M0(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=M0(n)}}function r1(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?r1(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function s1(){for(var t=window,e=td();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=td(t.document)}return e}function Eg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function R2(t){var e=s1(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&r1(n.ownerDocument.documentElement,n)){if(r!==null&&Eg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=O0(n,i);var o=O0(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var P2=Er&&"documentMode"in document&&11>=document.documentMode,co=null,$m=null,hl=null,Bm=!1;function L0(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Bm||co==null||co!==td(r)||(r=co,"selectionStart"in r&&Eg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hl&&Ol(hl,r)||(hl=r,r=ld($m,"onSelect"),0<r.length&&(e=new _g("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=co)))}function tu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var uo={animationend:tu("Animation","AnimationEnd"),animationiteration:tu("Animation","AnimationIteration"),animationstart:tu("Animation","AnimationStart"),transitionend:tu("Transition","TransitionEnd")},Nf={},i1={};Er&&(i1=document.createElement("div").style,"AnimationEvent"in window||(delete uo.animationend.animation,delete uo.animationiteration.animation,delete uo.animationstart.animation),"TransitionEvent"in window||delete uo.transitionend.transition);function lh(t){if(Nf[t])return Nf[t];if(!uo[t])return t;var e=uo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in i1)return Nf[t]=e[n];return t}var o1=lh("animationend"),a1=lh("animationiteration"),l1=lh("animationstart"),c1=lh("transitionend"),u1=new Map,F0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ds(t,e){u1.set(t,e),Vi(e,[t])}for(var Af=0;Af<F0.length;Af++){var Cf=F0[Af],j2=Cf.toLowerCase(),D2=Cf[0].toUpperCase()+Cf.slice(1);Ds(j2,"on"+D2)}Ds(o1,"onAnimationEnd");Ds(a1,"onAnimationIteration");Ds(l1,"onAnimationStart");Ds("dblclick","onDoubleClick");Ds("focusin","onFocus");Ds("focusout","onBlur");Ds(c1,"onTransitionEnd");Po("onMouseEnter",["mouseout","mouseover"]);Po("onMouseLeave",["mouseout","mouseover"]);Po("onPointerEnter",["pointerout","pointerover"]);Po("onPointerLeave",["pointerout","pointerover"]);Vi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Za="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),V2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Za));function U0(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,jA(r,e,void 0,t),t.currentTarget=null}function d1(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;U0(s,a,d),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;U0(s,a,d),i=c}}}if(rd)throw t=Lm,rd=!1,Lm=null,t}function Be(t,e){var n=e[Km];n===void 0&&(n=e[Km]=new Set);var r=t+"__bubble";n.has(r)||(h1(e,t,2,!1),n.add(r))}function kf(t,e,n){var r=0;e&&(r|=4),h1(n,t,r,e)}var nu="_reactListening"+Math.random().toString(36).slice(2);function Ll(t){if(!t[nu]){t[nu]=!0,_E.forEach(function(n){n!=="selectionchange"&&(V2.has(n)||kf(n,!1,t),kf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[nu]||(e[nu]=!0,kf("selectionchange",!1,e))}}function h1(t,e,n,r){switch(QE(e)){case 1:var s=QA;break;case 4:s=XA;break;default:s=yg}n=s.bind(null,e,n,t),s=void 0,!Om||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Rf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ii(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}VE(function(){var d=i,h=fg(n),m=[];e:{var p=u1.get(t);if(p!==void 0){var _=_g,A=t;switch(t){case"keypress":if(Au(n)===0)break e;case"keydown":case"keyup":_=d2;break;case"focusin":A="focus",_=Tf;break;case"focusout":A="blur",_=Tf;break;case"beforeblur":case"afterblur":_=Tf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=A0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=ZA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=m2;break;case o1:case a1:case l1:_=n2;break;case c1:_=g2;break;case"scroll":_=YA;break;case"wheel":_=v2;break;case"copy":case"cut":case"paste":_=s2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=k0}var C=(e&4)!==0,R=!C&&t==="scroll",E=C?p!==null?p+"Capture":null:p;C=[];for(var v=d,w;v!==null;){w=v;var N=w.stateNode;if(w.tag===5&&N!==null&&(w=N,E!==null&&(N=Pl(v,E),N!=null&&C.push(Fl(v,N,w)))),R)break;v=v.return}0<C.length&&(p=new _(p,A,null,n,h),m.push({event:p,listeners:C}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",p&&n!==Vm&&(A=n.relatedTarget||n.fromElement)&&(ii(A)||A[Ir]))break e;if((_||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,_?(A=n.relatedTarget||n.toElement,_=d,A=A?ii(A):null,A!==null&&(R=Mi(A),A!==R||A.tag!==5&&A.tag!==6)&&(A=null)):(_=null,A=d),_!==A)){if(C=A0,N="onMouseLeave",E="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(C=k0,N="onPointerLeave",E="onPointerEnter",v="pointer"),R=_==null?p:ho(_),w=A==null?p:ho(A),p=new C(N,v+"leave",_,n,h),p.target=R,p.relatedTarget=w,N=null,ii(h)===d&&(C=new C(E,v+"enter",A,n,h),C.target=w,C.relatedTarget=R,N=C),R=N,_&&A)t:{for(C=_,E=A,v=0,w=C;w;w=Gi(w))v++;for(w=0,N=E;N;N=Gi(N))w++;for(;0<v-w;)C=Gi(C),v--;for(;0<w-v;)E=Gi(E),w--;for(;v--;){if(C===E||E!==null&&C===E.alternate)break t;C=Gi(C),E=Gi(E)}C=null}else C=null;_!==null&&z0(m,p,_,C,!1),A!==null&&R!==null&&z0(m,R,A,C,!0)}}e:{if(p=d?ho(d):window,_=p.nodeName&&p.nodeName.toLowerCase(),_==="select"||_==="input"&&p.type==="file")var D=b2;else if(j0(p))if(t1)D=C2;else{D=N2;var O=S2}else(_=p.nodeName)&&_.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(D=A2);if(D&&(D=D(t,d))){e1(m,D,n,h);break e}O&&O(t,p,d),t==="focusout"&&(O=p._wrapperState)&&O.controlled&&p.type==="number"&&km(p,"number",p.value)}switch(O=d?ho(d):window,t){case"focusin":(j0(O)||O.contentEditable==="true")&&(co=O,$m=d,hl=null);break;case"focusout":hl=$m=co=null;break;case"mousedown":Bm=!0;break;case"contextmenu":case"mouseup":case"dragend":Bm=!1,L0(m,n,h);break;case"selectionchange":if(P2)break;case"keydown":case"keyup":L0(m,n,h)}var x;if(wg)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else lo?JE(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(YE&&n.locale!=="ko"&&(lo||y!=="onCompositionStart"?y==="onCompositionEnd"&&lo&&(x=XE()):(cs=h,vg="value"in cs?cs.value:cs.textContent,lo=!0)),O=ld(d,y),0<O.length&&(y=new C0(y,t,null,n,h),m.push({event:y,listeners:O}),x?y.data=x:(x=ZE(n),x!==null&&(y.data=x)))),(x=x2?w2(t,n):E2(t,n))&&(d=ld(d,"onBeforeInput"),0<d.length&&(h=new C0("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=x))}d1(m,e)})}function Fl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ld(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Pl(t,n),i!=null&&r.unshift(Fl(t,i,s)),i=Pl(t,e),i!=null&&r.push(Fl(t,i,s))),t=t.return}return r}function Gi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function z0(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=Pl(n,i),c!=null&&o.unshift(Fl(n,c,a))):s||(c=Pl(n,i),c!=null&&o.push(Fl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var M2=/\r\n?/g,O2=/\u0000|\uFFFD/g;function $0(t){return(typeof t=="string"?t:""+t).replace(M2,`
`).replace(O2,"")}function ru(t,e,n){if(e=$0(e),$0(t)!==e&&n)throw Error(W(425))}function cd(){}var qm=null,Hm=null;function Gm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Wm=typeof setTimeout=="function"?setTimeout:void 0,L2=typeof clearTimeout=="function"?clearTimeout:void 0,B0=typeof Promise=="function"?Promise:void 0,F2=typeof queueMicrotask=="function"?queueMicrotask:typeof B0<"u"?function(t){return B0.resolve(null).then(t).catch(U2)}:Wm;function U2(t){setTimeout(function(){throw t})}function Pf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Vl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Vl(e)}function ps(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function q0(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ca=Math.random().toString(36).slice(2),Xn="__reactFiber$"+ca,Ul="__reactProps$"+ca,Ir="__reactContainer$"+ca,Km="__reactEvents$"+ca,z2="__reactListeners$"+ca,$2="__reactHandles$"+ca;function ii(t){var e=t[Xn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ir]||n[Xn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=q0(t);t!==null;){if(n=t[Xn])return n;t=q0(t)}return e}t=n,n=t.parentNode}return null}function dc(t){return t=t[Xn]||t[Ir],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ho(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(W(33))}function ch(t){return t[Ul]||null}var Qm=[],fo=-1;function Vs(t){return{current:t}}function qe(t){0>fo||(t.current=Qm[fo],Qm[fo]=null,fo--)}function Ue(t,e){fo++,Qm[fo]=t.current,t.current=e}var Ss={},Lt=Vs(Ss),Zt=Vs(!1),yi=Ss;function jo(t,e){var n=t.type.contextTypes;if(!n)return Ss;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function en(t){return t=t.childContextTypes,t!=null}function ud(){qe(Zt),qe(Lt)}function H0(t,e,n){if(Lt.current!==Ss)throw Error(W(168));Ue(Lt,e),Ue(Zt,n)}function f1(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(W(108,SA(t)||"Unknown",s));return Xe({},n,r)}function dd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ss,yi=Lt.current,Ue(Lt,t),Ue(Zt,Zt.current),!0}function G0(t,e,n){var r=t.stateNode;if(!r)throw Error(W(169));n?(t=f1(t,e,yi),r.__reactInternalMemoizedMergedChildContext=t,qe(Zt),qe(Lt),Ue(Lt,t)):qe(Zt),Ue(Zt,n)}var mr=null,uh=!1,jf=!1;function m1(t){mr===null?mr=[t]:mr.push(t)}function B2(t){uh=!0,m1(t)}function Ms(){if(!jf&&mr!==null){jf=!0;var t=0,e=je;try{var n=mr;for(je=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}mr=null,uh=!1}catch(s){throw mr!==null&&(mr=mr.slice(t+1)),FE(mg,Ms),s}finally{je=e,jf=!1}}return null}var mo=[],po=0,hd=null,fd=0,yn=[],vn=0,vi=null,pr=1,gr="";function Xs(t,e){mo[po++]=fd,mo[po++]=hd,hd=t,fd=e}function p1(t,e,n){yn[vn++]=pr,yn[vn++]=gr,yn[vn++]=vi,vi=t;var r=pr;t=gr;var s=32-Dn(r)-1;r&=~(1<<s),n+=1;var i=32-Dn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,pr=1<<32-Dn(e)+s|n<<s|r,gr=i+t}else pr=1<<i|n<<s|r,gr=t}function Ig(t){t.return!==null&&(Xs(t,1),p1(t,1,0))}function Tg(t){for(;t===hd;)hd=mo[--po],mo[po]=null,fd=mo[--po],mo[po]=null;for(;t===vi;)vi=yn[--vn],yn[vn]=null,gr=yn[--vn],yn[vn]=null,pr=yn[--vn],yn[vn]=null}var dn=null,an=null,Ge=!1,Pn=null;function g1(t,e){var n=wn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function W0(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,dn=t,an=ps(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,dn=t,an=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=vi!==null?{id:pr,overflow:gr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,dn=t,an=null,!0):!1;default:return!1}}function Xm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Ym(t){if(Ge){var e=an;if(e){var n=e;if(!W0(t,e)){if(Xm(t))throw Error(W(418));e=ps(n.nextSibling);var r=dn;e&&W0(t,e)?g1(r,n):(t.flags=t.flags&-4097|2,Ge=!1,dn=t)}}else{if(Xm(t))throw Error(W(418));t.flags=t.flags&-4097|2,Ge=!1,dn=t}}}function K0(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;dn=t}function su(t){if(t!==dn)return!1;if(!Ge)return K0(t),Ge=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Gm(t.type,t.memoizedProps)),e&&(e=an)){if(Xm(t))throw y1(),Error(W(418));for(;e;)g1(t,e),e=ps(e.nextSibling)}if(K0(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(W(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){an=ps(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}an=null}}else an=dn?ps(t.stateNode.nextSibling):null;return!0}function y1(){for(var t=an;t;)t=ps(t.nextSibling)}function Do(){an=dn=null,Ge=!1}function bg(t){Pn===null?Pn=[t]:Pn.push(t)}var q2=jr.ReactCurrentBatchConfig;function La(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(W(309));var r=n.stateNode}if(!r)throw Error(W(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(W(284));if(!n._owner)throw Error(W(290,t))}return t}function iu(t,e){throw t=Object.prototype.toString.call(e),Error(W(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Q0(t){var e=t._init;return e(t._payload)}function v1(t){function e(E,v){if(t){var w=E.deletions;w===null?(E.deletions=[v],E.flags|=16):w.push(v)}}function n(E,v){if(!t)return null;for(;v!==null;)e(E,v),v=v.sibling;return null}function r(E,v){for(E=new Map;v!==null;)v.key!==null?E.set(v.key,v):E.set(v.index,v),v=v.sibling;return E}function s(E,v){return E=_s(E,v),E.index=0,E.sibling=null,E}function i(E,v,w){return E.index=w,t?(w=E.alternate,w!==null?(w=w.index,w<v?(E.flags|=2,v):w):(E.flags|=2,v)):(E.flags|=1048576,v)}function o(E){return t&&E.alternate===null&&(E.flags|=2),E}function a(E,v,w,N){return v===null||v.tag!==6?(v=Uf(w,E.mode,N),v.return=E,v):(v=s(v,w),v.return=E,v)}function c(E,v,w,N){var D=w.type;return D===ao?h(E,v,w.props.children,N,w.key):v!==null&&(v.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Xr&&Q0(D)===v.type)?(N=s(v,w.props),N.ref=La(E,v,w),N.return=E,N):(N=Vu(w.type,w.key,w.props,null,E.mode,N),N.ref=La(E,v,w),N.return=E,N)}function d(E,v,w,N){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=zf(w,E.mode,N),v.return=E,v):(v=s(v,w.children||[]),v.return=E,v)}function h(E,v,w,N,D){return v===null||v.tag!==7?(v=ui(w,E.mode,N,D),v.return=E,v):(v=s(v,w),v.return=E,v)}function m(E,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Uf(""+v,E.mode,w),v.return=E,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Kc:return w=Vu(v.type,v.key,v.props,null,E.mode,w),w.ref=La(E,null,v),w.return=E,w;case oo:return v=zf(v,E.mode,w),v.return=E,v;case Xr:var N=v._init;return m(E,N(v._payload),w)}if(Ya(v)||ja(v))return v=ui(v,E.mode,w,null),v.return=E,v;iu(E,v)}return null}function p(E,v,w,N){var D=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return D!==null?null:a(E,v,""+w,N);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Kc:return w.key===D?c(E,v,w,N):null;case oo:return w.key===D?d(E,v,w,N):null;case Xr:return D=w._init,p(E,v,D(w._payload),N)}if(Ya(w)||ja(w))return D!==null?null:h(E,v,w,N,null);iu(E,w)}return null}function _(E,v,w,N,D){if(typeof N=="string"&&N!==""||typeof N=="number")return E=E.get(w)||null,a(v,E,""+N,D);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Kc:return E=E.get(N.key===null?w:N.key)||null,c(v,E,N,D);case oo:return E=E.get(N.key===null?w:N.key)||null,d(v,E,N,D);case Xr:var O=N._init;return _(E,v,w,O(N._payload),D)}if(Ya(N)||ja(N))return E=E.get(w)||null,h(v,E,N,D,null);iu(v,N)}return null}function A(E,v,w,N){for(var D=null,O=null,x=v,y=v=0,b=null;x!==null&&y<w.length;y++){x.index>y?(b=x,x=null):b=x.sibling;var k=p(E,x,w[y],N);if(k===null){x===null&&(x=b);break}t&&x&&k.alternate===null&&e(E,x),v=i(k,v,y),O===null?D=k:O.sibling=k,O=k,x=b}if(y===w.length)return n(E,x),Ge&&Xs(E,y),D;if(x===null){for(;y<w.length;y++)x=m(E,w[y],N),x!==null&&(v=i(x,v,y),O===null?D=x:O.sibling=x,O=x);return Ge&&Xs(E,y),D}for(x=r(E,x);y<w.length;y++)b=_(x,E,y,w[y],N),b!==null&&(t&&b.alternate!==null&&x.delete(b.key===null?y:b.key),v=i(b,v,y),O===null?D=b:O.sibling=b,O=b);return t&&x.forEach(function(T){return e(E,T)}),Ge&&Xs(E,y),D}function C(E,v,w,N){var D=ja(w);if(typeof D!="function")throw Error(W(150));if(w=D.call(w),w==null)throw Error(W(151));for(var O=D=null,x=v,y=v=0,b=null,k=w.next();x!==null&&!k.done;y++,k=w.next()){x.index>y?(b=x,x=null):b=x.sibling;var T=p(E,x,k.value,N);if(T===null){x===null&&(x=b);break}t&&x&&T.alternate===null&&e(E,x),v=i(T,v,y),O===null?D=T:O.sibling=T,O=T,x=b}if(k.done)return n(E,x),Ge&&Xs(E,y),D;if(x===null){for(;!k.done;y++,k=w.next())k=m(E,k.value,N),k!==null&&(v=i(k,v,y),O===null?D=k:O.sibling=k,O=k);return Ge&&Xs(E,y),D}for(x=r(E,x);!k.done;y++,k=w.next())k=_(x,E,y,k.value,N),k!==null&&(t&&k.alternate!==null&&x.delete(k.key===null?y:k.key),v=i(k,v,y),O===null?D=k:O.sibling=k,O=k);return t&&x.forEach(function(P){return e(E,P)}),Ge&&Xs(E,y),D}function R(E,v,w,N){if(typeof w=="object"&&w!==null&&w.type===ao&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case Kc:e:{for(var D=w.key,O=v;O!==null;){if(O.key===D){if(D=w.type,D===ao){if(O.tag===7){n(E,O.sibling),v=s(O,w.props.children),v.return=E,E=v;break e}}else if(O.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Xr&&Q0(D)===O.type){n(E,O.sibling),v=s(O,w.props),v.ref=La(E,O,w),v.return=E,E=v;break e}n(E,O);break}else e(E,O);O=O.sibling}w.type===ao?(v=ui(w.props.children,E.mode,N,w.key),v.return=E,E=v):(N=Vu(w.type,w.key,w.props,null,E.mode,N),N.ref=La(E,v,w),N.return=E,E=N)}return o(E);case oo:e:{for(O=w.key;v!==null;){if(v.key===O)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(E,v.sibling),v=s(v,w.children||[]),v.return=E,E=v;break e}else{n(E,v);break}else e(E,v);v=v.sibling}v=zf(w,E.mode,N),v.return=E,E=v}return o(E);case Xr:return O=w._init,R(E,v,O(w._payload),N)}if(Ya(w))return A(E,v,w,N);if(ja(w))return C(E,v,w,N);iu(E,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(E,v.sibling),v=s(v,w),v.return=E,E=v):(n(E,v),v=Uf(w,E.mode,N),v.return=E,E=v),o(E)):n(E,v)}return R}var Vo=v1(!0),_1=v1(!1),md=Vs(null),pd=null,go=null,Sg=null;function Ng(){Sg=go=pd=null}function Ag(t){var e=md.current;qe(md),t._currentValue=e}function Jm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function To(t,e){pd=t,Sg=go=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Qt=!0),t.firstContext=null)}function bn(t){var e=t._currentValue;if(Sg!==t)if(t={context:t,memoizedValue:e,next:null},go===null){if(pd===null)throw Error(W(308));go=t,pd.dependencies={lanes:0,firstContext:t}}else go=go.next=t;return e}var oi=null;function Cg(t){oi===null?oi=[t]:oi.push(t)}function x1(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Cg(e)):(n.next=s.next,s.next=n),e.interleaved=n,Tr(t,r)}function Tr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Yr=!1;function kg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function w1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function gs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,be&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Tr(t,n)}return s=r.interleaved,s===null?(e.next=e,Cg(r)):(e.next=s.next,s.next=e),r.interleaved=e,Tr(t,n)}function Cu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,pg(t,n)}}function X0(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function gd(t,e,n,r){var s=t.updateQueue;Yr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,h=d=c=null,a=i;do{var p=a.lane,_=a.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=t,C=a;switch(p=e,_=n,C.tag){case 1:if(A=C.payload,typeof A=="function"){m=A.call(_,m,p);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=C.payload,p=typeof A=="function"?A.call(_,m,p):A,p==null)break e;m=Xe({},m,p);break e;case 2:Yr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else _={eventTime:_,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=_,c=m):h=h.next=_,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(c=m),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);xi|=o,t.lanes=o,t.memoizedState=m}}function Y0(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(W(191,s));s.call(r)}}}var hc={},nr=Vs(hc),zl=Vs(hc),$l=Vs(hc);function ai(t){if(t===hc)throw Error(W(174));return t}function Rg(t,e){switch(Ue($l,e),Ue(zl,t),Ue(nr,hc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Pm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Pm(e,t)}qe(nr),Ue(nr,e)}function Mo(){qe(nr),qe(zl),qe($l)}function E1(t){ai($l.current);var e=ai(nr.current),n=Pm(e,t.type);e!==n&&(Ue(zl,t),Ue(nr,n))}function Pg(t){zl.current===t&&(qe(nr),qe(zl))}var We=Vs(0);function yd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Df=[];function jg(){for(var t=0;t<Df.length;t++)Df[t]._workInProgressVersionPrimary=null;Df.length=0}var ku=jr.ReactCurrentDispatcher,Vf=jr.ReactCurrentBatchConfig,_i=0,Qe=null,ht=null,Et=null,vd=!1,fl=!1,Bl=0,H2=0;function kt(){throw Error(W(321))}function Dg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!On(t[n],e[n]))return!1;return!0}function Vg(t,e,n,r,s,i){if(_i=i,Qe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ku.current=t===null||t.memoizedState===null?Q2:X2,t=n(r,s),fl){i=0;do{if(fl=!1,Bl=0,25<=i)throw Error(W(301));i+=1,Et=ht=null,e.updateQueue=null,ku.current=Y2,t=n(r,s)}while(fl)}if(ku.current=_d,e=ht!==null&&ht.next!==null,_i=0,Et=ht=Qe=null,vd=!1,e)throw Error(W(300));return t}function Mg(){var t=Bl!==0;return Bl=0,t}function Wn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?Qe.memoizedState=Et=t:Et=Et.next=t,Et}function Sn(){if(ht===null){var t=Qe.alternate;t=t!==null?t.memoizedState:null}else t=ht.next;var e=Et===null?Qe.memoizedState:Et.next;if(e!==null)Et=e,ht=t;else{if(t===null)throw Error(W(310));ht=t,t={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},Et===null?Qe.memoizedState=Et=t:Et=Et.next=t}return Et}function ql(t,e){return typeof e=="function"?e(t):e}function Mf(t){var e=Sn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=ht,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,d=i;do{var h=d.lane;if((_i&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=m,o=r):c=c.next=m,Qe.lanes|=h,xi|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=a,On(r,e.memoizedState)||(Qt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Qe.lanes|=i,xi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Of(t){var e=Sn(),n=e.queue;if(n===null)throw Error(W(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);On(i,e.memoizedState)||(Qt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function I1(){}function T1(t,e){var n=Qe,r=Sn(),s=e(),i=!On(r.memoizedState,s);if(i&&(r.memoizedState=s,Qt=!0),r=r.queue,Og(N1.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||Et!==null&&Et.memoizedState.tag&1){if(n.flags|=2048,Hl(9,S1.bind(null,n,r,s,e),void 0,null),It===null)throw Error(W(349));_i&30||b1(n,e,s)}return s}function b1(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Qe.updateQueue,e===null?(e={lastEffect:null,stores:null},Qe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function S1(t,e,n,r){e.value=n,e.getSnapshot=r,A1(e)&&C1(t)}function N1(t,e,n){return n(function(){A1(e)&&C1(t)})}function A1(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!On(t,n)}catch{return!0}}function C1(t){var e=Tr(t,1);e!==null&&Vn(e,t,1,-1)}function J0(t){var e=Wn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ql,lastRenderedState:t},e.queue=t,t=t.dispatch=K2.bind(null,Qe,t),[e.memoizedState,t]}function Hl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Qe.updateQueue,e===null?(e={lastEffect:null,stores:null},Qe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function k1(){return Sn().memoizedState}function Ru(t,e,n,r){var s=Wn();Qe.flags|=t,s.memoizedState=Hl(1|e,n,void 0,r===void 0?null:r)}function dh(t,e,n,r){var s=Sn();r=r===void 0?null:r;var i=void 0;if(ht!==null){var o=ht.memoizedState;if(i=o.destroy,r!==null&&Dg(r,o.deps)){s.memoizedState=Hl(e,n,i,r);return}}Qe.flags|=t,s.memoizedState=Hl(1|e,n,i,r)}function Z0(t,e){return Ru(8390656,8,t,e)}function Og(t,e){return dh(2048,8,t,e)}function R1(t,e){return dh(4,2,t,e)}function P1(t,e){return dh(4,4,t,e)}function j1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function D1(t,e,n){return n=n!=null?n.concat([t]):null,dh(4,4,j1.bind(null,e,t),n)}function Lg(){}function V1(t,e){var n=Sn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function M1(t,e){var n=Sn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Dg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function O1(t,e,n){return _i&21?(On(n,e)||(n=$E(),Qe.lanes|=n,xi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Qt=!0),t.memoizedState=n)}function G2(t,e){var n=je;je=n!==0&&4>n?n:4,t(!0);var r=Vf.transition;Vf.transition={};try{t(!1),e()}finally{je=n,Vf.transition=r}}function L1(){return Sn().memoizedState}function W2(t,e,n){var r=vs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},F1(t))U1(e,n);else if(n=x1(t,e,n,r),n!==null){var s=$t();Vn(n,t,r,s),z1(n,e,r)}}function K2(t,e,n){var r=vs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(F1(t))U1(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,On(a,o)){var c=e.interleaved;c===null?(s.next=s,Cg(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=x1(t,e,s,r),n!==null&&(s=$t(),Vn(n,t,r,s),z1(n,e,r))}}function F1(t){var e=t.alternate;return t===Qe||e!==null&&e===Qe}function U1(t,e){fl=vd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function z1(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,pg(t,n)}}var _d={readContext:bn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},Q2={readContext:bn,useCallback:function(t,e){return Wn().memoizedState=[t,e===void 0?null:e],t},useContext:bn,useEffect:Z0,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ru(4194308,4,j1.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ru(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ru(4,2,t,e)},useMemo:function(t,e){var n=Wn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=W2.bind(null,Qe,t),[r.memoizedState,t]},useRef:function(t){var e=Wn();return t={current:t},e.memoizedState=t},useState:J0,useDebugValue:Lg,useDeferredValue:function(t){return Wn().memoizedState=t},useTransition:function(){var t=J0(!1),e=t[0];return t=G2.bind(null,t[1]),Wn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Qe,s=Wn();if(Ge){if(n===void 0)throw Error(W(407));n=n()}else{if(n=e(),It===null)throw Error(W(349));_i&30||b1(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Z0(N1.bind(null,r,i,t),[t]),r.flags|=2048,Hl(9,S1.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Wn(),e=It.identifierPrefix;if(Ge){var n=gr,r=pr;n=(r&~(1<<32-Dn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=H2++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},X2={readContext:bn,useCallback:V1,useContext:bn,useEffect:Og,useImperativeHandle:D1,useInsertionEffect:R1,useLayoutEffect:P1,useMemo:M1,useReducer:Mf,useRef:k1,useState:function(){return Mf(ql)},useDebugValue:Lg,useDeferredValue:function(t){var e=Sn();return O1(e,ht.memoizedState,t)},useTransition:function(){var t=Mf(ql)[0],e=Sn().memoizedState;return[t,e]},useMutableSource:I1,useSyncExternalStore:T1,useId:L1,unstable_isNewReconciler:!1},Y2={readContext:bn,useCallback:V1,useContext:bn,useEffect:Og,useImperativeHandle:D1,useInsertionEffect:R1,useLayoutEffect:P1,useMemo:M1,useReducer:Of,useRef:k1,useState:function(){return Of(ql)},useDebugValue:Lg,useDeferredValue:function(t){var e=Sn();return ht===null?e.memoizedState=t:O1(e,ht.memoizedState,t)},useTransition:function(){var t=Of(ql)[0],e=Sn().memoizedState;return[t,e]},useMutableSource:I1,useSyncExternalStore:T1,useId:L1,unstable_isNewReconciler:!1};function Cn(t,e){if(t&&t.defaultProps){e=Xe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Zm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Xe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var hh={isMounted:function(t){return(t=t._reactInternals)?Mi(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=$t(),s=vs(t),i=xr(r,s);i.payload=e,n!=null&&(i.callback=n),e=gs(t,i,s),e!==null&&(Vn(e,t,s,r),Cu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=$t(),s=vs(t),i=xr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=gs(t,i,s),e!==null&&(Vn(e,t,s,r),Cu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$t(),r=vs(t),s=xr(n,r);s.tag=2,e!=null&&(s.callback=e),e=gs(t,s,r),e!==null&&(Vn(e,t,r,n),Cu(e,t,r))}};function e_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Ol(n,r)||!Ol(s,i):!0}function $1(t,e,n){var r=!1,s=Ss,i=e.contextType;return typeof i=="object"&&i!==null?i=bn(i):(s=en(e)?yi:Lt.current,r=e.contextTypes,i=(r=r!=null)?jo(t,s):Ss),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=hh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function t_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&hh.enqueueReplaceState(e,e.state,null)}function ep(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},kg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=bn(i):(i=en(e)?yi:Lt.current,s.context=jo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Zm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&hh.enqueueReplaceState(s,s.state,null),gd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Oo(t,e){try{var n="",r=e;do n+=bA(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Lf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function tp(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var J2=typeof WeakMap=="function"?WeakMap:Map;function B1(t,e,n){n=xr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){wd||(wd=!0,dp=r),tp(t,e)},n}function q1(t,e,n){n=xr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){tp(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){tp(t,e),typeof r!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function n_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new J2;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=hC.bind(null,t,e,n),e.then(t,t))}function r_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function s_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xr(-1,1),e.tag=2,gs(n,e,1))),n.lanes|=1),t)}var Z2=jr.ReactCurrentOwner,Qt=!1;function zt(t,e,n,r){e.child=t===null?_1(e,null,n,r):Vo(e,t.child,n,r)}function i_(t,e,n,r,s){n=n.render;var i=e.ref;return To(e,s),r=Vg(t,e,n,r,i,s),n=Mg(),t!==null&&!Qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,br(t,e,s)):(Ge&&n&&Ig(e),e.flags|=1,zt(t,e,r,s),e.child)}function o_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Gg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,H1(t,e,i,r,s)):(t=Vu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Ol,n(o,r)&&t.ref===e.ref)return br(t,e,s)}return e.flags|=1,t=_s(i,r),t.ref=e.ref,t.return=e,e.child=t}function H1(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Ol(i,r)&&t.ref===e.ref)if(Qt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Qt=!0);else return e.lanes=t.lanes,br(t,e,s)}return np(t,e,n,r,s)}function G1(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ue(vo,sn),sn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ue(vo,sn),sn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ue(vo,sn),sn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ue(vo,sn),sn|=r;return zt(t,e,s,n),e.child}function W1(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function np(t,e,n,r,s){var i=en(n)?yi:Lt.current;return i=jo(e,i),To(e,s),n=Vg(t,e,n,r,i,s),r=Mg(),t!==null&&!Qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,br(t,e,s)):(Ge&&r&&Ig(e),e.flags|=1,zt(t,e,n,s),e.child)}function a_(t,e,n,r,s){if(en(n)){var i=!0;dd(e)}else i=!1;if(To(e,s),e.stateNode===null)Pu(t,e),$1(e,n,r),ep(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=bn(d):(d=en(n)?yi:Lt.current,d=jo(e,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==d)&&t_(e,o,r,d),Yr=!1;var p=e.memoizedState;o.state=p,gd(e,r,o,s),c=e.memoizedState,a!==r||p!==c||Zt.current||Yr?(typeof h=="function"&&(Zm(e,n,h,r),c=e.memoizedState),(a=Yr||e_(e,n,a,r,p,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,w1(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Cn(e.type,a),o.props=d,m=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=bn(c):(c=en(n)?yi:Lt.current,c=jo(e,c));var _=n.getDerivedStateFromProps;(h=typeof _=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||p!==c)&&t_(e,o,r,c),Yr=!1,p=e.memoizedState,o.state=p,gd(e,r,o,s);var A=e.memoizedState;a!==m||p!==A||Zt.current||Yr?(typeof _=="function"&&(Zm(e,n,_,r),A=e.memoizedState),(d=Yr||e_(e,n,d,r,p,A,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return rp(t,e,n,r,i,s)}function rp(t,e,n,r,s,i){W1(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&G0(e,n,!1),br(t,e,i);r=e.stateNode,Z2.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Vo(e,t.child,null,i),e.child=Vo(e,null,a,i)):zt(t,e,a,i),e.memoizedState=r.state,s&&G0(e,n,!0),e.child}function K1(t){var e=t.stateNode;e.pendingContext?H0(t,e.pendingContext,e.pendingContext!==e.context):e.context&&H0(t,e.context,!1),Rg(t,e.containerInfo)}function l_(t,e,n,r,s){return Do(),bg(s),e.flags|=256,zt(t,e,n,r),e.child}var sp={dehydrated:null,treeContext:null,retryLane:0};function ip(t){return{baseLanes:t,cachePool:null,transitions:null}}function Q1(t,e,n){var r=e.pendingProps,s=We.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ue(We,s&1),t===null)return Ym(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=ph(o,r,0,null),t=ui(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=ip(n),e.memoizedState=sp,t):Fg(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return eC(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=_s(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=_s(a,i):(i=ui(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?ip(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=sp,r}return i=t.child,t=i.sibling,r=_s(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Fg(t,e){return e=ph({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ou(t,e,n,r){return r!==null&&bg(r),Vo(e,t.child,null,n),t=Fg(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function eC(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Lf(Error(W(422))),ou(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=ph({mode:"visible",children:r.children},s,0,null),i=ui(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Vo(e,t.child,null,o),e.child.memoizedState=ip(o),e.memoizedState=sp,i);if(!(e.mode&1))return ou(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(W(419)),r=Lf(i,r,void 0),ou(t,e,o,r)}if(a=(o&t.childLanes)!==0,Qt||a){if(r=It,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Tr(t,s),Vn(r,t,s,-1))}return Hg(),r=Lf(Error(W(421))),ou(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=fC.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,an=ps(s.nextSibling),dn=e,Ge=!0,Pn=null,t!==null&&(yn[vn++]=pr,yn[vn++]=gr,yn[vn++]=vi,pr=t.id,gr=t.overflow,vi=e),e=Fg(e,r.children),e.flags|=4096,e)}function c_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Jm(t.return,e,n)}function Ff(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function X1(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(zt(t,e,r.children,n),r=We.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&c_(t,n,e);else if(t.tag===19)c_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ue(We,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&yd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Ff(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&yd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Ff(e,!0,n,null,i);break;case"together":Ff(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Pu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function br(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),xi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(W(153));if(e.child!==null){for(t=e.child,n=_s(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=_s(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function tC(t,e,n){switch(e.tag){case 3:K1(e),Do();break;case 5:E1(e);break;case 1:en(e.type)&&dd(e);break;case 4:Rg(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ue(md,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ue(We,We.current&1),e.flags|=128,null):n&e.child.childLanes?Q1(t,e,n):(Ue(We,We.current&1),t=br(t,e,n),t!==null?t.sibling:null);Ue(We,We.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return X1(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ue(We,We.current),r)break;return null;case 22:case 23:return e.lanes=0,G1(t,e,n)}return br(t,e,n)}var Y1,op,J1,Z1;Y1=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};op=function(){};J1=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ai(nr.current);var i=null;switch(n){case"input":s=Am(t,s),r=Am(t,r),i=[];break;case"select":s=Xe({},s,{value:void 0}),r=Xe({},r,{value:void 0}),i=[];break;case"textarea":s=Rm(t,s),r=Rm(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=cd)}jm(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(kl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(kl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Be("scroll",t),i||a===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};Z1=function(t,e,n,r){n!==r&&(e.flags|=4)};function Fa(t,e){if(!Ge)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Rt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function nC(t,e,n){var r=e.pendingProps;switch(Tg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(e),null;case 1:return en(e.type)&&ud(),Rt(e),null;case 3:return r=e.stateNode,Mo(),qe(Zt),qe(Lt),jg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(su(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Pn!==null&&(mp(Pn),Pn=null))),op(t,e),Rt(e),null;case 5:Pg(e);var s=ai($l.current);if(n=e.type,t!==null&&e.stateNode!=null)J1(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(W(166));return Rt(e),null}if(t=ai(nr.current),su(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Xn]=e,r[Ul]=i,t=(e.mode&1)!==0,n){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(s=0;s<Za.length;s++)Be(Za[s],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":v0(r,i),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Be("invalid",r);break;case"textarea":x0(r,i),Be("invalid",r)}jm(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&ru(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&ru(r.textContent,a,t),s=["children",""+a]):kl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Be("scroll",r)}switch(n){case"input":Qc(r),_0(r,i,!0);break;case"textarea":Qc(r),w0(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=cd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=NE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Xn]=e,t[Ul]=r,Y1(t,e,!1,!1),e.stateNode=t;e:{switch(o=Dm(n,r),n){case"dialog":Be("cancel",t),Be("close",t),s=r;break;case"iframe":case"object":case"embed":Be("load",t),s=r;break;case"video":case"audio":for(s=0;s<Za.length;s++)Be(Za[s],t);s=r;break;case"source":Be("error",t),s=r;break;case"img":case"image":case"link":Be("error",t),Be("load",t),s=r;break;case"details":Be("toggle",t),s=r;break;case"input":v0(t,r),s=Am(t,r),Be("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Xe({},r,{value:void 0}),Be("invalid",t);break;case"textarea":x0(t,r),s=Rm(t,r),Be("invalid",t);break;default:s=r}jm(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?kE(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&AE(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Rl(t,c):typeof c=="number"&&Rl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(kl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Be("scroll",t):c!=null&&cg(t,i,c,o))}switch(n){case"input":Qc(t),_0(t,r,!1);break;case"textarea":Qc(t),w0(t);break;case"option":r.value!=null&&t.setAttribute("value",""+bs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?xo(t,!!r.multiple,i,!1):r.defaultValue!=null&&xo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=cd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Rt(e),null;case 6:if(t&&e.stateNode!=null)Z1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(W(166));if(n=ai($l.current),ai(nr.current),su(e)){if(r=e.stateNode,n=e.memoizedProps,r[Xn]=e,(i=r.nodeValue!==n)&&(t=dn,t!==null))switch(t.tag){case 3:ru(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ru(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Xn]=e,e.stateNode=r}return Rt(e),null;case 13:if(qe(We),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ge&&an!==null&&e.mode&1&&!(e.flags&128))y1(),Do(),e.flags|=98560,i=!1;else if(i=su(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(W(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(W(317));i[Xn]=e}else Do(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Rt(e),i=!1}else Pn!==null&&(mp(Pn),Pn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||We.current&1?mt===0&&(mt=3):Hg())),e.updateQueue!==null&&(e.flags|=4),Rt(e),null);case 4:return Mo(),op(t,e),t===null&&Ll(e.stateNode.containerInfo),Rt(e),null;case 10:return Ag(e.type._context),Rt(e),null;case 17:return en(e.type)&&ud(),Rt(e),null;case 19:if(qe(We),i=e.memoizedState,i===null)return Rt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Fa(i,!1);else{if(mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=yd(t),o!==null){for(e.flags|=128,Fa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ue(We,We.current&1|2),e.child}t=t.sibling}i.tail!==null&&rt()>Lo&&(e.flags|=128,r=!0,Fa(i,!1),e.lanes=4194304)}else{if(!r)if(t=yd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Fa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Ge)return Rt(e),null}else 2*rt()-i.renderingStartTime>Lo&&n!==1073741824&&(e.flags|=128,r=!0,Fa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=rt(),e.sibling=null,n=We.current,Ue(We,r?n&1|2:n&1),e):(Rt(e),null);case 22:case 23:return qg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?sn&1073741824&&(Rt(e),e.subtreeFlags&6&&(e.flags|=8192)):Rt(e),null;case 24:return null;case 25:return null}throw Error(W(156,e.tag))}function rC(t,e){switch(Tg(e),e.tag){case 1:return en(e.type)&&ud(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Mo(),qe(Zt),qe(Lt),jg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Pg(e),null;case 13:if(qe(We),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(W(340));Do()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return qe(We),null;case 4:return Mo(),null;case 10:return Ag(e.type._context),null;case 22:case 23:return qg(),null;case 24:return null;default:return null}}var au=!1,Vt=!1,sC=typeof WeakSet=="function"?WeakSet:Set,re=null;function yo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Je(t,e,r)}else n.current=null}function ap(t,e,n){try{n()}catch(r){Je(t,e,r)}}var u_=!1;function iC(t,e){if(qm=od,t=s1(),Eg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,d=0,h=0,m=t,p=null;t:for(;;){for(var _;m!==n||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(_=m.firstChild)!==null;)p=m,m=_;for(;;){if(m===t)break t;if(p===n&&++d===s&&(a=o),p===i&&++h===r&&(c=o),(_=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=_}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Hm={focusedElem:t,selectionRange:n},od=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var C=A.memoizedProps,R=A.memoizedState,E=e.stateNode,v=E.getSnapshotBeforeUpdate(e.elementType===e.type?C:Cn(e.type,C),R);E.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(W(163))}}catch(N){Je(e,e.return,N)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return A=u_,u_=!1,A}function ml(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ap(e,n,i)}s=s.next}while(s!==r)}}function fh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function lp(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function eI(t){var e=t.alternate;e!==null&&(t.alternate=null,eI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Xn],delete e[Ul],delete e[Km],delete e[z2],delete e[$2])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tI(t){return t.tag===5||t.tag===3||t.tag===4}function d_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cp(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=cd));else if(r!==4&&(t=t.child,t!==null))for(cp(t,e,n),t=t.sibling;t!==null;)cp(t,e,n),t=t.sibling}function up(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(up(t,e,n),t=t.sibling;t!==null;)up(t,e,n),t=t.sibling}var Tt=null,kn=!1;function Hr(t,e,n){for(n=n.child;n!==null;)nI(t,e,n),n=n.sibling}function nI(t,e,n){if(tr&&typeof tr.onCommitFiberUnmount=="function")try{tr.onCommitFiberUnmount(ih,n)}catch{}switch(n.tag){case 5:Vt||yo(n,e);case 6:var r=Tt,s=kn;Tt=null,Hr(t,e,n),Tt=r,kn=s,Tt!==null&&(kn?(t=Tt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Tt.removeChild(n.stateNode));break;case 18:Tt!==null&&(kn?(t=Tt,n=n.stateNode,t.nodeType===8?Pf(t.parentNode,n):t.nodeType===1&&Pf(t,n),Vl(t)):Pf(Tt,n.stateNode));break;case 4:r=Tt,s=kn,Tt=n.stateNode.containerInfo,kn=!0,Hr(t,e,n),Tt=r,kn=s;break;case 0:case 11:case 14:case 15:if(!Vt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&ap(n,e,o),s=s.next}while(s!==r)}Hr(t,e,n);break;case 1:if(!Vt&&(yo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Je(n,e,a)}Hr(t,e,n);break;case 21:Hr(t,e,n);break;case 22:n.mode&1?(Vt=(r=Vt)||n.memoizedState!==null,Hr(t,e,n),Vt=r):Hr(t,e,n);break;default:Hr(t,e,n)}}function h_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new sC),e.forEach(function(r){var s=mC.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function An(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Tt=a.stateNode,kn=!1;break e;case 3:Tt=a.stateNode.containerInfo,kn=!0;break e;case 4:Tt=a.stateNode.containerInfo,kn=!0;break e}a=a.return}if(Tt===null)throw Error(W(160));nI(i,o,s),Tt=null,kn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Je(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rI(e,t),e=e.sibling}function rI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(An(e,t),Gn(t),r&4){try{ml(3,t,t.return),fh(3,t)}catch(C){Je(t,t.return,C)}try{ml(5,t,t.return)}catch(C){Je(t,t.return,C)}}break;case 1:An(e,t),Gn(t),r&512&&n!==null&&yo(n,n.return);break;case 5:if(An(e,t),Gn(t),r&512&&n!==null&&yo(n,n.return),t.flags&32){var s=t.stateNode;try{Rl(s,"")}catch(C){Je(t,t.return,C)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&bE(s,i),Dm(a,o);var d=Dm(a,i);for(o=0;o<c.length;o+=2){var h=c[o],m=c[o+1];h==="style"?kE(s,m):h==="dangerouslySetInnerHTML"?AE(s,m):h==="children"?Rl(s,m):cg(s,h,m,d)}switch(a){case"input":Cm(s,i);break;case"textarea":SE(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var _=i.value;_!=null?xo(s,!!i.multiple,_,!1):p!==!!i.multiple&&(i.defaultValue!=null?xo(s,!!i.multiple,i.defaultValue,!0):xo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ul]=i}catch(C){Je(t,t.return,C)}}break;case 6:if(An(e,t),Gn(t),r&4){if(t.stateNode===null)throw Error(W(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(C){Je(t,t.return,C)}}break;case 3:if(An(e,t),Gn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Vl(e.containerInfo)}catch(C){Je(t,t.return,C)}break;case 4:An(e,t),Gn(t);break;case 13:An(e,t),Gn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||($g=rt())),r&4&&h_(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Vt=(d=Vt)||h,An(e,t),Vt=d):An(e,t),Gn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(re=t,h=t.child;h!==null;){for(m=re=h;re!==null;){switch(p=re,_=p.child,p.tag){case 0:case 11:case 14:case 15:ml(4,p,p.return);break;case 1:yo(p,p.return);var A=p.stateNode;if(typeof A.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(C){Je(r,n,C)}}break;case 5:yo(p,p.return);break;case 22:if(p.memoizedState!==null){m_(m);continue}}_!==null?(_.return=p,re=_):m_(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=CE("display",o))}catch(C){Je(t,t.return,C)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(C){Je(t,t.return,C)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:An(e,t),Gn(t),r&4&&h_(t);break;case 21:break;default:An(e,t),Gn(t)}}function Gn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tI(n)){var r=n;break e}n=n.return}throw Error(W(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Rl(s,""),r.flags&=-33);var i=d_(t);up(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=d_(t);cp(t,a,o);break;default:throw Error(W(161))}}catch(c){Je(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function oC(t,e,n){re=t,sI(t)}function sI(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var s=re,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||au;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Vt;a=au;var d=Vt;if(au=o,(Vt=c)&&!d)for(re=s;re!==null;)o=re,c=o.child,o.tag===22&&o.memoizedState!==null?p_(s):c!==null?(c.return=o,re=c):p_(s);for(;i!==null;)re=i,sI(i),i=i.sibling;re=s,au=a,Vt=d}f_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,re=i):f_(t)}}function f_(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Vt||fh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Vt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Cn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Y0(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Y0(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Vl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(W(163))}Vt||e.flags&512&&lp(e)}catch(p){Je(e,e.return,p)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function m_(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function p_(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{fh(4,e)}catch(c){Je(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Je(e,s,c)}}var i=e.return;try{lp(e)}catch(c){Je(e,i,c)}break;case 5:var o=e.return;try{lp(e)}catch(c){Je(e,o,c)}}}catch(c){Je(e,e.return,c)}if(e===t){re=null;break}var a=e.sibling;if(a!==null){a.return=e.return,re=a;break}re=e.return}}var aC=Math.ceil,xd=jr.ReactCurrentDispatcher,Ug=jr.ReactCurrentOwner,In=jr.ReactCurrentBatchConfig,be=0,It=null,at=null,St=0,sn=0,vo=Vs(0),mt=0,Gl=null,xi=0,mh=0,zg=0,pl=null,Wt=null,$g=0,Lo=1/0,hr=null,wd=!1,dp=null,ys=null,lu=!1,us=null,Ed=0,gl=0,hp=null,ju=-1,Du=0;function $t(){return be&6?rt():ju!==-1?ju:ju=rt()}function vs(t){return t.mode&1?be&2&&St!==0?St&-St:q2.transition!==null?(Du===0&&(Du=$E()),Du):(t=je,t!==0||(t=window.event,t=t===void 0?16:QE(t.type)),t):1}function Vn(t,e,n,r){if(50<gl)throw gl=0,hp=null,Error(W(185));cc(t,n,r),(!(be&2)||t!==It)&&(t===It&&(!(be&2)&&(mh|=n),mt===4&&Zr(t,St)),tn(t,r),n===1&&be===0&&!(e.mode&1)&&(Lo=rt()+500,uh&&Ms()))}function tn(t,e){var n=t.callbackNode;qA(t,e);var r=id(t,t===It?St:0);if(r===0)n!==null&&T0(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&T0(n),e===1)t.tag===0?B2(g_.bind(null,t)):m1(g_.bind(null,t)),F2(function(){!(be&6)&&Ms()}),n=null;else{switch(BE(r)){case 1:n=mg;break;case 4:n=UE;break;case 16:n=sd;break;case 536870912:n=zE;break;default:n=sd}n=hI(n,iI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function iI(t,e){if(ju=-1,Du=0,be&6)throw Error(W(327));var n=t.callbackNode;if(bo()&&t.callbackNode!==n)return null;var r=id(t,t===It?St:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Id(t,r);else{e=r;var s=be;be|=2;var i=aI();(It!==t||St!==e)&&(hr=null,Lo=rt()+500,ci(t,e));do try{uC();break}catch(a){oI(t,a)}while(!0);Ng(),xd.current=i,be=s,at!==null?e=0:(It=null,St=0,e=mt)}if(e!==0){if(e===2&&(s=Fm(t),s!==0&&(r=s,e=fp(t,s))),e===1)throw n=Gl,ci(t,0),Zr(t,r),tn(t,rt()),n;if(e===6)Zr(t,r);else{if(s=t.current.alternate,!(r&30)&&!lC(s)&&(e=Id(t,r),e===2&&(i=Fm(t),i!==0&&(r=i,e=fp(t,i))),e===1))throw n=Gl,ci(t,0),Zr(t,r),tn(t,rt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(W(345));case 2:Ys(t,Wt,hr);break;case 3:if(Zr(t,r),(r&130023424)===r&&(e=$g+500-rt(),10<e)){if(id(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){$t(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Wm(Ys.bind(null,t,Wt,hr),e);break}Ys(t,Wt,hr);break;case 4:if(Zr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Dn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=rt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*aC(r/1960))-r,10<r){t.timeoutHandle=Wm(Ys.bind(null,t,Wt,hr),r);break}Ys(t,Wt,hr);break;case 5:Ys(t,Wt,hr);break;default:throw Error(W(329))}}}return tn(t,rt()),t.callbackNode===n?iI.bind(null,t):null}function fp(t,e){var n=pl;return t.current.memoizedState.isDehydrated&&(ci(t,e).flags|=256),t=Id(t,e),t!==2&&(e=Wt,Wt=n,e!==null&&mp(e)),t}function mp(t){Wt===null?Wt=t:Wt.push.apply(Wt,t)}function lC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!On(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Zr(t,e){for(e&=~zg,e&=~mh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Dn(e),r=1<<n;t[n]=-1,e&=~r}}function g_(t){if(be&6)throw Error(W(327));bo();var e=id(t,0);if(!(e&1))return tn(t,rt()),null;var n=Id(t,e);if(t.tag!==0&&n===2){var r=Fm(t);r!==0&&(e=r,n=fp(t,r))}if(n===1)throw n=Gl,ci(t,0),Zr(t,e),tn(t,rt()),n;if(n===6)throw Error(W(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ys(t,Wt,hr),tn(t,rt()),null}function Bg(t,e){var n=be;be|=1;try{return t(e)}finally{be=n,be===0&&(Lo=rt()+500,uh&&Ms())}}function wi(t){us!==null&&us.tag===0&&!(be&6)&&bo();var e=be;be|=1;var n=In.transition,r=je;try{if(In.transition=null,je=1,t)return t()}finally{je=r,In.transition=n,be=e,!(be&6)&&Ms()}}function qg(){sn=vo.current,qe(vo)}function ci(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,L2(n)),at!==null)for(n=at.return;n!==null;){var r=n;switch(Tg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ud();break;case 3:Mo(),qe(Zt),qe(Lt),jg();break;case 5:Pg(r);break;case 4:Mo();break;case 13:qe(We);break;case 19:qe(We);break;case 10:Ag(r.type._context);break;case 22:case 23:qg()}n=n.return}if(It=t,at=t=_s(t.current,null),St=sn=e,mt=0,Gl=null,zg=mh=xi=0,Wt=pl=null,oi!==null){for(e=0;e<oi.length;e++)if(n=oi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}oi=null}return t}function oI(t,e){do{var n=at;try{if(Ng(),ku.current=_d,vd){for(var r=Qe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}vd=!1}if(_i=0,Et=ht=Qe=null,fl=!1,Bl=0,Ug.current=null,n===null||n.return===null){mt=1,Gl=e,at=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=St,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=r_(o);if(_!==null){_.flags&=-257,s_(_,o,a,i,e),_.mode&1&&n_(i,d,e),e=_,c=d;var A=e.updateQueue;if(A===null){var C=new Set;C.add(c),e.updateQueue=C}else A.add(c);break e}else{if(!(e&1)){n_(i,d,e),Hg();break e}c=Error(W(426))}}else if(Ge&&a.mode&1){var R=r_(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),s_(R,o,a,i,e),bg(Oo(c,a));break e}}i=c=Oo(c,a),mt!==4&&(mt=2),pl===null?pl=[i]:pl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var E=B1(i,c,e);X0(i,E);break e;case 1:a=c;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(ys===null||!ys.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var N=q1(i,a,e);X0(i,N);break e}}i=i.return}while(i!==null)}cI(n)}catch(D){e=D,at===n&&n!==null&&(at=n=n.return);continue}break}while(!0)}function aI(){var t=xd.current;return xd.current=_d,t===null?_d:t}function Hg(){(mt===0||mt===3||mt===2)&&(mt=4),It===null||!(xi&268435455)&&!(mh&268435455)||Zr(It,St)}function Id(t,e){var n=be;be|=2;var r=aI();(It!==t||St!==e)&&(hr=null,ci(t,e));do try{cC();break}catch(s){oI(t,s)}while(!0);if(Ng(),be=n,xd.current=r,at!==null)throw Error(W(261));return It=null,St=0,mt}function cC(){for(;at!==null;)lI(at)}function uC(){for(;at!==null&&!VA();)lI(at)}function lI(t){var e=dI(t.alternate,t,sn);t.memoizedProps=t.pendingProps,e===null?cI(t):at=e,Ug.current=null}function cI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=rC(n,e),n!==null){n.flags&=32767,at=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{mt=6,at=null;return}}else if(n=nC(n,e,sn),n!==null){at=n;return}if(e=e.sibling,e!==null){at=e;return}at=e=t}while(e!==null);mt===0&&(mt=5)}function Ys(t,e,n){var r=je,s=In.transition;try{In.transition=null,je=1,dC(t,e,n,r)}finally{In.transition=s,je=r}return null}function dC(t,e,n,r){do bo();while(us!==null);if(be&6)throw Error(W(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(W(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(HA(t,i),t===It&&(at=It=null,St=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||lu||(lu=!0,hI(sd,function(){return bo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=In.transition,In.transition=null;var o=je;je=1;var a=be;be|=4,Ug.current=null,iC(t,n),rI(n,t),R2(Hm),od=!!qm,Hm=qm=null,t.current=n,oC(n),MA(),be=a,je=o,In.transition=i}else t.current=n;if(lu&&(lu=!1,us=t,Ed=s),i=t.pendingLanes,i===0&&(ys=null),FA(n.stateNode),tn(t,rt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(wd)throw wd=!1,t=dp,dp=null,t;return Ed&1&&t.tag!==0&&bo(),i=t.pendingLanes,i&1?t===hp?gl++:(gl=0,hp=t):gl=0,Ms(),null}function bo(){if(us!==null){var t=BE(Ed),e=In.transition,n=je;try{if(In.transition=null,je=16>t?16:t,us===null)var r=!1;else{if(t=us,us=null,Ed=0,be&6)throw Error(W(331));var s=be;for(be|=4,re=t.current;re!==null;){var i=re,o=i.child;if(re.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(re=d;re!==null;){var h=re;switch(h.tag){case 0:case 11:case 15:ml(8,h,i)}var m=h.child;if(m!==null)m.return=h,re=m;else for(;re!==null;){h=re;var p=h.sibling,_=h.return;if(eI(h),h===d){re=null;break}if(p!==null){p.return=_,re=p;break}re=_}}}var A=i.alternate;if(A!==null){var C=A.child;if(C!==null){A.child=null;do{var R=C.sibling;C.sibling=null,C=R}while(C!==null)}}re=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,re=o;else e:for(;re!==null;){if(i=re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ml(9,i,i.return)}var E=i.sibling;if(E!==null){E.return=i.return,re=E;break e}re=i.return}}var v=t.current;for(re=v;re!==null;){o=re;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,re=w;else e:for(o=v;re!==null;){if(a=re,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:fh(9,a)}}catch(D){Je(a,a.return,D)}if(a===o){re=null;break e}var N=a.sibling;if(N!==null){N.return=a.return,re=N;break e}re=a.return}}if(be=s,Ms(),tr&&typeof tr.onPostCommitFiberRoot=="function")try{tr.onPostCommitFiberRoot(ih,t)}catch{}r=!0}return r}finally{je=n,In.transition=e}}return!1}function y_(t,e,n){e=Oo(n,e),e=B1(t,e,1),t=gs(t,e,1),e=$t(),t!==null&&(cc(t,1,e),tn(t,e))}function Je(t,e,n){if(t.tag===3)y_(t,t,n);else for(;e!==null;){if(e.tag===3){y_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ys===null||!ys.has(r))){t=Oo(n,t),t=q1(e,t,1),e=gs(e,t,1),t=$t(),e!==null&&(cc(e,1,t),tn(e,t));break}}e=e.return}}function hC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=$t(),t.pingedLanes|=t.suspendedLanes&n,It===t&&(St&n)===n&&(mt===4||mt===3&&(St&130023424)===St&&500>rt()-$g?ci(t,0):zg|=n),tn(t,e)}function uI(t,e){e===0&&(t.mode&1?(e=Jc,Jc<<=1,!(Jc&130023424)&&(Jc=4194304)):e=1);var n=$t();t=Tr(t,e),t!==null&&(cc(t,e,n),tn(t,n))}function fC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),uI(t,n)}function mC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(W(314))}r!==null&&r.delete(e),uI(t,n)}var dI;dI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Zt.current)Qt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Qt=!1,tC(t,e,n);Qt=!!(t.flags&131072)}else Qt=!1,Ge&&e.flags&1048576&&p1(e,fd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Pu(t,e),t=e.pendingProps;var s=jo(e,Lt.current);To(e,n),s=Vg(null,e,r,t,s,n);var i=Mg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,en(r)?(i=!0,dd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,kg(e),s.updater=hh,e.stateNode=s,s._reactInternals=e,ep(e,r,t,n),e=rp(null,e,r,!0,i,n)):(e.tag=0,Ge&&i&&Ig(e),zt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Pu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=gC(r),t=Cn(r,t),s){case 0:e=np(null,e,r,t,n);break e;case 1:e=a_(null,e,r,t,n);break e;case 11:e=i_(null,e,r,t,n);break e;case 14:e=o_(null,e,r,Cn(r.type,t),n);break e}throw Error(W(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Cn(r,s),np(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Cn(r,s),a_(t,e,r,s,n);case 3:e:{if(K1(e),t===null)throw Error(W(387));r=e.pendingProps,i=e.memoizedState,s=i.element,w1(t,e),gd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Oo(Error(W(423)),e),e=l_(t,e,r,n,s);break e}else if(r!==s){s=Oo(Error(W(424)),e),e=l_(t,e,r,n,s);break e}else for(an=ps(e.stateNode.containerInfo.firstChild),dn=e,Ge=!0,Pn=null,n=_1(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Do(),r===s){e=br(t,e,n);break e}zt(t,e,r,n)}e=e.child}return e;case 5:return E1(e),t===null&&Ym(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Gm(r,s)?o=null:i!==null&&Gm(r,i)&&(e.flags|=32),W1(t,e),zt(t,e,o,n),e.child;case 6:return t===null&&Ym(e),null;case 13:return Q1(t,e,n);case 4:return Rg(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Vo(e,null,r,n):zt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Cn(r,s),i_(t,e,r,s,n);case 7:return zt(t,e,e.pendingProps,n),e.child;case 8:return zt(t,e,e.pendingProps.children,n),e.child;case 12:return zt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ue(md,r._currentValue),r._currentValue=o,i!==null)if(On(i.value,o)){if(i.children===s.children&&!Zt.current){e=br(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=xr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Jm(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(W(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Jm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}zt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,To(e,n),s=bn(s),r=r(s),e.flags|=1,zt(t,e,r,n),e.child;case 14:return r=e.type,s=Cn(r,e.pendingProps),s=Cn(r.type,s),o_(t,e,r,s,n);case 15:return H1(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Cn(r,s),Pu(t,e),e.tag=1,en(r)?(t=!0,dd(e)):t=!1,To(e,n),$1(e,r,s),ep(e,r,s,n),rp(null,e,r,!0,t,n);case 19:return X1(t,e,n);case 22:return G1(t,e,n)}throw Error(W(156,e.tag))};function hI(t,e){return FE(t,e)}function pC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(t,e,n,r){return new pC(t,e,n,r)}function Gg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function gC(t){if(typeof t=="function")return Gg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dg)return 11;if(t===hg)return 14}return 2}function _s(t,e){var n=t.alternate;return n===null?(n=wn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Vu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Gg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ao:return ui(n.children,s,i,e);case ug:o=8,s|=8;break;case Tm:return t=wn(12,n,e,s|2),t.elementType=Tm,t.lanes=i,t;case bm:return t=wn(13,n,e,s),t.elementType=bm,t.lanes=i,t;case Sm:return t=wn(19,n,e,s),t.elementType=Sm,t.lanes=i,t;case EE:return ph(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case xE:o=10;break e;case wE:o=9;break e;case dg:o=11;break e;case hg:o=14;break e;case Xr:o=16,r=null;break e}throw Error(W(130,t==null?t:typeof t,""))}return e=wn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ui(t,e,n,r){return t=wn(7,t,r,e),t.lanes=n,t}function ph(t,e,n,r){return t=wn(22,t,r,e),t.elementType=EE,t.lanes=n,t.stateNode={isHidden:!1},t}function Uf(t,e,n){return t=wn(6,t,null,e),t.lanes=n,t}function zf(t,e,n){return e=wn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function yC(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wf(0),this.expirationTimes=wf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Wg(t,e,n,r,s,i,o,a,c){return t=new yC(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=wn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},kg(i),t}function vC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:oo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function fI(t){if(!t)return Ss;t=t._reactInternals;e:{if(Mi(t)!==t||t.tag!==1)throw Error(W(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(en(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(W(171))}if(t.tag===1){var n=t.type;if(en(n))return f1(t,n,e)}return e}function mI(t,e,n,r,s,i,o,a,c){return t=Wg(n,r,!0,t,s,i,o,a,c),t.context=fI(null),n=t.current,r=$t(),s=vs(n),i=xr(r,s),i.callback=e??null,gs(n,i,s),t.current.lanes=s,cc(t,s,r),tn(t,r),t}function gh(t,e,n,r){var s=e.current,i=$t(),o=vs(s);return n=fI(n),e.context===null?e.context=n:e.pendingContext=n,e=xr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=gs(s,e,o),t!==null&&(Vn(t,s,o,i),Cu(t,s,o)),o}function Td(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function v_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Kg(t,e){v_(t,e),(t=t.alternate)&&v_(t,e)}function _C(){return null}var pI=typeof reportError=="function"?reportError:function(t){console.error(t)};function Qg(t){this._internalRoot=t}yh.prototype.render=Qg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(W(409));gh(t,e,null,null)};yh.prototype.unmount=Qg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;wi(function(){gh(null,t,null,null)}),e[Ir]=null}};function yh(t){this._internalRoot=t}yh.prototype.unstable_scheduleHydration=function(t){if(t){var e=GE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jr.length&&e!==0&&e<Jr[n].priority;n++);Jr.splice(n,0,t),n===0&&KE(t)}};function Xg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function vh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function __(){}function xC(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Td(o);i.call(d)}}var o=mI(e,r,t,0,null,!1,!1,"",__);return t._reactRootContainer=o,t[Ir]=o.current,Ll(t.nodeType===8?t.parentNode:t),wi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Td(c);a.call(d)}}var c=Wg(t,0,!1,null,null,!1,!1,"",__);return t._reactRootContainer=c,t[Ir]=c.current,Ll(t.nodeType===8?t.parentNode:t),wi(function(){gh(e,c,n,r)}),c}function _h(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=Td(o);a.call(c)}}gh(e,o,t,s)}else o=xC(n,e,t,s,r);return Td(o)}qE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ja(e.pendingLanes);n!==0&&(pg(e,n|1),tn(e,rt()),!(be&6)&&(Lo=rt()+500,Ms()))}break;case 13:wi(function(){var r=Tr(t,1);if(r!==null){var s=$t();Vn(r,t,1,s)}}),Kg(t,1)}};gg=function(t){if(t.tag===13){var e=Tr(t,134217728);if(e!==null){var n=$t();Vn(e,t,134217728,n)}Kg(t,134217728)}};HE=function(t){if(t.tag===13){var e=vs(t),n=Tr(t,e);if(n!==null){var r=$t();Vn(n,t,e,r)}Kg(t,e)}};GE=function(){return je};WE=function(t,e){var n=je;try{return je=t,e()}finally{je=n}};Mm=function(t,e,n){switch(e){case"input":if(Cm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ch(r);if(!s)throw Error(W(90));TE(r),Cm(r,s)}}}break;case"textarea":SE(t,n);break;case"select":e=n.value,e!=null&&xo(t,!!n.multiple,e,!1)}};jE=Bg;DE=wi;var wC={usingClientEntryPoint:!1,Events:[dc,ho,ch,RE,PE,Bg]},Ua={findFiberByHostInstance:ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},EC={bundleType:Ua.bundleType,version:Ua.version,rendererPackageName:Ua.rendererPackageName,rendererConfig:Ua.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:jr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=OE(t),t===null?null:t.stateNode},findFiberByHostInstance:Ua.findFiberByHostInstance||_C,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cu.isDisabled&&cu.supportsFiber)try{ih=cu.inject(EC),tr=cu}catch{}}pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wC;pn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Xg(e))throw Error(W(200));return vC(t,e,null,n)};pn.createRoot=function(t,e){if(!Xg(t))throw Error(W(299));var n=!1,r="",s=pI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Wg(t,1,!1,null,null,n,!1,r,s),t[Ir]=e.current,Ll(t.nodeType===8?t.parentNode:t),new Qg(e)};pn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(W(188)):(t=Object.keys(t).join(","),Error(W(268,t)));return t=OE(e),t=t===null?null:t.stateNode,t};pn.flushSync=function(t){return wi(t)};pn.hydrate=function(t,e,n){if(!vh(e))throw Error(W(200));return _h(null,t,e,!0,n)};pn.hydrateRoot=function(t,e,n){if(!Xg(t))throw Error(W(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=pI;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=mI(e,null,t,1,n??null,s,!1,i,o),t[Ir]=e.current,Ll(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new yh(e)};pn.render=function(t,e,n){if(!vh(e))throw Error(W(200));return _h(null,t,e,!1,n)};pn.unmountComponentAtNode=function(t){if(!vh(t))throw Error(W(40));return t._reactRootContainer?(wi(function(){_h(null,null,t,!1,function(){t._reactRootContainer=null,t[Ir]=null})}),!0):!1};pn.unstable_batchedUpdates=Bg;pn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!vh(n))throw Error(W(200));if(t==null||t._reactInternals===void 0)throw Error(W(38));return _h(t,e,n,!1,r)};pn.version="18.3.1-next-f1338f8080-20240426";function gI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gI)}catch(t){console.error(t)}}gI(),gE.exports=pn;var IC=gE.exports,x_=IC;Em.createRoot=x_.createRoot,Em.hydrateRoot=x_.hydrateRoot;const TC="modulepreload",bC=function(t){return"/"+t},w_={},SC=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=bC(c),c in w_)return;w_[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":TC,d||(m.as="script"),m.crossOrigin="",m.href=c,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((p,_)=>{m.addEventListener("load",p),m.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function NC(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,c;const d=async(m=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(a=await SC(async()=>{const{Workbox:m}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/sw.js",{scope:"/",type:"classic"})).catch(m=>{o==null||o(m)}),!a)return;a.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),a.addEventListener("installed",m=>{m.isUpdate||r==null||r()}),a.register({immediate:e}).then(m=>{i?i("/sw.js",m):s==null||s(m)}).catch(m=>{o==null||o(m)})}}return c=h(),d}var AC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const CC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),me=(t,e)=>{const n=j.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:a,...c},d)=>j.createElement("svg",{ref:d,...AC,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${CC(t)}`,...c},[...e.map(([h,m])=>j.createElement(h,m)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n},yI=me("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),E_=me("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Yg=me("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),yl=me("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),pp=me("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),gp=me("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),kC=me("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),vI=me("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),RC=me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),xh=me("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ua=me("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),PC=me("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Jg=me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),_I=me("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),wh=me("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),I_=me("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Mu=me("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),jC=me("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),$f=me("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),DC=me("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),T_=me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),VC=me("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),MC=me("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),xI=me("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),OC=me("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),LC=me("MessageSquareDashed",[["path",{d:"M3 6V5c0-1.1.9-2 2-2h2",key:"9usibi"}],["path",{d:"M11 3h3",key:"1c3ji7"}],["path",{d:"M18 3h1c1.1 0 2 .9 2 2",key:"19esxn"}],["path",{d:"M21 9v2",key:"p14lih"}],["path",{d:"M21 15c0 1.1-.9 2-2 2h-1",key:"1fo1j8"}],["path",{d:"M14 17h-3",key:"1w4p2m"}],["path",{d:"m7 17-4 4v-5",key:"ph9x1h"}],["path",{d:"M3 12v-2",key:"856n1q"}]]),b_=me("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),wI=me("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),FC=me("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),yp=me("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),En=me("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),UC=me("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),fc=me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),zC=me("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),EI=me("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),$C=me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),II=me("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Ns=me("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),As=me("ShieldMinus",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M8 11h8",key:"vwpz6n"}]]),S_=me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),BC=me("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),qC=me("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),bd=me("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),es=me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Wl=me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),So=me("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]),Ln=me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),HC=()=>{};var N_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},GC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},bI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|a>>4;let p=(a&15)<<2|d>>6,_=d&63;c||(_=64,o||(p=64)),r.push(n[h],n[m],n[p],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(TI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):GC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||m==null)throw new WC;const p=i<<2|a>>4;if(r.push(p),d!==64){const _=a<<4&240|d>>2;if(r.push(_),m!==64){const A=d<<6&192|m;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class WC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KC=function(t){const e=TI(t);return bI.encodeByteArray(e,!0)},Sd=function(t){return KC(t).replace(/\./g,"")},SI=function(t){try{return bI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=()=>NI().__FIREBASE_DEFAULTS__,XC=()=>{if(typeof process>"u"||typeof N_>"u")return;const t=N_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&SI(t[1]);return e&&JSON.parse(e)},Eh=()=>{try{return HC()||QC()||XC()||YC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},AI=t=>{var e,n;return(n=(e=Eh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},CI=t=>{const e=AI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},kI=()=>{var t;return(t=Eh())==null?void 0:t.config},RI=t=>{var e;return(e=Eh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ih(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Sd(JSON.stringify(n)),Sd(JSON.stringify(o)),""].join(".")}const vl={};function ek(){const t={prod:[],emulator:[]};for(const e of Object.keys(vl))vl[e]?t.emulator.push(e):t.prod.push(e);return t}function tk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let A_=!1;function Zg(t,e){if(typeof window>"u"||typeof document>"u"||!cr(window.location.host)||vl[t]===e||vl[t]||A_)return;vl[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",i=ek().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,_){p.setAttribute("width","24"),p.setAttribute("id",_),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{A_=!0,o()},p}function h(p,_){p.setAttribute("id",_),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function m(){const p=tk(r),_=n("text"),A=document.getElementById(_)||document.createElement("span"),C=n("learnmore"),R=document.getElementById(C)||document.createElement("a"),E=n("preprendIcon"),v=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const w=p.element;a(w),h(R,C);const N=d();c(v,E),w.append(v,A,R,N),document.body.appendChild(w)}i?(A.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gt())}function PI(){var e;const t=(e=Eh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function sk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function ik(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ok(){const t=gt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function jI(){return!PI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function DI(){return!PI()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function VI(){try{return typeof indexedDB=="object"}catch{return!1}}function ak(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lk="FirebaseError";class Un extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=lk,Object.setPrototypeOf(this,Un.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mc.prototype.create)}}class mc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?ck(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Un(s,a,r)}}function ck(t,e){return t.replace(uk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const uk=/\{\$([^}]+)}/g;function dk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ei(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(C_(i)&&C_(o)){if(!Ei(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function C_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function el(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function tl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function hk(t,e){const n=new fk(t,e);return n.subscribe.bind(n)}class fk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");mk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Bf),s.error===void 0&&(s.error=Bf),s.complete===void 0&&(s.complete=Bf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function mk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Bf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ne(t){return t&&t._delegate?t._delegate:t}class Sr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Js="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new JC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(yk(e))try{this.getOrInitializeService({instanceIdentifier:Js})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Js){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Js){return this.instances.has(e)}getOptions(e=Js){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:gk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Js){return this.component?this.component.multipleInstances?e:Js:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gk(t){return t===Js?void 0:t}function yk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new pk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const _k={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},xk=Ee.INFO,wk={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},Ek=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=wk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ey{constructor(e){this.name=e,this._logLevel=xk,this._logHandler=Ek,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_k[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const Ik=(t,e)=>e.some(n=>t instanceof n);let k_,R_;function Tk(){return k_||(k_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bk(){return R_||(R_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const MI=new WeakMap,vp=new WeakMap,OI=new WeakMap,qf=new WeakMap,ty=new WeakMap;function Sk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(xs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&MI.set(n,t)}).catch(()=>{}),ty.set(e,t),e}function Nk(t){if(vp.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});vp.set(t,e)}let _p={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return vp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||OI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ak(t){_p=t(_p)}function Ck(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Hf(this),e,...n);return OI.set(r,e.sort?e.sort():[e]),xs(r)}:bk().includes(t)?function(...e){return t.apply(Hf(this),e),xs(MI.get(this))}:function(...e){return xs(t.apply(Hf(this),e))}}function kk(t){return typeof t=="function"?Ck(t):(t instanceof IDBTransaction&&Nk(t),Ik(t,Tk())?new Proxy(t,_p):t)}function xs(t){if(t instanceof IDBRequest)return Sk(t);if(qf.has(t))return qf.get(t);const e=kk(t);return e!==t&&(qf.set(t,e),ty.set(e,t)),e}const Hf=t=>ty.get(t);function Rk(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=xs(o);return r&&o.addEventListener("upgradeneeded",c=>{r(xs(o.result),c.oldVersion,c.newVersion,xs(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const Pk=["get","getKey","getAll","getAllKeys","count"],jk=["put","add","delete","clear"],Gf=new Map;function P_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Gf.get(e))return Gf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=jk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Pk.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&c.done]))[0]};return Gf.set(e,i),i}Ak(t=>({...t,get:(e,n,r)=>P_(e,n)||t.get(e,n,r),has:(e,n)=>!!P_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Vk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Vk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const xp="@firebase/app",j_="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nr=new ey("@firebase/app"),Mk="@firebase/app-compat",Ok="@firebase/analytics-compat",Lk="@firebase/analytics",Fk="@firebase/app-check-compat",Uk="@firebase/app-check",zk="@firebase/auth",$k="@firebase/auth-compat",Bk="@firebase/database",qk="@firebase/data-connect",Hk="@firebase/database-compat",Gk="@firebase/functions",Wk="@firebase/functions-compat",Kk="@firebase/installations",Qk="@firebase/installations-compat",Xk="@firebase/messaging",Yk="@firebase/messaging-compat",Jk="@firebase/performance",Zk="@firebase/performance-compat",eR="@firebase/remote-config",tR="@firebase/remote-config-compat",nR="@firebase/storage",rR="@firebase/storage-compat",sR="@firebase/firestore",iR="@firebase/ai",oR="@firebase/firestore-compat",aR="firebase",lR="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp="[DEFAULT]",cR={[xp]:"fire-core",[Mk]:"fire-core-compat",[Lk]:"fire-analytics",[Ok]:"fire-analytics-compat",[Uk]:"fire-app-check",[Fk]:"fire-app-check-compat",[zk]:"fire-auth",[$k]:"fire-auth-compat",[Bk]:"fire-rtdb",[qk]:"fire-data-connect",[Hk]:"fire-rtdb-compat",[Gk]:"fire-fn",[Wk]:"fire-fn-compat",[Kk]:"fire-iid",[Qk]:"fire-iid-compat",[Xk]:"fire-fcm",[Yk]:"fire-fcm-compat",[Jk]:"fire-perf",[Zk]:"fire-perf-compat",[eR]:"fire-rc",[tR]:"fire-rc-compat",[nR]:"fire-gcs",[rR]:"fire-gcs-compat",[sR]:"fire-fst",[oR]:"fire-fst-compat",[iR]:"fire-vertex","fire-js":"fire-js",[aR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nd=new Map,uR=new Map,Ep=new Map;function D_(t,e){try{t.container.addComponent(e)}catch(n){Nr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Cs(t){const e=t.name;if(Ep.has(e))return Nr.debug(`There were multiple attempts to register component ${e}.`),!1;Ep.set(e,t);for(const n of Nd.values())D_(n,t);for(const n of uR.values())D_(n,t);return!0}function gc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Kt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ws=new mc("app","Firebase",dR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Sr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ws.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi=lR;function LI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:wp,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ws.create("bad-app-name",{appName:String(s)});if(n||(n=kI()),!n)throw ws.create("no-options");const i=Nd.get(s);if(i){if(Ei(n,i.options)&&Ei(r,i.config))return i;throw ws.create("duplicate-app",{appName:s})}const o=new vk(s);for(const c of Ep.values())o.addComponent(c);const a=new hR(n,r,o);return Nd.set(s,a),a}function ny(t=wp){const e=Nd.get(t);if(!e&&t===wp&&kI())return LI();if(!e)throw ws.create("no-app",{appName:t});return e}function Tn(t,e,n){let r=cR[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Nr.warn(o.join(" "));return}Cs(new Sr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fR="firebase-heartbeat-database",mR=1,Kl="firebase-heartbeat-store";let Wf=null;function FI(){return Wf||(Wf=Rk(fR,mR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Kl)}catch(n){console.warn(n)}}}}).catch(t=>{throw ws.create("idb-open",{originalErrorMessage:t.message})})),Wf}async function pR(t){try{const n=(await FI()).transaction(Kl),r=await n.objectStore(Kl).get(UI(t));return await n.done,r}catch(e){if(e instanceof Un)Nr.warn(e.message);else{const n=ws.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Nr.warn(n.message)}}}async function V_(t,e){try{const r=(await FI()).transaction(Kl,"readwrite");await r.objectStore(Kl).put(e,UI(t)),await r.done}catch(n){if(n instanceof Un)Nr.warn(n.message);else{const r=ws.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Nr.warn(r.message)}}}function UI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR=1024,yR=30;class vR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=M_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>yR){const o=wR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Nr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=M_(),{heartbeatsToSend:r,unsentEntries:s}=_R(this._heartbeatsCache.heartbeats),i=Sd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Nr.warn(n),""}}}function M_(){return new Date().toISOString().substring(0,10)}function _R(t,e=gR){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),O_(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),O_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class xR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VI()?ak().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await pR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return V_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return V_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function O_(t){return Sd(JSON.stringify({version:2,heartbeats:t})).length}function wR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(t){Cs(new Sr("platform-logger",e=>new Dk(e),"PRIVATE")),Cs(new Sr("heartbeat",e=>new vR(e),"PRIVATE")),Tn(xp,j_,t),Tn(xp,j_,"esm2020"),Tn("fire-js","")}ER("");var L_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Es,zI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,y){function b(){}b.prototype=y.prototype,x.F=y.prototype,x.prototype=new b,x.prototype.constructor=x,x.D=function(k,T,P){for(var S=Array(arguments.length-2),te=2;te<arguments.length;te++)S[te-2]=arguments[te];return y.prototype[T].apply(k,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(x,y,b){b||(b=0);const k=Array(16);if(typeof y=="string")for(var T=0;T<16;++T)k[T]=y.charCodeAt(b++)|y.charCodeAt(b++)<<8|y.charCodeAt(b++)<<16|y.charCodeAt(b++)<<24;else for(T=0;T<16;++T)k[T]=y[b++]|y[b++]<<8|y[b++]<<16|y[b++]<<24;y=x.g[0],b=x.g[1],T=x.g[2];let P=x.g[3],S;S=y+(P^b&(T^P))+k[0]+3614090360&4294967295,y=b+(S<<7&4294967295|S>>>25),S=P+(T^y&(b^T))+k[1]+3905402710&4294967295,P=y+(S<<12&4294967295|S>>>20),S=T+(b^P&(y^b))+k[2]+606105819&4294967295,T=P+(S<<17&4294967295|S>>>15),S=b+(y^T&(P^y))+k[3]+3250441966&4294967295,b=T+(S<<22&4294967295|S>>>10),S=y+(P^b&(T^P))+k[4]+4118548399&4294967295,y=b+(S<<7&4294967295|S>>>25),S=P+(T^y&(b^T))+k[5]+1200080426&4294967295,P=y+(S<<12&4294967295|S>>>20),S=T+(b^P&(y^b))+k[6]+2821735955&4294967295,T=P+(S<<17&4294967295|S>>>15),S=b+(y^T&(P^y))+k[7]+4249261313&4294967295,b=T+(S<<22&4294967295|S>>>10),S=y+(P^b&(T^P))+k[8]+1770035416&4294967295,y=b+(S<<7&4294967295|S>>>25),S=P+(T^y&(b^T))+k[9]+2336552879&4294967295,P=y+(S<<12&4294967295|S>>>20),S=T+(b^P&(y^b))+k[10]+4294925233&4294967295,T=P+(S<<17&4294967295|S>>>15),S=b+(y^T&(P^y))+k[11]+2304563134&4294967295,b=T+(S<<22&4294967295|S>>>10),S=y+(P^b&(T^P))+k[12]+1804603682&4294967295,y=b+(S<<7&4294967295|S>>>25),S=P+(T^y&(b^T))+k[13]+4254626195&4294967295,P=y+(S<<12&4294967295|S>>>20),S=T+(b^P&(y^b))+k[14]+2792965006&4294967295,T=P+(S<<17&4294967295|S>>>15),S=b+(y^T&(P^y))+k[15]+1236535329&4294967295,b=T+(S<<22&4294967295|S>>>10),S=y+(T^P&(b^T))+k[1]+4129170786&4294967295,y=b+(S<<5&4294967295|S>>>27),S=P+(b^T&(y^b))+k[6]+3225465664&4294967295,P=y+(S<<9&4294967295|S>>>23),S=T+(y^b&(P^y))+k[11]+643717713&4294967295,T=P+(S<<14&4294967295|S>>>18),S=b+(P^y&(T^P))+k[0]+3921069994&4294967295,b=T+(S<<20&4294967295|S>>>12),S=y+(T^P&(b^T))+k[5]+3593408605&4294967295,y=b+(S<<5&4294967295|S>>>27),S=P+(b^T&(y^b))+k[10]+38016083&4294967295,P=y+(S<<9&4294967295|S>>>23),S=T+(y^b&(P^y))+k[15]+3634488961&4294967295,T=P+(S<<14&4294967295|S>>>18),S=b+(P^y&(T^P))+k[4]+3889429448&4294967295,b=T+(S<<20&4294967295|S>>>12),S=y+(T^P&(b^T))+k[9]+568446438&4294967295,y=b+(S<<5&4294967295|S>>>27),S=P+(b^T&(y^b))+k[14]+3275163606&4294967295,P=y+(S<<9&4294967295|S>>>23),S=T+(y^b&(P^y))+k[3]+4107603335&4294967295,T=P+(S<<14&4294967295|S>>>18),S=b+(P^y&(T^P))+k[8]+1163531501&4294967295,b=T+(S<<20&4294967295|S>>>12),S=y+(T^P&(b^T))+k[13]+2850285829&4294967295,y=b+(S<<5&4294967295|S>>>27),S=P+(b^T&(y^b))+k[2]+4243563512&4294967295,P=y+(S<<9&4294967295|S>>>23),S=T+(y^b&(P^y))+k[7]+1735328473&4294967295,T=P+(S<<14&4294967295|S>>>18),S=b+(P^y&(T^P))+k[12]+2368359562&4294967295,b=T+(S<<20&4294967295|S>>>12),S=y+(b^T^P)+k[5]+4294588738&4294967295,y=b+(S<<4&4294967295|S>>>28),S=P+(y^b^T)+k[8]+2272392833&4294967295,P=y+(S<<11&4294967295|S>>>21),S=T+(P^y^b)+k[11]+1839030562&4294967295,T=P+(S<<16&4294967295|S>>>16),S=b+(T^P^y)+k[14]+4259657740&4294967295,b=T+(S<<23&4294967295|S>>>9),S=y+(b^T^P)+k[1]+2763975236&4294967295,y=b+(S<<4&4294967295|S>>>28),S=P+(y^b^T)+k[4]+1272893353&4294967295,P=y+(S<<11&4294967295|S>>>21),S=T+(P^y^b)+k[7]+4139469664&4294967295,T=P+(S<<16&4294967295|S>>>16),S=b+(T^P^y)+k[10]+3200236656&4294967295,b=T+(S<<23&4294967295|S>>>9),S=y+(b^T^P)+k[13]+681279174&4294967295,y=b+(S<<4&4294967295|S>>>28),S=P+(y^b^T)+k[0]+3936430074&4294967295,P=y+(S<<11&4294967295|S>>>21),S=T+(P^y^b)+k[3]+3572445317&4294967295,T=P+(S<<16&4294967295|S>>>16),S=b+(T^P^y)+k[6]+76029189&4294967295,b=T+(S<<23&4294967295|S>>>9),S=y+(b^T^P)+k[9]+3654602809&4294967295,y=b+(S<<4&4294967295|S>>>28),S=P+(y^b^T)+k[12]+3873151461&4294967295,P=y+(S<<11&4294967295|S>>>21),S=T+(P^y^b)+k[15]+530742520&4294967295,T=P+(S<<16&4294967295|S>>>16),S=b+(T^P^y)+k[2]+3299628645&4294967295,b=T+(S<<23&4294967295|S>>>9),S=y+(T^(b|~P))+k[0]+4096336452&4294967295,y=b+(S<<6&4294967295|S>>>26),S=P+(b^(y|~T))+k[7]+1126891415&4294967295,P=y+(S<<10&4294967295|S>>>22),S=T+(y^(P|~b))+k[14]+2878612391&4294967295,T=P+(S<<15&4294967295|S>>>17),S=b+(P^(T|~y))+k[5]+4237533241&4294967295,b=T+(S<<21&4294967295|S>>>11),S=y+(T^(b|~P))+k[12]+1700485571&4294967295,y=b+(S<<6&4294967295|S>>>26),S=P+(b^(y|~T))+k[3]+2399980690&4294967295,P=y+(S<<10&4294967295|S>>>22),S=T+(y^(P|~b))+k[10]+4293915773&4294967295,T=P+(S<<15&4294967295|S>>>17),S=b+(P^(T|~y))+k[1]+2240044497&4294967295,b=T+(S<<21&4294967295|S>>>11),S=y+(T^(b|~P))+k[8]+1873313359&4294967295,y=b+(S<<6&4294967295|S>>>26),S=P+(b^(y|~T))+k[15]+4264355552&4294967295,P=y+(S<<10&4294967295|S>>>22),S=T+(y^(P|~b))+k[6]+2734768916&4294967295,T=P+(S<<15&4294967295|S>>>17),S=b+(P^(T|~y))+k[13]+1309151649&4294967295,b=T+(S<<21&4294967295|S>>>11),S=y+(T^(b|~P))+k[4]+4149444226&4294967295,y=b+(S<<6&4294967295|S>>>26),S=P+(b^(y|~T))+k[11]+3174756917&4294967295,P=y+(S<<10&4294967295|S>>>22),S=T+(y^(P|~b))+k[2]+718787259&4294967295,T=P+(S<<15&4294967295|S>>>17),S=b+(P^(T|~y))+k[9]+3951481745&4294967295,x.g[0]=x.g[0]+y&4294967295,x.g[1]=x.g[1]+(T+(S<<21&4294967295|S>>>11))&4294967295,x.g[2]=x.g[2]+T&4294967295,x.g[3]=x.g[3]+P&4294967295}r.prototype.v=function(x,y){y===void 0&&(y=x.length);const b=y-this.blockSize,k=this.C;let T=this.h,P=0;for(;P<y;){if(T==0)for(;P<=b;)s(this,x,P),P+=this.blockSize;if(typeof x=="string"){for(;P<y;)if(k[T++]=x.charCodeAt(P++),T==this.blockSize){s(this,k),T=0;break}}else for(;P<y;)if(k[T++]=x[P++],T==this.blockSize){s(this,k),T=0;break}}this.h=T,this.o+=y},r.prototype.A=function(){var x=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);x[0]=128;for(var y=1;y<x.length-8;++y)x[y]=0;y=this.o*8;for(var b=x.length-8;b<x.length;++b)x[b]=y&255,y/=256;for(this.v(x),x=Array(16),y=0,b=0;b<4;++b)for(let k=0;k<32;k+=8)x[y++]=this.g[b]>>>k&255;return x};function i(x,y){var b=a;return Object.prototype.hasOwnProperty.call(b,x)?b[x]:b[x]=y(x)}function o(x,y){this.h=y;const b=[];let k=!0;for(let T=x.length-1;T>=0;T--){const P=x[T]|0;k&&P==y||(b[T]=P,k=!1)}this.g=b}var a={};function c(x){return-128<=x&&x<128?i(x,function(y){return new o([y|0],y<0?-1:0)}):new o([x|0],x<0?-1:0)}function d(x){if(isNaN(x)||!isFinite(x))return m;if(x<0)return R(d(-x));const y=[];let b=1;for(let k=0;x>=b;k++)y[k]=x/b|0,b*=4294967296;return new o(y,0)}function h(x,y){if(x.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(x.charAt(0)=="-")return R(h(x.substring(1),y));if(x.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=d(Math.pow(y,8));let k=m;for(let P=0;P<x.length;P+=8){var T=Math.min(8,x.length-P);const S=parseInt(x.substring(P,P+T),y);T<8?(T=d(Math.pow(y,T)),k=k.j(T).add(d(S))):(k=k.j(b),k=k.add(d(S)))}return k}var m=c(0),p=c(1),_=c(16777216);t=o.prototype,t.m=function(){if(C(this))return-R(this).m();let x=0,y=1;for(let b=0;b<this.g.length;b++){const k=this.i(b);x+=(k>=0?k:4294967296+k)*y,y*=4294967296}return x},t.toString=function(x){if(x=x||10,x<2||36<x)throw Error("radix out of range: "+x);if(A(this))return"0";if(C(this))return"-"+R(this).toString(x);const y=d(Math.pow(x,6));var b=this;let k="";for(;;){const T=N(b,y).g;b=E(b,T.j(y));let P=((b.g.length>0?b.g[0]:b.h)>>>0).toString(x);if(b=T,A(b))return P+k;for(;P.length<6;)P="0"+P;k=P+k}},t.i=function(x){return x<0?0:x<this.g.length?this.g[x]:this.h};function A(x){if(x.h!=0)return!1;for(let y=0;y<x.g.length;y++)if(x.g[y]!=0)return!1;return!0}function C(x){return x.h==-1}t.l=function(x){return x=E(this,x),C(x)?-1:A(x)?0:1};function R(x){const y=x.g.length,b=[];for(let k=0;k<y;k++)b[k]=~x.g[k];return new o(b,~x.h).add(p)}t.abs=function(){return C(this)?R(this):this},t.add=function(x){const y=Math.max(this.g.length,x.g.length),b=[];let k=0;for(let T=0;T<=y;T++){let P=k+(this.i(T)&65535)+(x.i(T)&65535),S=(P>>>16)+(this.i(T)>>>16)+(x.i(T)>>>16);k=S>>>16,P&=65535,S&=65535,b[T]=S<<16|P}return new o(b,b[b.length-1]&-2147483648?-1:0)};function E(x,y){return x.add(R(y))}t.j=function(x){if(A(this)||A(x))return m;if(C(this))return C(x)?R(this).j(R(x)):R(R(this).j(x));if(C(x))return R(this.j(R(x)));if(this.l(_)<0&&x.l(_)<0)return d(this.m()*x.m());const y=this.g.length+x.g.length,b=[];for(var k=0;k<2*y;k++)b[k]=0;for(k=0;k<this.g.length;k++)for(let T=0;T<x.g.length;T++){const P=this.i(k)>>>16,S=this.i(k)&65535,te=x.i(T)>>>16,ae=x.i(T)&65535;b[2*k+2*T]+=S*ae,v(b,2*k+2*T),b[2*k+2*T+1]+=P*ae,v(b,2*k+2*T+1),b[2*k+2*T+1]+=S*te,v(b,2*k+2*T+1),b[2*k+2*T+2]+=P*te,v(b,2*k+2*T+2)}for(x=0;x<y;x++)b[x]=b[2*x+1]<<16|b[2*x];for(x=y;x<2*y;x++)b[x]=0;return new o(b,0)};function v(x,y){for(;(x[y]&65535)!=x[y];)x[y+1]+=x[y]>>>16,x[y]&=65535,y++}function w(x,y){this.g=x,this.h=y}function N(x,y){if(A(y))throw Error("division by zero");if(A(x))return new w(m,m);if(C(x))return y=N(R(x),y),new w(R(y.g),R(y.h));if(C(y))return y=N(x,R(y)),new w(R(y.g),y.h);if(x.g.length>30){if(C(x)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var b=p,k=y;k.l(x)<=0;)b=D(b),k=D(k);var T=O(b,1),P=O(k,1);for(k=O(k,2),b=O(b,2);!A(k);){var S=P.add(k);S.l(x)<=0&&(T=T.add(b),P=S),k=O(k,1),b=O(b,1)}return y=E(x,T.j(y)),new w(T,y)}for(T=m;x.l(y)>=0;){for(b=Math.max(1,Math.floor(x.m()/y.m())),k=Math.ceil(Math.log(b)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),P=d(b),S=P.j(y);C(S)||S.l(x)>0;)b-=k,P=d(b),S=P.j(y);A(P)&&(P=p),T=T.add(P),x=E(x,S)}return new w(T,x)}t.B=function(x){return N(this,x).h},t.and=function(x){const y=Math.max(this.g.length,x.g.length),b=[];for(let k=0;k<y;k++)b[k]=this.i(k)&x.i(k);return new o(b,this.h&x.h)},t.or=function(x){const y=Math.max(this.g.length,x.g.length),b=[];for(let k=0;k<y;k++)b[k]=this.i(k)|x.i(k);return new o(b,this.h|x.h)},t.xor=function(x){const y=Math.max(this.g.length,x.g.length),b=[];for(let k=0;k<y;k++)b[k]=this.i(k)^x.i(k);return new o(b,this.h^x.h)};function D(x){const y=x.g.length+1,b=[];for(let k=0;k<y;k++)b[k]=x.i(k)<<1|x.i(k-1)>>>31;return new o(b,x.h)}function O(x,y){const b=y>>5;y%=32;const k=x.g.length-b,T=[];for(let P=0;P<k;P++)T[P]=y>0?x.i(P+b)>>>y|x.i(P+b+1)<<32-y:x.i(P+b);return new o(T,x.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,zI=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Es=o}).apply(typeof L_<"u"?L_:typeof self<"u"?self:typeof window<"u"?window:{});var uu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $I,nl,BI,Ou,Ip,qI,HI,GI;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof uu=="object"&&uu];for(var f=0;f<l.length;++f){var g=l[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(l,f){if(f)e:{var g=r;l=l.split(".");for(var I=0;I<l.length-1;I++){var M=l[I];if(!(M in g))break e;g=g[M]}l=l[l.length-1],I=g[l],f=f(I),f!=I&&f!=null&&e(g,l,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(f){var g=[],I;for(I in f)Object.prototype.hasOwnProperty.call(f,I)&&g.push([I,f[I]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function c(l,f,g){return l.call.apply(l.bind,arguments)}function d(l,f,g){return d=c,d.apply(null,arguments)}function h(l,f){var g=Array.prototype.slice.call(arguments,1);return function(){var I=g.slice();return I.push.apply(I,arguments),l.apply(this,I)}}function m(l,f){function g(){}g.prototype=f.prototype,l.Z=f.prototype,l.prototype=new g,l.prototype.constructor=l,l.Ob=function(I,M,L){for(var J=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)J[ye-2]=arguments[ye];return f.prototype[M].apply(I,J)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function _(l){const f=l.length;if(f>0){const g=Array(f);for(let I=0;I<f;I++)g[I]=l[I];return g}return[]}function A(l,f){for(let I=1;I<arguments.length;I++){const M=arguments[I];var g=typeof M;if(g=g!="object"?g:M?Array.isArray(M)?"array":g:"null",g=="array"||g=="object"&&typeof M.length=="number"){g=l.length||0;const L=M.length||0;l.length=g+L;for(let J=0;J<L;J++)l[g+J]=M[J]}else l.push(M)}}class C{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function R(l){o.setTimeout(()=>{throw l},0)}function E(){var l=x;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class v{constructor(){this.h=this.g=null}add(f,g){const I=w.get();I.set(f,g),this.h?this.h.next=I:this.g=I,this.h=I}}var w=new C(()=>new N,l=>l.reset());class N{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let D,O=!1,x=new v,y=()=>{const l=Promise.resolve(void 0);D=()=>{l.then(b)}};function b(){for(var l;l=E();){try{l.h.call(l.g)}catch(g){R(g)}var f=w;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}O=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function T(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var P=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};o.addEventListener("test",g,f),o.removeEventListener("test",g,f)}catch{}return l}();function S(l){return/^[\s\xa0]*$/.test(l)}function te(l,f){T.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}m(te,T),te.prototype.init=function(l,f){const g=this.type=l.type,I=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(g=="mouseover"?f=l.fromElement:g=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,I?(this.clientX=I.clientX!==void 0?I.clientX:I.pageX,this.clientY=I.clientY!==void 0?I.clientY:I.pageY,this.screenX=I.screenX||0,this.screenY=I.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&te.Z.h.call(this)},te.prototype.h=function(){te.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ae="closure_listenable_"+(Math.random()*1e6|0),K=0;function we(l,f,g,I,M){this.listener=l,this.proxy=null,this.src=f,this.type=g,this.capture=!!I,this.ha=M,this.key=++K,this.da=this.fa=!1}function B(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function F(l,f,g){for(const I in l)f.call(g,l[I],I,l)}function G(l,f){for(const g in l)f.call(void 0,l[g],g,l)}function Y(l){const f={};for(const g in l)f[g]=l[g];return f}const X="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function he(l,f){let g,I;for(let M=1;M<arguments.length;M++){I=arguments[M];for(g in I)l[g]=I[g];for(let L=0;L<X.length;L++)g=X[L],Object.prototype.hasOwnProperty.call(I,g)&&(l[g]=I[g])}}function ue(l){this.src=l,this.g={},this.h=0}ue.prototype.add=function(l,f,g,I,M){const L=l.toString();l=this.g[L],l||(l=this.g[L]=[],this.h++);const J=_e(l,f,I,M);return J>-1?(f=l[J],g||(f.fa=!1)):(f=new we(f,this.src,L,!!I,M),f.fa=g,l.push(f)),f};function Se(l,f){const g=f.type;if(g in l.g){var I=l.g[g],M=Array.prototype.indexOf.call(I,f,void 0),L;(L=M>=0)&&Array.prototype.splice.call(I,M,1),L&&(B(f),l.g[g].length==0&&(delete l.g[g],l.h--))}}function _e(l,f,g,I){for(let M=0;M<l.length;++M){const L=l[M];if(!L.da&&L.listener==f&&L.capture==!!g&&L.ha==I)return M}return-1}var ke="closure_lm_"+(Math.random()*1e6|0),Ve={};function Ct(l,f,g,I,M){if(Array.isArray(f)){for(let L=0;L<f.length;L++)Ct(l,f[L],g,I,M);return null}return g=$i(g),l&&l[ae]?l.J(f,g,a(I)?!!I.capture:!1,M):zn(l,f,g,!1,I,M)}function zn(l,f,g,I,M,L){if(!f)throw Error("Invalid event type");const J=a(M)?!!M.capture:!!M;let ye=Bn(l);if(ye||(l[ke]=ye=new ue(l)),g=ye.add(f,g,I,J,L),g.proxy)return g;if(I=Ui(),g.proxy=I,I.src=l,I.listener=g,l.addEventListener)P||(M=J),M===void 0&&(M=!1),l.addEventListener(f.toString(),I,M);else if(l.attachEvent)l.attachEvent(zi(f.toString()),I);else if(l.addListener&&l.removeListener)l.addListener(I);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Ui(){function l(g){return f.call(l.src,l.listener,g)}const f=vt;return l}function Lr(l,f,g,I,M){if(Array.isArray(f))for(var L=0;L<f.length;L++)Lr(l,f[L],g,I,M);else I=a(I)?!!I.capture:!!I,g=$i(g),l&&l[ae]?(l=l.i,L=String(f).toString(),L in l.g&&(f=l.g[L],g=_e(f,g,I,M),g>-1&&(B(f[g]),Array.prototype.splice.call(f,g,1),f.length==0&&(delete l.g[L],l.h--)))):l&&(l=Bn(l))&&(f=l.g[f.toString()],l=-1,f&&(l=_e(f,g,I,M)),(g=l>-1?f[l]:null)&&$n(g))}function $n(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[ae])Se(f.i,l);else{var g=l.type,I=l.proxy;f.removeEventListener?f.removeEventListener(g,I,l.capture):f.detachEvent?f.detachEvent(zi(g),I):f.addListener&&f.removeListener&&f.removeListener(I),(g=Bn(f))?(Se(g,l),g.h==0&&(g.src=null,f[ke]=null)):B(l)}}}function zi(l){return l in Ve?Ve[l]:Ve[l]="on"+l}function vt(l,f){if(l.da)l=!0;else{f=new te(f,this);const g=l.listener,I=l.ha||l.src;l.fa&&$n(l),l=g.call(I,f)}return l}function Bn(l){return l=l[ke],l instanceof ue?l:null}var Bs="__closure_events_fn_"+(Math.random()*1e9>>>0);function $i(l){return typeof l=="function"?l:(l[Bs]||(l[Bs]=function(f){return l.handleEvent(f)}),l[Bs])}function $(){k.call(this),this.i=new ue(this),this.M=this,this.G=null}m($,k),$.prototype[ae]=!0,$.prototype.removeEventListener=function(l,f,g,I){Lr(this,l,f,g,I)};function le(l,f){var g,I=l.G;if(I)for(g=[];I;I=I.G)g.push(I);if(l=l.M,I=f.type||f,typeof f=="string")f=new T(f,l);else if(f instanceof T)f.target=f.target||l;else{var M=f;f=new T(I,l),he(f,M)}M=!0;let L,J;if(g)for(J=g.length-1;J>=0;J--)L=f.g=g[J],M=U(L,I,!0,f)&&M;if(L=f.g=l,M=U(L,I,!0,f)&&M,M=U(L,I,!1,f)&&M,g)for(J=0;J<g.length;J++)L=f.g=g[J],M=U(L,I,!1,f)&&M}$.prototype.N=function(){if($.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const g=l.g[f];for(let I=0;I<g.length;I++)B(g[I]);delete l.g[f],l.h--}}this.G=null},$.prototype.J=function(l,f,g,I){return this.i.add(String(l),f,!1,g,I)},$.prototype.K=function(l,f,g,I){return this.i.add(String(l),f,!0,g,I)};function U(l,f,g,I){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let M=!0;for(let L=0;L<f.length;++L){const J=f[L];if(J&&!J.da&&J.capture==g){const ye=J.listener,dt=J.ha||J.src;J.fa&&Se(l.i,J),M=ye.call(dt,I)!==!1&&M}}return M&&!I.defaultPrevented}function Z(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(l,f||0)}function ne(l){l.g=Z(()=>{l.g=null,l.i&&(l.i=!1,ne(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class fe extends k{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ne(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ge(l){k.call(this),this.h=l,this.g={}}m(ge,k);var Ae=[];function Nn(l){F(l.g,function(f,g){this.g.hasOwnProperty(g)&&$n(f)},l),l.g={}}ge.prototype.N=function(){ge.Z.N.call(this),Nn(this)},ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Gt=o.JSON.stringify,Jh=o.JSON.parse,NN=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function wv(){}function Ev(){}var va={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Zh(){T.call(this,"d")}m(Zh,T);function ef(){T.call(this,"c")}m(ef,T);var qs={},Iv=null;function Mc(){return Iv=Iv||new $}qs.Ia="serverreachability";function Tv(l){T.call(this,qs.Ia,l)}m(Tv,T);function _a(l){const f=Mc();le(f,new Tv(f))}qs.STAT_EVENT="statevent";function bv(l,f){T.call(this,qs.STAT_EVENT,l),this.stat=f}m(bv,T);function Ft(l){const f=Mc();le(f,new bv(f,l))}qs.Ja="timingevent";function Sv(l,f){T.call(this,qs.Ja,l),this.size=f}m(Sv,T);function xa(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},f)}function wa(){this.g=!0}wa.prototype.ua=function(){this.g=!1};function AN(l,f,g,I,M,L){l.info(function(){if(l.g)if(L){var J="",ye=L.split("&");for(let Le=0;Le<ye.length;Le++){var dt=ye[Le].split("=");if(dt.length>1){const _t=dt[0];dt=dt[1];const Hn=_t.split("_");J=Hn.length>=2&&Hn[1]=="type"?J+(_t+"="+dt+"&"):J+(_t+"=redacted&")}}}else J=null;else J=L;return"XMLHTTP REQ ("+I+") [attempt "+M+"]: "+f+`
`+g+`
`+J})}function CN(l,f,g,I,M,L,J){l.info(function(){return"XMLHTTP RESP ("+I+") [ attempt "+M+"]: "+f+`
`+g+`
`+L+" "+J})}function Bi(l,f,g,I){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+RN(l,g)+(I?" "+I:"")})}function kN(l,f){l.info(function(){return"TIMEOUT: "+f})}wa.prototype.info=function(){};function RN(l,f){if(!l.g)return f;if(!f)return null;try{const L=JSON.parse(f);if(L){for(l=0;l<L.length;l++)if(Array.isArray(L[l])){var g=L[l];if(!(g.length<2)){var I=g[1];if(Array.isArray(I)&&!(I.length<1)){var M=I[0];if(M!="noop"&&M!="stop"&&M!="close")for(let J=1;J<I.length;J++)I[J]=""}}}}return Gt(L)}catch{return f}}var Oc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Nv={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Av;function tf(){}m(tf,wv),tf.prototype.g=function(){return new XMLHttpRequest},Av=new tf;function Ea(l){return encodeURIComponent(String(l))}function PN(l){var f=1;l=l.split(":");const g=[];for(;f>0&&l.length;)g.push(l.shift()),f--;return l.length&&g.push(l.join(":")),g}function Fr(l,f,g,I){this.j=l,this.i=f,this.l=g,this.S=I||1,this.V=new ge(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Cv}function Cv(){this.i=null,this.g="",this.h=!1}var kv={},nf={};function rf(l,f,g){l.M=1,l.A=Fc(qn(f)),l.u=g,l.R=!0,Rv(l,null)}function Rv(l,f){l.F=Date.now(),Lc(l),l.B=qn(l.A);var g=l.B,I=l.S;Array.isArray(I)||(I=[String(I)]),qv(g.i,"t",I),l.C=0,g=l.j.L,l.h=new Cv,l.g=l0(l.j,g?f:null,!l.u),l.P>0&&(l.O=new fe(d(l.Y,l,l.g),l.P)),f=l.V,g=l.g,I=l.ba;var M="readystatechange";Array.isArray(M)||(M&&(Ae[0]=M.toString()),M=Ae);for(let L=0;L<M.length;L++){const J=Ct(g,M[L],I||f.handleEvent,!1,f.h||f);if(!J)break;f.g[J.key]=J}f=l.J?Y(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),_a(),AN(l.i,l.v,l.B,l.l,l.S,l.u)}Fr.prototype.ba=function(l){l=l.target;const f=this.O;f&&$r(l)==3?f.j():this.Y(l)},Fr.prototype.Y=function(l){try{if(l==this.g)e:{const ye=$r(this.g),dt=this.g.ya(),Le=this.g.ca();if(!(ye<3)&&(ye!=3||this.g&&(this.h.h||this.g.la()||Yv(this.g)))){this.K||ye!=4||dt==7||(dt==8||Le<=0?_a(3):_a(2)),sf(this);var f=this.g.ca();this.X=f;var g=jN(this);if(this.o=f==200,CN(this.i,this.v,this.B,this.l,this.S,ye,f),this.o){if(this.U&&!this.L){t:{if(this.g){var I,M=this.g;if((I=M.g?M.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(I)){var L=I;break t}}L=null}if(l=L)Bi(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,of(this,l);else{this.o=!1,this.m=3,Ft(12),Hs(this),Ia(this);break e}}if(this.R){l=!0;let _t;for(;!this.K&&this.C<g.length;)if(_t=DN(this,g),_t==nf){ye==4&&(this.m=4,Ft(14),l=!1),Bi(this.i,this.l,null,"[Incomplete Response]");break}else if(_t==kv){this.m=4,Ft(15),Bi(this.i,this.l,g,"[Invalid Chunk]"),l=!1;break}else Bi(this.i,this.l,_t,null),of(this,_t);if(Pv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ye!=4||g.length!=0||this.h.h||(this.m=1,Ft(16),l=!1),this.o=this.o&&l,!l)Bi(this.i,this.l,g,"[Invalid Chunked Response]"),Hs(this),Ia(this);else if(g.length>0&&!this.W){this.W=!0;var J=this.j;J.g==this&&J.aa&&!J.P&&(J.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),mf(J),J.P=!0,Ft(11))}}else Bi(this.i,this.l,g,null),of(this,g);ye==4&&Hs(this),this.o&&!this.K&&(ye==4?s0(this.j,this):(this.o=!1,Lc(this)))}else KN(this.g),f==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ft(12)):(this.m=0,Ft(13)),Hs(this),Ia(this)}}}catch{}finally{}};function jN(l){if(!Pv(l))return l.g.la();const f=Yv(l.g);if(f==="")return"";let g="";const I=f.length,M=$r(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Hs(l),Ia(l),"";l.h.i=new o.TextDecoder}for(let L=0;L<I;L++)l.h.h=!0,g+=l.h.i.decode(f[L],{stream:!(M&&L==I-1)});return f.length=0,l.h.g+=g,l.C=0,l.h.g}function Pv(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function DN(l,f){var g=l.C,I=f.indexOf(`
`,g);return I==-1?nf:(g=Number(f.substring(g,I)),isNaN(g)?kv:(I+=1,I+g>f.length?nf:(f=f.slice(I,I+g),l.C=I+g,f)))}Fr.prototype.cancel=function(){this.K=!0,Hs(this)};function Lc(l){l.T=Date.now()+l.H,jv(l,l.H)}function jv(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=xa(d(l.aa,l),f)}function sf(l){l.D&&(o.clearTimeout(l.D),l.D=null)}Fr.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(kN(this.i,this.B),this.M!=2&&(_a(),Ft(17)),Hs(this),this.m=2,Ia(this)):jv(this,this.T-l)};function Ia(l){l.j.I==0||l.K||s0(l.j,l)}function Hs(l){sf(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,Nn(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function of(l,f){try{var g=l.j;if(g.I!=0&&(g.g==l||af(g.h,l))){if(!l.L&&af(g.h,l)&&g.I==3){try{var I=g.Ba.g.parse(f)}catch{I=null}if(Array.isArray(I)&&I.length==3){var M=I;if(M[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<l.F)qc(g),$c(g);else break e;ff(g),Ft(18)}}else g.xa=M[1],0<g.xa-g.K&&M[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=xa(d(g.Va,g),6e3));Mv(g.h)<=1&&g.ta&&(g.ta=void 0)}else Ws(g,11)}else if((l.L||g.g==l)&&qc(g),!S(f))for(M=g.Ba.g.parse(f),f=0;f<M.length;f++){let Le=M[f];const _t=Le[0];if(!(_t<=g.K))if(g.K=_t,Le=Le[1],g.I==2)if(Le[0]=="c"){g.M=Le[1],g.ba=Le[2];const Hn=Le[3];Hn!=null&&(g.ka=Hn,g.j.info("VER="+g.ka));const Ks=Le[4];Ks!=null&&(g.za=Ks,g.j.info("SVER="+g.za));const Br=Le[5];Br!=null&&typeof Br=="number"&&Br>0&&(I=1.5*Br,g.O=I,g.j.info("backChannelRequestTimeoutMs_="+I)),I=g;const qr=l.g;if(qr){const Gc=qr.g?qr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Gc){var L=I.h;L.g||Gc.indexOf("spdy")==-1&&Gc.indexOf("quic")==-1&&Gc.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(lf(L,L.h),L.h=null))}if(I.G){const pf=qr.g?qr.g.getResponseHeader("X-HTTP-Session-Id"):null;pf&&(I.wa=pf,$e(I.J,I.G,pf))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-l.F,g.j.info("Handshake RTT: "+g.T+"ms")),I=g;var J=l;if(I.na=a0(I,I.L?I.ba:null,I.W),J.L){Ov(I.h,J);var ye=J,dt=I.O;dt&&(ye.H=dt),ye.D&&(sf(ye),Lc(ye)),I.g=J}else n0(I);g.i.length>0&&Bc(g)}else Le[0]!="stop"&&Le[0]!="close"||Ws(g,7);else g.I==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?Ws(g,7):hf(g):Le[0]!="noop"&&g.l&&g.l.qa(Le),g.A=0)}}_a(4)}catch{}}var VN=class{constructor(l,f){this.g=l,this.map=f}};function Dv(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Vv(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Mv(l){return l.h?1:l.g?l.g.size:0}function af(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function lf(l,f){l.g?l.g.add(f):l.h=f}function Ov(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Dv.prototype.cancel=function(){if(this.i=Lv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Lv(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const g of l.g.values())f=f.concat(g.G);return f}return _(l.i)}var Fv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function MN(l,f){if(l){l=l.split("&");for(let g=0;g<l.length;g++){const I=l[g].indexOf("=");let M,L=null;I>=0?(M=l[g].substring(0,I),L=l[g].substring(I+1)):M=l[g],f(M,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function Ur(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof Ur?(this.l=l.l,Ta(this,l.j),this.o=l.o,this.g=l.g,ba(this,l.u),this.h=l.h,cf(this,Hv(l.i)),this.m=l.m):l&&(f=String(l).match(Fv))?(this.l=!1,Ta(this,f[1]||"",!0),this.o=Sa(f[2]||""),this.g=Sa(f[3]||"",!0),ba(this,f[4]),this.h=Sa(f[5]||"",!0),cf(this,f[6]||"",!0),this.m=Sa(f[7]||"")):(this.l=!1,this.i=new Aa(null,this.l))}Ur.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(Na(f,Uv,!0),":");var g=this.g;return(g||f=="file")&&(l.push("//"),(f=this.o)&&l.push(Na(f,Uv,!0),"@"),l.push(Ea(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&l.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Na(g,g.charAt(0)=="/"?FN:LN,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Na(g,zN)),l.join("")},Ur.prototype.resolve=function(l){const f=qn(this);let g=!!l.j;g?Ta(f,l.j):g=!!l.o,g?f.o=l.o:g=!!l.g,g?f.g=l.g:g=l.u!=null;var I=l.h;if(g)ba(f,l.u);else if(g=!!l.h){if(I.charAt(0)!="/")if(this.g&&!this.h)I="/"+I;else{var M=f.h.lastIndexOf("/");M!=-1&&(I=f.h.slice(0,M+1)+I)}if(M=I,M==".."||M==".")I="";else if(M.indexOf("./")!=-1||M.indexOf("/.")!=-1){I=M.lastIndexOf("/",0)==0,M=M.split("/");const L=[];for(let J=0;J<M.length;){const ye=M[J++];ye=="."?I&&J==M.length&&L.push(""):ye==".."?((L.length>1||L.length==1&&L[0]!="")&&L.pop(),I&&J==M.length&&L.push("")):(L.push(ye),I=!0)}I=L.join("/")}else I=M}return g?f.h=I:g=l.i.toString()!=="",g?cf(f,Hv(l.i)):g=!!l.m,g&&(f.m=l.m),f};function qn(l){return new Ur(l)}function Ta(l,f,g){l.j=g?Sa(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function ba(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function cf(l,f,g){f instanceof Aa?(l.i=f,$N(l.i,l.l)):(g||(f=Na(f,UN)),l.i=new Aa(f,l.l))}function $e(l,f,g){l.i.set(f,g)}function Fc(l){return $e(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function Sa(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Na(l,f,g){return typeof l=="string"?(l=encodeURI(l).replace(f,ON),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function ON(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Uv=/[#\/\?@]/g,LN=/[#\?:]/g,FN=/[#\?]/g,UN=/[#\?@]/g,zN=/#/g;function Aa(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Gs(l){l.g||(l.g=new Map,l.h=0,l.i&&MN(l.i,function(f,g){l.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=Aa.prototype,t.add=function(l,f){Gs(this),this.i=null,l=qi(this,l);let g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(f),this.h+=1,this};function zv(l,f){Gs(l),f=qi(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function $v(l,f){return Gs(l),f=qi(l,f),l.g.has(f)}t.forEach=function(l,f){Gs(this),this.g.forEach(function(g,I){g.forEach(function(M){l.call(f,M,I,this)},this)},this)};function Bv(l,f){Gs(l);let g=[];if(typeof f=="string")$v(l,f)&&(g=g.concat(l.g.get(qi(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)g=g.concat(l[f]);return g}t.set=function(l,f){return Gs(this),this.i=null,l=qi(this,l),$v(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=Bv(this,l),l.length>0?String(l[0]):f):f};function qv(l,f,g){zv(l,f),g.length>0&&(l.i=null,l.g.set(qi(l,f),_(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let I=0;I<f.length;I++){var g=f[I];const M=Ea(g);g=Bv(this,g);for(let L=0;L<g.length;L++){let J=M;g[L]!==""&&(J+="="+Ea(g[L])),l.push(J)}}return this.i=l.join("&")};function Hv(l){const f=new Aa;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function qi(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function $N(l,f){f&&!l.j&&(Gs(l),l.i=null,l.g.forEach(function(g,I){const M=I.toLowerCase();I!=M&&(zv(this,I),qv(this,M,g))},l)),l.j=f}function BN(l,f){const g=new wa;if(o.Image){const I=new Image;I.onload=h(zr,g,"TestLoadImage: loaded",!0,f,I),I.onerror=h(zr,g,"TestLoadImage: error",!1,f,I),I.onabort=h(zr,g,"TestLoadImage: abort",!1,f,I),I.ontimeout=h(zr,g,"TestLoadImage: timeout",!1,f,I),o.setTimeout(function(){I.ontimeout&&I.ontimeout()},1e4),I.src=l}else f(!1)}function qN(l,f){const g=new wa,I=new AbortController,M=setTimeout(()=>{I.abort(),zr(g,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:I.signal}).then(L=>{clearTimeout(M),L.ok?zr(g,"TestPingServer: ok",!0,f):zr(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(M),zr(g,"TestPingServer: error",!1,f)})}function zr(l,f,g,I,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),I(g)}catch{}}function HN(){this.g=new NN}function uf(l){this.i=l.Sb||null,this.h=l.ab||!1}m(uf,wv),uf.prototype.g=function(){return new Uc(this.i,this.h)};function Uc(l,f){$.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Uc,$),t=Uc.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,ka(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ca(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ka(this)),this.g&&(this.readyState=3,ka(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Gv(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Gv(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?Ca(this):ka(this),this.readyState==3&&Gv(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,Ca(this))},t.Na=function(l){this.g&&(this.response=l,Ca(this))},t.ga=function(){this.g&&Ca(this)};function Ca(l){l.readyState=4,l.l=null,l.j=null,l.B=null,ka(l)}t.setRequestHeader=function(l,f){this.A.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=f.next();return l.join(`\r
`)};function ka(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Uc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Wv(l){let f="";return F(l,function(g,I){f+=I,f+=":",f+=g,f+=`\r
`}),f}function df(l,f,g){e:{for(I in g){var I=!1;break e}I=!0}I||(g=Wv(g),typeof l=="string"?g!=null&&Ea(g):$e(l,f,g))}function Ye(l){$.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Ye,$);var GN=/^https?$/i,WN=["POST","PUT"];t=Ye.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,f,g,I){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Av.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(L){Kv(this,L);return}if(l=g||"",g=new Map(this.headers),I)if(Object.getPrototypeOf(I)===Object.prototype)for(var M in I)g.set(M,I[M]);else if(typeof I.keys=="function"&&typeof I.get=="function")for(const L of I.keys())g.set(L,I.get(L));else throw Error("Unknown input type for opt_headers: "+String(I));I=Array.from(g.keys()).find(L=>L.toLowerCase()=="content-type"),M=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(WN,f,void 0)>=0)||I||M||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,J]of g)this.g.setRequestHeader(L,J);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(L){Kv(this,L)}};function Kv(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,Qv(l),zc(l)}function Qv(l){l.A||(l.A=!0,le(l,"complete"),le(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,le(this,"complete"),le(this,"abort"),zc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),zc(this,!0)),Ye.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Xv(this):this.Xa())},t.Xa=function(){Xv(this)};function Xv(l){if(l.h&&typeof i<"u"){if(l.v&&$r(l)==4)setTimeout(l.Ca.bind(l),0);else if(le(l,"readystatechange"),$r(l)==4){l.h=!1;try{const L=l.ca();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var I;if(I=L===0){let J=String(l.D).match(Fv)[1]||null;!J&&o.self&&o.self.location&&(J=o.self.location.protocol.slice(0,-1)),I=!GN.test(J?J.toLowerCase():"")}g=I}if(g)le(l,"complete"),le(l,"success");else{l.o=6;try{var M=$r(l)>2?l.g.statusText:""}catch{M=""}l.l=M+" ["+l.ca()+"]",Qv(l)}}finally{zc(l)}}}}function zc(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const g=l.g;l.g=null,f||le(l,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function $r(l){return l.g?l.g.readyState:0}t.ca=function(){try{return $r(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Jh(f)}};function Yv(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function KN(l){const f={};l=(l.g&&$r(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let I=0;I<l.length;I++){if(S(l[I]))continue;var g=PN(l[I]);const M=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const L=f[M]||[];f[M]=L,L.push(g)}G(f,function(I){return I.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ra(l,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||f}function Jv(l){this.za=0,this.i=[],this.j=new wa,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Ra("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Ra("baseRetryDelayMs",5e3,l),this.Za=Ra("retryDelaySeedMs",1e4,l),this.Ta=Ra("forwardChannelMaxRetries",2,l),this.va=Ra("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Dv(l&&l.concurrentRequestLimit),this.Ba=new HN,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Jv.prototype,t.ka=8,t.I=1,t.connect=function(l,f,g,I){Ft(0),this.W=l,this.H=f||{},g&&I!==void 0&&(this.H.OSID=g,this.H.OAID=I),this.F=this.X,this.J=a0(this,null,this.W),Bc(this)};function hf(l){if(Zv(l),l.I==3){var f=l.V++,g=qn(l.J);if($e(g,"SID",l.M),$e(g,"RID",f),$e(g,"TYPE","terminate"),Pa(l,g),f=new Fr(l,l.j,f),f.M=2,f.A=Fc(qn(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=f.A,g=!0),g||(f.g=l0(f.j,null),f.g.ea(f.A)),f.F=Date.now(),Lc(f)}o0(l)}function $c(l){l.g&&(mf(l),l.g.cancel(),l.g=null)}function Zv(l){$c(l),l.v&&(o.clearTimeout(l.v),l.v=null),qc(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function Bc(l){if(!Vv(l.h)&&!l.m){l.m=!0;var f=l.Ea;D||y(),O||(D(),O=!0),x.add(f,l),l.D=0}}function QN(l,f){return Mv(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=xa(d(l.Ea,l,f),i0(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const M=new Fr(this,this.j,l);let L=this.o;if(this.U&&(L?(L=Y(L),he(L,this.U)):L=this.U),this.u!==null||this.R||(M.J=L,L=null),this.S)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var I=this.i[g];if("__data__"in I.map&&(I=I.map.__data__,typeof I=="string")){I=I.length;break t}I=void 0}if(I===void 0)break;if(f+=I,f>4096){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=t0(this,M,f),g=qn(this.J),$e(g,"RID",l),$e(g,"CVER",22),this.G&&$e(g,"X-HTTP-Session-Id",this.G),Pa(this,g),L&&(this.R?f="headers="+Ea(Wv(L))+"&"+f:this.u&&df(g,this.u,L)),lf(this.h,M),this.Ra&&$e(g,"TYPE","init"),this.S?($e(g,"$req",f),$e(g,"SID","null"),M.U=!0,rf(M,g,null)):rf(M,g,f),this.I=2}}else this.I==3&&(l?e0(this,l):this.i.length==0||Vv(this.h)||e0(this))};function e0(l,f){var g;f?g=f.l:g=l.V++;const I=qn(l.J);$e(I,"SID",l.M),$e(I,"RID",g),$e(I,"AID",l.K),Pa(l,I),l.u&&l.o&&df(I,l.u,l.o),g=new Fr(l,l.j,g,l.D+1),l.u===null&&(g.J=l.o),f&&(l.i=f.G.concat(l.i)),f=t0(l,g,1e3),g.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),lf(l.h,g),rf(g,I,f)}function Pa(l,f){l.H&&F(l.H,function(g,I){$e(f,I,g)}),l.l&&F({},function(g,I){$e(f,I,g)})}function t0(l,f,g){g=Math.min(l.i.length,g);const I=l.l?d(l.l.Ka,l.l,l):null;e:{var M=l.i;let ye=-1;for(;;){const dt=["count="+g];ye==-1?g>0?(ye=M[0].g,dt.push("ofs="+ye)):ye=0:dt.push("ofs="+ye);let Le=!0;for(let _t=0;_t<g;_t++){var L=M[_t].g;const Hn=M[_t].map;if(L-=ye,L<0)ye=Math.max(0,M[_t].g-100),Le=!1;else try{L="req"+L+"_"||"";try{var J=Hn instanceof Map?Hn:Object.entries(Hn);for(const[Ks,Br]of J){let qr=Br;a(Br)&&(qr=Gt(Br)),dt.push(L+Ks+"="+encodeURIComponent(qr))}}catch(Ks){throw dt.push(L+"type="+encodeURIComponent("_badmap")),Ks}}catch{I&&I(Hn)}}if(Le){J=dt.join("&");break e}}J=void 0}return l=l.i.splice(0,g),f.G=l,J}function n0(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;D||y(),O||(D(),O=!0),x.add(f,l),l.A=0}}function ff(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=xa(d(l.Da,l),i0(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,r0(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=xa(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ft(10),$c(this),r0(this))};function mf(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function r0(l){l.g=new Fr(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=qn(l.na);$e(f,"RID","rpc"),$e(f,"SID",l.M),$e(f,"AID",l.K),$e(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&$e(f,"TO",l.ia),$e(f,"TYPE","xmlhttp"),Pa(l,f),l.u&&l.o&&df(f,l.u,l.o),l.O&&(l.g.H=l.O);var g=l.g;l=l.ba,g.M=1,g.A=Fc(qn(f)),g.u=null,g.R=!0,Rv(g,l)}t.Va=function(){this.C!=null&&(this.C=null,$c(this),ff(this),Ft(19))};function qc(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function s0(l,f){var g=null;if(l.g==f){qc(l),mf(l),l.g=null;var I=2}else if(af(l.h,f))g=f.G,Ov(l.h,f),I=1;else return;if(l.I!=0){if(f.o)if(I==1){g=f.u?f.u.length:0,f=Date.now()-f.F;var M=l.D;I=Mc(),le(I,new Sv(I,g)),Bc(l)}else n0(l);else if(M=f.m,M==3||M==0&&f.X>0||!(I==1&&QN(l,f)||I==2&&ff(l)))switch(g&&g.length>0&&(f=l.h,f.i=f.i.concat(g)),M){case 1:Ws(l,5);break;case 4:Ws(l,10);break;case 3:Ws(l,6);break;default:Ws(l,2)}}}function i0(l,f){let g=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(g*=2),g*f}function Ws(l,f){if(l.j.info("Error code "+f),f==2){var g=d(l.bb,l),I=l.Ua;const M=!I;I=new Ur(I||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Ta(I,"https"),Fc(I),M?BN(I.toString(),g):qN(I.toString(),g)}else Ft(2);l.I=0,l.l&&l.l.pa(f),o0(l),Zv(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function o0(l){if(l.I=0,l.ja=[],l.l){const f=Lv(l.h);(f.length!=0||l.i.length!=0)&&(A(l.ja,f),A(l.ja,l.i),l.h.i.length=0,_(l.i),l.i.length=0),l.l.oa()}}function a0(l,f,g){var I=g instanceof Ur?qn(g):new Ur(g);if(I.g!="")f&&(I.g=f+"."+I.g),ba(I,I.u);else{var M=o.location;I=M.protocol,f=f?f+"."+M.hostname:M.hostname,M=+M.port;const L=new Ur(null);I&&Ta(L,I),f&&(L.g=f),M&&ba(L,M),g&&(L.h=g),I=L}return g=l.G,f=l.wa,g&&f&&$e(I,g,f),$e(I,"VER",l.ka),Pa(l,I),I}function l0(l,f,g){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new Ye(new uf({ab:g})):new Ye(l.ma),f.Fa(l.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function c0(){}t=c0.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Hc(){}Hc.prototype.g=function(l,f){return new rn(l,f)};function rn(l,f){$.call(this),this.g=new Jv(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!S(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!S(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Hi(this)}m(rn,$),rn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rn.prototype.close=function(){hf(this.g)},rn.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.v&&(g={},g.__data__=Gt(l),l=g);f.i.push(new VN(f.Ya++,l)),f.I==3&&Bc(f)},rn.prototype.N=function(){this.g.l=null,delete this.j,hf(this.g),delete this.g,rn.Z.N.call(this)};function u0(l){Zh.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const g in f){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}m(u0,Zh);function d0(){ef.call(this),this.status=1}m(d0,ef);function Hi(l){this.g=l}m(Hi,c0),Hi.prototype.ra=function(){le(this.g,"a")},Hi.prototype.qa=function(l){le(this.g,new u0(l))},Hi.prototype.pa=function(l){le(this.g,new d0)},Hi.prototype.oa=function(){le(this.g,"b")},Hc.prototype.createWebChannel=Hc.prototype.g,rn.prototype.send=rn.prototype.o,rn.prototype.open=rn.prototype.m,rn.prototype.close=rn.prototype.close,GI=function(){return new Hc},HI=function(){return Mc()},qI=qs,Ip={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Oc.NO_ERROR=0,Oc.TIMEOUT=8,Oc.HTTP_ERROR=6,Ou=Oc,Nv.COMPLETE="complete",BI=Nv,Ev.EventType=va,va.OPEN="a",va.CLOSE="b",va.ERROR="c",va.MESSAGE="d",$.prototype.listen=$.prototype.J,nl=Ev,Ye.prototype.listenOnce=Ye.prototype.K,Ye.prototype.getLastError=Ye.prototype.Ha,Ye.prototype.getLastErrorCode=Ye.prototype.ya,Ye.prototype.getStatus=Ye.prototype.ca,Ye.prototype.getResponseJson=Ye.prototype.La,Ye.prototype.getResponseText=Ye.prototype.la,Ye.prototype.send=Ye.prototype.ea,Ye.prototype.setWithCredentials=Ye.prototype.Fa,$I=Ye}).apply(typeof uu<"u"?uu:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jt.UNAUTHENTICATED=new jt(null),jt.GOOGLE_CREDENTIALS=new jt("google-credentials-uid"),jt.FIRST_PARTY=new jt("first-party-uid"),jt.MOCK_USER=new jt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let da="12.9.0";function IR(t){da=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new ey("@firebase/firestore");function eo(){return Ii.logLevel}function q(t,...e){if(Ii.logLevel<=Ee.DEBUG){const n=e.map(ry);Ii.debug(`Firestore (${da}): ${t}`,...n)}}function st(t,...e){if(Ii.logLevel<=Ee.ERROR){const n=e.map(ry);Ii.error(`Firestore (${da}): ${t}`,...n)}}function Fo(t,...e){if(Ii.logLevel<=Ee.WARN){const n=e.map(ry);Ii.warn(`Firestore (${da}): ${t}`,...n)}}function ry(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function se(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,WI(t,r,n)}function WI(t,e,n){let r=`FIRESTORE (${da}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw st(r),new Error(r)}function oe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||WI(e,s,r)}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends Un{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class bR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(jt.UNAUTHENTICATED))}shutdown(){}}class SR{constructor(e){this.t=e,this.currentUser=jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){oe(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new rr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new rr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new rr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(oe(typeof r.accessToken=="string",31837,{l:r}),new TR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string",2055,{h:e}),new jt(e)}}class NR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=jt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class AR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new NR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(jt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class F_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class CR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Kt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){oe(this.o===void 0,3512);const r=i=>{i.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new F_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(oe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new F_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=kR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function pe(t,e){return t<e?-1:t>e?1:0}function Tp(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Kf(s)===Kf(i)?pe(s,i):Kf(s)?1:-1}return pe(t.length,e.length)}const RR=55296,PR=57343;function Kf(t){const e=t.charCodeAt(0);return e>=RR&&e<=PR}function Uo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function KI(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U_="__name__";class Kn{constructor(e,n,r){n===void 0?n=0:n>e.length&&se(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&se(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Kn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Kn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Kn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return pe(e.length,n.length)}static compareSegments(e,n){const r=Kn.isNumericId(e),s=Kn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Kn.extractNumericId(e).compare(Kn.extractNumericId(n)):Tp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Es.fromString(e.substring(4,e.length-2))}}class Ce extends Kn{construct(e,n,r){return new Ce(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ce(n)}static emptyPath(){return new Ce([])}}const jR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ke extends Kn{construct(e,n,r){return new Ke(e,n,r)}static isValidIdentifier(e){return jR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ke.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===U_}static keyField(){return new Ke([U_])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Q(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Q(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Q(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Q(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ke(n)}static emptyPath(){return new Ke([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(Ce.fromString(e))}static fromName(e){return new ee(Ce.fromString(e).popFirst(5))}static empty(){return new ee(Ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new Ce(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(t,e,n){if(!n)throw new Q(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function DR(t,e,n,r){if(e===!0&&r===!0)throw new Q(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function z_(t){if(!ee.isDocumentKey(t))throw new Q(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $_(t){if(ee.isDocumentKey(t))throw new Q(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function XI(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Th(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":se(12329,{type:typeof t})}function nn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Th(t);throw new Q(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lt(t,e){const n={typeString:t};return e&&(n.value=e),n}function yc(t,e){if(!XI(t))throw new Q(z.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Q(z.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_=-62135596800,q_=1e6;class Re{static now(){return Re.fromMillis(Date.now())}static fromDate(e){return Re.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*q_);return new Re(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<B_)throw new Q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/q_}_compareTo(e){return this.seconds===e.seconds?pe(this.nanoseconds,e.nanoseconds):pe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Re._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(yc(e,Re._jsonSchema))return new Re(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-B_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Re._jsonSchemaVersion="firestore/timestamp/1.0",Re._jsonSchema={type:lt("string",Re._jsonSchemaVersion),seconds:lt("number"),nanoseconds:lt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{static fromTimestamp(e){return new ce(e)}static min(){return new ce(new Re(0,0))}static max(){return new ce(new Re(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zo=-1;class Ad{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function bp(t){return t.fields.find(e=>e.kind===2)}function Zs(t){return t.fields.filter(e=>e.kind!==2)}Ad.UNKNOWN_ID=-1;class Lu{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ql{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ql(0,mn.min())}}function YI(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ce.fromTimestamp(r===1e9?new Re(n+1,0):new Re(n,r));return new mn(s,ee.empty(),e)}function JI(t){return new mn(t.readTime,t.key,zo)}class mn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new mn(ce.min(),ee.empty(),zo)}static max(){return new mn(ce.max(),ee.empty(),zo)}}function iy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ee.comparator(t.documentKey,e.documentKey),n!==0?n:pe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eT{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Os(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==ZI)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&se(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new V((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof V?n:V.resolve(n)}catch(n){return V.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):V.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):V.reject(n)}static resolve(e){return new V((n,r)=>{n(e)})}static reject(e){return new V((n,r)=>{r(e)})}static waitFor(e){return new V((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=V.resolve(!1);for(const r of e)n=n.next(s=>s?V.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new V((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new V((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="SimpleDb";class bh{static open(e,n,r,s){try{return new bh(n,e.transaction(s,r))}catch(i){throw new _l(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new rr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new _l(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=oy(r.target.error);this.S.reject(new _l(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(q(on,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new MR(n)}}class Is{static delete(e){return q(on,"Removing database:",e),ti(NI().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!VI())return!1;if(Is.F())return!0;const e=gt(),n=Is.M(e),r=0<n&&n<10,s=tT(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Is.M(gt())===12.2&&st("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(q(on,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new _l(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Q(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Q(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new _l(e,o))},s.onupgradeneeded=i=>{q(on,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{q(on,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=n=>this.K(n)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=bh.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),V.reject(d))).toPromise();return c.catch(()=>{}),await a.D,c}catch(a){const c=a,d=c.name!=="FirebaseError"&&o<3;if(q(on,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tT(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class VR{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return ti(this.U.delete())}}class _l extends Q{constructor(e,n){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ls(t){return t.name==="IndexedDbTransactionError"}class MR{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(q(on,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(q(on,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ti(r)}add(e){return q(on,"ADD",this.store.name,e,e),ti(this.store.add(e))}get(e){return ti(this.store.get(e)).next(n=>(n===void 0&&(n=null),q(on,"GET",this.store.name,e,n),n))}delete(e){return q(on,"DELETE",this.store.name,e),ti(this.store.delete(e))}count(){return q(on,"COUNT",this.store.name),ti(this.store.count())}H(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new V((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.J(i,(a,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new V((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){q(on,"DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const s=this.cursor(r);return this.J(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.J(s,n)}te(e){const n=this.cursor({});return new V((r,s)=>{n.onerror=i=>{const o=oy(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}J(e,n){const r=[];return new V((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new VR(a),d=n(a.primaryKey,a.value,c);if(d instanceof V){const h=d.catch(m=>(c.done(),V.reject(m)));r.push(h)}c.isDone?s():c.G===null?a.continue():a.continue(c.G)}}).next(()=>V.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ti(t){return new V((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=oy(r.target.error);n(s)}})}let H_=!1;function oy(t){const e=Is.M(gt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return H_||(H_=!0,setTimeout(()=>{throw r},0)),r}}return t}const xl="IndexBackfiller";class OR{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){q(xl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();q(xl,`Documents written: ${n}`)}catch(n){Ls(n)?q(xl,"Ignoring IndexedDB error during index backfill: ",n):await Os(n)}await this.re(6e4)})}}class LR{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return V.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return q(xl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(q(xl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=JI(i);iy(o,r)>0&&(r=o)}),new mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Xt.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di=-1;function Sh(t){return t==null}function Xl(t){return t===0&&1/t==-1/0}function nT(t){return typeof t=="number"&&Number.isInteger(t)&&!Xl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd="";function Ot(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=G_(e)),e=FR(t.get(n),e);return G_(e)}function FR(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Cd:n+="";break;default:n+=i}}return n}function G_(t){return t+Cd+""}function Yn(t){const e=t.length;if(oe(e>=2,64408,{path:t}),e===2)return oe(t.charAt(0)===Cd&&t.charAt(1)==="",56145,{path:t}),Ce.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Cd,i);switch((o<0||o>n)&&se(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:se(61167,{path:t})}i=o+2}return new Ce(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei="remoteDocuments",vc="owner",Wi="owner",Yl="mutationQueues",UR="userId",Rn="mutations",W_="batchId",li="userMutationsIndex",K_=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t,e){return[t,Ot(e)]}function rT(t,e,n){return[t,Ot(e),n]}const zR={},$o="documentMutations",kd="remoteDocumentsV14",$R=["prefixPath","collectionGroup","readTime","documentId"],Uu="documentKeyIndex",BR=["prefixPath","collectionGroup","documentId"],sT="collectionGroupIndex",qR=["collectionGroup","readTime","prefixPath","documentId"],Jl="remoteDocumentGlobal",Sp="remoteDocumentGlobalKey",Bo="targets",iT="queryTargetsIndex",HR=["canonicalId","targetId"],qo="targetDocuments",GR=["targetId","path"],ay="documentTargetsIndex",WR=["path","targetId"],Rd="targetGlobalKey",hi="targetGlobal",Zl="collectionParents",KR=["collectionId","parent"],Ho="clientMetadata",QR="clientId",Nh="bundles",XR="bundleId",Ah="namedQueries",YR="name",ly="indexConfiguration",JR="indexId",Np="collectionGroupIndex",ZR="collectionGroup",wl="indexState",eP=["indexId","uid"],oT="sequenceNumberIndex",tP=["uid","sequenceNumber"],El="indexEntries",nP=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],aT="documentKeyIndex",rP=["indexId","uid","orderedDocumentKey"],Ch="documentOverlays",sP=["userId","collectionPath","documentId"],Ap="collectionPathOverlayIndex",iP=["userId","collectionPath","largestBatchId"],lT="collectionGroupOverlayIndex",oP=["userId","collectionGroup","largestBatchId"],cy="globals",aP="name",cT=[Yl,Rn,$o,ei,Bo,vc,hi,qo,Ho,Jl,Zl,Nh,Ah],lP=[...cT,Ch],uT=[Yl,Rn,$o,kd,Bo,vc,hi,qo,Ho,Jl,Zl,Nh,Ah,Ch],dT=uT,uy=[...dT,ly,wl,El],cP=uy,hT=[...uy,cy],uP=hT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp extends eT{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function yt(t,e){const n=ie(t);return Is.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fT(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e,n){this.comparator=e,this.root=n||bt.EMPTY}insert(e,n){return new ze(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(e){return new ze(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new du(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new du(this.root,e,this.comparator,!1)}getReverseIterator(){return new du(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new du(this.root,e,this.comparator,!0)}}class du{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class bt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??bt.RED,this.left=s??bt.EMPTY,this.right=i??bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new bt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return bt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw se(43730,{key:this.key,value:this.value});if(this.right.isRed())throw se(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw se(27949);return e+(this.isRed()?0:1)}}bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1;bt.EMPTY=new class{constructor(){this.size=0}get key(){throw se(57766)}get value(){throw se(16141)}get color(){throw se(16727)}get left(){throw se(29726)}get right(){throw se(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new bt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.comparator=e,this.data=new ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new X_(this.data.getIterator())}getIteratorFrom(e){return new X_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof De)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new De(this.comparator);return n.data=e,n}}class X_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ki(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.fields=e,e.sort(Ke.comparator)}static empty(){return new Yt([])}unionWith(e){let n=new De(Ke.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Yt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Uo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mT("Invalid base64 string: "+i):i}}(e);return new it(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new it(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return pe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}it.EMPTY_BYTE_STRING=new it("");const dP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ar(t){if(oe(!!t,39018),typeof t=="string"){let e=0;const n=dP.exec(t);if(oe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:He(t.seconds),nanos:He(t.nanos)}}function He(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Cr(t){return typeof t=="string"?it.fromBase64String(t):it.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT="server_timestamp",gT="__type__",yT="__previous_value__",vT="__local_write_time__";function dy(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[gT])==null?void 0:r.stringValue)===pT}function kh(t){const e=t.mapValue.fields[yT];return dy(e)?kh(e):e}function ec(t){const e=Ar(t.mapValue.fields[vT].timestampValue);return new Re(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hP{constructor(e,n,r,s,i,o,a,c,d,h,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=m}}const Pd="(default)";class Ti{constructor(e,n){this.projectId=e,this.database=n||Pd}static empty(){return new Ti("","")}get isDefaultDatabase(){return this.database===Pd}isEqual(e){return e instanceof Ti&&e.projectId===this.projectId&&e.database===this.database}}function fP(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Q(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ti(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hy="__type__",_T="__max__",ds={mapValue:{fields:{__type__:{stringValue:_T}}}},fy="__vector__",Go="value",zu={nullValue:"NULL_VALUE"};function ks(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?dy(t)?4:xT(t)?9007199254740991:Rh(t)?10:11:se(28295,{value:t})}function ar(t,e){if(t===e)return!0;const n=ks(t);if(n!==ks(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ec(t).isEqual(ec(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ar(s.timestampValue),a=Ar(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Cr(s.bytesValue).isEqual(Cr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return He(s.geoPointValue.latitude)===He(i.geoPointValue.latitude)&&He(s.geoPointValue.longitude)===He(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return He(s.integerValue)===He(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=He(s.doubleValue),a=He(i.doubleValue);return o===a?Xl(o)===Xl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Uo(t.arrayValue.values||[],e.arrayValue.values||[],ar);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Q_(o)!==Q_(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!ar(o[c],a[c])))return!1;return!0}(t,e);default:return se(52216,{left:t})}}function tc(t,e){return(t.values||[]).find(n=>ar(n,e))!==void 0}function Rs(t,e){if(t===e)return 0;const n=ks(t),r=ks(e);if(n!==r)return pe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return pe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=He(i.integerValue||i.doubleValue),c=He(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return Y_(t.timestampValue,e.timestampValue);case 4:return Y_(ec(t),ec(e));case 5:return Tp(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Cr(i),c=Cr(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const h=pe(a[d],c[d]);if(h!==0)return h}return pe(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=pe(He(i.latitude),He(o.latitude));return a!==0?a:pe(He(i.longitude),He(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return J_(t.arrayValue,e.arrayValue);case 10:return function(i,o){var p,_,A,C;const a=i.fields||{},c=o.fields||{},d=(p=a[Go])==null?void 0:p.arrayValue,h=(_=c[Go])==null?void 0:_.arrayValue,m=pe(((A=d==null?void 0:d.values)==null?void 0:A.length)||0,((C=h==null?void 0:h.values)==null?void 0:C.length)||0);return m!==0?m:J_(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===ds.mapValue&&o===ds.mapValue)return 0;if(i===ds.mapValue)return 1;if(o===ds.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let m=0;m<c.length&&m<h.length;++m){const p=Tp(c[m],h[m]);if(p!==0)return p;const _=Rs(a[c[m]],d[h[m]]);if(_!==0)return _}return pe(c.length,h.length)}(t.mapValue,e.mapValue);default:throw se(23264,{he:n})}}function Y_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return pe(t,e);const n=Ar(t),r=Ar(e),s=pe(n.seconds,r.seconds);return s!==0?s:pe(n.nanos,r.nanos)}function J_(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Rs(n[s],r[s]);if(i)return i}return pe(n.length,r.length)}function Wo(t){return kp(t)}function kp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ar(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Cr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=kp(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${kp(n.fields[o])}`;return s+"}"}(t.mapValue):se(61005,{value:t})}function $u(t){switch(ks(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=kh(t);return e?16+$u(e):16;case 5:return 2*t.stringValue.length;case 6:return Cr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+$u(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Fs(r.fields,(i,o)=>{s+=i.length+$u(o)}),s}(t.mapValue);default:throw se(13486,{value:t})}}function nc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Rp(t){return!!t&&"integerValue"in t}function rc(t){return!!t&&"arrayValue"in t}function Z_(t){return!!t&&"nullValue"in t}function ex(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bu(t){return!!t&&"mapValue"in t}function Rh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[hy])==null?void 0:r.stringValue)===fy}function Il(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Fs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Il(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Il(t.arrayValue.values[n]);return e}return{...t}}function xT(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_T}const wT={mapValue:{fields:{[hy]:{stringValue:fy},[Go]:{arrayValue:{}}}}};function mP(t){return"nullValue"in t?zu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?nc(Ti.empty(),ee.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Rh(t)?wT:{mapValue:{}}:se(35942,{value:t})}function pP(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?nc(Ti.empty(),ee.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?wT:"mapValue"in t?Rh(t)?{mapValue:{}}:ds:se(61959,{value:t})}function tx(t,e){const n=Rs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function nx(t,e){const n=Rs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.value=e}static empty(){return new Mt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Bu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Il(n)}setAll(e){let n=Ke.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=Il(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Bu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ar(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Bu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Fs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Mt(Il(this.value))}}function ET(t){const e=[];return Fs(t.fields,(n,r)=>{const s=new Ke([n]);if(Bu(r)){const i=ET(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Yt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ze(e,0,ce.min(),ce.min(),ce.min(),Mt.empty(),0)}static newFoundDocument(e,n,r,s){return new Ze(e,1,n,ce.min(),r,s,0)}static newNoDocument(e,n){return new Ze(e,2,n,ce.min(),ce.min(),Mt.empty(),0)}static newUnknownDocument(e,n){return new Ze(e,3,n,ce.min(),ce.min(),Mt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Mt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Mt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ze&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ze(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e,n){this.position=e,this.inclusive=n}}function rx(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),n.key):r=Rs(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function sx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ar(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,n="asc"){this.field=e,this.dir=n}}function gP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IT{}class Ie extends IT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new yP(e,n,r):n==="array-contains"?new xP(e,r):n==="in"?new CT(e,r):n==="not-in"?new wP(e,r):n==="array-contains-any"?new EP(e,r):new Ie(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new vP(e,r):new _P(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Rs(n,this.value)):n!==null&&ks(this.value)===ks(n)&&this.matchesComparison(Rs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return se(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pe extends IT{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Pe(e,n)}matches(e){return Qo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Qo(t){return t.op==="and"}function Pp(t){return t.op==="or"}function my(t){return TT(t)&&Qo(t)}function TT(t){for(const e of t.filters)if(e instanceof Pe)return!1;return!0}function jp(t){if(t instanceof Ie)return t.field.canonicalString()+t.op.toString()+Wo(t.value);if(my(t))return t.filters.map(e=>jp(e)).join(",");{const e=t.filters.map(n=>jp(n)).join(",");return`${t.op}(${e})`}}function bT(t,e){return t instanceof Ie?function(r,s){return s instanceof Ie&&r.op===s.op&&r.field.isEqual(s.field)&&ar(r.value,s.value)}(t,e):t instanceof Pe?function(r,s){return s instanceof Pe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&bT(o,s.filters[a]),!0):!1}(t,e):void se(19439)}function ST(t,e){const n=t.filters.concat(e);return Pe.create(n,t.op)}function NT(t){return t instanceof Ie?function(n){return`${n.field.canonicalString()} ${n.op} ${Wo(n.value)}`}(t):t instanceof Pe?function(n){return n.op.toString()+" {"+n.getFilters().map(NT).join(" ,")+"}"}(t):"Filter"}class yP extends Ie{constructor(e,n,r){super(e,n,r),this.key=ee.fromName(r.referenceValue)}matches(e){const n=ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class vP extends Ie{constructor(e,n){super(e,"in",n),this.keys=AT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class _P extends Ie{constructor(e,n){super(e,"not-in",n),this.keys=AT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function AT(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ee.fromName(r.referenceValue))}class xP extends Ie{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return rc(n)&&tc(n.arrayValue,this.value)}}class CT extends Ie{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&tc(this.value.arrayValue,n)}}class wP extends Ie{constructor(e,n){super(e,"not-in",n)}matches(e){if(tc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!tc(this.value.arrayValue,n)}}class EP extends Ie{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!rc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>tc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IP{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Dp(t,e=null,n=[],r=[],s=null,i=null,o=null){return new IP(t,e,n,r,s,i,o)}function bi(t){const e=ie(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>jp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Sh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Wo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Wo(r)).join(",")),e.Te=n}return e.Te}function _c(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!gP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!bT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!sx(t.startAt,e.startAt)&&sx(t.endAt,e.endAt)}function jd(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Dd(t,e){return t.filters.filter(n=>n instanceof Ie&&n.field.isEqual(e))}function ix(t,e,n){let r=zu,s=!0;for(const i of Dd(t,e)){let o=zu,a=!0;switch(i.op){case"<":case"<=":o=mP(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=zu}tx({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];tx({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function ox(t,e,n){let r=ds,s=!0;for(const i of Dd(t,e)){let o=ds,a=!0;switch(i.op){case">=":case">":o=pP(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=ds}nx({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];nx({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function kT(t,e,n,r,s,i,o,a){return new ha(t,e,n,r,s,i,o,a)}function xc(t){return new ha(t)}function ax(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function TP(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function RT(t){return t.collectionGroup!==null}function Tl(t){const e=ie(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new De(Ke.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new sc(i,r))}),n.has(Ke.keyField().canonicalString())||e.Ie.push(new sc(Ke.keyField(),r))}return e.Ie}function hn(t){const e=ie(t);return e.Ee||(e.Ee=bP(e,Tl(t))),e.Ee}function bP(t,e){if(t.limitType==="F")return Dp(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new sc(s.field,i)});const n=t.endAt?new Ko(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Ko(t.startAt.position,t.startAt.inclusive):null;return Dp(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Vp(t,e){const n=t.filters.concat([e]);return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function SP(t,e){const n=t.explicitOrderBy.concat([e]);return new ha(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function Vd(t,e,n){return new ha(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ph(t,e){return _c(hn(t),hn(e))&&t.limitType===e.limitType}function PT(t){return`${bi(hn(t))}|lt:${t.limitType}`}function to(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>NT(s)).join(", ")}]`),Sh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Wo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Wo(s)).join(",")),`Target(${r})`}(hn(t))}; limitType=${t.limitType})`}function wc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Tl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const d=rx(o,a,c);return o.inclusive?d<=0:d<0}(r.startAt,Tl(r),s)||r.endAt&&!function(o,a,c){const d=rx(o,a,c);return o.inclusive?d>=0:d>0}(r.endAt,Tl(r),s))}(t,e)}function jT(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function DT(t){return(e,n)=>{let r=!1;for(const s of Tl(t)){const i=NP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function NP(t,e,n){const r=t.field.isKeyField()?ee.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),d=a.data.field(i);return c!==null&&d!==null?Rs(c,d):se(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return se(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Fs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return fT(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AP=new ze(ee.comparator);function ln(){return AP}const VT=new ze(ee.comparator);function rl(...t){let e=VT;for(const n of t)e=e.insert(n.key,n);return e}function MT(t){let e=VT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Jn(){return bl()}function OT(){return bl()}function bl(){return new Dr(t=>t.toString(),(t,e)=>t.isEqual(e))}const CP=new ze(ee.comparator),kP=new De(ee.comparator);function ve(...t){let e=kP;for(const n of t)e=e.add(n);return e}const RP=new De(pe);function py(){return RP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xl(e)?"-0":e}}function LT(t){return{integerValue:""+t}}function PP(t,e){return nT(e)?LT(e):gy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(){this._=void 0}}function jP(t,e,n){return t instanceof Xo?function(s,i){const o={fields:{[gT]:{stringValue:pT},[vT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&dy(i)&&(i=kh(i)),i&&(o.fields[yT]=i),{mapValue:o}}(n,e):t instanceof Yo?UT(t,e):t instanceof Jo?zT(t,e):function(s,i){const o=FT(s,i),a=lx(o)+lx(s.Ae);return Rp(o)&&Rp(s.Ae)?LT(a):gy(s.serializer,a)}(t,e)}function DP(t,e,n){return t instanceof Yo?UT(t,e):t instanceof Jo?zT(t,e):n}function FT(t,e){return t instanceof ic?function(r){return Rp(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Xo extends jh{}class Yo extends jh{constructor(e){super(),this.elements=e}}function UT(t,e){const n=$T(e);for(const r of t.elements)n.some(s=>ar(s,r))||n.push(r);return{arrayValue:{values:n}}}class Jo extends jh{constructor(e){super(),this.elements=e}}function zT(t,e){let n=$T(e);for(const r of t.elements)n=n.filter(s=>!ar(s,r));return{arrayValue:{values:n}}}class ic extends jh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function lx(t){return He(t.integerValue||t.doubleValue)}function $T(t){return rc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BT{constructor(e,n){this.field=e,this.transform=n}}function VP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Yo&&s instanceof Yo||r instanceof Jo&&s instanceof Jo?Uo(r.elements,s.elements,ar):r instanceof ic&&s instanceof ic?ar(r.Ae,s.Ae):r instanceof Xo&&s instanceof Xo}(t.transform,e.transform)}class MP{constructor(e,n){this.version=e,this.transformResults=n}}class pt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new pt}static exists(e){return new pt(void 0,e)}static updateTime(e){return new pt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function qu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Dh{}function qT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ec(t.key,pt.none()):new fa(t.key,t.data,pt.none());{const n=t.data,r=Mt.empty();let s=new De(Ke.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Vr(t.key,r,new Yt(s.toArray()),pt.none())}}function OP(t,e,n){t instanceof fa?function(s,i,o){const a=s.value.clone(),c=ux(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Vr?function(s,i,o){if(!qu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=ux(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(HT(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Sl(t,e,n,r){return t instanceof fa?function(i,o,a,c){if(!qu(i.precondition,o))return a;const d=i.value.clone(),h=dx(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Vr?function(i,o,a,c){if(!qu(i.precondition,o))return a;const d=dx(i.fieldTransforms,c,o),h=o.data;return h.setAll(HT(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,a){return qu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function LP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=FT(r.transform,s||null);i!=null&&(n===null&&(n=Mt.empty()),n.set(r.field,i))}return n||null}function cx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Uo(r,s,(i,o)=>VP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class fa extends Dh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Vr extends Dh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function HT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ux(t,e,n){const r=new Map;oe(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,DP(o,a,n[s]))}return r}function dx(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,jP(i,o,e))}return r}class Ec extends Dh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class GT extends Dh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&OP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Sl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Sl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=OT();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=qT(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ve())}isEqual(e){return this.batchId===e.batchId&&Uo(this.mutations,e.mutations,(n,r)=>cx(n,r))&&Uo(this.baseMutations,e.baseMutations,(n,r)=>cx(n,r))}}class vy{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){oe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return CP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new vy(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _y{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ot,Te;function UP(t){switch(t){case z.OK:return se(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return se(15467,{code:t})}}function WT(t){if(t===void 0)return st("GRPC error has no .code"),z.UNKNOWN;switch(t){case ot.OK:return z.OK;case ot.CANCELLED:return z.CANCELLED;case ot.UNKNOWN:return z.UNKNOWN;case ot.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case ot.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case ot.INTERNAL:return z.INTERNAL;case ot.UNAVAILABLE:return z.UNAVAILABLE;case ot.UNAUTHENTICATED:return z.UNAUTHENTICATED;case ot.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case ot.NOT_FOUND:return z.NOT_FOUND;case ot.ALREADY_EXISTS:return z.ALREADY_EXISTS;case ot.PERMISSION_DENIED:return z.PERMISSION_DENIED;case ot.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case ot.ABORTED:return z.ABORTED;case ot.OUT_OF_RANGE:return z.OUT_OF_RANGE;case ot.UNIMPLEMENTED:return z.UNIMPLEMENTED;case ot.DATA_LOSS:return z.DATA_LOSS;default:return se(39323,{code:t})}}(Te=ot||(ot={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $P=new Es([4294967295,4294967295],0);function hx(t){const e=zP().encode(t),n=new zI;return n.update(e),new Uint8Array(n.digest())}function fx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Es([n,r],0),new Es([s,i],0)]}class xy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new sl(`Invalid padding: ${n}`);if(r<0)throw new sl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new sl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Es.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(Es.fromNumber(r)));return s.compare($P)===1&&(s=new Es([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=hx(e),[r,s]=fx(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new xy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=hx(e),[r,s]=fx(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class sl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ic{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Tc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ic(ce.min(),s,new ze(pe),ln(),ve())}}class Tc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Tc(r,n,ve(),ve(),ve())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=s}}class KT{constructor(e,n){this.targetId=e,this.Ce=n}}class QT{constructor(e,n,r=it.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class mx{constructor(){this.ve=0,this.Fe=px(),this.Me=it.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ve(),n=ve(),r=ve();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:se(38017,{changeType:i})}}),new Tc(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=px()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,oe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class BP{constructor(e){this.Ge=e,this.ze=new Map,this.je=ln(),this.He=hu(),this.Je=hu(),this.Ze=new ze(pe)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:se(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(jd(i))if(r===0){const o=new ee(i.path);this.et(n,o,Ze.newNoDocument(o,ce.min()))}else oe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Cr(r).toUint8Array()}catch(c){if(c instanceof mT)return Fo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new xy(o,s,i)}catch(c){return Fo(c instanceof sl?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&jd(a.target)){const c=new ee(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Ze.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.Ke())}});let r=ve();this.Je.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new Ic(e,n,this.Ze,this.je,r);return this.je=ln(),this.He=hu(),this.Je=hu(),this.Ze=new ze(pe),s}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.qe(n,1):s.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new mx,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new De(pe),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new De(pe),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new mx),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function hu(){return new ze(ee.comparator)}function px(){return new ze(ee.comparator)}const qP={asc:"ASCENDING",desc:"DESCENDING"},HP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GP={and:"AND",or:"OR"};class WP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Mp(t,e){return t.useProto3Json||Sh(e)?e:{value:e}}function Zo(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function XT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function KP(t,e){return Zo(t,e.toTimestamp())}function Bt(t){return oe(!!t,49232),ce.fromTimestamp(function(n){const r=Ar(n);return new Re(r.seconds,r.nanos)}(t))}function wy(t,e){return Op(t,e).canonicalString()}function Op(t,e){const n=function(s){return new Ce(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function YT(t){const e=Ce.fromString(t);return oe(ob(e),10190,{key:e.toString()}),e}function Md(t,e){return wy(t.databaseId,e.path)}function fi(t,e){const n=YT(e);if(n.get(1)!==t.databaseId.projectId)throw new Q(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ee(eb(n))}function JT(t,e){return wy(t.databaseId,e)}function ZT(t){const e=YT(t);return e.length===4?Ce.emptyPath():eb(e)}function Lp(t){return new Ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eb(t){return oe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function gx(t,e,n){return{name:Md(t,e),fields:n.value.mapValue.fields}}function QP(t,e,n){const r=fi(t,e.name),s=Bt(e.updateTime),i=e.createTime?Bt(e.createTime):ce.min(),o=new Mt({mapValue:{fields:e.fields}}),a=Ze.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function XP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:se(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(oe(h===void 0||typeof h=="string",58123),it.fromBase64String(h||"")):(oe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),it.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?z.UNKNOWN:WT(d.code);return new Q(h,d.message||"")}(o);n=new QT(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=fi(t,r.document.name),i=Bt(r.document.updateTime),o=r.document.createTime?Bt(r.document.createTime):ce.min(),a=new Mt({mapValue:{fields:r.document.fields}}),c=Ze.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Hu(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=fi(t,r.document),i=r.readTime?Bt(r.readTime):ce.min(),o=Ze.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Hu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=fi(t,r.document),i=r.removedTargetIds||[];n=new Hu([],i,s,null)}else{if(!("filter"in e))return se(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new FP(s,i),a=r.targetId;n=new KT(a,o)}}return n}function Od(t,e){let n;if(e instanceof fa)n={update:gx(t,e.key,e.value)};else if(e instanceof Ec)n={delete:Md(t,e.key)};else if(e instanceof Vr)n={update:gx(t,e.key,e.data),updateMask:nj(e.fieldMask)};else{if(!(e instanceof GT))return se(16599,{dt:e.type});n={verify:Md(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Xo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Yo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Jo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ic)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw se(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:KP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:se(27497)}(t,e.precondition)),n}function Fp(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?pt.updateTime(Bt(i.updateTime)):i.exists!==void 0?pt.exists(i.exists):pt.none()}(e.currentDocument):pt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)oe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Xo;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];c=new Yo(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];c=new Jo(h)}else"increment"in a?c=new ic(o,a.increment):se(16584,{proto:a});const d=Ke.fromServerFormat(a.fieldPath);return new BT(d,c)}(t,s)):[];if(e.update){e.update.name;const s=fi(t,e.update.name),i=new Mt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new Yt(d.map(h=>Ke.fromServerFormat(h)))}(e.updateMask);return new Vr(s,i,o,n,r)}return new fa(s,i,n,r)}if(e.delete){const s=fi(t,e.delete);return new Ec(s,n)}if(e.verify){const s=fi(t,e.verify);return new GT(s,n)}return se(1463,{proto:e})}function YP(t,e){return t&&t.length>0?(oe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Bt(s.updateTime):Bt(i);return o.isEqual(ce.min())&&(o=Bt(i)),new MP(o,s.transformResults||[])}(n,e))):[]}function tb(t,e){return{documents:[JT(t,e.path)]}}function nb(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=JT(t,s);const i=function(d){if(d.length!==0)return ib(Pe.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:no(p.field),direction:ZP(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Mp(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function rb(t){let e=ZT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){oe(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(m){const p=sb(m);return p instanceof Pe&&my(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(A){return new sc(ro(A.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(m){let p;return p=typeof m=="object"?m.value:m,Sh(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(m){const p=!!m.before,_=m.values||[];return new Ko(_,p)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const p=!m.before,_=m.values||[];return new Ko(_,p)}(n.endAt)),kT(e,s,o,i,a,"F",c,d)}function JP(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return se(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function sb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ro(n.unaryFilter.field);return Ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=ro(n.unaryFilter.field);return Ie.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=ro(n.unaryFilter.field);return Ie.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ro(n.unaryFilter.field);return Ie.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return se(61313);default:return se(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ie.create(ro(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return se(58110);default:return se(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Pe.create(n.compositeFilter.filters.map(r=>sb(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return se(1026)}}(n.compositeFilter.op))}(t):se(30097,{filter:t})}function ZP(t){return qP[t]}function ej(t){return HP[t]}function tj(t){return GP[t]}function no(t){return{fieldPath:t.canonicalString()}}function ro(t){return Ke.fromServerFormat(t.fieldPath)}function ib(t){return t instanceof Ie?function(n){if(n.op==="=="){if(ex(n.value))return{unaryFilter:{field:no(n.field),op:"IS_NAN"}};if(Z_(n.value))return{unaryFilter:{field:no(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(ex(n.value))return{unaryFilter:{field:no(n.field),op:"IS_NOT_NAN"}};if(Z_(n.value))return{unaryFilter:{field:no(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:no(n.field),op:ej(n.op),value:n.value}}}(t):t instanceof Pe?function(n){const r=n.getFilters().map(s=>ib(s));return r.length===1?r[0]:{compositeFilter:{op:tj(n.op),filters:r}}}(t):se(54877,{filter:t})}function nj(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function ob(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function ab(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,n,r,s,i=ce.min(),o=ce.min(),a=it.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new yr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new yr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new yr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new yr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(e){this.yt=e}}function rj(t,e){let n;if(e.document)n=QP(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ee.fromSegments(e.noDocument.path),s=Ni(e.noDocument.readTime);n=Ze.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return se(56709);{const r=ee.fromSegments(e.unknownDocument.path),s=Ni(e.unknownDocument.version);n=Ze.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Re(s[0],s[1]);return ce.fromTimestamp(i)}(e.readTime)),n}function yx(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ld(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Md(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Zo(i,o.version.toTimestamp()),createTime:Zo(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Si(e.version)};else{if(!e.isUnknownDocument())return se(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Si(e.version)}}return r}function Ld(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Si(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ni(t){const e=new Re(t.seconds,t.nanoseconds);return ce.fromTimestamp(e)}function ni(t,e){const n=(e.baseMutations||[]).map(i=>Fp(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Fp(t.yt,i)),s=Re.fromMillis(e.localWriteTimeMs);return new yy(e.batchId,s,n,r)}function il(t){const e=Ni(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ni(t.lastLimboFreeSnapshotVersion):ce.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return oe(o===1,1966,{count:o}),hn(xc(ZT(i.documents[0])))}(t.query):function(i){return hn(rb(i))}(t.query),new yr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,it.fromBase64String(t.resumeToken))}function cb(t,e){const n=Si(e.snapshotVersion),r=Si(e.lastLimboFreeSnapshotVersion);let s;s=jd(e.target)?tb(t.yt,e.target):nb(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:bi(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function ub(t){const e=rb({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Vd(e,e.limit,"L"):e}function Qf(t,e){return new _y(e.largestBatchId,Fp(t.yt,e.overlayMutation))}function vx(t,e){const n=e.path.lastSegment();return[t,Ot(e.path.popLast()),n]}function _x(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Si(r.readTime),documentKey:Ot(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{getBundleMetadata(e,n){return xx(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Ni(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return xx(e).put(function(s){return{bundleId:s.id,createTime:Si(Bt(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return wx(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:ub(i.bundledQuery),readTime:Ni(i.readTime)}}(r)})}saveNamedQuery(e,n){return wx(e).put(function(s){return{name:s.name,readTime:Si(Bt(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function xx(t){return yt(t,Nh)}function wx(t){return yt(t,Ah)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Vh(e,r)}getOverlay(e,n){return za(e).get(vx(this.userId,n)).next(r=>r?Qf(this.serializer,r):null)}getOverlays(e,n){const r=Jn();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new _y(n,o);s.push(this.bt(e,a))}),V.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Ot(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(za(e).X(Ap,a))}),V.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Jn(),i=Ot(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return za(e).H(Ap,o).next(a=>{for(const c of a){const d=Qf(this.serializer,c);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Jn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return za(e).ee({index:lT,range:a},(c,d,h)=>{const m=Qf(this.serializer,d);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):h.done()}).next(()=>i)}bt(e,n){return za(e).put(function(s,i,o){const[a,c,d]=vx(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Od(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function za(t){return yt(t,Ch)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{St(e){return yt(e,cy)}getSessionToken(e){return this.St(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?it.fromUint8Array(r):it.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.St(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(He(e.integerValue));else if("doubleValue"in e){const r=He(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Xl(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Ar(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Cr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?xT(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):Rh(e)?this.kt(e.mapValue,n):(this.Kt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.qt(e.arrayValue,n),this.Nt(n)):se(19022,{Ut:e})}Ot(e,n){this.Ft(n,25),this.$t(e,n)}$t(e,n){n.xt(e)}Kt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=Go,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(He(i)),this.Ot(s,n),this.Ct(r[s],n)}qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),ee.fromName(e).path.forEach(r=>{this.Ft(n,60),this.$t(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}ri.Wt=new ri;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qi=255;function oj(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function Ex(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=oj(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class aj{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ht(r.value),r=n.next();this.Jt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const s=n.codePointAt(0);this.Ht(240|s>>>18),this.Ht(128|63&s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s)}}this.Jt()}Yt(e){const n=this.en(e),r=Ex(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=Ex(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(Qi),this.sn(255)}_n(){this.an(Qi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Qi?(this.sn(Qi),this.sn(0)):this.sn(n)}Ht(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Qi?(this.an(Qi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class lj{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class cj{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class $a{constructor(){this.cn=new aj,this.ascending=new lj(this.cn),this.descending=new cj(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n,r,s){this.hn=e,this.Pn=n,this.Tn=r,this.In=s}En(){const e=this.In.length,n=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.In,0),n!==e?r.set([0],this.In.length):++r[r.length-1],new si(this.hn,this.Pn,this.Tn,r)}Rn(e,n,r){return{indexId:this.hn,uid:e,arrayValue:Gu(this.Tn),directionalValue:Gu(this.In),orderedDocumentKey:Gu(n),documentKey:r.path.toArray()}}An(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Gr(t,e){let n=t.hn-e.hn;return n!==0?n:(n=Ix(t.Tn,e.Tn),n!==0?n:(n=Ix(t.In,e.In),n!==0?n:ee.comparator(t.Pn,e.Pn)))}function Ix(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Gu(t){return DI()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function Tx(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class bx{constructor(e){this.Vn=new De((n,r)=>Ke.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(oe(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const n=bp(e);if(n!==void 0&&!this.pn(n))return!1;const r=Zs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.pn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){const a=this.Vn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.yn(a,c)||!this.wn(this.dn[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.dn.length||!this.wn(this.dn[o++],a))return!1}return!0}bn(){if(this.fn)return null;let e=new De(Ke.comparator);const n=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Lu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Lu(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Lu(r.field,r.dir==="asc"?0:1)));return new Ad(Ad.UNKNOWN_ID,this.collectionId,n,Ql.empty())}pn(e){for(const n of this.mn)if(this.yn(n,e))return!0;return!1}yn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}wn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(t){var n,r;if(oe(t instanceof Ie||t instanceof Pe,20012),t instanceof Ie){if(t instanceof CT){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Ie.create(t.field,"==",i)))||[];return Pe.create(s,"or")}return t}const e=t.filters.map(s=>db(s));return Pe.create(e,t.op)}function uj(t){if(t.getFilters().length===0)return[];const e=$p(db(t));return oe(hb(e),7391),Up(e)||zp(e)?[e]:e.getFilters()}function Up(t){return t instanceof Ie}function zp(t){return t instanceof Pe&&my(t)}function hb(t){return Up(t)||zp(t)||function(n){if(n instanceof Pe&&Pp(n)){for(const r of n.getFilters())if(!Up(r)&&!zp(r))return!1;return!0}return!1}(t)}function $p(t){if(oe(t instanceof Ie||t instanceof Pe,34018),t instanceof Ie)return t;if(t.filters.length===1)return $p(t.filters[0]);const e=t.filters.map(r=>$p(r));let n=Pe.create(e,t.op);return n=Fd(n),hb(n)?n:(oe(n instanceof Pe,64498),oe(Qo(n),40251),oe(n.filters.length>1,57927),n.filters.reduce((r,s)=>Ey(r,s)))}function Ey(t,e){let n;return oe(t instanceof Ie||t instanceof Pe,38388),oe(e instanceof Ie||e instanceof Pe,25473),n=t instanceof Ie?e instanceof Ie?function(s,i){return Pe.create([s,i],"and")}(t,e):Sx(t,e):e instanceof Ie?Sx(e,t):function(s,i){if(oe(s.filters.length>0&&i.filters.length>0,48005),Qo(s)&&Qo(i))return ST(s,i.getFilters());const o=Pp(s)?s:i,a=Pp(s)?i:s,c=o.filters.map(d=>Ey(d,a));return Pe.create(c,"or")}(t,e),Fd(n)}function Sx(t,e){if(Qo(e))return ST(e,t.getFilters());{const n=e.filters.map(r=>Ey(t,r));return Pe.create(n,"or")}}function Fd(t){if(oe(t instanceof Ie||t instanceof Pe,11850),t instanceof Ie)return t;const e=t.getFilters();if(e.length===1)return Fd(e[0]);if(TT(t))return t;const n=e.map(s=>Fd(s)),r=[];return n.forEach(s=>{s instanceof Ie?r.push(s):s instanceof Pe&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Pe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(){this.Sn=new Iy}addToCollectionParentIndex(e,n){return this.Sn.add(n),V.resolve()}getCollectionParents(e,n){return V.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return V.resolve()}deleteFieldIndex(e,n){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,n){return V.resolve()}getDocumentsMatchingTarget(e,n){return V.resolve(null)}getIndexType(e,n){return V.resolve(0)}getFieldIndexes(e,n){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,n){return V.resolve(mn.min())}getMinOffsetFromCollectionGroup(e,n){return V.resolve(mn.min())}updateCollectionGroup(e,n,r){return V.resolve()}updateIndexEntries(e,n){return V.resolve()}}class Iy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new De(Ce.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new De(Ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nx="IndexedDbIndexManager",fu=new Uint8Array(0);class hj{constructor(e,n){this.databaseId=n,this.Dn=new Iy,this.Cn=new Dr(r=>bi(r),(r,s)=>_c(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Dn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Dn.add(n)});const i={collectionId:r,parent:Ot(s)};return Ax(e).put(i)}return V.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[KI(n),""],!1,!0);return Ax(e).H(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Yn(o.parent))}return r})}addFieldIndex(e,n){const r=Ba(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Yi(e);return i.next(a=>{o.put(_x(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Ba(e),s=Yi(e),i=Xi(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Ba(e),r=Xi(e),s=Yi(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return V.forEach(this.vn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new bx(r).bn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Xi(e);let s=!0;const i=new Map;return V.forEach(this.vn(n),o=>this.Fn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ve();const a=[];return V.forEach(i,(c,d)=>{q(Nx,`Using index ${function(w){return`id=${w.indexId}|cg=${w.collectionGroup}|f=${w.fields.map(N=>`${N.fieldPath}:${N.kind}`).join(",")}`}(c)} to execute ${bi(n)}`);const h=function(w,N){const D=bp(N);if(D===void 0)return null;for(const O of Dd(w,D.fieldPath))switch(O.op){case"array-contains-any":return O.value.arrayValue.values||[];case"array-contains":return[O.value]}return null}(d,c),m=function(w,N){const D=new Map;for(const O of Zs(N))for(const x of Dd(w,O.fieldPath))switch(x.op){case"==":case"in":D.set(O.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return D.set(O.fieldPath.canonicalString(),x.value),Array.from(D.values())}return null}(d,c),p=function(w,N){const D=[];let O=!0;for(const x of Zs(N)){const y=x.kind===0?ix(w,x.fieldPath,w.startAt):ox(w,x.fieldPath,w.startAt);D.push(y.value),O&&(O=y.inclusive)}return new Ko(D,O)}(d,c),_=function(w,N){const D=[];let O=!0;for(const x of Zs(N)){const y=x.kind===0?ox(w,x.fieldPath,w.endAt):ix(w,x.fieldPath,w.endAt);D.push(y.value),O&&(O=y.inclusive)}return new Ko(D,O)}(d,c),A=this.Mn(c,d,p),C=this.Mn(c,d,_),R=this.xn(c,d,m),E=this.On(c.indexId,h,A,p.inclusive,C,_.inclusive,R);return V.forEach(E,v=>r.Z(v,n.limit).next(w=>{w.forEach(N=>{const D=ee.fromSegments(N.documentKey);o.has(D)||(o=o.add(D),a.push(D))})}))}).next(()=>a)}return V.resolve(null)})}vn(e){let n=this.Cn.get(e);return n||(e.filters.length===0?n=[e]:n=uj(Pe.create(e.filters,"and")).map(r=>Dp(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,n),n)}On(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),d=c/(n!=null?n.length:1),h=[];for(let m=0;m<c;++m){const p=n?this.Nn(n[m/d]):fu,_=this.Bn(e,p,r[m%d],s),A=this.Ln(e,p,i[m%d],o),C=a.map(R=>this.Bn(e,p,R,!0));h.push(...this.createRange(_,A,C))}return h}Bn(e,n,r,s){const i=new si(e,ee.empty(),n,r);return s?i:i.En()}Ln(e,n,r,s){const i=new si(e,ee.empty(),n,r);return s?i.En():i}Fn(e,n){const r=new bx(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.gn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.vn(n);return V.forEach(s,i=>this.Fn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let d=new De(Ke.comparator),h=!1;for(const m of c.filters)for(const p of m.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?h=!0:d=d.add(p.field));for(const m of c.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}kn(e,n){const r=new $a;for(const s of Zs(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.ln(s.kind);ri.Wt.Dt(i,o)}return r.un()}Nn(e){const n=new $a;return ri.Wt.Dt(e,n.ln(0)),n.un()}Kn(e,n){const r=new $a;return ri.Wt.Dt(nc(this.databaseId,n),r.ln(function(i){const o=Zs(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}xn(e,n,r){if(r===null)return[];let s=[];s.push(new $a);let i=0;for(const o of Zs(e)){const a=r[i++];for(const c of s)if(this.qn(n,o.fieldPath)&&rc(a))s=this.Un(s,o,a);else{const d=c.ln(o.kind);ri.Wt.Dt(a,d)}}return this.$n(s)}Mn(e,n,r){return this.xn(e,n,r.position)}$n(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Un(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new $a;c.seed(a.un()),ri.Wt.Dt(o,c.ln(n.kind)),i.push(c)}return i}qn(e,n){return!!e.filters.find(r=>r instanceof Ie&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Ba(e),s=Yi(e);return(n?r.H(Np,IDBKeyRange.bound(n,n)):r.H()).next(i=>{const o=[];return V.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(h,m){const p=m?new Ql(m.sequenceNumber,new mn(Ni(m.readTime),new ee(Yn(m.documentKey)),m.largestBatchId)):Ql.empty(),_=h.fields.map(([A,C])=>new Lu(Ke.fromServerFormat(A),C));return new Ad(h.indexId,h.collectionGroup,_,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:pe(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Ba(e),i=Yi(e);return this.Wn(e).next(o=>s.H(Np,IDBKeyRange.bound(n,n)).next(a=>V.forEach(a,c=>i.put(_x(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return V.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),V.forEach(a,c=>this.Qn(e,s,c).next(d=>{const h=this.Gn(i,c);return d.isEqual(h)?V.resolve():this.zn(e,i,c,d,h)}))))})}jn(e,n,r,s){return Xi(e).put(s.Rn(this.uid,this.Kn(r,n.key),n.key))}Hn(e,n,r,s){return Xi(e).delete(s.An(this.uid,this.Kn(r,n.key),n.key))}Qn(e,n,r){const s=Xi(e);let i=new De(Gr);return s.ee({index:aT,range:IDBKeyRange.only([r.indexId,this.uid,Gu(this.Kn(r,n))])},(o,a)=>{i=i.add(new si(r.indexId,n,Tx(a.arrayValue),Tx(a.directionalValue)))}).next(()=>i)}Gn(e,n){let r=new De(Gr);const s=this.kn(n,e);if(s==null)return r;const i=bp(n);if(i!=null){const o=e.data.field(i.fieldPath);if(rc(o))for(const a of o.arrayValue.values||[])r=r.add(new si(n.indexId,e.key,this.Nn(a),s))}else r=r.add(new si(n.indexId,e.key,fu,s));return r}zn(e,n,r,s,i){q(Nx,"Updating index entries for document '%s'",n.key);const o=[];return function(c,d,h,m,p){const _=c.getIterator(),A=d.getIterator();let C=Ki(_),R=Ki(A);for(;C||R;){let E=!1,v=!1;if(C&&R){const w=h(C,R);w<0?v=!0:w>0&&(E=!0)}else C!=null?v=!0:E=!0;E?(m(R),R=Ki(A)):v?(p(C),C=Ki(_)):(C=Ki(_),R=Ki(A))}}(s,i,Gr,a=>{o.push(this.jn(e,n,r,a))},a=>{o.push(this.Hn(e,n,r,a))}),V.waitFor(o)}Wn(e){let n=1;return Yi(e).ee({index:oT,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Gr(o,a)).filter((o,a,c)=>!a||Gr(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Gr(o,e),c=Gr(o,n);if(a===0)s[0]=e.En();else if(a>0&&c<0)s.push(o),s.push(o.En());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Jn(s[o],s[o+1]))return[];const a=s[o].An(this.uid,fu,ee.empty()),c=s[o+1].An(this.uid,fu,ee.empty());i.push(IDBKeyRange.bound(a,c))}return i}Jn(e,n){return Gr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Cx)}getMinOffset(e,n){return V.mapArray(this.vn(n),r=>this.Fn(e,r).next(s=>s||se(44426))).next(Cx)}}function Ax(t){return yt(t,Zl)}function Xi(t){return yt(t,El)}function Ba(t){return yt(t,ly)}function Yi(t){return yt(t,wl)}function Cx(t){oe(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;iy(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},fb=41943040;class Dt{static withCacheSize(e){return new Dt(e,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mb(t,e,n){const r=t.store(Rn),s=t.store($o),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.ee({range:o},(h,m,p)=>(a++,p.delete()));i.push(c.next(()=>{oe(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const m=rT(e,h.key.path,n.batchId);i.push(s.delete(m)),d.push(h.key)}return V.waitFor(i).next(()=>d)}function Ud(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw se(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Dt.DEFAULT_COLLECTION_PERCENTILE=10,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Dt.DEFAULT=new Dt(fb,Dt.DEFAULT_COLLECTION_PERCENTILE,Dt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Dt.DISABLED=new Dt(-1,0,0);class Mh{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Zn={}}static wt(e,n,r,s){oe(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Mh(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Wr(e).ee({index:li,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=so(e),o=Wr(e);return o.add({}).next(a=>{oe(typeof a=="number",49019);const c=new yy(a,n,r,s),d=function(_,A,C){const R=C.baseMutations.map(v=>Od(_.yt,v)),E=C.mutations.map(v=>Od(_.yt,v));return{userId:A,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:R,mutations:E}}(this.serializer,this.userId,c),h=[];let m=new De((p,_)=>pe(p.canonicalString(),_.canonicalString()));for(const p of s){const _=rT(this.userId,p.key.path,a);m=m.add(p.key.path.popLast()),h.push(o.put(d)),h.push(i.put(_,zR))}return m.forEach(p=>{h.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Zn[a]=c.keys()}),V.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return Wr(e).get(n).next(r=>r?(oe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),ni(this.serializer,r)):null)}Xn(e,n){return this.Zn[n]?V.resolve(this.Zn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Zn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Wr(e).ee({index:li,range:s},(o,a,c)=>{a.userId===this.userId&&(oe(a.batchId>=r,47524,{Yn:r}),i=ni(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=di;return Wr(e).ee({index:li,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,di],[this.userId,Number.POSITIVE_INFINITY]);return Wr(e).H(li,n).next(r=>r.map(s=>ni(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Fu(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return so(e).ee({range:s},(o,a,c)=>{const[d,h,m]=o,p=Yn(h);if(d===this.userId&&n.path.isEqual(p))return Wr(e).get(m).next(_=>{if(!_)throw se(61480,{er:o,batchId:m});oe(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:m}),i.push(ni(this.serializer,_))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new De(pe);const s=[];return n.forEach(i=>{const o=Fu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=so(e).ee({range:a},(d,h,m)=>{const[p,_,A]=d,C=Yn(_);p===this.userId&&i.path.isEqual(C)?r=r.add(A):m.done()});s.push(c)}),V.waitFor(s).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Fu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new De(pe);return so(e).ee({range:o},(c,d,h)=>{const[m,p,_]=c,A=Yn(p);m===this.userId&&r.isPrefixOf(A)?A.length===s&&(a=a.add(_)):h.done()}).next(()=>this.tr(e,a))}tr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Wr(e).get(i).next(o=>{if(o===null)throw se(35274,{batchId:i});oe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(ni(this.serializer,o))}))}),V.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return mb(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.nr(n.batchId)}),V.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return so(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=Yn(i[1]);s.push(c)}else a.done()}).next(()=>{oe(s.length===0,56720,{rr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return pb(e,this.userId,n)}ir(e){return gb(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:di,lastStreamToken:""})}}function pb(t,e,n){const r=Fu(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return so(t).ee({range:i,Y:!0},(a,c,d)=>{const[h,m,p]=a;h===e&&m===s&&(o=!0),d.done()}).next(()=>o)}function Wr(t){return yt(t,Rn)}function so(t){return yt(t,$o)}function gb(t){return yt(t,Yl)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ai{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ai(0)}static ar(){return new Ai(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.ur(e).next(n=>{const r=new Ai(n.highestTargetId);return n.highestTargetId=r.next(),this.cr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(n=>ce.fromTimestamp(new Re(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.ur(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.cr(e,s)))}addTargetData(e,n){return this.lr(e,n).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(n,r),this.cr(e,r))))}updateTargetData(e,n){return this.lr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ji(e).delete(n.targetId)).next(()=>this.ur(e)).next(r=>(oe(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Ji(e).ee((o,a)=>{const c=il(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>V.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Ji(e).ee((r,s)=>{const i=il(s);n(i)})}ur(e){return Rx(e).get(Rd).next(n=>(oe(n!==null,2888),n))}cr(e,n){return Rx(e).put(Rd,n)}lr(e,n){return Ji(e).put(cb(this.serializer,n))}hr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(n=>n.targetCount)}getTargetData(e,n){const r=bi(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Ji(e).ee({range:s,index:iT},(o,a,c)=>{const d=il(a);_c(n,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=ts(e);return n.forEach(o=>{const a=Ot(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(s)}removeMatchingKeys(e,n,r){const s=ts(e);return V.forEach(n,i=>{const o=Ot(i.path);return V.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=ts(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=ts(e);let i=ve();return s.ee({range:r,Y:!0},(o,a,c)=>{const d=Yn(o[1]),h=new ee(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=Ot(n.path),s=IDBKeyRange.bound([r],[KI(r)],!1,!0);let i=0;return ts(e).ee({index:ay,Y:!0,range:s},([o,a],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return Ji(e).get(n).next(r=>r?il(r):null)}}function Ji(t){return yt(t,Bo)}function Rx(t){return yt(t,hi)}function ts(t){return yt(t,qo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Px="LruGarbageCollector",yb=1048576;function jx([t,e],[n,r]){const s=pe(t,n);return s===0?pe(e,r):s}class mj{constructor(e){this.Pr=e,this.buffer=new De(jx),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();jx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class vb{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){q(Px,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ls(n)?q(Px,"Ignoring IndexedDB error during garbage collection: ",n):await Os(n)}await this.Ar(3e5)})}}class pj{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return V.resolve(Xt.ce);const r=new mj(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.mr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(kx)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),kx):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,s,i,o,a,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),eo()<=Ee.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${m} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function _b(t,e){return new pj(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(e,n){this.db=e,this.garbageCollector=_b(this,n)}dr(e){const n=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}mr(e,n){return this.yr(e,(r,s)=>n(s))}addReference(e,n,r){return mu(e,r)}removeReference(e,n,r){return mu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return mu(e,n)}wr(e,n){return function(s,i){let o=!1;return gb(s).te(a=>pb(s,a,i).next(c=>(c&&(o=!0),V.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.yr(e,(o,a)=>{if(a<=n){const c=this.wr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ce.min()),ts(e).delete(function(m){return[0,Ot(m.path)]}(o))))});s.push(c)}}).next(()=>V.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return mu(e,n)}yr(e,n){const r=ts(e);let s,i=Xt.ce;return r.ee({index:ay},([o,a],{path:c,sequenceNumber:d})=>{o===0?(i!==Xt.ce&&n(new ee(Yn(s)),i),i=d,s=c):i=Xt.ce}).next(()=>{i!==Xt.ce&&n(new ee(Yn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function mu(t,e){return ts(t).put(function(r,s){return{targetId:0,path:Ot(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xb{constructor(){this.changes=new Dr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ze.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?V.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yj{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Qs(e).put(r)}removeEntry(e,n,r){return Qs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ld(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.br(e,r)))}getEntry(e,n){let r=Ze.newInvalidDocument(n);return Qs(e).ee({index:Uu,range:IDBKeyRange.only(qa(n))},(s,i)=>{r=this.Sr(n,i)}).next(()=>r)}Dr(e,n){let r={size:0,document:Ze.newInvalidDocument(n)};return Qs(e).ee({index:Uu,range:IDBKeyRange.only(qa(n))},(s,i)=>{r={document:this.Sr(n,i),size:Ud(i)}}).next(()=>r)}getEntries(e,n){let r=ln();return this.Cr(e,n,(s,i)=>{const o=this.Sr(s,i);r=r.insert(s,o)}).next(()=>r)}vr(e,n){let r=ln(),s=new ze(ee.comparator);return this.Cr(e,n,(i,o)=>{const a=this.Sr(i,o);r=r.insert(i,a),s=s.insert(i,Ud(o))}).next(()=>({documents:r,Fr:s}))}Cr(e,n,r){if(n.isEmpty())return V.resolve();let s=new De(Mx);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(qa(s.first()),qa(s.last())),o=s.getIterator();let a=o.getNext();return Qs(e).ee({index:Uu,range:i},(c,d,h)=>{const m=ee.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&Mx(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(qa(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Ld(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Qs(e).H(IDBKeyRange.bound(a,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=ln();for(const m of d){const p=this.Sr(ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);p.isFoundDocument()&&(wc(n,p)||s.has(p.key))&&(h=h.insert(p.key,p))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=ln();const o=Vx(n,r),a=Vx(n,mn.max());return Qs(e).ee({index:sT,range:IDBKeyRange.bound(o,a,!0)},(c,d,h)=>{const m=this.Sr(ee.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new vj(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Dx(e).get(Sp).next(n=>(oe(!!n,20021),n))}br(e,n){return Dx(e).put(Sp,n)}Sr(e,n){if(n){const r=rj(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ce.min())))return r}return Ze.newInvalidDocument(e)}}function wb(t){return new yj(t)}class vj extends xb{constructor(e,n){super(),this.Mr=e,this.trackRemovals=n,this.Or=new Dr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new De((i,o)=>pe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Or.get(i);if(n.push(this.Mr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=yx(this.Mr.serializer,o);s=s.add(i.path.popLast());const d=Ud(c);r+=d-a.size,n.push(this.Mr.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=yx(this.Mr.serializer,o.convertToNoDocument(ce.min()));n.push(this.Mr.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Mr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Mr.updateMetadata(e,r)),V.waitFor(n)}getFromCache(e,n){return this.Mr.Dr(e,n).next(r=>(this.Or.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Mr.vr(e,n).next(({documents:r,Fr:s})=>(s.forEach((i,o)=>{this.Or.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Dx(t){return yt(t,Jl)}function Qs(t){return yt(t,kd)}function qa(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Vx(t,e){const n=e.documentKey.path.toArray();return[t,Ld(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Mx(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=pe(n[i],r[i]),s)return s;return s=pe(n.length,r.length),s||(s=pe(n[n.length-2],r[r.length-2]),s||pe(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Sl(r.mutation,s,Yt.empty(),Re.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ve()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ve()){const s=Jn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=rl();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Jn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ve()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=ln();const o=bl(),a=function(){return bl()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Vr)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Sl(h.mutation,d,h.mutation.getFieldMask(),Re.now())):o.set(d.key,Yt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new _j(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=bl();let s=new ze((o,a)=>o-a),i=ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||Yt.empty();h=a.applyToLocalView(d,h),r.set(c,h);const m=(s.get(a.batchId)||ve()).add(c);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,h=c.value,m=OT();h.forEach(p=>{if(!i.has(p)){const _=qT(n.get(p),r.get(p));_!==null&&m.set(p,_),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return TP(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):RT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):V.resolve(Jn());let a=zo,c=i;return o.next(d=>V.forEach(d,(h,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(h)?V.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,ve())).next(h=>({batchId:a,changes:MT(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ee(n)).next(r=>{let s=rl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=rl();return this.indexManager.getCollectionParents(e,i).next(a=>V.forEach(a,c=>{const d=function(m,p){return new ha(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Ze.newInvalidDocument(h)))});let a=rl();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&Sl(h.mutation,d,Yt.empty(),Re.now()),wc(n,d)&&(a=a.insert(c,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return V.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Bt(s.createTime)}}(n)),V.resolve()}getNamedQuery(e,n){return V.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(s){return{name:s.name,query:ub(s.bundledQuery),readTime:Bt(s.readTime)}}(n)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(){this.overlays=new ze(ee.comparator),this.Lr=new Map}getOverlay(e,n){return V.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Jn();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),V.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Lr.delete(r)),V.resolve()}getOverlaysForCollection(e,n,r){const s=Jn(),i=n.length+1,o=new ee(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return V.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ze((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Jn(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Jn(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return V.resolve(a)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(r.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new _y(n,r));let i=this.Lr.get(n);i===void 0&&(i=ve(),this.Lr.set(n,i)),this.Lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(){this.sessionToken=it.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(){this.kr=new De(xt.Kr),this.qr=new De(xt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new xt(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new xt(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new ee(new Ce([])),r=new xt(n,e),s=new xt(n,e+1),i=[];return this.qr.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new ee(new Ce([])),r=new xt(n,e),s=new xt(n,e+1);let i=ve();return this.qr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new xt(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class xt{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return ee.comparator(e.key,n.key)||pe(e.Hr,n.Hr)}static Ur(e,n){return pe(e.Hr,n.Hr)||ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ij{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new De(xt.Kr)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new yy(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Jr=this.Jr.add(new xt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,n){return V.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?di:this.Yn-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new xt(n,0),s=new xt(n,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([r,s],o=>{const a=this.Zr(o.Hr);i.push(a)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new De(pe);return n.forEach(s=>{const i=new xt(s,0),o=new xt(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],a=>{r=r.add(a.Hr)})}),V.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ee.isDocumentKey(i)||(i=i.child(""));const o=new xt(new ee(i),0);let a=new De(pe);return this.Jr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(c.Hr)),!0)},o),V.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){oe(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return V.forEach(n.mutations,s=>{const i=new xt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new xt(n,0),s=this.Jr.firstAfterOrEqual(r);return V.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e){this.ti=e,this.docs=function(){return new ze(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return V.resolve(r?r.document.mutableCopy():Ze.newInvalidDocument(n))}getEntries(e,n){let r=ln();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ze.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=ln();const o=n.path,a=new ee(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||iy(JI(h),r)<=0||(s.has(h.key)||wc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,n,r,s){se(9500)}ni(e,n){return V.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new bj(this)}getSize(e){return V.resolve(this.size)}}class bj extends xb{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(r)}),V.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e){this.persistence=e,this.ri=new Dr(n=>bi(n),_c),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.ii=0,this.si=new Ty,this.targetCount=0,this.oi=Ai._r()}forEachTarget(e,n){return this.ri.forEach((r,s)=>n(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),V.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Ai(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,V.resolve()}updateTargetData(e,n){return this.lr(n),V.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return V.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),V.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),V.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return V.resolve(r)}containsKey(e,n){return V.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(e,n){this._i={},this.overlays={},this.ai=new Xt(0),this.ui=!1,this.ui=!0,this.ci=new Ej,this.referenceDelegate=e(this),this.li=new Sj(this),this.indexManager=new dj,this.remoteDocumentCache=function(s){return new Tj(s)}(r=>this.referenceDelegate.hi(r)),this.serializer=new lb(n),this.Pi=new xj(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new wj,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new Ij(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const s=new Nj(this.ai.next());return this.referenceDelegate.Ti(),r(s).next(i=>this.referenceDelegate.Ii(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return V.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class Nj extends eT{constructor(e){super(),this.currentSequenceNumber=e}}class Oh{constructor(e){this.persistence=e,this.Ri=new Ty,this.Ai=null}static Vi(e){return new Oh(e)}get di(){if(this.Ai)return this.Ai;throw se(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),V.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),V.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(s=>this.di.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.di.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.di,r=>{const s=ee.fromPath(r);return this.mi(e,s).next(i=>{i||n.removeEntry(s,ce.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return V.or([()=>V.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class zd{constructor(e,n){this.persistence=e,this.fi=new Dr(r=>Ot(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=_b(this,n)}static Vi(e,n){return new zd(e,n)}Ti(){}Ii(e){return V.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return V.forEach(this.fi,(r,s)=>this.wr(e,r,s).next(i=>i?V.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,ce.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),V.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),V.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),V.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=$u(e.data.value)),n}wr(e,n,r){return V.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.fi.get(n);return V.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.serializer=e}k(e,n,r,s){const i=new bh("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(vc)}(e),function(c){c.createObjectStore(Yl,{keyPath:UR}),c.createObjectStore(Rn,{keyPath:W_,autoIncrement:!0}).createIndex(li,K_,{unique:!0}),c.createObjectStore($o)}(e),Ox(e),function(c){c.createObjectStore(ei)}(e));let o=V.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(qo),c.deleteObjectStore(Bo),c.deleteObjectStore(hi)}(e),Ox(e)),o=o.next(()=>function(c){const d=c.store(hi),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ce.min().toTimestamp(),targetCount:0};return d.put(Rd,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,d){return d.store(Rn).H().next(m=>{c.deleteObjectStore(Rn),c.createObjectStore(Rn,{keyPath:W_,autoIncrement:!0}).createIndex(li,K_,{unique:!0});const p=d.store(Rn),_=m.map(A=>p.put(A));return V.waitFor(_)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(Ho,{keyPath:QR})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.gi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Jl)}(e),this.pi(i)))),r<7&&s>=7&&(o=o.next(()=>this.yi(i))),r<8&&s>=8&&(o=o.next(()=>this.wi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.bi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(Nh,{keyPath:XR})})(e),function(c){c.createObjectStore(Ah,{keyPath:YR})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore(Ch,{keyPath:sP});d.createIndex(Ap,iP,{unique:!1}),d.createIndex(lT,oP,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore(kd,{keyPath:$R});d.createIndex(Uu,BR),d.createIndex(sT,qR)}(e)).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(ei))),r<14&&s>=14&&(o=o.next(()=>this.Di(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(ly,{keyPath:JR,autoIncrement:!0}).createIndex(Np,ZR,{unique:!1}),c.createObjectStore(wl,{keyPath:eP}).createIndex(oT,tP,{unique:!1}),c.createObjectStore(El,{keyPath:nP}).createIndex(aT,rP,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(wl).clear()}).next(()=>{n.objectStore(El).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(cy,{keyPath:aP})})(e)})),r<18&&s>=18&&DI()&&(o=o.next(()=>{n.objectStore(wl).clear()}).next(()=>{n.objectStore(El).clear()})),o}pi(e){let n=0;return e.store(ei).ee((r,s)=>{n+=Ud(s)}).next(()=>{const r={byteSize:n};return e.store(Jl).put(Sp,r)})}gi(e){const n=e.store(Yl),r=e.store(Rn);return n.H().next(s=>V.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,di],[i.userId,i.lastAcknowledgedBatchId]);return r.H(li,o).next(a=>V.forEach(a,c=>{oe(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const d=ni(this.serializer,c);return mb(e,i.userId,d).next(()=>{})}))}))}yi(e){const n=e.store(qo),r=e.store(ei);return e.store(hi).get(Rd).next(s=>{const i=[];return r.ee((o,a)=>{const c=new Ce(o),d=function(m){return[0,Ot(m)]}(c);i.push(n.get(d).next(h=>h?V.resolve():(m=>n.put({targetId:0,path:Ot(m),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>V.waitFor(i))})}wi(e,n){e.createObjectStore(Zl,{keyPath:KR});const r=n.store(Zl),s=new Iy,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Ot(c)})}};return n.store(ei).ee({Y:!0},(o,a)=>{const c=new Ce(o);return i(c.popLast())}).next(()=>n.store($o).ee({Y:!0},([o,a,c],d)=>{const h=Yn(a);return i(h.popLast())}))}bi(e){const n=e.store(Bo);return n.ee((r,s)=>{const i=il(s),o=cb(this.serializer,i);return n.put(o)})}Si(e,n){const r=n.store(ei),s=[];return r.ee((i,o)=>{const a=n.store(kd),c=function(m){return m.document?new ee(Ce.fromString(m.document.name).popFirst(5)):m.noDocument?ee.fromSegments(m.noDocument.path):m.unknownDocument?ee.fromSegments(m.unknownDocument.path):se(36783)}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>V.waitFor(s))}Di(e,n){const r=n.store(Rn),s=wb(this.serializer),i=new by(Oh.Vi,this.serializer.yt);return r.H().next(o=>{const a=new Map;return o.forEach(c=>{let d=a.get(c.userId)??ve();ni(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),V.forEach(a,(c,d)=>{const h=new jt(d),m=Vh.wt(this.serializer,h),p=i.getIndexManager(h),_=Mh.wt(h,this.serializer,p,i.referenceDelegate);return new Eb(s,_,m,p).recalculateAndSaveOverlaysForDocumentKeys(new Cp(n,Xt.ce),c).next()})})}}function Ox(t){t.createObjectStore(qo,{keyPath:GR}).createIndex(ay,WR,{unique:!0}),t.createObjectStore(Bo,{keyPath:"targetId"}).createIndex(iT,HR,{unique:!0}),t.createObjectStore(hi)}const Kr="IndexedDbPersistence",Xf=18e5,Yf=5e3,Jf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Cj="main";class Sy{constructor(e,n,r,s,i,o,a,c,d,h,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Ci=i,this.window=o,this.document=a,this.Fi=d,this.Mi=h,this.xi=m,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=p=>Promise.resolve(),!Sy.v())throw new Q(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new gj(this,s),this.Ki=n+Cj,this.serializer=new lb(c),this.qi=new Is(this.Ki,this.xi,new Aj(this.serializer)),this.ci=new ij,this.li=new fj(this.referenceDelegate,this.serializer),this.remoteDocumentCache=wb(this.serializer),this.Pi=new sj,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,h===!1&&st(Kr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Q(z.FAILED_PRECONDITION,Jf);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new Xt(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>pu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(n=>{n||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(n=>this.isPrimary&&!n?this.Ji(e).next(()=>!1):!!n&&this.Zi(e).next(()=>!0))).catch(e=>{if(Ls(e))return q(Kr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q(Kr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return Ha(e).get(Wi).next(n=>V.resolve(this.Xi(n)))}Yi(e){return pu(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Xf)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=yt(n,Ho);return r.H().next(s=>{const i=this.ns(s,Xf),o=s.filter(a=>i.indexOf(a)===-1);return V.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ui)for(const n of e)this.Ui.removeItem(this.rs(n.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?V.resolve(!0):Ha(e).get(Wi).next(n=>{if(n!==null&&this.ts(n.leaseTimestampMs,Yf)&&!this.ss(n.ownerId)){if(this.Xi(n)&&this.networkEnabled)return!0;if(!this.Xi(n)){if(!n.allowTabSynchronization)throw new Q(z.FAILED_PRECONDITION,Jf);return!1}}return!(!this.networkEnabled||!this.inForeground)||pu(e).H().next(r=>this.ns(r,Yf).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&q(Kr,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[vc,Ho],e=>{const n=new Cp(e,Xt.ce);return this.Ji(n).next(()=>this.Yi(n))}),this.qi.close(),this.ls()}ns(e,n){return e.filter(r=>this.ts(r.updateTimeMs,n)&&!this.ss(r.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>pu(e).H().next(n=>this.ns(n,Xf).map(r=>r.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,n){return Mh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new hj(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Vh.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,n,r){q(Kr,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?uP:c===17?hT:c===16?cP:c===15?uy:c===14?dT:c===13?uT:c===12?lP:c===11?cT:void se(60245)}(this.xi);let o;return this.qi.runTransaction(e,s,i,a=>(o=new Cp(a,this.ai?this.ai.next():Xt.ce),n==="readwrite-primary"?this.ji(o).next(c=>!!c||this.Hi(o)).next(c=>{if(!c)throw st(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new Q(z.FAILED_PRECONDITION,ZI);return r(o)}).next(c=>this.Zi(o).next(()=>c)):this.Ps(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ps(e){return Ha(e).get(Wi).next(n=>{if(n!==null&&this.ts(n.leaseTimestampMs,Yf)&&!this.ss(n.ownerId)&&!this.Xi(n)&&!(this.Mi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Q(z.FAILED_PRECONDITION,Jf)})}Zi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ha(e).put(Wi,n)}static v(){return Is.v()}Ji(e){const n=Ha(e);return n.get(Wi).next(r=>this.Xi(r)?(q(Kr,"Releasing primary lease."),n.delete(Wi)):V.resolve())}ts(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(st(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const n=/(?:Version|Mobile)\/1[456]/;jI()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var n;try{const r=((n=this.Ui)==null?void 0:n.getItem(this.rs(e)))!==null;return q(Kr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return st(Kr,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){st("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ha(t){return yt(t,vc)}function pu(t){return yt(t,Ho)}function Ib(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ny{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=s}static Es(e,n){let r=ve(),s=ve();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Ny(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return jI()?8:tT(gt())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.gs(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ps(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new kj;return this.ys(e,n,o).next(a=>{if(i.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>i.result)}ws(e,n,r,s){return r.documentReadCount<this.Vs?(eo()<=Ee.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",to(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),V.resolve()):(eo()<=Ee.DEBUG&&q("QueryEngine","Query:",to(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(eo()<=Ee.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",to(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hn(n))):V.resolve())}gs(e,n){if(ax(n))return V.resolve(null);let r=hn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Vd(n,null,"F"),r=hn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ve(...i);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.bs(n,a);return this.Ss(n,d,o,c.readTime)?this.gs(e,Vd(n,null,"F")):this.Ds(e,d,n,c)}))})))}ps(e,n,r,s){return ax(n)||s.isEqual(ce.min())?V.resolve(null):this.fs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ss(n,o,r,s)?V.resolve(null):(eo()<=Ee.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),to(n)),this.Ds(e,o,n,YI(s,zo)).next(a=>a))})}bs(e,n){let r=new De(DT(e));return n.forEach((s,i)=>{wc(e,i)&&(r=r.add(i))}),r}Ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ys(e,n,r){return eo()<=Ee.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",to(n)),this.fs.getDocumentsMatchingQuery(e,n,mn.min(),r)}Ds(e,n,r,s){return this.fs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ay="LocalStore",Rj=3e8;class Pj{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.vs=new ze(pe),this.Fs=new Dr(i=>bi(i),_c),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Eb(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function bb(t,e,n,r){return new Pj(t,e,n,r)}async function Sb(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=ve();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function jj(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,c,d,h){const m=d.batch,p=m.keys();let _=V.resolve();return p.forEach(A=>{_=_.next(()=>h.getEntry(c,A)).next(C=>{const R=d.docVersions.get(A);oe(R!==null,48541),C.version.compareTo(R)<0&&(m.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),h.addEntry(C)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ve();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Nb(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function Dj(t,e){const n=ie(t),r=e.snapshotVersion;let s=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});s=n.vs;const a=[];e.targetChanges.forEach((h,m)=>{const p=s.get(m);if(!p)return;a.push(n.li.removeMatchingKeys(i,h.removedDocuments,m).next(()=>n.li.addMatchingKeys(i,h.addedDocuments,m)));let _=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?_=_.withResumeToken(it.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),s=s.insert(m,_),function(C,R,E){return C.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=Rj?!0:E.addedDocuments.size+E.modifiedDocuments.size+E.removedDocuments.size>0}(p,_,h)&&a.push(n.li.updateTargetData(i,_))});let c=ln(),d=ve();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(Vj(i,o,e.documentUpdates).next(h=>{c=h.Bs,d=h.Ls})),!r.isEqual(ce.min())){const h=n.li.getLastRemoteSnapshotVersion(i).next(m=>n.li.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return V.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.vs=s,i))}function Vj(t,e,n){let r=ve(),s=ve();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=ln();return n.forEach((a,c)=>{const d=i.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(ce.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):q(Ay,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{Bs:o,Ls:s}})}function Mj(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=di),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function $d(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.li.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):n.li.allocateTargetId(r).next(o=>(s=new yr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.vs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function ea(t,e,n){const r=ie(t),s=r.vs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ls(o))throw o;q(Ay,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(s.target)}function Bp(t,e,n){const r=ie(t);let s=ce.min(),i=ve();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const m=ie(c),p=m.Fs.get(h);return p!==void 0?V.resolve(m.vs.get(p)):m.li.getTargetData(d,h)}(r,o,hn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:ce.min(),n?i:ve())).next(a=>(kb(r,jT(e),a),{documents:a,ks:i})))}function Ab(t,e){const n=ie(t),r=ie(n.li),s=n.vs.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.At(i,e).next(o=>o?o.target:null))}function Cb(t,e){const n=ie(t),r=n.Ms.get(e)||ce.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.xs.getAllFromCollectionGroup(s,e,YI(r,zo),Number.MAX_SAFE_INTEGER)).then(s=>(kb(n,e,s),s))}function kb(t,e,n){let r=t.Ms.get(e)||ce.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ms.set(e,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rb="firestore_clients";function Lx(t,e){return`${Rb}_${t}_${e}`}const Pb="firestore_mutations";function Fx(t,e,n){let r=`${Pb}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const jb="firestore_targets";function Zf(t,e){return`${jb}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn="SharedClientState";class Bd{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static $s(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new Q(s.error.code,s.error.message))),o?new Bd(e,n,s.state,i):(st(Qn,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Nl{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static $s(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new Q(r.error.code,r.error.message))),i?new Nl(e,r.state,s):(st(Qn,`Failed to parse target state for ID '${e}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class qd{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static $s(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=py();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=nT(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new qd(e,i):(st(Qn,`Failed to parse client data for instance '${e}': ${n}`),null)}}class Cy{constructor(e,n){this.clientId=e,this.onlineState=n}static $s(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Cy(n.clientId,n.onlineState):(st(Qn,`Failed to parse online state: ${e}`),null)}}class qp{constructor(){this.activeTargetIds=py()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class em{constructor(e,n,r,s,i){this.window=e,this.Ci=n,this.persistenceKey=r,this.zs=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new ze(pe),this.started=!1,this.Zs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=Lx(this.persistenceKey,this.zs),this.Ys=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Js=this.Js.insert(this.zs,new qp),this.eo=new RegExp(`^${Rb}_${o}_([^_]*)$`),this.no=new RegExp(`^${Pb}_${o}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${jb}_${o}_(\\d+)$`),this.io=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.so=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const s=this.getItem(Lx(this.persistenceKey,r));if(s){const i=qd.$s(r,s);i&&(this.Js=this.Js.insert(i.clientId,i))}}this.oo();const n=this.storage.getItem(this.io);if(n){const r=this._o(n);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let n=!1;return this.Js.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,n,r){this.co(e,n,r),this.lo(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Zf(this.persistenceKey,e));if(s){const i=Nl.$s(e,s);i&&(r=i.state)}}return n&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Zf(this.persistenceKey,e))}updateQueryState(e,n,r){this.Po(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.lo(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return q(Qn,"READ",e,n),n}setItem(e,n){q(Qn,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){q(Qn,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const n=e;if(n.storageArea===this.storage){if(q(Qn,"EVENT",n.key,n.newValue),n.key===this.Xs)return void st("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.eo.test(n.key)){if(n.newValue==null){const r=this.Eo(n.key);return this.Ro(r,null)}{const r=this.Ao(n.key,n.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(n.key)){if(n.newValue!==null){const r=this.Vo(n.key,n.newValue);if(r)return this.mo(r)}}else if(this.ro.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(n.key===this.io){if(n.newValue!==null){const r=this._o(n.newValue);if(r)return this.ao(r)}}else if(n.key===this.Ys){const r=function(i){let o=Xt.ce;if(i!=null)try{const a=JSON.parse(i);oe(typeof a=="number",30636,{yo:i}),o=a}catch(a){st(Qn,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Xt.ce&&this.sequenceNumberHandler(r)}else if(n.key===this.so){const r=this.wo(n.newValue);await Promise.all(r.map(s=>this.syncEngine.bo(s)))}}}else this.Zs.push(n)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,n,r){const s=new Bd(this.currentUser,e,n,r),i=Fx(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Ws())}lo(e){const n=Fx(this.persistenceKey,this.currentUser,e);this.removeItem(n)}To(e){const n={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(n))}Po(e,n,r){const s=Zf(this.persistenceKey,e),i=new Nl(e,n,r);this.setItem(s,i.Ws())}Io(e){const n=JSON.stringify(Array.from(e));this.setItem(this.so,n)}Eo(e){const n=this.eo.exec(e);return n?n[1]:null}Ao(e,n){const r=this.Eo(e);return qd.$s(r,n)}Vo(e,n){const r=this.no.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Bd.$s(new jt(i),s,n)}fo(e,n){const r=this.ro.exec(e),s=Number(r[1]);return Nl.$s(s,n)}_o(e){return Cy.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);q(Qn,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,n){const r=n?this.Js.insert(e,n):this.Js.remove(e),s=this.uo(this.Js),i=this.uo(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Co(o,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let n=py();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class Db{constructor(){this.vo=new qp,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new qp,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux="ConnectivityMonitor";class zx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){q(Ux,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){q(Ux,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gu=null;function Hp(){return gu===null?gu=function(){return 268435456+Math.round(2147483648*Math.random())}():gu++,"0x"+gu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tm="RestConnection",Lj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class Fj{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.$o=this.databaseId.database===Pd?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=Hp(),a=this.Qo(e,n.toUriEncodedString());q(tm,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,s,i);const{host:d}=new URL(a),h=cr(d);return this.zo(e,a,c,r,h).then(m=>(q(tm,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Fo(tm,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+da}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Qo(e,n){const r=Lj[e];let s=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pt="WebChannelConnection",Ga=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(s){setTimeout(()=>{throw s},0)}})};class No extends Fj{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!No.c_){const e=HI();Ga(e,qI.STAT_EVENT,n=>{n.stat===Ip.PROXY?q(Pt,"STAT_EVENT: detected buffering proxy"):n.stat===Ip.NOPROXY&&q(Pt,"STAT_EVENT: detected no buffering proxy")}),No.c_=!0}}zo(e,n,r,s,i){const o=Hp();return new Promise((a,c)=>{const d=new $I;d.setWithCredentials(!0),d.listenOnce(BI.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Ou.NO_ERROR:const m=d.getResponseJson();q(Pt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case Ou.TIMEOUT:q(Pt,`RPC '${e}' ${o} timed out`),c(new Q(z.DEADLINE_EXCEEDED,"Request time out"));break;case Ou.HTTP_ERROR:const p=d.getStatus();if(q(Pt,`RPC '${e}' ${o} failed with status:`,p,"response text:",d.getResponseText()),p>0){let _=d.getResponseJson();Array.isArray(_)&&(_=_[0]);const A=_==null?void 0:_.error;if(A&&A.status&&A.message){const C=function(E){const v=E.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(v)>=0?v:z.UNKNOWN}(A.status);c(new Q(C,A.message))}else c(new Q(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new Q(z.UNAVAILABLE,"Connection failed."));break;default:se(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{q(Pt,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);q(Pt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=Hp(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const d=i.join("");q(Pt,`Creating RPC '${e}' stream ${s}: ${d}`,a);const h=o.createWebChannel(d,a);this.I_(h);let m=!1,p=!1;const _=new Uj({Ho:A=>{p?q(Pt,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(m||(q(Pt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),q(Pt,`RPC '${e}' stream ${s} sending:`,A),h.send(A))},Jo:()=>h.close()});return Ga(h,nl.EventType.OPEN,()=>{p||(q(Pt,`RPC '${e}' stream ${s} transport opened.`),_.i_())}),Ga(h,nl.EventType.CLOSE,()=>{p||(p=!0,q(Pt,`RPC '${e}' stream ${s} transport closed`),_.o_(),this.E_(h))}),Ga(h,nl.EventType.ERROR,A=>{p||(p=!0,Fo(Pt,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),_.o_(new Q(z.UNAVAILABLE,"The operation could not be completed")))}),Ga(h,nl.EventType.MESSAGE,A=>{var C;if(!p){const R=A.data[0];oe(!!R,16349);const E=R,v=(E==null?void 0:E.error)||((C=E[0])==null?void 0:C.error);if(v){q(Pt,`RPC '${e}' stream ${s} received error:`,v);const w=v.status;let N=function(x){const y=ot[x];if(y!==void 0)return WT(y)}(w),D=v.message;w==="NOT_FOUND"&&D.includes("database")&&D.includes("does not exist")&&D.includes(this.databaseId.database)&&Fo(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),N===void 0&&(N=z.INTERNAL,D="Unknown error status: "+w+" with message "+v.message),p=!0,_.o_(new Q(N,D)),h.close()}else q(Pt,`RPC '${e}' stream ${s} received:`,R),_.__(R)}}),No.u_(),setTimeout(()=>{_.s_()},0),_}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return GI()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zj(t){return new No(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(){return typeof window<"u"?window:null}function Wu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lh(t){return new WP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */No.c_=!1;class Mb{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=s,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x="PersistentStream";class Ob{constructor(e,n,r,s,i,o,a,c){this.Ci=e,this.b_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Mb(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(st(n.toString()),st("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Q(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.H_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return q($x,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(q($x,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class $j extends Ob{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=XP(this.serializer,e),r=function(i){if(!("targetChange"in i))return ce.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ce.min():o.readTime?Bt(o.readTime):ce.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Lp(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=jd(c)?{documents:tb(i,c)}:{query:nb(i,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=XT(i,o.resumeToken);const d=Mp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(ce.min())>0){a.readTime=Zo(i,o.snapshotVersion.toTimestamp());const d=Mp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=JP(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Lp(this.serializer),n.removeTarget=e,this.K_(n)}}class Bj extends Ob{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=YP(e.writeResults,e.commitTime),r=Bt(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Lp(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Od(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{}class Hj extends qj{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Q(z.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,Op(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Q(z.UNKNOWN,i.toString())})}jo(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,Op(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(z.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function Gj(t,e,n,r){return new Hj(t,e,n,r)}class Wj{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(st(n),this.aa=!1):q("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci="RemoteStore";class Kj{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Li(this)&&(q(Ci,"Restarting streams for network reachability change."),await async function(c){const d=ie(c);d.Ea.add(4),await bc(d),d.Va.set("Unknown"),d.Ea.delete(4),await Fh(d)}(this))})}),this.Va=new Wj(r,s)}}async function Fh(t){if(Li(t))for(const e of t.Ra)await e(!0)}async function bc(t){for(const e of t.Ra)await e(!1)}function Uh(t,e){const n=ie(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Py(n)?Ry(n):pa(n).O_()&&ky(n,e))}function ta(t,e){const n=ie(t),r=pa(n);n.Ia.delete(e),r.O_()&&Lb(n,e),n.Ia.size===0&&(r.O_()?r.L_():Li(n)&&n.Va.set("Unknown"))}function ky(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}pa(t).Z_(e)}function Lb(t,e){t.da.$e(e),pa(t).X_(e)}function Ry(t){t.da=new BP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),pa(t).start(),t.Va.ua()}function Py(t){return Li(t)&&!pa(t).x_()&&t.Ia.size>0}function Li(t){return ie(t).Ea.size===0}function Fb(t){t.da=void 0}async function Qj(t){t.Va.set("Online")}async function Xj(t){t.Ia.forEach((e,n)=>{ky(t,e)})}async function Yj(t,e){Fb(t),Py(t)?(t.Va.ha(e),Ry(t)):t.Va.set("Unknown")}async function Jj(t,e,n){if(t.Va.set("Online"),e instanceof QT&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.da.removeTarget(a))}(t,e)}catch(r){q(Ci,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Hd(t,r)}else if(e instanceof Hu?t.da.Xe(e):e instanceof KT?t.da.st(e):t.da.tt(e),!n.isEqual(ce.min()))try{const r=await Nb(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.da.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(it.EMPTY_BYTE_STRING,h.snapshotVersion)),Lb(i,c);const m=new yr(h.target,c,d,h.sequenceNumber);ky(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){q(Ci,"Failed to raise snapshot:",r),await Hd(t,r)}}async function Hd(t,e,n){if(!Ls(e))throw e;t.Ea.add(1),await bc(t),t.Va.set("Offline"),n||(n=()=>Nb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q(Ci,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Fh(t)})}function Ub(t,e){return e().catch(n=>Hd(t,n,e))}async function ma(t){const e=ie(t),n=Ps(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:di;for(;Zj(e);)try{const s=await Mj(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,eD(e,s)}catch(s){await Hd(e,s)}zb(e)&&$b(e)}function Zj(t){return Li(t)&&t.Ta.length<10}function eD(t,e){t.Ta.push(e);const n=Ps(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function zb(t){return Li(t)&&!Ps(t).x_()&&t.Ta.length>0}function $b(t){Ps(t).start()}async function tD(t){Ps(t).ra()}async function nD(t){const e=Ps(t);for(const n of t.Ta)e.ea(n.mutations)}async function rD(t,e,n){const r=t.Ta.shift(),s=vy.from(r,e,n);await Ub(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ma(t)}async function sD(t,e){e&&Ps(t).Y_&&await async function(r,s){if(function(o){return UP(o)&&o!==z.ABORTED}(s.code)){const i=r.Ta.shift();Ps(r).B_(),await Ub(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ma(r)}}(t,e),zb(t)&&$b(t)}async function Bx(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),q(Ci,"RemoteStore received new credentials");const r=Li(n);n.Ea.add(3),await bc(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Fh(n)}async function Gp(t,e){const n=ie(t);e?(n.Ea.delete(2),await Fh(n)):e||(n.Ea.add(2),await bc(n),n.Va.set("Unknown"))}function pa(t){return t.ma||(t.ma=function(n,r,s){const i=ie(n);return i.sa(),new $j(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:Qj.bind(null,t),Yo:Xj.bind(null,t),t_:Yj.bind(null,t),J_:Jj.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),Py(t)?Ry(t):t.Va.set("Unknown")):(await t.ma.stop(),Fb(t))})),t.ma}function Ps(t){return t.fa||(t.fa=function(n,r,s){const i=ie(n);return i.sa(),new Bj(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:tD.bind(null,t),t_:sD.bind(null,t),ta:nD.bind(null,t),na:rD.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await ma(t)):(await t.fa.stop(),t.Ta.length>0&&(q(Ci,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new jy(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dy(t,e){if(st("AsyncQueue",`${e}: ${t}`),Ls(t))return new Q(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ao{static emptySet(e){return new Ao(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ee.comparator(n.key,r.key):(n,r)=>ee.comparator(n.key,r.key),this.keyedMap=rl(),this.sortedSet=new ze(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ao)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ao;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(){this.ga=new ze(ee.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):se(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class na{constructor(e,n,r,s,i,o,a,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new na(e,n,Ao.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ph(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iD{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class oD{constructor(){this.queries=Hx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ie(n),i=s.queries;s.queries=Hx(),i.forEach((o,a)=>{for(const c of a.ba)c.onError(r)})})(this,new Q(z.ABORTED,"Firestore shutting down"))}}function Hx(){return new Dr(t=>PT(t),Ph)}async function Vy(t,e){const n=ie(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.Da()&&(r=2):(i=new iD,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Dy(o,`Initialization of query '${to(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.ba.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Oy(n)}async function My(t,e){const n=ie(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?s=e.Da()?0:1:!i.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function aD(t,e){const n=ie(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.ba)a.Fa(s)&&(r=!0);o.wa=s}}r&&Oy(n)}function lD(t,e,n){const r=ie(t),s=r.queries.get(e);if(s)for(const i of s.ba)i.onError(n);r.queries.delete(e)}function Oy(t){t.Ca.forEach(e=>{e.next()})}var Wp,Gx;(Gx=Wp||(Wp={})).Ma="default",Gx.Cache="cache";class Ly{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new na(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=na.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Wp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e){this.key=e}}class qb{constructor(e){this.key=e}}class cD{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ve(),this.mutatedKeys=ve(),this.eu=DT(e),this.tu=new Ao(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new qx,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,m)=>{const p=s.get(h),_=wc(this.query,m)?m:null,A=!!p&&this.mutatedKeys.has(p.key),C=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let R=!1;p&&_?p.data.isEqual(_.data)?A!==C&&(r.track({type:3,doc:_}),R=!0):this.su(p,_)||(r.track({type:2,doc:_}),R=!0,(c&&this.eu(_,c)>0||d&&this.eu(_,d)<0)&&(a=!0)):!p&&_?(r.track({type:0,doc:_}),R=!0):p&&!_&&(r.track({type:1,doc:p}),R=!0,(c||d)&&(a=!0)),R&&(_?(o=o.add(_),i=C?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,m)=>function(_,A){const C=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return se(20277,{Vt:R})}};return C(_)-C(A)}(h.type,m.type)||this.eu(h.doc,m.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],c=this.Ya.size===0&&this.current&&!s?1:0,d=c!==this.Xa;return this.Xa=c,o.length!==0||d?{snapshot:new na(this.query,e.tu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new qx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ve(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new qb(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new Bb(r))}),n}cu(e){this.Za=e.ks,this.Ya=ve();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return na.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const ga="SyncEngine";class uD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class dD{constructor(e){this.key=e,this.hu=!1}}class hD{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Dr(a=>PT(a),Ph),this.Iu=new Map,this.Eu=new Set,this.Ru=new ze(ee.comparator),this.Au=new Map,this.Vu=new Ty,this.du={},this.mu=new Map,this.fu=Ai.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function fD(t,e,n=!0){const r=zh(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Hb(r,e,n,!0),s}async function mD(t,e){const n=zh(t);await Hb(n,e,!0,!1)}async function Hb(t,e,n,r){const s=await $d(t.localStore,hn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await Fy(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Uh(t.remoteStore,s),a}async function Fy(t,e,n,r,s){t.pu=(m,p,_)=>async function(C,R,E,v){let w=R.view.ru(E);w.Ss&&(w=await Bp(C.localStore,R.query,!1).then(({documents:x})=>R.view.ru(x,w)));const N=v&&v.targetChanges.get(R.targetId),D=v&&v.targetMismatches.get(R.targetId)!=null,O=R.view.applyChanges(w,C.isPrimaryClient,N,D);return Kp(C,R.targetId,O.au),O.snapshot}(t,m,p,_);const i=await Bp(t.localStore,e,!0),o=new cD(e,i.ks),a=o.ru(i.documents),c=Tc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,c);Kp(t,n,d.au);const h=new uD(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function pD(t,e,n){const r=ie(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Ph(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ea(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&ta(r.remoteStore,s.targetId),ra(r,s.targetId)}).catch(Os)):(ra(r,s.targetId),await ea(r.localStore,s.targetId,!0))}async function gD(t,e){const n=ie(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ta(n.remoteStore,r.targetId))}async function yD(t,e,n){const r=By(t);try{const s=await function(o,a){const c=ie(o),d=Re.now(),h=a.reduce((_,A)=>_.add(A.key),ve());let m,p;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let A=ln(),C=ve();return c.xs.getEntries(_,h).next(R=>{A=R,A.forEach((E,v)=>{v.isValidDocument()||(C=C.add(E))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,A)).next(R=>{m=R;const E=[];for(const v of a){const w=LP(v,m.get(v.key).overlayedDocument);w!=null&&E.push(new Vr(v.key,w,ET(w.value.mapValue),pt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,d,E,a)}).next(R=>{p=R;const E=R.applyToLocalDocumentSet(m,C);return c.documentOverlayCache.saveOverlays(_,R.batchId,E)})}).then(()=>({batchId:p.batchId,changes:MT(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let d=o.du[o.currentUser.toKey()];d||(d=new ze(pe)),d=d.insert(a,c),o.du[o.currentUser.toKey()]=d}(r,s.batchId,n),await Us(r,s.changes),await ma(r.remoteStore)}catch(s){const i=Dy(s,"Failed to persist write");n.reject(i)}}async function Gb(t,e){const n=ie(t);try{const r=await Dj(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?oe(o.hu,14607):s.removedDocuments.size>0&&(oe(o.hu,42227),o.hu=!1))}),await Us(n,r,e)}catch(r){await Os(r)}}function Wx(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=ie(o);c.onlineState=a;let d=!1;c.queries.forEach((h,m)=>{for(const p of m.ba)p.va(a)&&(d=!0)}),d&&Oy(c)}(r.eventManager,e),s.length&&r.Pu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function vD(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new ze(ee.comparator);o=o.insert(i,Ze.newNoDocument(i,ce.min()));const a=ve().add(i),c=new Ic(ce.min(),new Map,new ze(pe),o,a);await Gb(r,c),r.Ru=r.Ru.remove(i),r.Au.delete(e),$y(r)}else await ea(r.localStore,e,!1).then(()=>ra(r,e,n)).catch(Os)}async function _D(t,e){const n=ie(t),r=e.batch.batchId;try{const s=await jj(n.localStore,e);zy(n,r,null),Uy(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Us(n,s)}catch(s){await Os(s)}}async function xD(t,e,n){const r=ie(t);try{const s=await function(o,a){const c=ie(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(m=>(oe(m!==null,37113),h=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);zy(r,e,n),Uy(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Us(r,s)}catch(s){await Os(s)}}function Uy(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function zy(t,e,n){const r=ie(t);let s=r.du[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.du[r.currentUser.toKey()]=s}}function ra(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||Wb(t,r)})}function Wb(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(ta(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),$y(t))}function Kp(t,e,n){for(const r of n)r instanceof Bb?(t.Vu.addReference(r.key,e),wD(t,r)):r instanceof qb?(q(ga,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||Wb(t,r.key)):se(19791,{wu:r})}function wD(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(q(ga,"New document in limbo: "+n),t.Eu.add(r),$y(t))}function $y(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ee(Ce.fromString(e)),r=t.fu.next();t.Au.set(r,new dD(n)),t.Ru=t.Ru.insert(n,r),Uh(t.remoteStore,new yr(hn(xc(n.path)),r,"TargetPurposeLimboResolution",Xt.ce))}}async function Us(t,e,n){const r=ie(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Ny.Es(c.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Pu.J_(s),await async function(c,d){const h=ie(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>V.forEach(d,p=>V.forEach(p.Ts,_=>h.persistence.referenceDelegate.addReference(m,p.targetId,_)).next(()=>V.forEach(p.Is,_=>h.persistence.referenceDelegate.removeReference(m,p.targetId,_)))))}catch(m){if(!Ls(m))throw m;q(Ay,"Failed to update sequence numbers: "+m)}for(const m of d){const p=m.targetId;if(!m.fromCache){const _=h.vs.get(p),A=_.snapshotVersion,C=_.withLastLimboFreeSnapshotVersion(A);h.vs=h.vs.insert(p,C)}}}(r.localStore,i))}async function ED(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){q(ga,"User change. New user:",e.toKey());const r=await Sb(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(c=>{c.reject(new Q(z.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Us(n,r.Ns)}}function ID(t,e){const n=ie(t),r=n.Au.get(e);if(r&&r.hu)return ve().add(r.key);{let s=ve();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function TD(t,e){const n=ie(t),r=await Bp(n.localStore,e.query,!0),s=e.view.cu(r);return n.isPrimaryClient&&Kp(n,e.targetId,s.au),s}async function bD(t,e){const n=ie(t);return Cb(n.localStore,e).then(r=>Us(n,r))}async function SD(t,e,n,r){const s=ie(t),i=await function(a,c){const d=ie(a),h=ie(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",m=>h.Xn(m,c).next(p=>p?d.localDocuments.getDocuments(m,p):V.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await ma(s.remoteStore):n==="acknowledged"||n==="rejected"?(zy(s,e,r||null),Uy(s,e),function(a,c){ie(ie(a).mutationQueue).nr(c)}(s.localStore,e)):se(6720,"Unknown batchState",{bu:n}),await Us(s,i)):q(ga,"Cannot apply mutation batch with id: "+e)}async function ND(t,e){const n=ie(t);if(zh(n),By(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await Kx(n,r.toArray());n.gu=!0,await Gp(n.remoteStore,!0);for(const i of s)Uh(n.remoteStore,i)}else if(e===!1&&n.gu!==!1){const r=[];let s=Promise.resolve();n.Iu.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(ra(n,o),ea(n.localStore,o,!0))),ta(n.remoteStore,o)}),await s,await Kx(n,r),function(o){const a=ie(o);a.Au.forEach((c,d)=>{ta(a.remoteStore,d)}),a.Vu.zr(),a.Au=new Map,a.Ru=new ze(ee.comparator)}(n),n.gu=!1,await Gp(n.remoteStore,!1)}}async function Kx(t,e,n){const r=ie(t),s=[],i=[];for(const o of e){let a;const c=r.Iu.get(o);if(c&&c.length!==0){a=await $d(r.localStore,hn(c[0]));for(const d of c){const h=r.Tu.get(d),m=await TD(r,h);m.snapshot&&i.push(m.snapshot)}}else{const d=await Ab(r.localStore,o);a=await $d(r.localStore,d),await Fy(r,Kb(d),o,!1,a.resumeToken)}s.push(a)}return r.Pu.J_(i),s}function Kb(t){return kT(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function AD(t){return function(n){return ie(ie(n).persistence).hs()}(ie(t).localStore)}async function CD(t,e,n,r){const s=ie(t);if(s.gu)return void q(ga,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await Cb(s.localStore,jT(i[0])),a=Ic.createSynthesizedRemoteEventForCurrentChange(e,n==="current",it.EMPTY_BYTE_STRING);await Us(s,o,a);break}case"rejected":await ea(s.localStore,e,!0),ra(s,e,r);break;default:se(64155,n)}}async function kD(t,e,n){const r=zh(t);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){q(ga,"Adding an already active target "+s);continue}const i=await Ab(r.localStore,s),o=await $d(r.localStore,i);await Fy(r,Kb(i),o.targetId,!1,o.resumeToken),Uh(r.remoteStore,o)}for(const s of n)r.Iu.has(s)&&await ea(r.localStore,s,!1).then(()=>{ta(r.remoteStore,s),ra(r,s)}).catch(Os)}}function zh(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Gb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=ID.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=vD.bind(null,e),e.Pu.J_=aD.bind(null,e.eventManager),e.Pu.yu=lD.bind(null,e.eventManager),e}function By(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=_D.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=xD.bind(null,e),e}class oc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return bb(this.persistence,new Tb,e.initialUser,this.serializer)}Cu(e){return new by(Oh.Vi,this.serializer)}Du(e){return new Db}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}oc.provider={build:()=>new oc};class Qb extends oc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){oe(this.persistence.referenceDelegate instanceof zd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new vb(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new by(r=>zd.Vi(r,n),this.serializer)}}class Xb extends oc{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await By(this.xu.syncEngine),await ma(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return bb(this.persistence,new Tb,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new vb(r,e.asyncQueue,n)}Mu(e,n){const r=new LR(n,this.persistence);return new OR(e.asyncQueue,r)}Cu(e){const n=Ib(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Dt.withCacheSize(this.cacheSizeBytes):Dt.DEFAULT;return new Sy(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,Vb(),Wu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Db}}class RD extends Xb{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof em&&(this.sharedClientState.syncEngine={So:SD.bind(null,n),Do:CD.bind(null,n),Co:kD.bind(null,n),hs:AD.bind(null,n),bo:bD.bind(null,n)},await this.sharedClientState.start()),await this.persistence.zi(async r=>{await ND(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=Vb();if(!em.v(n))throw new Q(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=Ib(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new em(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class sa{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Wx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ED.bind(null,this.syncEngine),await Gp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new oD}()}createDatastore(e){const n=Lh(e.databaseInfo.databaseId),r=zj(e.databaseInfo);return Gj(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new Kj(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Wx(this.syncEngine,n,0),function(){return zx.v()?new zx:new Oj}())}createSyncEngine(e,n){return function(s,i,o,a,c,d,h){const m=new hD(s,i,o,a,c,d);return h&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ie(s);q(Ci,"RemoteStore shutting down."),i.Ea.add(5),await bc(i),i.Aa.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}sa.provider={build:()=>new sa};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qy{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):st("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const js="FirestoreClient";class PD{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=s,this.user=jt.UNAUTHENTICATED,this.clientId=sy.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{q(js,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(q(js,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Dy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function nm(t,e){t.asyncQueue.verifyOperationInProgress(),q(js,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Sb(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Qx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await jD(t);q(js,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Bx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Bx(e.remoteStore,s)),t._onlineComponents=e}async function jD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q(js,"Using user provided OfflineComponentProvider");try{await nm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Fo("Error using user provided cache. Falling back to memory cache: "+n),await nm(t,new oc)}}else q(js,"Using default OfflineComponentProvider"),await nm(t,new Qb(void 0));return t._offlineComponents}async function Yb(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q(js,"Using user provided OnlineComponentProvider"),await Qx(t,t._uninitializedComponentsProvider._online)):(q(js,"Using default OnlineComponentProvider"),await Qx(t,new sa))),t._onlineComponents}function DD(t){return Yb(t).then(e=>e.syncEngine)}async function Gd(t){const e=await Yb(t),n=e.eventManager;return n.onListen=fD.bind(null,e.syncEngine),n.onUnlisten=pD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=mD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=gD.bind(null,e.syncEngine),n}function VD(t,e,n,r){const s=new qy(r),i=new Ly(e,s,n);return t.asyncQueue.enqueueAndForget(async()=>Vy(await Gd(t),i)),()=>{s.Nu(),t.asyncQueue.enqueueAndForget(async()=>My(await Gd(t),i))}}function MD(t,e,n={}){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new qy({next:p=>{h.Nu(),o.enqueueAndForget(()=>My(i,m));const _=p.docs.has(a);!_&&p.fromCache?d.reject(new Q(z.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&p.fromCache&&c&&c.source==="server"?d.reject(new Q(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new Ly(xc(a.path),h,{includeMetadataChanges:!0,Ka:!0});return Vy(i,m)}(await Gd(t),t.asyncQueue,e,n,r)),r.promise}function OD(t,e,n={}){const r=new rr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new qy({next:p=>{h.Nu(),o.enqueueAndForget(()=>My(i,m)),p.fromCache&&c.source==="server"?d.reject(new Q(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new Ly(a,h,{includeMetadataChanges:!0,Ka:!0});return Vy(i,m)}(await Gd(t),t.asyncQueue,e,n,r)),r.promise}function LD(t,e){const n=new rr;return t.asyncQueue.enqueueAndForget(async()=>yD(await DD(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jb(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FD="ComponentProvider",Xx=new Map;function UD(t,e,n,r,s){return new hP(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,Jb(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zD="firestore.googleapis.com",Yx=!0;class Jx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=zD,this.ssl=Yx}else this.host=e.host,this.ssl=e.ssl??Yx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=fb;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yb)throw new Q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}DR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Jb(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hy{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Jx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Jx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new bR;switch(r.type){case"firstParty":return new AR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Xx.get(n);r&&(q(FD,"Removing Datastore"),Xx.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Mr(this.firestore,e,this._query)}}class et{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ts(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new et(this.firestore,e,this._key)}toJSON(){return{type:et._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(yc(n,et._jsonSchema))return new et(e,r||null,new ee(Ce.fromString(n.referencePath)))}}et._jsonSchemaVersion="firestore/documentReference/1.0",et._jsonSchema={type:lt("string",et._jsonSchemaVersion),referencePath:lt("string")};class Ts extends Mr{constructor(e,n,r){super(e,n,xc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new et(this.firestore,null,new ee(e))}withConverter(e){return new Ts(this.firestore,e,this._path)}}function Oe(t,e,...n){if(t=Ne(t),QI("collection","path",e),t instanceof Hy){const r=Ce.fromString(e,...n);return $_(r),new Ts(t,null,r)}{if(!(t instanceof et||t instanceof Ts))throw new Q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return $_(r),new Ts(t.firestore,null,r)}}function Me(t,e,...n){if(t=Ne(t),arguments.length===1&&(e=sy.newId()),QI("doc","path",e),t instanceof Hy){const r=Ce.fromString(e,...n);return z_(r),new et(t,null,new ee(r))}{if(!(t instanceof et||t instanceof Ts))throw new Q(z.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ce.fromString(e,...n));return z_(r),new et(t.firestore,t instanceof Ts?t.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zx="AsyncQueue";class ew{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Mb(this,"async_queue_retry"),this._c=()=>{const r=Wu();r&&q(Zx,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Wu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Wu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new rr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ls(e))throw e;q(Zx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,st("INTERNAL UNHANDLED ERROR: ",tw(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=jy.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&se(47125,{Pc:tw(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function tw(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class lr extends Hy{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new ew,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ew(e),this._firestoreClient=void 0,await e}}}function nw(t,e,n){n||(n=Pd);const r=gc(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(Ei(i,e))return s;throw new Q(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Q(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yb)throw new Q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&cr(e.host)&&Ih(e.host),r.initialize({options:e,instanceIdentifier:n})}function Sc(t){if(t._terminated)throw new Q(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||$D(t),t._firestoreClient}function $D(t){var r,s,i,o;const e=t._freezeSettings(),n=UD(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(s=t._app)==null?void 0:s.options.apiKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new PD(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const d=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xn(it.fromBase64String(e))}catch(n){throw new Q(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new xn(it.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:xn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(yc(e,xn._jsonSchema))return xn.fromBase64String(e.bytes)}}xn._jsonSchemaVersion="firestore/bytes/1.0",xn._jsonSchema={type:lt("string",xn._jsonSchemaVersion),bytes:lt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ke(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return pe(this._lat,e._lat)||pe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:sr._jsonSchemaVersion}}static fromJSON(e){if(yc(e,sr._jsonSchema))return new sr(e.latitude,e.longitude)}}sr._jsonSchemaVersion="firestore/geoPoint/1.0",sr._jsonSchema={type:lt("string",sr._jsonSchemaVersion),latitude:lt("number"),longitude:lt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Mn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(yc(e,Mn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Mn(e.vectorValues);throw new Q(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Mn._jsonSchemaVersion="firestore/vectorValue/1.0",Mn._jsonSchema={type:lt("string",Mn._jsonSchemaVersion),vectorValues:lt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=/^__.*__$/;class qD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Vr(e,this.data,this.fieldMask,n,this.fieldTransforms):new fa(e,this.data,n,this.fieldTransforms)}}class Zb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Vr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function eS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw se(40011,{dataSource:t})}}class Gy{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Gy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Wd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(eS(this.dataSource)&&BD.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class HD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Lh(e)}createContext(e,n,r,s=!1){return new Gy({dataSource:e,methodName:n,targetDoc:r,path:Ke.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Nc(t){const e=t._freezeSettings(),n=Lh(t._databaseId);return new HD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Wy(t,e,n,r,s,i={}){const o=t.createContext(i.merge||i.mergeFields?2:0,e,n,s);Qy("Data must be an object, but it was:",o,r);const a=rS(r,o);let c,d;if(i.merge)c=new Yt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const m of i.mergeFields){const p=ki(e,m,n);if(!o.contains(p))throw new Q(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);oS(h,p)||h.push(p)}c=new Yt(h),d=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=o.fieldTransforms;return new qD(new Mt(a),c,d)}class qh extends Bh{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof qh}}class Ky extends Bh{_toFieldTransform(e){return new BT(e.path,new Xo)}isEqual(e){return e instanceof Ky}}function tS(t,e,n,r){const s=t.createContext(1,e,n);Qy("Data must be an object, but it was:",s,r);const i=[],o=Mt.empty();Fs(r,(c,d)=>{const h=iS(e,c,n);d=Ne(d);const m=s.childContextForFieldPath(h);if(d instanceof qh)i.push(h);else{const p=Ac(d,m);p!=null&&(i.push(h),o.set(h,p))}});const a=new Yt(i);return new Zb(o,a,s.fieldTransforms)}function nS(t,e,n,r,s,i){const o=t.createContext(1,e,n),a=[ki(e,r,n)],c=[s];if(i.length%2!=0)throw new Q(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(ki(e,i[p])),c.push(i[p+1]);const d=[],h=Mt.empty();for(let p=a.length-1;p>=0;--p)if(!oS(d,a[p])){const _=a[p];let A=c[p];A=Ne(A);const C=o.childContextForFieldPath(_);if(A instanceof qh)d.push(_);else{const R=Ac(A,C);R!=null&&(d.push(_),h.set(_,R))}}const m=new Yt(d);return new Zb(h,m,o.fieldTransforms)}function GD(t,e,n,r=!1){return Ac(n,t.createContext(r?4:3,e))}function Ac(t,e){if(sS(t=Ne(t)))return Qy("Unsupported field value:",e,t),rS(t,e);if(t instanceof Bh)return function(r,s){if(!eS(s.dataSource))throw s.createError(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=Ac(a,s.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ne(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return PP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Re.fromDate(r);return{timestampValue:Zo(s.serializer,i)}}if(r instanceof Re){const i=new Re(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Zo(s.serializer,i)}}if(r instanceof sr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof xn)return{bytesValue:XT(s.serializer,r._byteString)};if(r instanceof et){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:wy(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Mn)return function(o,a){const c=o instanceof Mn?o.toArray():o;return{mapValue:{fields:{[hy]:{stringValue:fy},[Go]:{arrayValue:{values:c.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return gy(a.serializer,h)})}}}}}}(r,s);if(ab(r))return r._toProto(s.serializer);throw s.createError(`Unsupported field value: ${Th(r)}`)}(t,e)}function rS(t,e){const n={};return fT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fs(t,(r,s)=>{const i=Ac(s,e.childContextForField(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function sS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Re||t instanceof sr||t instanceof xn||t instanceof et||t instanceof Bh||t instanceof Mn||ab(t))}function Qy(t,e,n){if(!sS(n)||!XI(n)){const r=Th(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function ki(t,e,n){if((e=Ne(e))instanceof $h)return e._internalPath;if(typeof e=="string")return iS(t,e);throw Wd("Field path arguments must be of type string or ",t,!1,void 0,n)}const WD=new RegExp("[~\\*/\\[\\]]");function iS(t,e,n){if(e.search(WD)>=0)throw Wd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new $h(...e.split("."))._internalPath}catch{throw Wd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Wd(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Q(z.INVALID_ARGUMENT,a+t+c)}function oS(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{convertValue(e,n="none"){switch(ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return He(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Cr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw se(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Fs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Go].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>He(o.doubleValue));return new Mn(n)}convertGeoPoint(e){return new sr(He(e.latitude),He(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=kh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(ec(e));default:return null}}convertTimestamp(e){const n=Ar(e);return new Re(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ce.fromString(e);oe(ob(r),9688,{name:e});const s=new Ti(r.get(1),r.get(3)),i=new ee(r.popFirst(5));return s.isEqual(n)||st(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy extends KD{constructor(e){super(),this.firestore=e}convertBytes(e){return new xn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new et(this.firestore,null,n)}}function Fe(){return new Ky("serverTimestamp")}const rw="@firebase/firestore",sw="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aS{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new et(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(ki("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class QD extends aS{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lS(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Q(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Yy{}class Jy extends Yy{}function Nt(t,e,...n){let r=[];e instanceof Yy&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Zy).length,a=i.filter(c=>c instanceof Hh).length;if(o>1||o>0&&a>0)throw new Q(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Hh extends Jy{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Hh(e,n,r)}_apply(e){const n=this._parse(e);return cS(e._query,n),new Mr(e.firestore,e.converter,Vp(e._query,n))}_parse(e){const n=Nc(e.firestore);return function(i,o,a,c,d,h,m){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Q(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){aw(m,h);const A=[];for(const C of m)A.push(ow(c,i,C));p={arrayValue:{values:A}}}else p=ow(c,i,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||aw(m,h),p=GD(a,o,m,h==="in"||h==="not-in");return Ie.create(d,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ct(t,e,n){const r=e,s=ki("where",t);return Hh._create(s,r,n)}class Zy extends Yy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Zy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Pe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)cS(o,c),o=Vp(o,c)}(e._query,n),new Mr(e.firestore,e.converter,Vp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ev extends Jy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new ev(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new Q(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Q(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new sc(i,o)}(e._query,this._field,this._direction);return new Mr(e.firestore,e.converter,SP(e._query,n))}}function tv(t,e="asc"){const n=e,r=ki("orderBy",t);return ev._create(r,n)}class nv extends Jy{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new nv(e,n,r)}_apply(e){return new Mr(e.firestore,e.converter,Vd(e._query,this._limit,this._limitType))}}function XD(t){return nv._create("limit",t,"F")}function ow(t,e,n){if(typeof(n=Ne(n))=="string"){if(n==="")throw new Q(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!RT(e)&&n.indexOf("/")!==-1)throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ce.fromString(n));if(!ee.isDocumentKey(r))throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return nc(t,new ee(r))}if(n instanceof et)return nc(t,n._key);throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Th(n)}.`)}function aw(t,e){if(!Array.isArray(t)||t.length===0)throw new Q(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function cS(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Q(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function rv(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class YD{constructor(e){this.kind="memory",this._onlineComponentProvider=sa.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new Qb(void 0)}}toJSON(){return{kind:this.kind}}}class JD{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=rV(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function ZD(t){return new YD(t)}function eV(t){return new JD(t)}class tV{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=sa.provider,this._offlineComponentProvider={build:n=>new Xb(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class nV{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=sa.provider,this._offlineComponentProvider={build:n=>new RD(n,e==null?void 0:e.cacheSizeBytes)}}}function rV(t){return new tV(t==null?void 0:t.forceOwnership)}function sV(){return new nV}class ol{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mi extends aS{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ku(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ki("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=mi._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}mi._jsonSchemaVersion="firestore/documentSnapshot/1.0",mi._jsonSchema={type:lt("string",mi._jsonSchemaVersion),bundleSource:lt("string","DocumentSnapshot"),bundleName:lt("string"),bundle:lt("string")};class Ku extends mi{data(e={}){return super.data(e)}}class pi{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ol(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ku(this._firestore,this._userDataWriter,r.key,r,new ol(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new Ku(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ol(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Ku(s._firestore,s._userDataWriter,a.doc.key,a.doc,new ol(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:iV(a.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=pi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=sy.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function iV(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return se(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */pi._jsonSchemaVersion="firestore/querySnapshot/1.0",pi._jsonSchema={type:lt("string",pi._jsonSchemaVersion),bundleSource:lt("string","QuerySnapshot"),bundleName:lt("string"),bundle:lt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Nc(e)}set(e,n,r){this._verifyNotCommitted();const s=rm(e,this._firestore),i=rv(s.converter,n,r),o=Wy(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,pt.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=rm(e,this._firestore);let o;return o=typeof(n=Ne(n))=="string"||n instanceof $h?nS(this._dataReader,"WriteBatch.update",i._key,n,r,s):tS(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,pt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=rm(e,this._firestore);return this._mutations=this._mutations.concat(new Ec(n._key,pt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Q(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function rm(t,e){if((t=Ne(t)).firestore!==e)throw new Q(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(t){t=nn(t,et);const e=nn(t.firestore,lr),n=Sc(e);return MD(n,t._key).then(r=>uS(e,t,r))}function Qp(t){t=nn(t,Mr);const e=nn(t.firestore,lr),n=Sc(e),r=new Xy(e);return lS(t._query),OD(n,t._query).then(s=>new pi(e,r,t,s))}function ns(t,e,n){t=nn(t,et);const r=nn(t.firestore,lr),s=rv(t.converter,e,n),i=Nc(r);return kc(r,[Wy(i,"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,pt.none())])}function cn(t,e,n,...r){t=nn(t,et);const s=nn(t.firestore,lr),i=Nc(s);let o;return o=typeof(e=Ne(e))=="string"||e instanceof $h?nS(i,"updateDoc",t._key,e,n,r):tS(i,"updateDoc",t._key,e),kc(s,[o.toMutation(t._key,pt.exists(!0))])}function aV(t){return kc(nn(t.firestore,lr),[new Ec(t._key,pt.none())])}function Cc(t,e){const n=nn(t.firestore,lr),r=Me(t),s=rv(t.converter,e),i=Nc(t.firestore);return kc(n,[Wy(i,"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,pt.exists(!1))]).then(()=>r)}function ut(t,...e){var d,h,m;t=Ne(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||iw(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(iw(e[r])){const p=e[r];e[r]=(d=p.next)==null?void 0:d.bind(p),e[r+1]=(h=p.error)==null?void 0:h.bind(p),e[r+2]=(m=p.complete)==null?void 0:m.bind(p)}let i,o,a;if(t instanceof et)o=nn(t.firestore,lr),a=xc(t._key.path),i={next:p=>{e[r]&&e[r](uS(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=nn(t,Mr);o=nn(p.firestore,lr),a=p._query;const _=new Xy(o);i={next:A=>{e[r]&&e[r](new pi(o,_,p,A))},error:e[r+1],complete:e[r+2]},lS(t._query)}const c=Sc(o);return VD(c,a,s,i)}function kc(t,e){const n=Sc(t);return LD(n,e)}function uS(t,e,n){const r=n.docs.get(e._key),s=new Xy(t);return new mi(t,s,e._key,r,new ol(n.hasPendingWrites,n.fromCache),e.converter)}function lV(t){return t=nn(t,lr),Sc(t),new oV(t,e=>kc(t,e))}(function(e,n=!0){IR(Oi),Cs(new Sr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new lr(new SR(r.getProvider("auth-internal")),new CR(o,r.getProvider("app-check-internal")),fP(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Tn(rw,sw,e),Tn(rw,sw,"esm2020")})();let cV={data:""},uV=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||cV},dV=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,hV=/\/\*[^]*?\*\/|  +/g,lw=/\n+/g,rs=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?rs(o,i):i+"{"+rs(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=rs(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=rs.p?rs.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},dr={},dS=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+dS(t[n]);return e}return t},fV=(t,e,n,r,s)=>{let i=dS(t),o=dr[i]||(dr[i]=(c=>{let d=0,h=11;for(;d<c.length;)h=101*h+c.charCodeAt(d++)>>>0;return"go"+h})(i));if(!dr[o]){let c=i!==t?t:(d=>{let h,m,p=[{}];for(;h=dV.exec(d.replace(hV,""));)h[4]?p.shift():h[3]?(m=h[3].replace(lw," ").trim(),p.unshift(p[0][m]=p[0][m]||{})):p[0][h[1]]=h[2].replace(lw," ").trim();return p[0]})(t);dr[o]=rs(s?{["@keyframes "+o]:c}:c,n?"":"."+o)}let a=n&&dr.g?dr.g:null;return n&&(dr.g=dr[o]),((c,d,h,m)=>{m?d.data=d.data.replace(m,c):d.data.indexOf(c)===-1&&(d.data=h?c+d.data:d.data+c)})(dr[o],e,r,a),o},mV=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(n),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=c?"."+c:a&&typeof a=="object"?a.props?"":rs(a,""):a===!1?"":a}return r+s+(o??"")},"");function Gh(t){let e=this||{},n=t.call?t(e.p):t;return fV(n.unshift?n.raw?mV(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,uV(e.target),e.g,e.o,e.k)}let hS,Xp,Yp;Gh.bind({g:1});let kr=Gh.bind({k:1});function pV(t,e,n,r){rs.p=e,hS=t,Xp=n,Yp=r}function zs(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),c=a.className||s.className;n.p=Object.assign({theme:Xp&&Xp()},a),n.o=/ *go\d+/.test(c),a.className=Gh.apply(n,r)+(c?" "+c:"");let d=t;return t[0]&&(d=a.as||t,delete a.as),Yp&&d[0]&&Yp(a),hS(d,a)}return s}}var gV=t=>typeof t=="function",Kd=(t,e)=>gV(t)?t(e):t,yV=(()=>{let t=0;return()=>(++t).toString()})(),fS=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),vV=20,sv="default",mS=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return mS(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Qu=[],pS={toasts:[],pausedAt:void 0,settings:{toastLimit:vV}},Zn={},gS=(t,e=sv)=>{Zn[e]=mS(Zn[e]||pS,t),Qu.forEach(([n,r])=>{n===e&&r(Zn[e])})},yS=t=>Object.keys(Zn).forEach(e=>gS(t,e)),_V=t=>Object.keys(Zn).find(e=>Zn[e].toasts.some(n=>n.id===t)),Wh=(t=sv)=>e=>{gS(e,t)},xV={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},wV=(t={},e=sv)=>{let[n,r]=j.useState(Zn[e]||pS),s=j.useRef(Zn[e]);j.useEffect(()=>(s.current!==Zn[e]&&r(Zn[e]),Qu.push([e,r]),()=>{let o=Qu.findIndex(([a])=>a===e);o>-1&&Qu.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var a,c,d;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((a=t[o.type])==null?void 0:a.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((c=t[o.type])==null?void 0:c.duration)||(t==null?void 0:t.duration)||xV[o.type],style:{...t.style,...(d=t[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:i}},EV=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||yV()}),Rc=t=>(e,n)=>{let r=EV(e,t,n);return Wh(r.toasterId||_V(r.id))({type:2,toast:r}),r.id},ft=(t,e)=>Rc("blank")(t,e);ft.error=Rc("error");ft.success=Rc("success");ft.loading=Rc("loading");ft.custom=Rc("custom");ft.dismiss=(t,e)=>{let n={type:3,toastId:t};e?Wh(e)(n):yS(n)};ft.dismissAll=t=>ft.dismiss(void 0,t);ft.remove=(t,e)=>{let n={type:4,toastId:t};e?Wh(e)(n):yS(n)};ft.removeAll=t=>ft.remove(void 0,t);ft.promise=(t,e,n)=>{let r=ft.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?Kd(e.success,s):void 0;return i?ft.success(i,{id:r,...n,...n==null?void 0:n.success}):ft.dismiss(r),s}).catch(s=>{let i=e.error?Kd(e.error,s):void 0;i?ft.error(i,{id:r,...n,...n==null?void 0:n.error}):ft.dismiss(r)}),t};var IV=1e3,TV=(t,e="default")=>{let{toasts:n,pausedAt:r}=wV(t,e),s=j.useRef(new Map).current,i=j.useCallback((m,p=IV)=>{if(s.has(m))return;let _=setTimeout(()=>{s.delete(m),o({type:4,toastId:m})},p);s.set(m,_)},[]);j.useEffect(()=>{if(r)return;let m=Date.now(),p=n.map(_=>{if(_.duration===1/0)return;let A=(_.duration||0)+_.pauseDuration-(m-_.createdAt);if(A<0){_.visible&&ft.dismiss(_.id);return}return setTimeout(()=>ft.dismiss(_.id,e),A)});return()=>{p.forEach(_=>_&&clearTimeout(_))}},[n,r,e]);let o=j.useCallback(Wh(e),[e]),a=j.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=j.useCallback((m,p)=>{o({type:1,toast:{id:m,height:p}})},[o]),d=j.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),h=j.useCallback((m,p)=>{let{reverseOrder:_=!1,gutter:A=8,defaultPosition:C}=p||{},R=n.filter(w=>(w.position||C)===(m.position||C)&&w.height),E=R.findIndex(w=>w.id===m.id),v=R.filter((w,N)=>N<E&&w.visible).length;return R.filter(w=>w.visible).slice(..._?[v+1]:[0,v]).reduce((w,N)=>w+(N.height||0)+A,0)},[n]);return j.useEffect(()=>{n.forEach(m=>{if(m.dismissed)i(m.id,m.removeDelay);else{let p=s.get(m.id);p&&(clearTimeout(p),s.delete(m.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:c,startPause:a,endPause:d,calculateOffset:h}}},bV=kr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,SV=kr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,NV=kr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,AV=zs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${bV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${SV} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${NV} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,CV=kr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,kV=zs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${CV} 1s linear infinite;
`,RV=kr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,PV=kr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,jV=zs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${RV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${PV} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,DV=zs("div")`
  position: absolute;
`,VV=zs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,MV=kr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,OV=zs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${MV} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,LV=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?j.createElement(OV,null,e):e:n==="blank"?null:j.createElement(VV,null,j.createElement(kV,{...r}),n!=="loading"&&j.createElement(DV,null,n==="error"?j.createElement(AV,{...r}):j.createElement(jV,{...r})))},FV=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,UV=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,zV="0%{opacity:0;} 100%{opacity:1;}",$V="0%{opacity:1;} 100%{opacity:0;}",BV=zs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,qV=zs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,HV=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=fS()?[zV,$V]:[FV(n),UV(n)];return{animation:e?`${kr(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${kr(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},GV=j.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?HV(t.position||e||"top-center",t.visible):{opacity:0},i=j.createElement(LV,{toast:t}),o=j.createElement(qV,{...t.ariaProps},Kd(t.message,t));return j.createElement(BV,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):j.createElement(j.Fragment,null,i,o))});pV(j.createElement);var WV=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=j.useCallback(o=>{if(o){let a=()=>{let c=o.getBoundingClientRect().height;r(t,c)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return j.createElement("div",{ref:i,className:e,style:n},s)},KV=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:fS()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},QV=Gh`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,yu=16,XV=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:c,handlers:d}=TV(n,i);return j.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:yu,left:yu,right:yu,bottom:yu,pointerEvents:"none",...o},className:a,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(h=>{let m=h.position||e,p=d.calculateOffset(h,{reverseOrder:t,gutter:r,defaultPosition:e}),_=KV(m,p);return j.createElement(WV,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?QV:"",style:_},h.type==="custom"?Kd(h.message,h):s?s(h):j.createElement(GV,{toast:h,position:m}))}))},_n=ft,YV="firebase",JV="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tn(YV,JV,"app");function vS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZV=vS,_S=new mc("auth","Firebase",vS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd=new ey("@firebase/auth");function e4(t,...e){Qd.logLevel<=Ee.WARN&&Qd.warn(`Auth (${Oi}): ${t}`,...e)}function Xu(t,...e){Qd.logLevel<=Ee.ERROR&&Qd.error(`Auth (${Oi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t,...e){throw iv(t,...e)}function ir(t,...e){return iv(t,...e)}function xS(t,e,n){const r={...ZV(),[e]:n};return new mc("auth","Firebase",r).create(e,{appName:t.name})}function wr(t){return xS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function iv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return _S.create(t,...e)}function de(t,e,...n){if(!t)throw iv(e,...n)}function vr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Xu(e),new Error(e)}function Rr(t,e){t||vr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function t4(){return cw()==="http:"||cw()==="https:"}function cw(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(t4()||sk()||"connection"in navigator)?navigator.onLine:!0}function r4(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Rr(n>e,"Short delay should be less than long delay!"),this.isMobile=nk()||ik()}get(){return n4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ov(t,e){Rr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],o4=new Pc(3e4,6e4);function Or(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ur(t,e,n,r,s={}){return ES(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=pc({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...i};return rk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&cr(t.emulatorConfig.host)&&(d.credentials="include"),wS.fetch()(await IS(t,t.config.apiHost,n,a),d)})}async function ES(t,e,n){t._canInitEmulator=!1;const r={...s4,...e};try{const s=new l4(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw vu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw vu(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw vu(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw vu(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw xS(t,h,d);Fn(t,h)}}catch(s){if(s instanceof Un)throw s;Fn(t,"network-request-failed",{message:String(s)})}}async function jc(t,e,n,r,s={}){const i=await ur(t,e,n,r,s);return"mfaPendingCredential"in i&&Fn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function IS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?ov(t.config,s):`${t.config.apiScheme}://${s}`;return i4.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function a4(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class l4{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(ir(this.auth,"network-request-failed")),o4.get())})}}function vu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=ir(t,e,r);return s.customData._tokenResponse=n,s}function uw(t){return t!==void 0&&t.enterprise!==void 0}class c4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return a4(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function u4(t,e){return ur(t,"GET","/v2/recaptchaConfig",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d4(t,e){return ur(t,"POST","/v1/accounts:delete",e)}async function Xd(t,e){return ur(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function h4(t,e=!1){const n=Ne(t),r=await n.getIdToken(e),s=av(r);de(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Al(sm(s.auth_time)),issuedAtTime:Al(sm(s.iat)),expirationTime:Al(sm(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function sm(t){return Number(t)*1e3}function av(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Xu("JWT malformed, contained fewer than 3 sections"),null;try{const s=SI(n);return s?JSON.parse(s):(Xu("Failed to decode base64 JWT payload"),null)}catch(s){return Xu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function dw(t){const e=av(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ia(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Un&&f4(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function f4({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Al(this.lastLoginAt),this.creationTime=Al(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yd(t){var m;const e=t.auth,n=await t.getIdToken(),r=await ia(t,Xd(e,{idToken:n}));de(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?TS(s.providerUserInfo):[],o=g4(t.providerData,i),a=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Zp(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function p4(t){const e=Ne(t);await Yd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function g4(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function TS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y4(t,e){const n=await ES(t,{},async()=>{const r=pc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await IS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&cr(t.emulatorConfig.host)&&(c.credentials="include"),wS.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function v4(t,e){return ur(t,"POST","/v2/accounts:revokeToken",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):dw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){de(e.length!==0,"internal-error");const n=dw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await y4(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Co;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(de(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(de(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Co,this.toJSON())}_performRefresh(){return vr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qr(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class jn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new m4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Zp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await ia(this,this.stsTokenManager.getToken(this.auth,e));return de(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return h4(this,e)}reload(){return p4(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new jn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Yd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Kt(this.auth.app))return Promise.reject(wr(this.auth));const e=await this.getIdToken();return await ia(this,d4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:m,emailVerified:p,isAnonymous:_,providerData:A,stsTokenManager:C}=n;de(m&&C,e,"internal-error");const R=Co.fromJSON(this.name,C);de(typeof m=="string",e,"internal-error"),Qr(r,e.name),Qr(s,e.name),de(typeof p=="boolean",e,"internal-error"),de(typeof _=="boolean",e,"internal-error"),Qr(i,e.name),Qr(o,e.name),Qr(a,e.name),Qr(c,e.name),Qr(d,e.name),Qr(h,e.name);const E=new jn({uid:m,auth:e,email:s,emailVerified:p,displayName:r,isAnonymous:_,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:R,createdAt:d,lastLoginAt:h});return A&&Array.isArray(A)&&(E.providerData=A.map(v=>({...v}))),c&&(E._redirectEventId=c),E}static async _fromIdTokenResponse(e,n,r=!1){const s=new Co;s.updateFromServerResponse(n);const i=new jn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Yd(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];de(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?TS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Co;a.updateFromIdToken(r);const c=new jn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Zp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw=new Map;function _r(t){Rr(t instanceof Function,"Expected a class definition");let e=hw.get(t);return e?(Rr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,hw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}bS.type="NONE";const fw=bS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(t,e,n){return`firebase:${t}:${e}:${n}`}class ko{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Yu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Yu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Xd(this.auth,{idToken:e}).catch(()=>{});return n?jn._fromGetAccountInfoResponse(this.auth,n,e):null}return jn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ko(_r(fw),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||_r(fw);const o=Yu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let m;if(typeof h=="string"){const p=await Xd(e,{idToken:h}).catch(()=>{});if(!p)break;m=await jn._fromGetAccountInfoResponse(e,p,h)}else m=jn._fromJSON(e,h);d!==i&&(a=m),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new ko(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new ko(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(CS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(SS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(RS(e))return"Blackberry";if(PS(e))return"Webos";if(NS(e))return"Safari";if((e.includes("chrome/")||AS(e))&&!e.includes("edge/"))return"Chrome";if(kS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function SS(t=gt()){return/firefox\//i.test(t)}function NS(t=gt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function AS(t=gt()){return/crios\//i.test(t)}function CS(t=gt()){return/iemobile/i.test(t)}function kS(t=gt()){return/android/i.test(t)}function RS(t=gt()){return/blackberry/i.test(t)}function PS(t=gt()){return/webos/i.test(t)}function lv(t=gt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function _4(t=gt()){var e;return lv(t)&&!!((e=window.navigator)!=null&&e.standalone)}function x4(){return ok()&&document.documentMode===10}function jS(t=gt()){return lv(t)||kS(t)||PS(t)||RS(t)||/windows phone/i.test(t)||CS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(t,e=[]){let n;switch(t){case"Browser":n=mw(gt());break;case"Worker":n=`${mw(gt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Oi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E4(t,e={}){return ur(t,"GET","/v2/passwordPolicy",Or(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4=6;class T4{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??I4,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b4{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pw(this),this.idTokenSubscription=new pw(this),this.beforeStateQueue=new w4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_S,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=_r(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await ko.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Xd(this,{idToken:e}),r=await jn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Kt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Yd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=r4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Kt(this.app))return Promise.reject(wr(this));const n=e?Ne(e):null;return n&&de(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Kt(this.app)?Promise.reject(wr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Kt(this.app)?Promise.reject(wr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_r(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await E4(this),n=new T4(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new mc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await v4(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&_r(e)||this._popupRedirectResolver;de(n,this,"argument-error"),this.redirectPersistenceManager=await ko.create(this,[_r(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=DS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Kt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&e4(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function $s(t){return Ne(t)}class pw{constructor(e){this.auth=e,this.observer=null,this.addObserver=hk(n=>this.observer=n)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function S4(t){Kh=t}function VS(t){return Kh.loadJS(t)}function N4(){return Kh.recaptchaEnterpriseScript}function A4(){return Kh.gapiScript}function C4(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class k4{constructor(){this.enterprise=new R4}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class R4{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const P4="recaptcha-enterprise",MS="NO_RECAPTCHA";class j4{constructor(e){this.type=P4,this.auth=$s(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{u4(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new c4(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;uw(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(MS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new k4().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&uw(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=N4();c.length!==0&&(c+=a),VS(c).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function gw(t,e,n,r=!1,s=!1){const i=new j4(t);let o;if(s)o=MS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Jd(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await gw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await gw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D4(t,e){const n=gc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Ei(i,e??{}))return s;Fn(s,"already-initialized")}return n.initialize({options:e})}function V4(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(_r);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function M4(t,e,n){const r=$s(t);de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=OS(e),{host:o,port:a}=O4(e),c=a===null?"":`:${a}`,d={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){de(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),de(Ei(d,r.config.emulator)&&Ei(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,cr(o)?(Ih(`${i}//${o}${c}`),Zg("Auth",!0)):L4()}function OS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function O4(t){const e=OS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:yw(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:yw(o)}}}function yw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function L4(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return vr("not implemented")}_getIdTokenResponse(e){return vr("not implemented")}_linkToIdToken(e,n){return vr("not implemented")}_getReauthenticationResolver(e){return vr("not implemented")}}async function F4(t,e){return ur(t,"POST","/v1/accounts:update",e)}async function U4(t,e){return ur(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z4(t,e){return jc(t,"POST","/v1/accounts:signInWithPassword",Or(t,e))}async function $4(t,e){return ur(t,"POST","/v1/accounts:sendOobCode",Or(t,e))}async function B4(t,e){return $4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q4(t,e){return jc(t,"POST","/v1/accounts:signInWithEmailLink",Or(t,e))}async function H4(t,e){return jc(t,"POST","/v1/accounts:signInWithEmailLink",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac extends cv{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new ac(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ac(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jd(e,n,"signInWithPassword",z4);case"emailLink":return q4(e,{email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jd(e,r,"signUpPassword",U4);case"emailLink":return H4(e,{idToken:n,email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ro(t,e){return jc(t,"POST","/v1/accounts:signInWithIdp",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4="http://localhost";class Ri extends cv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ri(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Fn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ri(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ro(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ro(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ro(e,n)}buildRequest(){const e={requestUri:G4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=pc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W4(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function K4(t){const e=el(tl(t)).link,n=e?el(tl(e)).deep_link_id:null,r=el(tl(t)).deep_link_id;return(r?el(tl(r)).link:null)||r||n||e||t}class uv{constructor(e){const n=el(tl(e)),r=n.apiKey??null,s=n.oobCode??null,i=W4(n.mode??null);de(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=K4(e);try{return new uv(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(){this.providerId=Fi.PROVIDER_ID}static credential(e,n){return ac._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=uv.parseLink(n);return de(r,"argument-error"),ac._fromEmailAndCode(e,r.code,r.tenantId)}}Fi.PROVIDER_ID="password";Fi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Fi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc extends LS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends Dc{constructor(){super("facebook.com")}static credential(e){return Ri._fromParams({providerId:ss.PROVIDER_ID,signInMethod:ss.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ss.credentialFromTaggedObject(e)}static credentialFromError(e){return ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ss.credential(e.oauthAccessToken)}catch{return null}}}ss.FACEBOOK_SIGN_IN_METHOD="facebook.com";ss.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is extends Dc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ri._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return is.credentialFromTaggedObject(e)}static credentialFromError(e){return is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return is.credential(n,r)}catch{return null}}}is.GOOGLE_SIGN_IN_METHOD="google.com";is.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os extends Dc{constructor(){super("github.com")}static credential(e){return Ri._fromParams({providerId:os.PROVIDER_ID,signInMethod:os.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return os.credentialFromTaggedObject(e)}static credentialFromError(e){return os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return os.credential(e.oauthAccessToken)}catch{return null}}}os.GITHUB_SIGN_IN_METHOD="github.com";os.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as extends Dc{constructor(){super("twitter.com")}static credential(e,n){return Ri._fromParams({providerId:as.PROVIDER_ID,signInMethod:as.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return as.credentialFromTaggedObject(e)}static credentialFromError(e){return as.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return as.credential(n,r)}catch{return null}}}as.TWITTER_SIGN_IN_METHOD="twitter.com";as.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q4(t,e){return jc(t,"POST","/v1/accounts:signUp",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await jn._fromIdTokenResponse(e,r,s),o=vw(r);return new Pi({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=vw(r);return new Pi({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function vw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd extends Un{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Zd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Zd(e,n,r,s)}}function FS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Zd._fromErrorAndOperation(t,i,e,r):i})}async function X4(t,e,n=!1){const r=await ia(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Pi._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function US(t,e,n=!1){const{auth:r}=t;if(Kt(r.app))return Promise.reject(wr(r));const s="reauthenticate";try{const i=await ia(t,FS(r,s,e,t),n);de(i.idToken,r,"internal-error");const o=av(i.idToken);de(o,r,"internal-error");const{sub:a}=o;return de(t.uid===a,r,"user-mismatch"),Pi._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Fn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zS(t,e,n=!1){if(Kt(t.app))return Promise.reject(wr(t));const r="signIn",s=await FS(t,r,e),i=await Pi._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Y4(t,e){return zS($s(t),e)}async function J4(t,e){return US(Ne(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $S(t){const e=$s(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function BS(t,e,n){const r=$s(t);await Jd(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",B4)}async function Z4(t,e,n){if(Kt(t.app))return Promise.reject(wr(t));const r=$s(t),o=await Jd(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Q4).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&$S(t),c}),a=await Pi._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function _w(t,e,n){return Kt(t.app)?Promise.reject(wr(t)):Y4(Ne(t),Fi.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&$S(t),r})}function eM(t,e){return tM(Ne(t),null,e)}async function tM(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await ia(t,F4(r,i));await t._updateTokensIfNecessary(o,!0)}function nM(t,e,n,r){return Ne(t).onIdTokenChanged(e,n,r)}function rM(t,e,n){return Ne(t).beforeAuthStateChanged(e,n)}function sM(t,e,n,r){return Ne(t).onAuthStateChanged(e,n,r)}function iM(t){return Ne(t).signOut()}async function oM(t){return Ne(t).delete()}const eh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(eh,"1"),this.storage.removeItem(eh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aM=1e3,lM=10;class HS extends qS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);x4()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,lM):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},aM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}HS.type="LOCAL";const cM=HS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GS extends qS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}GS.type="SESSION";const WS=GS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Qh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),c=await uM(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Qh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const d=dv("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(){return window}function hM(t){or().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KS(){return typeof or().WorkerGlobalScope<"u"&&typeof or().importScripts=="function"}async function fM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function mM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function pM(){return KS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS="firebaseLocalStorageDb",gM=1,th="firebaseLocalStorage",XS="fbase_key";class Vc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Xh(t,e){return t.transaction([th],e?"readwrite":"readonly").objectStore(th)}function yM(){const t=indexedDB.deleteDatabase(QS);return new Vc(t).toPromise()}function eg(){const t=indexedDB.open(QS,gM);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(th,{keyPath:XS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(th)?e(r):(r.close(),await yM(),e(await eg()))})})}async function xw(t,e,n){const r=Xh(t,!0).put({[XS]:e,value:n});return new Vc(r).toPromise()}async function vM(t,e){const n=Xh(t,!1).get(e),r=await new Vc(n).toPromise();return r===void 0?null:r.value}function ww(t,e){const n=Xh(t,!0).delete(e);return new Vc(n).toPromise()}const _M=800,xM=3;class YS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await eg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>xM)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return KS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Qh._getInstance(pM()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await fM(),!this.activeServiceWorker)return;this.sender=new dM(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||mM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await eg();return await xw(e,eh,"1"),await ww(e,eh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>xw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>vM(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ww(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Xh(s,!1).getAll();return new Vc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_M)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}YS.type="LOCAL";const wM=YS;new Pc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(t,e){return e?_r(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv extends cv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ro(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ro(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ro(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function IM(t){return zS(t.auth,new hv(t),t.bypassAuthState)}function TM(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),US(n,new hv(t),t.bypassAuthState)}async function bM(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),X4(n,new hv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return IM;case"linkViaPopup":case"linkViaRedirect":return bM;case"reauthViaPopup":case"reauthViaRedirect":return TM;default:Fn(this.auth,"internal-error")}}resolve(e){Rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Rr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=new Pc(2e3,1e4);class _o extends JS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,_o.currentPopupAction&&_o.currentPopupAction.cancel(),_o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){Rr(this.filter.length===1,"Popup operations only handle one event");const e=dv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ir(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(ir(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_o.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ir(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,SM.get())};e()}}_o.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NM="pendingRedirect",Ju=new Map;class AM extends JS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ju.get(this.auth._key());if(!e){try{const r=await CM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ju.set(this.auth._key(),e)}return this.bypassAuthState||Ju.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function CM(t,e){const n=PM(e),r=RM(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function kM(t,e){Ju.set(t._key(),e)}function RM(t){return _r(t._redirectPersistence)}function PM(t){return Yu(NM,t.config.apiKey,t.name)}async function jM(t,e,n=!1){if(Kt(t.app))return Promise.reject(wr(t));const r=$s(t),s=EM(r,e),o=await new AM(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DM=10*60*1e3;class VM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!MM(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!ZS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(ir(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=DM&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ew(e))}saveEventToCache(e){this.cachedEventUids.add(Ew(e)),this.lastProcessedEventTime=Date.now()}}function Ew(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function ZS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function MM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ZS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OM(t,e={}){return ur(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,FM=/^https?/;async function UM(t){if(t.config.emulator)return;const{authorizedDomains:e}=await OM(t);for(const n of e)try{if(zM(n))return}catch{}Fn(t,"unauthorized-domain")}function zM(t){const e=Jp(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!FM.test(n))return!1;if(LM.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $M=new Pc(3e4,6e4);function Iw(){const t=or().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function BM(t){return new Promise((e,n)=>{var s,i,o;function r(){Iw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Iw(),n(ir(t,"network-request-failed"))},timeout:$M.get()})}if((i=(s=or().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=or().gapi)!=null&&o.load)r();else{const a=C4("iframefcb");return or()[a]=()=>{gapi.load?r():n(ir(t,"network-request-failed"))},VS(`${A4()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Zu=null,e})}let Zu=null;function qM(t){return Zu=Zu||BM(t),Zu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HM=new Pc(5e3,15e3),GM="__/auth/iframe",WM="emulator/auth/iframe",KM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function XM(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ov(e,WM):`https://${t.config.authDomain}/${GM}`,r={apiKey:e.apiKey,appName:t.name,v:Oi},s=QM.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${pc(r).slice(1)}`}async function YM(t){const e=await qM(t),n=or().gapi;return de(n,t,"internal-error"),e.open({where:document.body,url:XM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:KM,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=ir(t,"network-request-failed"),a=or().setTimeout(()=>{i(o)},HM.get());function c(){or().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ZM=500,eO=600,tO="_blank",nO="http://localhost";class Tw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function rO(t,e,n,r=ZM,s=eO){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...JM,width:r.toString(),height:s.toString(),top:i,left:o},d=gt().toLowerCase();n&&(a=AS(d)?tO:n),SS(d)&&(e=e||nO,c.scrollbars="yes");const h=Object.entries(c).reduce((p,[_,A])=>`${p}${_}=${A},`,"");if(_4(d)&&a!=="_self")return sO(e||"",a),new Tw(null);const m=window.open(e||"",a,h);de(m,t,"popup-blocked");try{m.focus()}catch{}return new Tw(m)}function sO(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO="__/auth/handler",oO="emulator/auth/handler",aO=encodeURIComponent("fac");async function bw(t,e,n,r,s,i){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Oi,eventId:s};if(e instanceof LS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",dk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))o[h]=m}if(e instanceof Dc){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),d=c?`#${aO}=${encodeURIComponent(c)}`:"";return`${lO(t)}?${pc(a).slice(1)}${d}`}function lO({config:t}){return t.emulator?ov(t,oO):`https://${t.authDomain}/${iO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const im="webStorageSupport";class cO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=WS,this._completeRedirectFn=jM,this._overrideRedirectResult=kM}async _openPopup(e,n,r,s){var o;Rr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await bw(e,n,r,Jp(),s);return rO(e,i,dv())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await bw(e,n,r,Jp(),s);return hM(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Rr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await YM(e),r=new VM(e);return n.register("authEvent",s=>(de(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(im,{type:im},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[im];i!==void 0&&n(!!i),Fn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=UM(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return jS()||NS()||lv()}}const uO=cO;var Sw="@firebase/auth",Nw="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function fO(t){Cs(new Sr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:DS(t)},d=new b4(r,s,i,c);return V4(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Cs(new Sr("auth-internal",e=>{const n=$s(e.getProvider("auth").getImmediate());return(r=>new dO(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tn(Sw,Nw,hO(t)),Tn(Sw,Nw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mO=5*60,pO=RI("authIdTokenMaxAge")||mO;let Aw=null;const gO=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>pO)return;const s=n==null?void 0:n.token;Aw!==s&&(Aw=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function yO(t=ny()){const e=gc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=D4(t,{popupRedirectResolver:uO,persistence:[wM,cM,WS]}),r=RI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=gO(i.toString());rM(n,o,()=>o(n.currentUser)),nM(n,a=>o(a))}}const s=AI("auth");return s&&M4(n,`http://${s}`),n}function vO(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}S4({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=ir("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",vO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});fO("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O="type.googleapis.com/google.protobuf.Int64Value",xO="type.googleapis.com/google.protobuf.UInt64Value";function eN(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function nh(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>nh(e));if(typeof t=="function"||typeof t=="object")return eN(t,e=>nh(e));throw new Error("Data cannot be encoded in JSON: "+t)}function oa(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case _O:case xO:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>oa(e)):typeof t=="function"||typeof t=="object"?eN(t,e=>oa(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cw={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Jt extends Un{constructor(e,n,r){super(`${fv}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,Jt.prototype)}}function wO(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function rh(t,e){let n=wO(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!Cw[o])return new Jt("internal","internal");n=Cw[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=oa(s))}}catch{}return n==="ok"?null:new Jt(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Kt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tg="us-central1",IO=/^data: (.*?)(?:\n|$)/;function TO(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new Jt("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class bO{constructor(e,n,r,s,i=tg,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new EO(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=tg}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function SO(t,e,n){const r=cr(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(Ih(t.emulatorOrigin+"/backends"),Zg("Functions",!0))}function NO(t,e,n){const r=s=>CO(t,e,s,{});return r.stream=(s,i)=>RO(t,e,s,i),r}function tN(t){return t.emulatorOrigin&&cr(t.emulatorOrigin)?"include":void 0}async function AO(t,e,n,r,s){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:tN(s)})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function nN(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function CO(t,e,n,r){const s=t._url(e);return kO(t,s,n,r)}async function kO(t,e,n,r){n=nh(n);const s={data:n},i=await nN(t,r),o=r.timeout||7e4,a=TO(o),c=await Promise.race([AO(e,s,i,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!c)throw new Jt("cancelled","Firebase Functions instance was deleted.");const d=rh(c.status,c.json);if(d)throw d;if(!c.json)throw new Jt("internal","Response is not valid JSON object.");let h=c.json.data;if(typeof h>"u"&&(h=c.json.result),typeof h>"u")throw new Jt("internal","Response is missing data field.");return{data:oa(h)}}function RO(t,e,n,r){const s=t._url(e);return PO(t,s,n,r||{})}async function PO(t,e,n,r){var p;n=nh(n);const s={data:n},i=await nN(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal,credentials:tN(t)})}catch(_){if(_ instanceof Error&&_.name==="AbortError"){const C=new Jt("cancelled","Request was cancelled.");return{data:Promise.reject(C),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(C)}}}}}}const A=rh(0,null);return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}let a,c;const d=new Promise((_,A)=>{a=_,c=A});(p=r==null?void 0:r.signal)==null||p.addEventListener("abort",()=>{const _=new Jt("cancelled","Request was cancelled.");c(_)});const h=o.body.getReader(),m=jO(h,a,c,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const _=m.getReader();return{async next(){const{value:A,done:C}=await _.read();return{value:A,done:C}},async return(){return await _.cancel(),{done:!0,value:void 0}}}}},data:d}}function jO(t,e,n,r){const s=(o,a)=>{const c=o.match(IO);if(!c)return;const d=c[1];try{const h=JSON.parse(d);if("result"in h){e(oa(h.result));return}if("message"in h){a.enqueue(oa(h.message));return}if("error"in h){const m=rh(0,h);a.error(m),n(m);return}}catch(h){if(h instanceof Jt){a.error(h),n(h);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return c();async function c(){if(r!=null&&r.aborted){const d=new Jt("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const p=new Jt("cancelled","Request was cancelled");o.error(p),n(p),await t.cancel();return}a+=i.decode(d,{stream:!0});const m=a.split(`
`);a=m.pop()||"";for(const p of m)p.trim()&&s(p.trim(),o);return c()}catch(d){const h=d instanceof Jt?d:rh(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const kw="@firebase/functions",Rw="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO="auth-internal",VO="app-check-internal",MO="messaging-internal";function OO(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(DO),o=n.getProvider(MO),a=n.getProvider(VO);return new bO(s,i,o,a,r)};Cs(new Sr(fv,e,"PUBLIC").setMultipleInstances(!0)),Tn(kw,Rw,t),Tn(kw,Rw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LO(t=ny(),e=tg){const r=gc(Ne(t),fv).getImmediate({identifier:e}),s=CI("functions");return s&&FO(r,...s),r}function FO(t,e,n){SO(Ne(t),e,n)}function rN(t,e,n){return NO(Ne(t),e)}OO();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN="firebasestorage.googleapis.com",iN="storageBucket",UO=2*60*1e3,zO=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt extends Un{constructor(e,n,r=0){super(om(e),`Firebase Storage: ${n} (${om(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,nt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return om(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var tt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(tt||(tt={}));function om(t){return"storage/"+t}function mv(){const t="An unknown error occurred, please check the error payload for server response.";return new nt(tt.UNKNOWN,t)}function $O(t){return new nt(tt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function BO(t){return new nt(tt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function qO(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new nt(tt.UNAUTHENTICATED,t)}function HO(){return new nt(tt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function GO(t){return new nt(tt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function WO(){return new nt(tt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function KO(){return new nt(tt.CANCELED,"User canceled the upload/download.")}function QO(t){return new nt(tt.INVALID_URL,"Invalid URL '"+t+"'.")}function XO(t){return new nt(tt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function YO(){return new nt(tt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+iN+"' property when initializing the app?")}function JO(){return new nt(tt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ZO(){return new nt(tt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function eL(t){return new nt(tt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ng(t){return new nt(tt.INVALID_ARGUMENT,t)}function oN(){return new nt(tt.APP_DELETED,"The Firebase app was deleted.")}function tL(t){return new nt(tt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Cl(t,e){return new nt(tt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Wa(t){throw new nt(tt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=un.makeFromUrl(e,n)}catch{return new un(e,"")}if(r.path==="")return r;throw XO(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(N){N.path_=decodeURIComponent(N.path)}const h="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",_=new RegExp(`^https?://${m}/${h}/b/${s}/o${p}`,"i"),A={bucket:1,path:3},C=n===sN?"(?:storage.googleapis.com|storage.cloud.google.com)":n,R="([^?#]*)",E=new RegExp(`^https?://${C}/${s}/${R}`,"i"),w=[{regex:a,indices:c,postModify:i},{regex:_,indices:A,postModify:d},{regex:E,indices:{bucket:1,path:2},postModify:d}];for(let N=0;N<w.length;N++){const D=w[N],O=D.regex.exec(e);if(O){const x=O[D.indices.bucket];let y=O[D.indices.path];y||(y=""),r=new un(x,y),D.postModify(r);break}}if(r==null)throw QO(e);return r}}class nL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rL(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let d=!1;function h(...R){d||(d=!0,e.apply(null,R))}function m(R){s=setTimeout(()=>{s=null,t(_,c())},R)}function p(){i&&clearTimeout(i)}function _(R,...E){if(d){p();return}if(R){p(),h.call(null,R,...E);return}if(c()||o){p(),h.call(null,R,...E);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,m(w)}let A=!1;function C(R){A||(A=!0,p(),!d&&(s!==null?(R||(a=2),clearTimeout(s),m(0)):R||(a=1)))}return m(0),i=setTimeout(()=>{o=!0,C(!0)},n),C}function sL(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(t){return t!==void 0}function oL(t){return typeof t=="object"&&!Array.isArray(t)}function pv(t){return typeof t=="string"||t instanceof String}function Pw(t){return gv()&&t instanceof Blob}function gv(){return typeof Blob<"u"}function jw(t,e,n,r){if(r<e)throw ng(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ng(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yh(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function aN(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var gi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(gi||(gi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aL(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(e,n,r,s,i,o,a,c,d,h,m,p=!0,_=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=m,this.retry=p,this.isUsingEmulator=_,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,C)=>{this.resolve_=A,this.reject_=C,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new _u(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===gi.NO_ERROR,c=i.getStatus();if(!a||aL(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===gi.ABORT;r(!1,new _u(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new _u(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());iL(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=mv();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?oN():KO();o(c)}else{const c=WO();o(c)}};this.canceled_?n(!1,new _u(!1,null,!0)):this.backoffId_=rL(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&sL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class _u{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function cL(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function uL(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function dL(t,e){e&&(t["X-Firebase-GMPID"]=e)}function hL(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function fL(t,e,n,r,s,i,o=!0,a=!1){const c=aN(t.urlParams),d=t.url+c,h=Object.assign({},t.headers);return dL(h,e),cL(h,n),uL(h,i),hL(h,r),new lL(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mL(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function pL(...t){const e=mL();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(gv())return new Blob(t);throw new nt(tt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function gL(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yL(t){if(typeof atob>"u")throw eL("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class am{constructor(e,n){this.data=e,this.contentType=n||null}}function vL(t,e){switch(t){case er.RAW:return new am(lN(e));case er.BASE64:case er.BASE64URL:return new am(cN(t,e));case er.DATA_URL:return new am(xL(e),wL(e))}throw mv()}function lN(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function _L(t){let e;try{e=decodeURIComponent(t)}catch{throw Cl(er.DATA_URL,"Malformed data URL.")}return lN(e)}function cN(t,e){switch(t){case er.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Cl(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case er.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Cl(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=yL(e)}catch(s){throw s.message.includes("polyfill")?s:Cl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class uN{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Cl(er.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=EL(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function xL(t){const e=new uN(t);return e.base64?cN(er.BASE64,e.rest):_L(e.rest)}function wL(t){return new uN(t).contentType}function EL(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,n){let r=0,s="";Pw(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(Pw(this.data_)){const r=this.data_,s=gL(r,e,n);return s===null?null:new ls(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ls(r,!0)}}static getBlob(...e){if(gv()){const n=e.map(r=>r instanceof ls?r.data_:r);return new ls(pL.apply(null,n))}else{const n=e.map(o=>pv(o)?vL(er.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new ls(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dN(t){let e;try{e=JSON.parse(t)}catch{return null}return oL(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function TL(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function hN(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bL(t,e){return e}class Ut{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||bL}}let xu=null;function SL(t){return!pv(t)||t.length<2?t:hN(t)}function fN(){if(xu)return xu;const t=[];t.push(new Ut("bucket")),t.push(new Ut("generation")),t.push(new Ut("metageneration")),t.push(new Ut("name","fullPath",!0));function e(i,o){return SL(o)}const n=new Ut("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Ut("size");return s.xform=r,t.push(s),t.push(new Ut("timeCreated")),t.push(new Ut("updated")),t.push(new Ut("md5Hash",null,!0)),t.push(new Ut("cacheControl",null,!0)),t.push(new Ut("contentDisposition",null,!0)),t.push(new Ut("contentEncoding",null,!0)),t.push(new Ut("contentLanguage",null,!0)),t.push(new Ut("contentType",null,!0)),t.push(new Ut("metadata","customMetadata",!0)),xu=t,xu}function NL(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new un(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function AL(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return NL(r,t),r}function mN(t,e,n){const r=dN(e);return r===null?null:AL(t,r,n)}function CL(t,e,n,r){const s=dN(e);if(s===null||!pv(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,m=t.fullPath,p="/b/"+o(h)+"/o/"+o(m),_=Yh(p,n,r),A=aN({alt:"media",token:d});return _+A})[0]}function kL(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class yv{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pN(t){if(!t)throw mv()}function RL(t,e){function n(r,s){const i=mN(t,s,e);return pN(i!==null),i}return n}function PL(t,e){function n(r,s){const i=mN(t,s,e);return pN(i!==null),CL(i,s,t.host,t._protocol)}return n}function gN(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=HO():s=qO():n.getStatus()===402?s=BO(t.bucket):n.getStatus()===403?s=GO(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function yN(t){const e=gN(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=$O(t.path)),i.serverResponse=s.serverResponse,i}return n}function jL(t,e,n){const r=e.fullServerUrl(),s=Yh(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new yv(s,i,PL(t,n),o);return a.errorHandler=yN(e),a}function DL(t,e){const n=e.fullServerUrl(),r=Yh(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,d){}const a=new yv(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=yN(e),a}function VL(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function ML(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=VL(null,e)),r}function OL(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let N=0;N<2;N++)w=w+Math.random().toString().slice(2);return w}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const d=ML(e,r,s),h=kL(d,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+c+"--",_=ls.getBlob(m,r,p);if(_===null)throw JO();const A={name:d.fullPath},C=Yh(i,t.host,t._protocol),R="POST",E=t.maxUploadRetryTime,v=new yv(C,R,RL(t,n),E);return v.urlParams=A,v.headers=o,v.body=_.uploadData(),v.errorHandler=gN(e),v}class LL{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=gi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=gi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=gi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Wa("cannot .send() more than once");if(cr(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Wa("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Wa("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Wa("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Wa("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class FL extends LL{initXhr(){this.xhr_.responseType="text"}}function vv(){return new FL}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e,n){this._service=e,n instanceof un?this._location=n:this._location=un.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ji(e,n)}get root(){const e=new un(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return hN(this._location.path)}get storage(){return this._service}get parent(){const e=IL(this._location.path);if(e===null)return null;const n=new un(this._location.bucket,e);return new ji(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw tL(e)}}function UL(t,e,n){t._throwIfRoot("uploadBytes");const r=OL(t.storage,t._location,fN(),new ls(e,!0),n);return t.storage.makeRequestWithTokens(r,vv).then(s=>({metadata:s,ref:t}))}function zL(t){t._throwIfRoot("getDownloadURL");const e=jL(t.storage,t._location,fN());return t.storage.makeRequestWithTokens(e,vv).then(n=>{if(n===null)throw ZO();return n})}function $L(t){t._throwIfRoot("deleteObject");const e=DL(t.storage,t._location);return t.storage.makeRequestWithTokens(e,vv)}function BL(t,e){const n=TL(t._location.path,e),r=new un(t._location.bucket,n);return new ji(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qL(t){return/^[A-Za-z]+:\/\//.test(t)}function HL(t,e){return new ji(t,e)}function vN(t,e){if(t instanceof _v){const n=t;if(n._bucket==null)throw YO();const r=new ji(n,n._bucket);return e!=null?vN(r,e):r}else return e!==void 0?BL(t,e):t}function GL(t,e){if(e&&qL(e)){if(t instanceof _v)return HL(t,e);throw ng("To use ref(service, url), the first argument must be a Storage instance.")}else return vN(t,e)}function Dw(t,e){const n=e==null?void 0:e[iN];return n==null?null:un.makeFromBucketSpec(n,t)}function WL(t,e,n,r={}){t.host=`${e}:${n}`;const s=cr(e);s&&(Ih(`https://${t.host}/b`),Zg("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:ZC(i,t.app.options.projectId))}class _v{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=sN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=UO,this._maxUploadRetryTime=zO,this._requests=new Set,s!=null?this._bucket=un.makeFromBucketSpec(s,this._host):this._bucket=Dw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=un.makeFromBucketSpec(this._url,e):this._bucket=Dw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){jw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){jw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Kt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ji(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new nL(oN());{const o=fL(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Vw="@firebase/storage",Mw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _N="storage";function xN(t,e,n){return t=Ne(t),UL(t,e,n)}function wN(t){return t=Ne(t),zL(t)}function Ow(t){return t=Ne(t),$L(t)}function ed(t,e){return t=Ne(t),GL(t,e)}function KL(t=ny(),e){t=Ne(t);const r=gc(t,_N).getImmediate({identifier:e}),s=CI("storage");return s&&QL(r,...s),r}function QL(t,e,n,r={}){WL(t,e,n,r)}function XL(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new _v(n,r,s,e,Oi)}function YL(){Cs(new Sr(_N,XL,"PUBLIC").setMultipleInstances(!0)),Tn(Vw,Mw,""),Tn(Vw,Mw,"esm2020")}YL();const EN={apiKey:"AIzaSyBqe7srBIViRiHmZlIQzMywDhiop5q7OXI",authDomain:"colegio-verdy.firebaseapp.com",projectId:"colegio-verdy",storageBucket:"colegio-verdy.firebasestorage.app",messagingSenderId:"602481785882",appId:"1:602481785882:web:0f873bf9968992e5af65a3"},Lw=Object.entries(EN).filter(([,t])=>!t).map(([t])=>t),al=Lw.length?`Configurao Firebase incompleta. Defina: ${Lw.join(", ")}.`:null;function JL(t){if(!t)return null;try{return nw(t,{localCache:eV({tabManager:sV()})})}catch{return nw(t,{localCache:ZD()})}}const Pr=al?null:LI(EN),wt=Pr?yO(Pr):null,H=JL(Pr),IN=Pr?LO(Pr):null,io=Pr?KL(Pr):null,ZL=["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],e3=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],t3={Administrativos:"bg-primary",Acadmicos:"bg-blue-500",Feriado:"bg-red-400",Recesso:"bg-amber-500"},n3=t=>t3[t]||"bg-slate-500",r3=t=>(t||"").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim(),xv=({embedded:t=!1})=>{const[e,n]=j.useState(new Date),[r,s]=j.useState(null),[i,o]=j.useState([]),[a,c]=j.useState(!0),[d,h]=j.useState(!1);j.useEffect(()=>{if(!H)return c(!1),()=>{};const N=ut(Oe(H,"events"),D=>{const O=D.docs.map(x=>{const y=x.data();return{id:x.id,title:y.titulo||"Sem ttulo",date:y.data||"",time:y.diaTodo?"Dia todo":y.horario||"",location:y.local||"Local no informado",type:y.tipo||"Administrativos",color:n3(y.tipo),description:r3(y.descricao||""),diaTodo:!!y.diaTodo}}).sort((x,y)=>{const b=`${x.date||""} ${x.time||""}`,k=`${y.date||""} ${y.time||""}`;return b.localeCompare(k)});o(O),c(!1)},()=>{o([]),c(!1)});return()=>N()},[]);const m=j.useMemo(()=>i.reduce((N,D)=>(D.date&&(N[D.date]||(N[D.date]=[]),N[D.date].push(D)),N),{}),[i]),p=r?m[r]||[]:[],_=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),A=new Date(e.getFullYear(),e.getMonth(),1).getDay(),C=()=>n(new Date(e.getFullYear(),e.getMonth()-1,1)),R=()=>n(new Date(e.getFullYear(),e.getMonth()+1,1)),E=N=>{s(N),h(!0)},v=()=>{const N=[],D=new Date,O=`${D.getFullYear()}-${String(D.getMonth()+1).padStart(2,"0")}-${String(D.getDate()).padStart(2,"0")}`;for(let x=0;x<A;x++)N.push(u.jsx("div",{className:"h-10 lg:h-24 bg-slate-50/50 rounded-xl border border-transparent"},`empty-${x}`));for(let x=1;x<=_;x++){const y=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(x).padStart(2,"0")}`,b=m[y]||[],k=y===O,T=r===y;N.push(u.jsxs("div",{onClick:()=>E(y),className:`relative h-12 lg:h-24 p-1 lg:p-2 rounded-xl border transition-all cursor-pointer flex flex-col items-center lg:items-start ${T?"border-primary ring-2 ring-primary/20 bg-primary/5":"border-slate-100 hover:border-primary/40 bg-white shadow-sm"}`,children:[u.jsx("span",{className:`text-[13px] lg:text-sm font-semibold w-7 h-7 flex items-center justify-center rounded-full ${k?"bg-primary text-white":"text-slate-700"}`,children:x}),u.jsx("div",{className:"flex lg:hidden gap-1 mt-1",children:b.slice(0,3).map(P=>u.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${P.color}`},P.id))}),u.jsxs("div",{className:"hidden lg:flex flex-col gap-1 mt-1 w-full overflow-hidden",children:[b.slice(0,2).map(P=>u.jsxs("div",{className:`text-[10px] text-white font-medium px-1.5 py-0.5 rounded truncate ${P.color}`,children:[P.diaTodo?"Dia todo":P.time," - ",P.title]},P.id)),b.length>2&&u.jsxs("div",{className:"text-[10px] text-slate-500 font-medium px-1",children:["+ ",b.length-2," mais"]})]})]},x))}return N},w=r?r.split("-").reverse().join("/"):"";return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`${t?"w-full":"max-w-7xl mx-auto h-full"}`,children:u.jsxs("div",{className:"flex flex-col bg-white rounded-2xl border border-slate-200 shadow-sm p-4 lg:p-6 h-fit shrink-0",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("h2",{className:"text-xl lg:text-2xl font-bold text-slate-800 flex items-center gap-3",children:[u.jsx(gp,{className:"text-primary hidden sm:block",size:24}),ZL[e.getMonth()]," ",e.getFullYear()]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:C,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-600 transition-colors",children:u.jsx(xh,{size:20})}),u.jsx("button",{onClick:R,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-600 transition-colors",children:u.jsx(ua,{size:20})})]})]}),u.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2 lg:mb-4",children:e3.map(N=>u.jsx("div",{className:"text-center text-[11px] lg:text-xs font-bold text-slate-400 uppercase tracking-wider",children:N},N))}),u.jsx("div",{className:"grid grid-cols-7 gap-1 lg:gap-2",children:v()}),a&&u.jsx("div",{className:"text-sm text-slate-500 mt-3",children:"Carregando eventos..."})]})}),d&&u.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[u.jsx("button",{className:"absolute inset-0 bg-slate-900/45",onClick:()=>h(!1),"aria-label":"Fechar modal"}),u.jsxs("div",{className:"relative w-full sm:max-w-2xl max-h-[85vh] bg-white rounded-t-2xl sm:rounded-2xl border border-slate-200 shadow-xl p-4 sm:p-5 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("h3",{className:"text-lg font-bold text-slate-800",children:["Eventos de ",w]}),u.jsx("button",{onClick:()=>h(!1),className:"w-9 h-9 rounded-lg border border-slate-200 text-slate-500 hover:bg-slate-50 inline-flex items-center justify-center",children:u.jsx(Ln,{size:16})})]}),u.jsx("div",{className:"overflow-y-auto max-h-[68vh] flex flex-col gap-3 pr-1",children:p.length===0?u.jsx("div",{className:"text-sm text-slate-500 bg-slate-50 rounded-xl border border-slate-100 p-4",children:"Nenhum evento cadastrado para este dia."}):p.map(N=>u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-3 relative overflow-hidden",children:[u.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${N.color}`}),u.jsxs("div",{className:"pl-2",children:[u.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[u.jsx("h4",{className:"font-semibold text-slate-800",children:N.title}),u.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide text-white ${N.color}`,children:N.type})]}),N.description&&u.jsx("p",{className:"text-sm text-slate-500 mb-2",children:N.description}),u.jsxs("div",{className:"flex flex-col gap-1.5",children:[u.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-600",children:[u.jsx(Jg,{size:14,className:"text-slate-400"})," ",N.time||"Horrio no informado"]}),u.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-600",children:[u.jsx(MC,{size:14,className:"text-slate-400"})," ",N.location]})]})]})]},N.id))})]})]})]})},Fw=()=>u.jsx(xv,{}),Uw=({onOpenTurma:t,turmas:e=[],studentsStatus:n={},carregando:r=!1})=>u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("h2",{className:"text-2xl lg:text-3xl font-bold text-slate-800 mb-4",children:["Minhas Turmas ",e.length>0?`(${e.length})`:""]}),r?u.jsx("p",{className:"text-slate-500",children:"Carregando turmas..."}):e.length>0?u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(s=>{const i=Object.values(n).filter(c=>c.turmaId===s.id),o=i.length,a=i.filter(c=>c.status==="sent"||c.status==="absent").length;return u.jsxs("div",{onClick:()=>t(s),className:"p-4 rounded-lg border-2 border-slate-200 hover:border-primary/50 bg-white cursor-pointer transition-all hover:shadow-md",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"font-semibold text-slate-800",children:s.nome}),u.jsx(ua,{size:18,className:"text-slate-400"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-sm text-slate-600",children:s.periodo}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs",children:[u.jsx("span",{className:"text-slate-600",children:"Cadernetas preenchidas"}),u.jsxs("span",{className:"font-semibold text-primary",children:[a,"/",o]})]}),u.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:u.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${o>0?a/o*100:0}%`}})})]})]})]},s.id)})}):u.jsx("p",{className:"text-slate-500",children:"Nenhuma turma atribuda"})]}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-slate-800 mb-4",children:"Calendrio Escolar"}),u.jsx(xv,{embedded:!0})]})]}),s3=({turma:t,onBack:e,onOpenStudent:n,studentsStatus:r})=>{const[s,i]=j.useState(""),a=Object.values(r).filter(d=>d.turmaId===t.id).filter(d=>d.name.toLowerCase().includes(s.toLowerCase())),c=d=>{switch(d){case"sent":return{icon:kC,color:"text-primary",bg:"bg-primary/10",label:"Enviado"};case"draft":return{icon:Jg,color:"text-accent",bg:"bg-accent/10",label:"Pendente (Rascunho)"};case"absent":return{icon:bd,color:"text-red-500",bg:"bg-red-50",label:"Faltou"};default:return{icon:PC,color:"text-slate-300",bg:"bg-slate-50",label:"No iniciado"}}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto h-full",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-2 lg:mb-6 flex-wrap",children:[u.jsx("button",{onClick:e,className:"w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary hover:border-primary transition-all shadow-sm shrink-0",children:u.jsx(Yg,{size:20})}),u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800 truncate",children:"Dirio de Classe"}),u.jsxs("p",{className:"text-sm font-medium text-primary mt-1",children:[t.nome," (",t.periodo,")"]})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:u.jsx($C,{size:18,className:"text-slate-400"})}),u.jsx("input",{type:"text",placeholder:"Buscar aluno na turma...",className:"form-control !pl-10 !py-3 bg-white shadow-sm border-transparent",value:s,onChange:d=>i(d.target.value)})]}),u.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden flex-1 flex flex-col",children:[u.jsxs("div",{className:"bg-slate-50 px-6 py-3 border-b border-slate-200 flex justify-between items-center text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[u.jsxs("span",{children:[a.length," Alunos"]}),u.jsx("span",{children:"Status de Envio"})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto divide-y divide-slate-100",children:[a.map(d=>{const h=c(d.status),m=h.icon;return u.jsxs("div",{onClick:()=>n(d.id),className:"flex items-center justify-between p-4 px-6 hover:bg-slate-50 cursor-pointer transition-colors group",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-200 shrink-0 relative",children:u.jsx("img",{src:d.avatar,alt:d.name,className:`w-full h-full rounded-full object-cover ${d.status==="absent"?"grayscale opacity-60":""}`})}),u.jsxs("div",{children:[u.jsx("h4",{className:`font-semibold text-[15px] ${d.status==="absent"?"text-slate-500 line-through":"text-slate-800"}`,children:d.name}),u.jsx("span",{className:"text-xs text-slate-400",children:"Ver dirio"})]})]}),u.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg ${h.bg}`,children:[u.jsx(m,{size:16,className:h.color}),u.jsx("span",{className:`text-xs font-semibold ${h.color}`,children:h.label})]})]},d.id)}),a.length===0&&u.jsxs("div",{className:"p-10 flex flex-col items-center justify-center text-slate-400 text-center",children:[u.jsx(bd,{size:48,className:"mb-4 text-slate-300"}),"Nenhum aluno encontrado correspondente  busca."]})]})]})]})},wu=({options:t,active:e,onChange:n})=>u.jsx("div",{className:"flex bg-slate-100/50 p-0.5 rounded-xl w-full",children:t.map(r=>u.jsx("button",{className:`segment-btn ${e===r?"active":""}`,onClick:()=>n(r),children:r},r))}),zw={meals:{"Lanche Manh":null,Almoo:null,"Lanche Tarde":null,Jantar:null},rest:{"Sono Manh":null,"Sono Tarde":null},activities:{Manh:null,Tarde:null},evacuation:{Manh:null,Tarde:null},obs:""},i3=({student:t,turma:e,onBack:n,onUpdateStatus:r})=>{const[s,i]=j.useState(zw),[o,a]=j.useState(!1),[c,d]=j.useState(!1),[h,m]=j.useState(!0),p=()=>new Date().toISOString().split("T")[0];j.useEffect(()=>{(async()=>{try{if(!H||!t.id){m(!1);return}const E=p(),v=Nt(Oe(H,"cadernetaEntries"),ct("studentId","==",t.id),ct("date","==",E)),w=await Qp(v);if(!w.empty){const N=w.docs[0].data();i(N.data||zw),a(N.isAbsent||!1)}m(!1)}catch(E){console.error("Erro ao carregar caderneta:",E),m(!1)}})()},[t.id]);const _=(R,E,v)=>{if(o)return;const w={...s,[R]:{...s[R],[E]:v}};R==="obs"&&(w.obs=v),i(w),t.status!=="sent"&&r("draft")},A=()=>{o?(a(!1),r("pending")):(a(!0),r("absent"))},C=async()=>{try{if(d(!0),!H){_n.error("Erro de conexo. Tente novamente."),d(!1);return}const R=p(),E={studentId:t.id,studentName:t.name,turmaId:e.id,turmaName:e.nome,date:R,data:s,isAbsent:o,status:o?"absent":"sent",createdAt:Fe(),updatedAt:Fe()},v=Nt(Oe(H,"cadernetaEntries"),ct("studentId","==",t.id),ct("date","==",R)),w=await Qp(v);if(w.empty)await Cc(Oe(H,"cadernetaEntries"),E);else{const N=w.docs[0].id;await ns(Me(H,"cadernetaEntries",N),{...E,createdAt:w.docs[0].data().createdAt})}o?_n.success(`Falta de ${t.name} registrada!`):_n.success(`Caderneta de ${t.name} enviada!`),r(o?"absent":"sent"),d(!1),n()}catch(R){console.error("Erro ao salvar caderneta:",R),_n.error("Erro ao salvar. Tente novamente."),d(!1)}};return u.jsxs("div",{className:"flex flex-col gap-0 max-w-4xl mx-auto",children:[u.jsxs("div",{className:`flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-2 lg:mb-6 glass-panel !p-4 transition-colors ${o?"bg-red-50/80 border-red-200":""}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary transition-colors bg-white",children:u.jsx(Yg,{size:20})}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-12 h-12 rounded-full p-0.5 bg-slate-200",children:u.jsx("img",{src:t.avatar,alt:"Avatar",className:`w-full h-full rounded-full object-cover ${o?"grayscale":""}`})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-widest",children:e==null?void 0:e.nome}),u.jsx("div",{className:`font-bold text-lg ${o?"text-red-700 line-through":"text-slate-800"}`,children:t.name})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:A,className:`px-4 py-2.5 rounded-xl font-semibold text-sm transition-all flex items-center gap-1.5 ${o?"bg-red-500 text-white shadow-md":"bg-red-50 text-red-500 hover:bg-red-100"}`,children:[u.jsx(bd,{size:18})," ",o?"Marcado como Falta":"Indicar Falta"]}),u.jsxs("button",{className:`btn-primary px-5 py-2.5 ${c?"opacity-50 pointer-events-none":""}`,onClick:C,disabled:c,children:[u.jsx(II,{size:18})," ",o?"Confirmar Falta":"Enviar"]})]})]}),u.jsxs("div",{className:`grid grid-cols-1 lg:grid-cols-2 gap-6 transition-opacity duration-300 ${o?"opacity-30 pointer-events-none":"opacity-100"}`,children:[u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(_I,{className:"text-primary",size:20})," Refeies"]}),u.jsx("div",{className:"flex flex-col gap-3",children:Object.keys(s.meals).map(R=>u.jsxs("div",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:R}),u.jsx("div",{className:"w-full lg:w-[320px]",children:u.jsx(wu,{options:["Total","Suficiente","Insuficiente","Recusou"],active:s.meals[R],onChange:E=>_("meals",R,E)})})]},R))})]}),u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(wI,{className:"text-primary",size:20})," Descanso"]}),u.jsx("div",{className:"flex flex-col gap-3",children:Object.keys(s.rest).map(R=>u.jsxs("div",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:R}),u.jsx("div",{className:"w-full lg:w-[180px]",children:u.jsx(wu,{options:["Sim","No"],active:s.rest[R],onChange:E=>_("rest",R,E)})})]},R))})]}),u.jsxs("div",{className:"glass-panel lg:col-span-full flex flex-col lg:flex-row gap-8 lg:gap-12",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(yI,{className:"text-primary",size:20})," Atividades"]}),u.jsx("div",{className:"flex flex-col gap-3",children:["Manh","Tarde"].map(R=>u.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:R}),u.jsx(wu,{options:["Ativa","Parcial","Sem Participao"],active:s.activities[R],onChange:E=>_("activities",R,E)})]},R))})]}),u.jsx("div",{className:"hidden lg:block w-px bg-slate-200"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(vI,{className:"text-primary",size:20})," Evacuao"]}),u.jsx("div",{className:"flex flex-col gap-3",children:["Manh","Tarde"].map(R=>u.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:R}),u.jsx(wu,{options:["Normal","Alterado","No houve"],active:s.evacuation[R],onChange:E=>_("evacuation",R,E)})]},R))})]})]}),u.jsxs("div",{className:"glass-panel lg:col-span-full",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(yp,{className:"text-primary",size:20})," Observaes e Recados"]}),u.jsx("textarea",{className:"form-control min-h-[120px] resize-none",placeholder:`Escreva notas importantes sobre o dia de ${t==null?void 0:t.name.split(" ")[0]}...`,value:s.obs,onChange:R=>_("obs",null,R.target.value)})]})]})]})},$w=[{id:"1",type:"broadcast",name:"Comunicados Gerais",role:"Escola",lastMessage:"Lembrando que amanh no haver aula na educao infantil.",time:"14:30",unread:0},{id:"2",type:"direct",name:"Me do Joo Pedro",role:"Famlia",lastMessage:"Ele est melhor da gripe, amanh ir.",time:"10:15",unread:2},{id:"3",type:"direct",name:"Pai do Lucas T.",role:"Famlia",lastMessage:"Hoje a av vai buscar o Lucas s 17h, ok?",time:"Ontem",unread:0},{id:"4",type:"direct",name:"Me da Maria Clara",role:"Famlia",lastMessage:"Obrigada pelo cuidado de sempre!",time:"Segunda",unread:0}],Bw=()=>{const[t,e]=j.useState($w[1]),[n,r]=j.useState("all"),[s,i]=j.useState("");return $w.filter(o=>n==="all"?!0:o.type===n),u.jsx("div",{className:"flex h-[calc(100vh-140px)] lg:h-[calc(100vh-160px)] gap-0 lg:gap-6 antialiased -mx-4 lg:mx-0",children:u.jsx("div",{className:"w-full flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:u.jsx(xI,{size:32,className:"text-slate-400"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Mensagens"}),u.jsx("p",{className:"text-slate-500",children:"Esta funcionalidade est em desenvolvimento."}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Em breve voc poder se comunicar diretamente com pais, professore e direo."})]})})})};function Di(t){const e=t.replace(/\D/g,"").slice(0,11),n=e.length;return n===0?"":n<=2?`(${e}`:n<=6?`(${e.slice(0,2)}) ${e.slice(2)}`:n<=10?`(${e.slice(0,2)}) ${e.slice(2,6)}-${e.slice(6)}`:`(${e.slice(0,2)}) ${e.slice(2,7)}-${e.slice(7)}`}const TN=j.createContext(),ya=()=>j.useContext(TN),qw=new Set(["teacher","parent","admin"]),Zi=t=>((t||"").split("@")[0]||"Usuario").replace(/[._-]+/g," ").trim()||"Usuario",o3=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t||""),Hw=t=>(t||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g,".").replace(/[^a-z0-9.]/g,""),a3=t=>`${t}@usuario.verdy.app`,lm=t=>/@usuario\.verdy\.app$/i.test(t||""),Eu=t=>`https://ui-avatars.com/api/?name=${encodeURIComponent(t||"Usuario")}&background=e2e8f0&color=0f172a`;async function l3(t,e=3,n=300){let r;for(let s=1;s<=e;s++)try{return await t()}catch(i){r=i,s<e&&await new Promise(o=>setTimeout(o,n*s))}throw r}const c3=({children:t})=>{const[e,n]=j.useState(null),[r,s]=j.useState(null),[i,o]=j.useState(null),[a,c]=j.useState(!0),d=j.useRef(null);j.useEffect(()=>wt?sM(wt,async C=>{if(C)try{const R=Me(H,"users",C.uid),E=await fr(R);if(E.exists()){const v=E.data(),w=v.role,N=typeof v.email=="string"&&v.email.trim()?v.email.trim():null,D=C.email||null,O=N||(lm(D||"")?null:D),x=v.nome||Zi(O||D||""),y={uid:C.uid,email:O,authEmail:D,username:v.username||"",role:qw.has(w)?w:"parent",nome:x,telefone:v.telefone||"",disciplina:v.disciplina||"",avatarUrl:v.avatarUrl||Eu(x)};if(v.avatarUrl||await ns(R,{avatarUrl:y.avatarUrl,updatedAt:Fe()},{merge:!0}),v.username)try{await C.getIdToken();const b=Me(H,"usernames",v.username);if(!(await fr(b)).exists()){const T=v.authEmail||C.email;T&&await ns(b,{email:T,uid:C.uid})}}catch{}o(y),s(qw.has(w)?w:"parent")}else{const v=C.email||null,w=lm(v||"")?null:v,N=d.current,D=(N==null?void 0:N.nome)||Zi(w||v||""),O={uid:C.uid,email:(N==null?void 0:N.emailInformado)??w,authEmail:v,username:(N==null?void 0:N.username)||"",role:"parent",nome:D,telefone:(N==null?void 0:N.telefone)||"",disciplina:"",avatarUrl:Eu(D)};o(O),s("parent")}}catch(R){console.log("Erro ao buscar role, backend no configurado ok. "+R),o({uid:C.uid,email:lm(C.email||"")?null:C.email||null,authEmail:C.email||null,username:"",role:"parent",nome:Zi(C.email||""),telefone:"",disciplina:"",avatarUrl:Eu(Zi(C.email||""))}),s("parent")}else o(null),s(null);n(C),c(!1)}):(c(!1),()=>{}),[]);const _={currentUser:e,userRole:r,userProfile:i,login:async(A,C)=>{if(!wt)return Promise.reject({code:"auth/configuration-not-found",message:al});const R=async N=>{const D=await fr(Me(H,"users",N.user.uid));if(!D.exists())return;const O=D.data();if(!O.username)return;const x=Me(H,"usernames",O.username);if(!(await fr(x)).exists()){const b=O.authEmail||N.user.email;b&&await ns(x,{email:b,uid:N.user.uid})}};if(A.includes("@")){const N=await _w(wt,A,C);try{await R(N)}catch{}return N}const E=Hw(A),v=await fr(Me(H,"usernames",E));if(!v.exists())throw{code:"auth/username-not-linked",message:"Usurio no encontrado. Tente fazer login com seu e-mail."};const w=v.data().email;return _w(wt,w,C)},register:async(A,C)=>{if(!wt)return Promise.reject({code:"auth/configuration-not-found",message:al});if(!H)return Promise.reject({code:"auth/configuration-not-found",message:al});const R=typeof A=="object"&&A!==null?A:{nome:Zi(A||""),telefone:"",username:(A||"").split("@")[0]||"",email:A||"",password:C||""},E=typeof R.nome=="string"?R.nome.trim():"",v=typeof R.telefone=="string"?R.telefone.trim():"",w=Hw(R.username),N=typeof R.email=="string"?R.email.trim().toLowerCase():"",D=typeof R.password=="string"?R.password:"";if(!E)throw{code:"auth/invalid-display-name",message:"Nome completo  obrigatrio."};if(!w||w.length<3)throw{code:"auth/invalid-username",message:"Usurio invlido. Use ao menos 3 caracteres."};if(!D||D.length<6)throw{code:"auth/weak-password",message:"A senha deve ter pelo menos 6 caracteres."};if(N&&!o3(N))throw{code:"auth/invalid-email",message:"E-mail invlido."};const O=(N||a3(w)).toLowerCase(),x=Me(H,"usernames",w);if((await fr(x)).exists())throw{code:"auth/username-already-in-use",message:"Este usurio j est em uso."};const b=E||Zi(N||O),k=Eu(b),T={uid:"",email:N||null,authEmail:O,username:w,role:"parent",nome:b,telefone:v,avatarUrl:k,createdAt:Fe(),updatedAt:Fe()};d.current={nome:b,telefone:v,username:w,emailInformado:N||null};let P;try{P=await Z4(wt,O,D),await P.user.getIdToken(),await new Promise(S=>setTimeout(S,200))}catch(S){throw d.current=null,S}try{await ns(Me(H,"users",P.user.uid),{...T,uid:P.user.uid})}catch(S){d.current=null;try{await oM(P.user)}catch{}throw S}try{await l3(async()=>{var te;const S=await fr(x);if(S.exists()){if(((te=S.data())==null?void 0:te.uid)!==P.user.uid)throw new Error("USERNAME_IN_USE");return}await ns(x,{email:O,uid:P.user.uid})})}catch(S){if(d.current=null,(S==null?void 0:S.message)==="USERNAME_IN_USE")throw{code:"auth/username-already-in-use",message:"Este usurio j est em uso."};console.error("[register] Falha ao salvar doc usernames aps retries:",S)}return d.current=null,o({uid:P.user.uid,email:N||null,authEmail:O,username:w,role:"parent",nome:b,telefone:v,disciplina:"",avatarUrl:k}),s("parent"),P},logout:()=>wt?iM(wt):Promise.resolve(),authError:al};return u.jsx(TN.Provider,{value:_,children:!a&&t})},u3=()=>{const[t,e]=j.useState(!0),[n,r]=j.useState(""),[s,i]=j.useState(""),[o,a]=j.useState(""),[c,d]=j.useState(""),[h,m]=j.useState(""),[p,_]=j.useState(""),[A,C]=j.useState(""),[R,E]=j.useState(""),[v,w]=j.useState(!1),{login:N,register:D,authError:O}=ya(),x=async y=>{y.preventDefault();try{if(E(""),w(!0),t)await N(n,s);else{if(s!==o){E("A confirmao da senha no confere.");return}await D({nome:c,telefone:h,username:p,email:A,password:s})}}catch(b){console.error(b),b.code==="auth/user-not-found"||b.code==="auth/invalid-credential"?E("Usurio ou senha invlidos. Verifique seus dados de acesso."):b.code==="auth/email-already-in-use"?E("Este e-mail j est cadastrado no sistema."):b.code==="auth/weak-password"?E("A senha deve ter pelo menos 6 caracteres."):b.code==="auth/invalid-email"?E("Informe um e-mail vlido ou deixe o campo em branco."):b.code==="auth/invalid-username"?E("Usurio invlido. Use ao menos 3 caracteres (letras, nmeros e ponto)."):b.code==="auth/username-already-in-use"?E("Este nome de usurio j est em uso."):b.code==="auth/invalid-display-name"?E("Informe o nome completo."):b.code==="auth/username-not-linked"?E(b.message):b.code==="auth/configuration-not-found"?E(b.message||"Firebase no configurado para autenticao."):E("Ocorreu um erro ao comunicar com o servidor!")}finally{w(!1)}};return u.jsx("div",{className:"min-h-screen bg-slate-50 flex flex-col justify-center items-center p-4",children:u.jsxs("div",{className:"w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("img",{src:"/pwa-192x192.png",alt:"Colgio Verdy",className:"w-20 h-20 mx-auto rounded-2xl shadow-lg mb-4 object-cover"}),u.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Colgio Verdy"}),u.jsx("p",{className:"text-slate-500 mt-2",children:t?"Acesse o portal da escola":"Crie seu acesso inicial"})]}),u.jsxs("div",{className:"bg-white rounded-3xl p-8 border border-slate-200 shadow-xl shadow-slate-200/50",children:[O&&u.jsxs("div",{className:"bg-amber-50 text-amber-700 p-4 rounded-xl mb-6 flex items-start gap-3 text-sm",children:[u.jsx(E_,{className:"shrink-0 mt-0.5",size:18}),u.jsx("span",{children:O})]}),R&&u.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-xl mb-6 flex items-start gap-3 text-sm",children:[u.jsx(E_,{className:"shrink-0 mt-0.5",size:18}),u.jsx("span",{children:R})]}),u.jsxs("form",{onSubmit:x,className:"flex flex-col gap-5",children:[t?u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Usurio ou E-mail"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:n,onChange:y=>r(y.target.value),placeholder:"Seu usurio de acesso",className:"w-full form-control !pl-10 !py-3",required:!0,autoComplete:"username"}),u.jsx(es,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Senha"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"password",value:s,onChange:y=>i(y.target.value),placeholder:"",className:"w-full form-control !pl-10 !py-3",required:!0,minLength:6,autoComplete:"current-password"}),u.jsx($f,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Nome Completo"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:c,onChange:y=>d(y.target.value),placeholder:"Seu nome completo",className:"w-full form-control !pl-10 !py-3",required:!0,autoComplete:"name"}),u.jsx(es,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Telefone"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"tel",value:h,onChange:y=>m(Di(y.target.value)),placeholder:"(XX) XXXXX-XXXX",className:"w-full form-control !pl-10 !py-3",required:!0,autoComplete:"tel"}),u.jsx(UC,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Usurio"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:p,onChange:y=>_(y.target.value),placeholder:"seu.usuario",className:"w-full form-control !pl-10 !py-3",required:!0,autoComplete:"username"}),u.jsx(es,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"E-mail (opcional)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"email",value:A,onChange:y=>C(y.target.value),placeholder:"seu@email.com",className:"w-full form-control !pl-10 !py-3",autoComplete:"email"}),u.jsx(VC,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Senha"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"password",value:s,onChange:y=>i(y.target.value),placeholder:"",className:"w-full form-control !pl-10 !py-3",required:!0,minLength:6,autoComplete:"new-password"}),u.jsx($f,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Confirmao de Senha"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"password",value:o,onChange:y=>a(y.target.value),placeholder:"",className:"w-full form-control !pl-10 !py-3",required:!0,minLength:6,autoComplete:"new-password"}),u.jsx($f,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]})]}),u.jsxs("button",{type:"submit",disabled:v,className:`btn-primary w-full justify-center !py-3.5 mt-2 text-base ${v?"opacity-70 cursor-not-allowed":""}`,children:[v?"Processando...":t?"Entrar no Sistema":"Criar Cadastro",t?u.jsx(DC,{size:20}):u.jsx(qC,{size:20})]})]}),u.jsx("div",{className:"mt-8 text-center text-sm text-slate-500 border-t border-slate-100 pt-6",children:u.jsxs("p",{children:[t?"Primeiro acesso? ":"J possui uma conta? ",u.jsx("button",{onClick:()=>{e(!t),E(""),i(""),a("")},className:"font-bold text-primary hover:text-primary-dark transition-colors",type:"button",children:t?"Cadastre-se aqui":"Faa Login"})]})})]})]})})},d3=({value:t})=>t?u.jsx("span",{className:"text-xs font-semibold px-2.5 py-1 rounded-full bg-primary/10 text-primary border border-primary/20",children:t}):u.jsx("span",{className:"text-xs text-slate-400 italic",children:""}),cm=({icon:t,title:e,children:n})=>u.jsxs("div",{className:"glass-panel flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(t,{className:"text-primary",size:20})," ",e]}),n]}),Iu=({label:t,value:e})=>u.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[u.jsx("span",{className:"text-sm font-medium text-slate-600",children:t}),u.jsx(d3,{value:e})]}),Gw=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(Number);return new Date(e,n-1,r).toLocaleDateString("pt-BR",{weekday:"long",day:"2-digit",month:"2-digit",year:"numeric"})},Ww=t=>t===new Date().toISOString().split("T")[0],h3=({student:t,turmaNome:e,onBack:n})=>{var A,C;const[r,s]=j.useState([]),[i,o]=j.useState(0),[a,c]=j.useState(!0);j.useEffect(()=>{if(!H||!(t!=null&&t.id)){c(!1);return}(async()=>{try{const E=(await Qp(Nt(Oe(H,"cadernetaEntries"),ct("studentId","==",t.id),tv("date","desc")))).docs.map(w=>({id:w.id,...w.data()}));s(E);const v=E.findIndex(w=>Ww(w.date));o(v>=0?v:0)}catch{s([])}finally{c(!1)}})()},[t==null?void 0:t.id]);const d=r[i]??null,h=(d==null?void 0:d.data)??null,m=(d==null?void 0:d.isAbsent)??!1,p=i<r.length-1,_=i>0;return u.jsxs("div",{className:"flex flex-col gap-4 max-w-4xl mx-auto p-4 lg:p-8",children:[u.jsxs("div",{className:"glass-panel !p-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary transition-colors bg-white shrink-0",children:u.jsx(Yg,{size:20})}),u.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-200 overflow-hidden shrink-0 flex items-center justify-center",children:t.fotoUrl?u.jsx("img",{src:t.fotoUrl,alt:t.nome,className:"w-full h-full object-cover"}):u.jsx("span",{className:"text-lg font-bold text-slate-400",children:(C=(A=t.nome)==null?void 0:A.charAt(0))==null?void 0:C.toUpperCase()})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-widest",children:e}),u.jsx("div",{className:"font-bold text-lg text-slate-800",children:t.nome})]})]}),!a&&u.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-xl px-3 py-2",children:[u.jsx("button",{onClick:()=>o(R=>R+1),disabled:!p,className:"w-8 h-8 rounded-lg flex items-center justify-center text-slate-500 hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":"Data anterior",children:u.jsx(xh,{size:18})}),u.jsx("span",{className:"text-sm font-semibold text-slate-700 min-w-[160px] text-center",children:d?Ww(d.date)?"Hoje  "+Gw(d.date):Gw(d.date):"Nenhuma entrada"}),u.jsx("button",{onClick:()=>o(R=>R-1),disabled:!_,className:"w-8 h-8 rounded-lg flex items-center justify-center text-slate-500 hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":"Prxima data",children:u.jsx(ua,{size:18})})]})]}),a&&u.jsx("div",{className:"flex flex-col gap-4",children:[1,2,3].map(R=>u.jsx("div",{className:"glass-panel animate-pulse h-24"},R))}),!a&&r.length===0&&u.jsxs("div",{className:"glass-panel p-10 text-center",children:[u.jsx(yp,{size:36,className:"mx-auto text-slate-300 mb-3"}),u.jsx("p",{className:"font-semibold text-slate-600",children:"Nenhuma caderneta registrada"}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"As cadernetas aparecero aqui aps serem enviadas pela escola."})]}),!a&&d&&m&&u.jsxs("div",{className:"glass-panel bg-red-50/80 border-red-200 flex items-center gap-4 p-6",children:[u.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 border border-red-200 flex items-center justify-center",children:u.jsx(bd,{size:24,className:"text-red-500"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-bold text-red-700",children:"Falta registrada"}),u.jsxs("p",{className:"text-sm text-red-500 mt-0.5",children:[t.nome," no compareceu neste dia."]})]})]}),!a&&d&&!m&&h&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[u.jsx(cm,{icon:_I,title:"Refeies",children:Object.entries(h.meals??{}).map(([R,E])=>u.jsx(Iu,{label:R,value:E},R))}),u.jsx(cm,{icon:wI,title:"Descanso",children:Object.entries(h.rest??{}).map(([R,E])=>u.jsx(Iu,{label:R,value:E},R))}),u.jsxs("div",{className:"glass-panel lg:col-span-full flex flex-col lg:flex-row gap-8 lg:gap-12",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(yI,{className:"text-primary",size:20})," Atividades"]}),["Manh","Tarde"].map(R=>{var E;return u.jsx(Iu,{label:R,value:(E=h.activities)==null?void 0:E[R]},R)})]}),u.jsx("div",{className:"hidden lg:block w-px bg-slate-200"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(vI,{className:"text-primary",size:20})," Evacuao"]}),["Manh","Tarde"].map(R=>{var E;return u.jsx(Iu,{label:R,value:(E=h.evacuation)==null?void 0:E[R]},R)})]})]}),u.jsx(cm,{icon:yp,title:"Observaes e Recados",className:"flex-1",children:h.obs?u.jsx("p",{className:"text-sm text-slate-600 whitespace-pre-wrap leading-relaxed",children:h.obs}):u.jsx("p",{className:"text-sm text-slate-400 italic",children:"Nenhuma observao registrada."})})]})]})},Kw={sent:{label:"Enviada hoje",className:"bg-emerald-50 text-emerald-700 border-emerald-200"},absent:{label:"Falta registrada",className:"bg-red-50 text-red-600 border-red-200"},pending:{label:"Aguardando",className:"bg-slate-50 text-slate-500 border-slate-200"}},f3=({student:t,turmaNome:e,cadernetaStatus:n,onClick:r})=>{var i,o;const s=Kw[n]??Kw.pending;return u.jsxs("button",{onClick:r,className:"w-full bg-white rounded-2xl border border-slate-200 shadow-sm p-4 flex items-center gap-4 hover:border-primary/40 hover:shadow-md transition-all text-left",children:[u.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 border border-slate-200 overflow-hidden shrink-0 flex items-center justify-center",children:t.fotoUrl?u.jsx("img",{src:t.fotoUrl,alt:t.nome,className:"w-full h-full object-cover"}):u.jsx("span",{className:"text-lg font-bold text-slate-400",children:(o=(i=t.nome)==null?void 0:i.charAt(0))==null?void 0:o.toUpperCase()})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-semibold text-slate-800 truncate",children:t.nome}),u.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:e||"Turma no informada"})]}),u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[u.jsx("span",{className:`text-xs font-semibold px-2.5 py-1 rounded-full border ${s.className}`,children:s.label}),u.jsx(ua,{size:16,className:"text-slate-400"})]})]})},m3=()=>{var A;const{currentUser:t,userProfile:e}=ya(),[n,r]=j.useState([]),[s,i]=j.useState({}),[o,a]=j.useState({}),[c,d]=j.useState(!0),[h,m]=j.useState(null),p=t==null?void 0:t.uid;j.useEffect(()=>{if(!H||!p){d(!1);return}const C=Nt(Oe(H,"students"),ct("responsaveisIds","array-contains",p));return ut(C,E=>{const v=E.docs.map(w=>({id:w.id,...w.data()})).filter(w=>w.status==="ativo");r(v),d(!1)},()=>d(!1))},[p]),j.useEffect(()=>{if(!H||n.length===0){i({});return}const C=[...new Set(n.map(v=>v.turmaId).filter(Boolean))];if(C.length===0)return;const R=Nt(Oe(H,"classrooms"),ct("__name__","in",C));return ut(R,v=>{const w={};v.docs.forEach(N=>{w[N.id]=N.data().nome||"Turma"}),i(w)},()=>{})},[n]),j.useEffect(()=>{if(!H||n.length===0){a({});return}const C=new Date,R=`${C.getFullYear()}-${String(C.getMonth()+1).padStart(2,"0")}-${String(C.getDate()).padStart(2,"0")}`,E=n.map(N=>N.id),v=[];for(let N=0;N<E.length;N+=30)v.push(E.slice(N,N+30));const w=v.map(N=>{const D=Nt(Oe(H,"cadernetaEntries"),ct("studentId","in",N),ct("date","==",R));return ut(D,O=>{a(x=>{const y={...x};return O.docs.forEach(b=>{const k=b.data();y[k.studentId]=k.status||"pending"}),y})},()=>{})});return()=>w.forEach(N=>N())},[n]);const _=((A=e==null?void 0:e.nome)==null?void 0:A.split(" ")[0])||"Responsvel";return h?u.jsx(h3,{student:h,turmaNome:s[h.turmaId],onBack:()=>m(null)}):u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto p-4 lg:p-8",children:[u.jsx("div",{children:u.jsxs("h1",{className:"text-2xl font-bold text-slate-800",children:["Ol, ",_,"!"]})}),u.jsxs("section",{children:[u.jsx("div",{className:"flex items-center gap-2 mb-3",children:u.jsx("h2",{className:"text-base font-semibold text-slate-700",children:"Calendrio Escolar"})}),u.jsx(xv,{embedded:!0})]}),u.jsxs("section",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[u.jsx(yl,{size:18,className:"text-primary"}),u.jsx("h2",{className:"text-base font-semibold text-slate-700",children:"Meus Filhos"})]}),c?u.jsx("div",{className:"flex flex-col gap-3",children:[1,2].map(C=>u.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-4 flex items-center gap-4 animate-pulse",children:[u.jsx("div",{className:"w-14 h-14 rounded-2xl bg-slate-100"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-4 bg-slate-100 rounded w-1/3"}),u.jsx("div",{className:"h-3 bg-slate-100 rounded w-1/4"})]})]},C))}):n.length===0?u.jsxs("div",{className:"bg-white rounded-2xl border border-dashed border-slate-200 p-8 text-center",children:[u.jsx(Jg,{size:36,className:"mx-auto text-slate-300 mb-3"}),u.jsx("p",{className:"font-semibold text-slate-600",children:"Nenhum aluno vinculado"}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Entre em contato com a escola para vincular seu filho  sua conta."})]}):u.jsx("div",{className:"flex flex-col gap-3",children:n.map(C=>u.jsx(f3,{student:C,turmaNome:s[C.turmaId],cadernetaStatus:o[C.id]||"pending",onClick:()=>m(C)},C.id))})]})]})};function p3(){const[t,e]=j.useState(null),[n,r]=j.useState(null),[s,i]=j.useState([]),[o,a]=j.useState(!0);j.useEffect(()=>{if(!H)return()=>{};const h=[];h.push(ut(Oe(H,"students"),_=>{e(_.size)},()=>{e(0)})),h.push(ut(Nt(Oe(H,"classrooms"),ct("status","==","ativa")),_=>{r(_.size)},()=>{r(0)}));const m=new Date,p=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}-${String(m.getDate()).padStart(2,"0")}`;return h.push(ut(Nt(Oe(H,"events"),ct("data",">=",p),tv("data","asc"),XD(5)),_=>{const A=_.docs.map(C=>{const R=C.data();return{id:C.id,titulo:R.titulo||"Sem ttulo",tipo:R.tipo||"Administrativos",data:R.data||"",local:R.local||"",diaTodo:!!R.diaTodo,horario:R.horario||"",anexoUrl:R.anexoUrl||"",anexoNome:R.anexoNome||""}});i(A),a(!1)},()=>{i([]),a(!1)})),()=>h.forEach(_=>_())},[]);const c=h=>{if(!h)return{dia:"--",mes:"---"};const[m,p,_]=h.split("-");if(!m||!p||!_)return{dia:"--",mes:"---"};const A=new Date(Number(m),Number(p)-1,Number(_));return{dia:String(A.getDate()).padStart(2,"0"),mes:A.toLocaleDateString("pt-BR",{month:"short"}).replace(".","").toUpperCase()}},d=j.useMemo(()=>[{id:"i1",label:"Total de Alunos",valor:t,icon:Wl,color:"text-primary bg-primary/10"},{id:"i2",label:"Turmas Ativas",valor:n,icon:EI,color:"text-primary bg-primary/10"},{id:"i3",label:"Calendrio",valor:s.length,icon:pp,color:"text-primary bg-primary/10"},{id:"i4",label:"Comunicados",valor:"-",icon:LC,color:"text-primary bg-primary/10"}],[t,n,s.length]);return u.jsxs("div",{className:"flex flex-col gap-6 max-w-6xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Dashboard da Administrao"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Viso consolidada da operao escolar."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:d.map(h=>u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60 flex items-center gap-3",children:[u.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center ${h.color}`,children:u.jsx(h.icon,{size:20})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wide",children:h.label}),u.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.valor??""})]})]},h.id))}),u.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(pp,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Prximos eventos"})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[o&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando eventos..."}),!o&&s.map(h=>{const m=c(h.data);return u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/80 p-3 flex items-center gap-3",children:[u.jsxs("div",{className:"w-14 h-14 rounded-lg bg-slate-100 border border-slate-200 flex flex-col items-center justify-center",children:[u.jsx("span",{className:"text-base font-bold text-slate-800 leading-none",children:m.dia}),u.jsx("span",{className:"text-[10px] font-semibold text-slate-500",children:m.mes})]}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"font-semibold text-slate-800 truncate",children:h.titulo}),u.jsx("div",{className:"text-sm text-slate-500",children:h.diaTodo?"Dia todo":h.horario}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:h.tipo}),h.local&&u.jsx("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:h.local}),h.anexoUrl&&u.jsx("a",{href:h.anexoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-primary hover:underline mt-0.5 inline-block truncate",children:h.anexoNome||"Ver anexo"})]})]},h.id)}),!o&&s.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhum evento cadastrado."})]})]}),u.jsx("div",{className:"glass-panel p-5 border border-slate-200/60",children:u.jsx("div",{className:"flex flex-col gap-3",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:u.jsx(xI,{size:32,className:"text-slate-400"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Mensagens"}),u.jsx("p",{className:"text-slate-500",children:"Esta funcionalidade est em desenvolvimento."}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Em breve voc poder se comunicar diretamente com pais, professore e direo."})]})})})]})]})}const g3=["Administrativos","Acadmicos","Feriado","Recesso"],um=5,dm={titulo:"",tipo:"Administrativos",data:"",local:"",descricao:"",diaTodo:!1,horario:"",anexoUrl:"",anexoNome:"",anexoMimeType:"",anexoPath:""};function y3(){const[t,e]=j.useState([]),[n,r]=j.useState(!0),[s,i]=j.useState(!1),[o,a]=j.useState(null),[c,d]=j.useState(dm),[h,m]=j.useState(!1),[p,_]=j.useState(null),[A,C]=j.useState(1),R=j.useRef(null);j.useEffect(()=>{if(!H)return()=>{};const T=ut(Oe(H,"events"),P=>{const S=P.docs.map(te=>{const ae=te.data();return{id:te.id,titulo:ae.titulo||"Sem ttulo",tipo:ae.tipo||"Administrativos",data:ae.data||"",local:ae.local||"",descricao:ae.descricao||"",diaTodo:!!ae.diaTodo,horario:ae.horario||"",anexoUrl:ae.anexoUrl||"",anexoNome:ae.anexoNome||"",anexoMimeType:ae.anexoMimeType||"",anexoPath:ae.anexoPath||""}}).sort((te,ae)=>{const K=`${te.data||""} ${te.horario||""}`;return`${ae.data||""} ${ae.horario||""}`.localeCompare(K)});e(S),r(!1)},()=>{e([]),r(!1)});return()=>T()},[]);const E=T=>{if(!T)return{dia:"--",mes:"---"};const[P,S,te]=T.split("-");if(!P||!S||!te)return{dia:"--",mes:"---"};const ae=new Date(Number(P),Number(S)-1,Number(te));return{dia:String(ae.getDate()).padStart(2,"0"),mes:ae.toLocaleDateString("pt-BR",{month:"short"}).replace(".","").toUpperCase()}},v=()=>{a(null),d(dm),_(null),i(!0)},w=T=>{a(T.id),d({titulo:T.titulo||"",tipo:T.tipo||"Administrativos",data:T.data||"",local:T.local||"",descricao:T.descricao||"",diaTodo:!!T.diaTodo,horario:T.horario||"",anexoUrl:T.anexoUrl||"",anexoNome:T.anexoNome||"",anexoMimeType:T.anexoMimeType||"",anexoPath:T.anexoPath||""}),_(null),i(!0)},N=()=>{a(null),d(dm),_(null),i(!1)};j.useEffect(()=>{!s||!R.current||(R.current.innerHTML=c.descricao||"")},[s,o]);const D=T=>{document.execCommand(T,!1),R.current&&d(P=>({...P,descricao:R.current.innerHTML}))},O=j.useMemo(()=>Math.max(1,Math.ceil(t.length/um)),[t.length]),x=Math.min(A,O),y=j.useMemo(()=>t.slice((x-1)*um,x*um),[t,x]),b=async T=>{T.preventDefault();const P=c.titulo.trim(),S=c.tipo,te=c.data,ae=c.local.trim(),K=(c.descricao||"").trim(),we=!!c.diaTodo,B=c.horario;if(!(!P||!S||!te||!we&&!B||!H))try{m(!0);let F=c.anexoUrl||"",G=c.anexoNome||"",Y=c.anexoMimeType||"",X=c.anexoPath||"";if(p&&io){const ue=p.name.replace(/\s+/g,"_"),Se=`events/${Date.now()}-${ue}`,_e=ed(io,Se);if(await xN(_e,p),F=await wN(_e),G=p.name,Y=p.type||"",c.anexoPath)try{await Ow(ed(io,c.anexoPath))}catch{}X=Se}const he={titulo:P,tipo:S,data:te,local:ae,descricao:K,diaTodo:we,horario:we?"":B,anexoUrl:F,anexoNome:G,anexoMimeType:Y,anexoPath:X,updatedAt:Fe()};o?await cn(Me(H,"events",o),he):await Cc(Oe(H,"events"),{...he,createdAt:Fe()}),C(1),N()}finally{m(!1)}},k=async T=>{if(!H)return;const P=t.find(S=>S.id===T);if(await aV(Me(H,"events",T)),P!=null&&P.anexoPath&&io)try{await Ow(ed(io,P.anexoPath))}catch{}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-6xl mx-auto",children:[u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Calendrio Escolar"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Gerencie os eventos e compromissos da escola."})]}),u.jsxs("button",{onClick:s?N:v,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center gap-1",children:[s?u.jsx(Ln,{size:14}):u.jsx(fc,{size:14}),s?"Cancelar":"Novo evento"]})]}),s&&u.jsxs("form",{onSubmit:b,className:"rounded-xl border border-slate-200 p-3 bg-white/80 grid grid-cols-1 md:grid-cols-6 gap-2 items-end",children:[u.jsxs("label",{className:"md:col-span-2 text-sm text-slate-600 flex flex-col gap-1",children:["Ttulo",u.jsx("input",{value:c.titulo,onChange:T=>d(P=>({...P,titulo:T.target.value})),className:"form-control !py-2.5",placeholder:"Ttulo do evento",required:!0})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Tipo",u.jsx("select",{value:c.tipo,onChange:T=>d(P=>({...P,tipo:T.target.value})),className:"form-control !py-2.5",required:!0,children:g3.map(T=>u.jsx("option",{value:T,children:T},T))})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Data",u.jsx("input",{type:"date",value:c.data,onChange:T=>d(P=>({...P,data:T.target.value})),className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Local",u.jsx("input",{value:c.local,onChange:T=>d(P=>({...P,local:T.target.value})),className:"form-control !py-2.5",placeholder:"Ex.: Auditrio"})]}),u.jsxs("div",{className:"text-sm text-slate-600 flex flex-col gap-1",children:[u.jsx("span",{children:"Perodo"}),u.jsx("div",{className:"h-[42px] flex items-center",children:u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:c.diaTodo,onChange:T=>d(P=>({...P,diaTodo:T.target.checked,horario:T.target.checked?"":P.horario}))}),"Dia todo"]})})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Horrio",u.jsx("input",{type:"time",value:c.horario,onChange:T=>d(P=>({...P,horario:T.target.value})),className:"form-control !py-2.5",required:!c.diaTodo,disabled:c.diaTodo})]}),u.jsxs("label",{className:"md:col-span-2 text-sm text-slate-600 flex flex-col gap-1",children:["Anexo (PDF ou imagem)",u.jsx("input",{type:"file",accept:"application/pdf,image/*",onChange:T=>{var P;return _(((P=T.target.files)==null?void 0:P[0])||null)},className:"form-control !py-2.5"}),!p&&c.anexoUrl&&u.jsxs("a",{href:c.anexoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-primary hover:underline truncate",children:["Anexo atual: ",c.anexoNome||"Visualizar arquivo"]})]}),u.jsxs("div",{className:"md:col-span-6 flex flex-col gap-2 text-sm text-slate-600",children:[u.jsx("span",{children:"Descrio"}),u.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 w-fit",children:[u.jsx("button",{type:"button",onMouseDown:T=>T.preventDefault(),onClick:()=>D("bold"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 font-semibold",children:"B"}),u.jsx("button",{type:"button",onMouseDown:T=>T.preventDefault(),onClick:()=>D("italic"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 italic",children:"I"}),u.jsx("button",{type:"button",onMouseDown:T=>T.preventDefault(),onClick:()=>D("underline"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 underline",children:"U"}),u.jsx("button",{type:"button",onMouseDown:T=>T.preventDefault(),onClick:()=>D("insertUnorderedList"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100",children:""})]}),u.jsx("div",{ref:R,contentEditable:!0,suppressContentEditableWarning:!0,onInput:T=>{const P=T.currentTarget.innerHTML;d(S=>({...S,descricao:P}))},className:"min-h-[120px] rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),u.jsx("div",{className:"md:col-span-6 flex justify-end",children:u.jsx("button",{type:"submit",disabled:h,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-60",children:o?"Salvar edio":"Salvar evento"})})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(pp,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Eventos"})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[n&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando eventos..."}),!n&&y.map(T=>{const P=E(T.data);return u.jsxs("div",{className:"mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 border-l-8 border-l-slate-500",children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap p-2",children:[u.jsxs("button",{onClick:()=>w(T),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(En,{}),"Editar"]}),u.jsxs("button",{onClick:()=>k(T.id),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-red-600 bg-red-50 border border-red-200 hover:bg-red-100 transition-colors flex flex-col items-center gap-1",children:[u.jsx(S_,{}),"Excluir"]})]}),u.jsx("div",{className:"md:grow min-w-0 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsxs("div",{className:"w-14 h-14 rounded-full bg-slate-200 border border-slate-500 flex flex-col items-center justify-center shrink-0",children:[u.jsx("span",{className:"text-base font-bold text-slate-500 leading-none",children:P.dia}),u.jsx("span",{className:"text-[10px] font-semibold text-slate-500",children:P.mes})]}),u.jsxs("div",{className:"min-w-0 md:grow",children:[u.jsxs("div",{className:"font-semibold text-slate-800 truncate",children:[T.titulo,u.jsxs("span",{className:`inline-flex items-center ${T.anexoUrl?"":"hidden"}`,children:["",u.jsx(FC,{size:14})]})]}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:T.tipo}),u.jsx("div",{className:"md:hidden text-xs text-slate-500",children:T.diaTodo?"Dia todo":T.horario}),u.jsx("div",{className:"md:hidden text-xs text-slate-500 mt-0.5 truncate",children:T.local})]}),u.jsxs("div",{className:"hidden md:block md:w-32",children:[u.jsx("div",{className:"text-sm text-slate-500",children:T.diaTodo?"Dia todo":T.horario}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:T.local})]})]})})]}),u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>w(T),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(En,{size:14})}),u.jsx("button",{onClick:()=>k(T.id),className:"h-8 px-2 rounded-e-lg text-xs font-medium text-red-600 border border-primary border-l-0 inline-flex justify-center items-center gap-1",children:u.jsx(S_,{size:14})})]})]},T.id)}),!n&&t.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhum evento cadastrado."}),!n&&t.length>0&&u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",x," de ",O]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:x===1,onClick:()=>C(T=>Math.max(1,T-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:x===O,onClick:()=>C(T=>Math.min(O,T+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})]})}const hm=5,fm={nome:"",turmaId:"",fotoUrl:""},Ka={responsavelId:"",parentesco:"",podeBuscar:!0,contatoEmergencia:!1};function v3(t){return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=e2e8f0&color=0f172a`}async function _3(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function x3(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function Qw(){const[t,e]=j.useState([]),[n,r]=j.useState([]),[s,i]=j.useState([]),[o,a]=j.useState(!1),[c,d]=j.useState(null),[h,m]=j.useState(fm),[p,_]=j.useState(""),[A,C]=j.useState("todos"),[R,E]=j.useState("todas"),[v,w]=j.useState(!1),[N,D]=j.useState(1),[O,x]=j.useState(!1),[y,b]=j.useState(!0),[k,T]=j.useState(!1),[P,S]=j.useState({tipo:"",mensagem:""}),[te,ae]=j.useState(!1),[K,we]=j.useState(null),[B,F]=j.useState(""),[G,Y]=j.useState(Ka);j.useEffect(()=>H?ut(Oe(H,"students"),Z=>{const ne=Z.docs.map(ge=>{const Ae=ge.data();return{id:ge.id,nome:Ae.nome||"Sem nome",turmaId:Ae.turmaId||"",status:Ae.status||"ativo",fotoUrl:Ae.fotoUrl||"",responsaveis:Array.isArray(Ae.responsaveis)?Ae.responsaveis:[]}}).sort((ge,Ae)=>ge.nome.localeCompare(Ae.nome,"pt-BR"));e(ne),b(!1);const fe=Z.docs.filter(ge=>{const Ae=ge.data();return Array.isArray(Ae.responsaveis)&&Ae.responsaveis.length>0&&!Array.isArray(Ae.responsaveisIds)});if(fe.length>0){const ge=lV(H);fe.forEach(Ae=>{const Nn=Ae.data().responsaveis.map(Gt=>Gt.responsavelId).filter(Boolean);ge.update(Me(H,"students",Ae.id),{responsaveisIds:Nn})}),ge.commit().catch(()=>{})}},Z=>{b(!1),S({tipo:"erro",mensagem:(Z==null?void 0:Z.message)||"No foi possvel carregar os alunos do banco."})}):(b(!1),S({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{}),[]),j.useEffect(()=>{if(!H)return()=>{};const U=Nt(Oe(H,"users"),ct("role","==","parent"));return ut(U,ne=>{const fe=ne.docs.map(ge=>{const Ae=ge.data();return{id:ge.id,nome:Ae.nome||"Sem nome",email:Ae.email||"",telefone:Ae.telefone||"",avatarUrl:Ae.avatarUrl||"",status:Ae.status||"ativo"}}).sort((ge,Ae)=>ge.nome.localeCompare(Ae.nome,"pt-BR"));i(fe)})},[]),j.useEffect(()=>H?ut(Oe(H,"classrooms"),Z=>{const ne=Z.docs.map(fe=>{const ge=fe.data();return{id:fe.id,nome:ge.nome||"Sem nome",periodo:ge.periodo||"",status:ge.status||"ativa"}}).sort((fe,ge)=>fe.nome.localeCompare(ge.nome,"pt-BR"));r(ne)}):()=>{},[]);const X=j.useMemo(()=>t.filter(U=>{const Z=U.nome.toLowerCase().includes(p.toLowerCase()),ne=A==="todos"?!0:U.status===A,fe=R==="todas"?!0:U.turmaId===R;return Z&&ne&&fe}),[t,p,A,R]),he=Math.max(1,Math.ceil(X.length/hm)),ue=Math.min(N,he),Se=X.slice((ue-1)*hm,ue*hm),_e=U=>{var Z;return((Z=n.find(ne=>ne.id===U))==null?void 0:Z.nome)||"Sem turma"},ke=()=>{d(null),m(fm),a(!0)},Ve=U=>{d(U.id),m({nome:U.nome,turmaId:U.turmaId||"",fotoUrl:U.fotoUrl||""}),a(!0)},Ct=()=>{a(!1),d(null),m(fm)},zn=async U=>{var ne;const Z=(ne=U.target.files)==null?void 0:ne[0];if(Z)try{const fe=await _3(Z),ge=await x3(fe);m(Ae=>({...Ae,fotoUrl:ge}))}catch(fe){S({tipo:"erro",mensagem:(fe==null?void 0:fe.message)||"No foi possvel carregar a foto."})}finally{U.target.value=""}},Ui=async U=>{U.preventDefault(),S({tipo:"",mensagem:""}),x(!0);const Z=h.nome.trim(),ne=h.turmaId;if(!Z||!ne){x(!1);return}const fe=h.fotoUrl.trim()||v3(Z);try{if(!H)throw new Error("Banco de dados no configurado.");c?(await cn(Me(H,"students",c),{nome:Z,turmaId:ne,fotoUrl:fe,updatedAt:Fe()}),S({tipo:"sucesso",mensagem:"Dados do aluno atualizados com sucesso."})):(await Cc(Oe(H,"students"),{nome:Z,turmaId:ne,fotoUrl:fe,status:"ativo",createdAt:Fe(),updatedAt:Fe()}),S({tipo:"sucesso",mensagem:"Aluno cadastrado com sucesso."})),D(1),Ct()}catch(ge){S({tipo:"erro",mensagem:(ge==null?void 0:ge.message)||"No foi possvel salvar o aluno."})}finally{x(!1)}},Lr=U=>{(async()=>{if(!H)throw new Error("Banco de dados no configurado.");const ne=t.find(fe=>fe.id===U);ne&&await cn(Me(H,"students",U),{status:ne.status==="ativo"?"inativo":"ativo",updatedAt:Fe()})})().catch(ne=>{S({tipo:"erro",mensagem:(ne==null?void 0:ne.message)||"No foi possvel atualizar o status do aluno."})})},$n=U=>{we(U),ae(!0),F(""),Y(Ka)},zi=()=>{ae(!1),we(null),F(""),Y(Ka)},vt=K?t.find(U=>U.id===K.id)||K:null,Bn=(vt==null?void 0:vt.responsaveis)||[],Bs=j.useMemo(()=>{const U=B.trim().toLowerCase();return s.filter(Z=>Z.status==="ativo").filter(Z=>!U||Z.nome.toLowerCase().includes(U))},[s,B]),$i=async U=>{if(U.preventDefault(),!H||!vt)return;const Z=s.find(fe=>fe.id===G.responsavelId),ne=G.parentesco.trim();if(!(!Z||!ne))try{T(!0),S({tipo:"",mensagem:""});const fe=Array.isArray(vt.responsaveis)?vt.responsaveis:[],ge={responsavelId:Z.id,nome:Z.nome,email:Z.email||"",telefone:Z.telefone||"",avatarUrl:Z.avatarUrl||"",parentesco:ne,podeBuscar:!!G.podeBuscar,contatoEmergencia:!!G.contatoEmergencia},Ae=fe.findIndex(Gt=>Gt.responsavelId===Z.id);let Nn=[];Ae>=0?Nn=fe.map((Gt,Jh)=>Jh===Ae?ge:Gt):Nn=[...fe,ge],ge.contatoEmergencia&&(Nn=Nn.map(Gt=>({...Gt,contatoEmergencia:Gt.responsavelId===ge.responsavelId}))),await cn(Me(H,"students",vt.id),{responsaveis:Nn,responsaveisIds:Nn.map(Gt=>Gt.responsavelId),updatedAt:Fe()}),Y(Ka),S({tipo:"sucesso",mensagem:"Vnculo de responsvel salvo com sucesso."})}catch(fe){S({tipo:"erro",mensagem:(fe==null?void 0:fe.message)||"No foi possvel salvar o vnculo do responsvel."})}finally{T(!1)}},$=U=>{Y({responsavelId:U.responsavelId||"",parentesco:U.parentesco||"",podeBuscar:!!U.podeBuscar,contatoEmergencia:!!U.contatoEmergencia})},le=async U=>{if(!(!H||!vt))try{T(!0),S({tipo:"",mensagem:""});const ne=(Array.isArray(vt.responsaveis)?vt.responsaveis:[]).filter(fe=>fe.responsavelId!==U);await cn(Me(H,"students",vt.id),{responsaveis:ne,responsaveisIds:ne.map(fe=>fe.responsavelId),updatedAt:Fe()}),G.responsavelId===U&&Y(Ka),S({tipo:"sucesso",mensagem:"Vnculo removido com sucesso."})}catch(Z){S({tipo:"erro",mensagem:(Z==null?void 0:Z.message)||"No foi possvel remover o vnculo do responsvel."})}finally{T(!1)}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Alunos"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro, edio e status dos alunos."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Alunos"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>w(U=>!U),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${v?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(wh,{size:16})}),u.jsx("button",{onClick:o?Ct:ke,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar aluno",children:o?u.jsx(Ln,{size:16}):u.jsx(fc,{size:16})}),u.jsx("button",{onClick:o?Ct:ke,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:o?"Cancelar":"Adicionar aluno"})]})]}),o&&u.jsxs("form",{onSubmit:Ui,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload da foto",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32 rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:h.fotoUrl?u.jsx("img",{src:h.fotoUrl,alt:"Avatar do aluno",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem foto"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:zn,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:h.nome,onChange:U=>m(Z=>({...Z,nome:U.target.value})),placeholder:"Nome do aluno",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Turma",u.jsxs("select",{value:h.turmaId,onChange:U=>m(Z=>({...Z,turmaId:U.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione a turma"}),n.map(U=>u.jsx("option",{value:U.id,children:U.nome},U.id))]})]})]})})]}),u.jsx("button",{type:"submit",disabled:O,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:c?"Salvar edio":"Salvar aluno"})]}),P.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${P.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:P.mensagem}),u.jsxs("div",{className:`${v?"flex":"hidden"} flex-col gap-3 mb-4 md:flex md:flex-row`,children:[u.jsx("input",{value:p,onChange:U=>{_(U.target.value),D(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:A,onChange:U=>{C(U.target.value),D(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]}),u.jsxs("select",{value:R,onChange:U=>{E(U.target.value),D(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todas",children:"Todas as turmas"}),n.map(U=>u.jsx("option",{value:U.id,children:U.nome},U.id))]})]}),y&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando alunos..."}),!y&&Se.map(U=>u.jsx("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${U.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:(()=>{const Z=(U.responsaveis||[]).filter(ne=>ne.contatoEmergencia);return u.jsxs("div",{children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>Ve(U),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(En,{}),"Editar"]}),u.jsxs("button",{onClick:()=>$n(U),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-primary bg-primary/15 border border-primary/30 hover:bg-primary/35 transition-colors flex flex-col items-center gap-1",children:[u.jsx(Wl,{}),"Resp."]}),u.jsxs("button",{onClick:()=>Lr(U.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${U.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[U.status==="ativo"?u.jsx(As,{}):u.jsx(Ns,{}),U.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:U.fotoUrl?u.jsx("img",{src:U.fotoUrl,alt:U.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:U.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:_e(U.turmaId)})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:Z.map(ne=>u.jsxs("div",{children:[u.jsx("div",{className:"font-bold",children:ne.nome||"Responsvel"}),u.jsxs("div",{children:[ne.parentesco||"Parentesco no informado"," - ",ne.telefone||"Sem telefone"]})]}))})})]}),u.jsxs("div",{className:"grid grid-cols-3 md:hidden p-1",children:[u.jsx("button",{onClick:()=>Ve(U),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(En,{})}),u.jsx("button",{onClick:()=>$n(U),className:"h-8 px-2 text-xs font-medium text-primary border border-primary inline-flex justify-center items-center gap-1",children:u.jsx(Wl,{})}),u.jsx("button",{onClick:()=>Lr(U.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${U.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:U.status==="ativo"?u.jsx(As,{}):u.jsx(Ns,{})})]})]},U.id)})()},U.id)),te&&vt&&u.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-2xl rounded-xl border border-slate-200 bg-white shadow-xl p-4 md:p-5",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h4",{className:"text-base font-bold text-slate-800",children:["Responsveis de ",vt.nome]}),u.jsx("button",{onClick:zi,className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),u.jsxs("form",{onSubmit:$i,className:"rounded-lg border border-slate-200 p-3 mb-3 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Responsvel",u.jsxs("select",{value:G.responsavelId,onChange:U=>Y(Z=>({...Z,responsavelId:U.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione"}),Bs.map(U=>u.jsx("option",{value:U.id,children:U.nome},U.id))]})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Parentesco",u.jsx("input",{value:G.parentesco,onChange:U=>Y(Z=>({...Z,parentesco:U.target.value})),placeholder:"Ex.: Me, Pai, Av, Tio",className:"form-control !py-2.5",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:G.podeBuscar,onChange:U=>Y(Z=>({...Z,podeBuscar:U.target.checked}))}),"Pode buscar o aluno"]}),u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:G.contatoEmergencia,onChange:U=>Y(Z=>({...Z,contatoEmergencia:U.target.checked}))}),"Contato de emergncia"]})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",disabled:k,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-60",children:k?"Salvando...":"Salvar vnculo"})})]}),u.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:["Vnculos atuais (",Bn.length,")"]}),u.jsxs("div",{className:"flex flex-col gap-2 max-h-60 overflow-y-auto",children:[Bn.map(U=>u.jsxs("div",{className:`rounded-lg border px-3 py-2 ${U.contatoEmergencia?"bg-amber-50 border-amber-500":""}`,children:[u.jsxs("div",{className:"flex items-center justify-start gap-2",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 py-2",children:[u.jsxs("button",{onClick:()=>$(U),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(En,{}),"Editar"]}),u.jsxs("button",{onClick:()=>le(U.responsavelId),className:"w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 bg-red-50 text-red-600 hover:bg-red-100 border border-red-700",children:[u.jsx(BC,{}),"Excluir"]})]}),u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:u.jsx("img",{src:U.avatarUrl,alt:U.nome,className:"w-full h-full object-cover"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:U.nome||"Responsvel"}),u.jsxs("div",{className:"text-sm text-slate-500 truncate",children:[U.parentesco||"Sem parentesco","  ",U.podeBuscar?"Pode buscar":"No pode buscar",U.contatoEmergencia?"  Emergncia":""]})]})]})]}),u.jsx("div",{className:"w-full md:hidden",children:u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>$(U),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(En,{})}),u.jsx("button",{onClick:()=>le(U.responsavelId),className:"h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1",children:u.jsx(Ln,{})})]})})]},U.responsavelId)),Bn.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum responsvel vinculado."})]})]})]})}),!y&&Se.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum aluno encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",ue," de ",he]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{disabled:ue===1,onClick:()=>D(U=>Math.max(1,U-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Anterior"}),u.jsx("button",{disabled:ue===he,onClick:()=>D(U=>Math.min(he,U+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Prxima"})]})]})]})]})}const mm=5,pm={nome:"",disciplina:"",email:"",telefone:"",avatarUrl:""};async function w3(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function E3(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function I3(){const[t,e]=j.useState([]),[n,r]=j.useState(!1),[s,i]=j.useState(null),[o,a]=j.useState(pm),[c,d]=j.useState(""),[h,m]=j.useState("todos"),[p,_]=j.useState("todas"),[A,C]=j.useState(!1),[R,E]=j.useState(1),[v,w]=j.useState(!1),[N,D]=j.useState(!0),[O,x]=j.useState({tipo:"",mensagem:""});j.useEffect(()=>{if(!H)return D(!1),x({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{};const F=Nt(Oe(H,"users"),ct("role","==","teacher"));return ut(F,Y=>{const X=Y.docs.map(he=>{const ue=he.data();return{id:he.id,nome:ue.nome||"Sem nome",disciplina:ue.disciplina||"",email:ue.email||"",telefone:ue.telefone||"",avatarUrl:ue.avatarUrl||"",status:ue.status||"ativo"}}).sort((he,ue)=>he.nome.localeCompare(ue.nome,"pt-BR"));e(X.map(he=>({...he,nomeRaw:he.nome==="Sem nome"?"":he.nome}))),D(!1)},Y=>{D(!1),x({tipo:"erro",mensagem:(Y==null?void 0:Y.message)||"No foi possvel carregar os professores do banco."})})},[]);const y=j.useMemo(()=>[...new Set(t.map(F=>F.disciplina).filter(Boolean))].sort(),[t]),b=j.useMemo(()=>t.filter(F=>{const G=F.nome.toLowerCase().includes(c.toLowerCase()),Y=h==="todos"?!0:F.status===h,X=p==="todas"?!0:F.disciplina===p;return G&&Y&&X}),[t,c,h,p]),k=Math.max(1,Math.ceil(b.length/mm)),T=Math.min(R,k),P=b.slice((T-1)*mm,T*mm),S=()=>{i(null),a(pm),r(!0)},te=F=>{i(F.id),a({nome:F.nomeRaw??F.nome,disciplina:F.disciplina,email:F.email||"",telefone:Di(F.telefone||""),avatarUrl:F.avatarUrl||""}),r(!0)},ae=()=>{i(null),a(pm),r(!1)},K=F=>{F.preventDefault(),(async()=>{var _e;x({tipo:"",mensagem:""}),w(!0);const Y=o.nome.trim(),X=o.disciplina.trim(),he=o.email.trim().toLowerCase(),ue=o.telefone.trim(),Se=o.avatarUrl.trim();if(!Y||!he){w(!1);return}try{if(s){if(!H)throw new Error("Banco de dados no configurado.");await cn(Me(H,"users",s),{nome:Y,disciplina:X||null,telefone:ue||null,avatarUrl:Se||null,updatedAt:Fe()}),x({tipo:"sucesso",mensagem:"Dados do professor atualizados com sucesso."})}else{if(!Pr||!wt)throw new Error("Firebase no configurado para cadastro de professor.");const Ve=await rN(IN,"createTeacherAccount")({nome:Y,email:he,disciplina:X,telefone:ue,avatarUrl:Se}),Ct=((_e=Ve==null?void 0:Ve.data)==null?void 0:_e.email)||he;await BS(wt,Ct),x({tipo:"sucesso",mensagem:"Professor cadastrado e link para criao de senha enviado por e-mail."})}E(1),ae()}catch(ke){const Ve=(ke==null?void 0:ke.message)||"No foi possvel salvar o professor.";x({tipo:"erro",mensagem:Ve})}finally{w(!1)}})()},we=F=>{(async()=>{if(!H)throw new Error("Banco de dados no configurado.");const Y=t.find(X=>X.id===F);Y&&await cn(Me(H,"users",F),{status:Y.status==="ativo"?"inativo":"ativo",updatedAt:Fe()})})().catch(Y=>{x({tipo:"erro",mensagem:(Y==null?void 0:Y.message)||"No foi possvel atualizar o status do professor."})})},B=async F=>{var Y;const G=(Y=F.target.files)==null?void 0:Y[0];if(G)try{const X=await w3(G),he=await E3(X);a(ue=>({...ue,avatarUrl:he}))}catch(X){x({tipo:"erro",mensagem:(X==null?void 0:X.message)||"No foi possvel carregar o avatar."})}finally{F.target.value=""}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Professores"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro, edio e status do quadro docente."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Professores"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>C(F=>!F),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${A?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(wh,{size:16})}),u.jsx("button",{onClick:n?ae:S,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar professor",children:n?u.jsx(Ln,{size:16}):u.jsx(fc,{size:16})}),u.jsx("button",{onClick:n?ae:S,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:n?"Cancelar":"Adicionar professor"})]})]}),n&&u.jsxs("form",{onSubmit:K,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload de avatar",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32  rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar do professor",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem avatar"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:B,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:o.nome,onChange:F=>a(G=>({...G,nome:F.target.value})),placeholder:"Nome completo",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2 text-sm text-slate-600",children:["E-mail",u.jsx("input",{type:"email",value:o.email,onChange:F=>a(G=>({...G,email:F.target.value})),placeholder:"E-mail",className:"form-control !py-2.5",required:!0,disabled:!!s})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Disciplina",u.jsx("input",{value:o.disciplina,onChange:F=>a(G=>({...G,disciplina:F.target.value})),placeholder:"Disciplina (opcional)",className:"form-control !py-2.5"})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Telefone",u.jsx("input",{value:o.telefone,onChange:F=>a(G=>({...G,telefone:Di(F.target.value)})),placeholder:"(XX) XXXXX-XXXX",className:"form-control !py-2.5"})]})]})})]}),u.jsx("button",{type:"submit",disabled:v,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:s?"Salvar edio":"Salvar professor"})]}),O.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${O.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:O.mensagem}),u.jsxs("div",{className:`${A?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:c,onChange:F=>{d(F.target.value),E(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:h,onChange:F=>{m(F.target.value),E(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]}),u.jsxs("select",{value:p,onChange:F=>{_(F.target.value),E(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todas",children:"Todas as disciplinas"}),y.map(F=>u.jsx("option",{value:F,children:F},F))]})]}),N&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando professores..."}),!N&&P.map(F=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${F.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>te(F),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(En,{}),"Editar"]}),u.jsxs("button",{onClick:()=>we(F.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${F.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[F.status==="ativo"?u.jsx(As,{}):u.jsx(Ns,{}),F.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:F.avatarUrl?u.jsx("img",{src:F.avatarUrl,alt:F.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{className:"",children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:F.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:F.disciplina||"Sem disciplina"}),u.jsx("div",{className:"md:hidden text-sm text-slate-500 truncate",children:F.email})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:F.email})})]}),u.jsx("div",{children:u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>te(F),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(En,{})}),u.jsx("button",{onClick:()=>we(F.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${F.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:F.status==="ativo"?u.jsx(As,{}):u.jsx(Ns,{})})]})})]},F.id)),!N&&P.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum professor encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",T," de ",k]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:T===1,onClick:()=>E(F=>Math.max(1,F-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:T===k,onClick:()=>E(F=>Math.min(k,F+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}const gm=5,ym={nome:"",email:"",telefone:"",avatarUrl:""};async function T3(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function b3(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function S3(){const[t,e]=j.useState([]),[n,r]=j.useState(!1),[s,i]=j.useState(null),[o,a]=j.useState(ym),[c,d]=j.useState(""),[h,m]=j.useState("todos"),[p,_]=j.useState(!1),[A,C]=j.useState(1),[R,E]=j.useState(!1),[v,w]=j.useState(!0),[N,D]=j.useState({tipo:"",mensagem:""});j.useEffect(()=>{if(!H)return w(!1),D({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{};const K=Nt(Oe(H,"users"),ct("role","==","parent"));return ut(K,B=>{const F=B.docs.map(G=>{const Y=G.data();return{id:G.id,nome:Y.nome||"Sem nome",email:Y.email||"",telefone:Y.telefone||"",avatarUrl:Y.avatarUrl||"",status:Y.status||"ativo"}}).sort((G,Y)=>G.nome.localeCompare(Y.nome,"pt-BR"));e(F.map(G=>({...G,nomeRaw:G.nome==="Sem nome"?"":G.nome}))),w(!1)},B=>{w(!1),D({tipo:"erro",mensagem:(B==null?void 0:B.message)||"No foi possvel carregar os responsveis do banco."})})},[]);const O=j.useMemo(()=>t.filter(K=>{const we=K.nome.toLowerCase().includes(c.toLowerCase()),B=h==="todos"?!0:K.status===h;return we&&B}),[t,c,h]),x=Math.max(1,Math.ceil(O.length/gm)),y=Math.min(A,x),b=O.slice((y-1)*gm,y*gm),k=()=>{i(null),a(ym),r(!0)},T=K=>{i(K.id),a({nome:K.nomeRaw??K.nome,email:K.email||"",telefone:Di(K.telefone||""),avatarUrl:K.avatarUrl||""}),r(!0)},P=()=>{i(null),a(ym),r(!1)},S=K=>{K.preventDefault(),(async()=>{var X;D({tipo:"",mensagem:""}),E(!0);const B=o.nome.trim(),F=o.email.trim().toLowerCase(),G=o.telefone.trim(),Y=o.avatarUrl.trim();if(!B||!F){E(!1);return}try{if(s){if(!H)throw new Error("Banco de dados no configurado.");await cn(Me(H,"users",s),{nome:B,telefone:G||null,avatarUrl:Y||null,updatedAt:Fe()}),D({tipo:"sucesso",mensagem:"Dados do responsvel atualizados com sucesso."})}else{if(!Pr||!wt)throw new Error("Firebase no configurado para cadastro de responsvel.");const ue=await rN(IN,"createParentAccount")({nome:B,email:F,telefone:G,avatarUrl:Y}),Se=((X=ue==null?void 0:ue.data)==null?void 0:X.email)||F;await BS(wt,Se),D({tipo:"sucesso",mensagem:"Responsvel cadastrado e link para criao de senha enviado por e-mail."})}C(1),P()}catch(he){const ue=(he==null?void 0:he.message)||"No foi possvel salvar o responsvel.";D({tipo:"erro",mensagem:ue})}finally{E(!1)}})()},te=K=>{(async()=>{if(!H)throw new Error("Banco de dados no configurado.");const B=t.find(F=>F.id===K);B&&await cn(Me(H,"users",K),{status:B.status==="ativo"?"inativo":"ativo",updatedAt:Fe()})})().catch(B=>{D({tipo:"erro",mensagem:(B==null?void 0:B.message)||"No foi possvel atualizar o status do responsvel."})})},ae=async K=>{var B;const we=(B=K.target.files)==null?void 0:B[0];if(we)try{const F=await T3(we),G=await b3(F);a(Y=>({...Y,avatarUrl:G}))}catch(F){D({tipo:"erro",mensagem:(F==null?void 0:F.message)||"No foi possvel carregar o avatar."})}finally{K.target.value=""}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Responsveis"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro e acompanhamento dos responsveis dos alunos."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Responsveis"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>_(K=>!K),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${p?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(wh,{size:16})}),u.jsx("button",{onClick:n?P:k,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar responsvel",children:n?u.jsx(Ln,{size:16}):u.jsx(fc,{size:16})}),u.jsx("button",{onClick:n?P:k,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:n?"Cancelar":"Adicionar responsvel"})]})]}),n&&u.jsxs("form",{onSubmit:S,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload de avatar",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32 rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar do responsvel",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem avatar"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:ae,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:o.nome,onChange:K=>a(we=>({...we,nome:K.target.value})),placeholder:"Nome completo",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2 text-sm text-slate-600",children:["E-mail",u.jsx("input",{type:"email",value:o.email,onChange:K=>a(we=>({...we,email:K.target.value})),placeholder:"E-mail",className:"form-control !py-2.5",required:!0,disabled:!!s})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Telefone",u.jsx("input",{value:o.telefone,onChange:K=>a(we=>({...we,telefone:Di(K.target.value)})),placeholder:"(XX) XXXXX-XXXX",className:"form-control !py-2.5"})]})]})})]}),u.jsx("button",{type:"submit",disabled:R,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:s?"Salvar edio":"Salvar responsvel"})]}),N.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${N.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:N.mensagem}),u.jsxs("div",{className:`${p?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:c,onChange:K=>{d(K.target.value),C(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:h,onChange:K=>{m(K.target.value),C(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]})]}),v&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando responsveis..."}),!v&&b.map(K=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${K.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>T(K),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(En,{}),"Editar"]}),u.jsxs("button",{onClick:()=>te(K.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${K.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[K.status==="ativo"?u.jsx(As,{}):u.jsx(Ns,{}),K.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:K.avatarUrl?u.jsx("img",{src:K.avatarUrl,alt:K.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:K.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:K.email}),u.jsx("div",{className:"md:hidden text-sm text-slate-500 truncate",children:K.telefone||"Sem telefone"})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:K.telefone||"Sem telefone"})})]}),u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>T(K),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(En,{})}),u.jsx("button",{onClick:()=>te(K.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${K.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:K.status==="ativo"?u.jsx(As,{}):u.jsx(Ns,{})})]})]},K.id)),!v&&b.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum responsvel encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",y," de ",x]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:y===1,onClick:()=>C(K=>Math.max(1,K-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:y===x,onClick:()=>C(K=>Math.min(x,K+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}const vm=5,_m={nome:"",periodo:"Integral",professorId:""};function N3(){const[t,e]=j.useState([]),[n,r]=j.useState([]),[s,i]=j.useState([]),[o,a]=j.useState(!1),[c,d]=j.useState(null),[h,m]=j.useState(_m),[p,_]=j.useState(""),[A,C]=j.useState("todos"),[R,E]=j.useState("todos"),[v,w]=j.useState(!1),[N,D]=j.useState(1),[O,x]=j.useState(!1),[y,b]=j.useState(!1),[k,T]=j.useState(!0),[P,S]=j.useState(!0),[te,ae]=j.useState({tipo:"",mensagem:""}),[K,we]=j.useState(null),[B,F]=j.useState(!1),[G,Y]=j.useState("");j.useEffect(()=>H?ut(Oe(H,"classrooms"),le=>{const U=le.docs.map(Z=>{const ne=Z.data();return{id:Z.id,nome:ne.nome||"Sem nome",periodo:ne.periodo||"",professorId:ne.professorId||"",professorNome:ne.professorNome||"",status:ne.status||"ativa"}}).sort((Z,ne)=>Z.nome.localeCompare(ne.nome,"pt-BR"));e(U),T(!1)},le=>{T(!1),ae({tipo:"erro",mensagem:(le==null?void 0:le.message)||"No foi possvel carregar as turmas do banco."})}):(T(!1),ae({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{}),[]),j.useEffect(()=>{if(!H)return()=>{};const $=Nt(Oe(H,"users"),ct("role","==","teacher"));return ut($,U=>{const Z=U.docs.map(ne=>{const fe=ne.data();return{id:ne.id,nome:fe.nome||"Sem nome",status:fe.status||"ativo"}}).sort((ne,fe)=>ne.nome.localeCompare(fe.nome,"pt-BR"));i(Z)})},[]),j.useEffect(()=>H?ut(Nt(Oe(H,"students")),le=>{const U=le.docs.map(Z=>{const ne=Z.data();return{id:Z.id,nome:ne.nome||"Sem nome",turmaId:ne.turmaId||"",status:ne.status||"ativo",fotoUrl:ne.fotoUrl||""}}).sort((Z,ne)=>Z.nome.localeCompare(ne.nome,"pt-BR"));r(U),S(!1)},()=>{S(!1)}):(S(!1),()=>{}),[]);const X=j.useMemo(()=>[...new Set(t.map($=>$.periodo).filter(Boolean))],[t]),he=j.useMemo(()=>{const $=["Matutino","Vespertino","Integral"];return[...new Set([...$,...X])]},[X]),ue=j.useMemo(()=>t.filter($=>{const le=$.nome.toLowerCase().includes(p.toLowerCase()),U=A==="todos"?!0:$.status===A,Z=R==="todos"?!0:$.periodo===R;return le&&U&&Z}),[t,p,A,R]),Se=Math.max(1,Math.ceil(ue.length/vm)),_e=Math.min(N,Se),ke=ue.slice((_e-1)*vm,_e*vm),Ve=t.find($=>$.id===K)||null,Ct=j.useMemo(()=>K?n.filter($=>$.turmaId===K):[],[n,K]),zn=j.useMemo(()=>{if(!K)return[];const $=G.trim().toLowerCase();return $?n.filter(le=>le.nome.toLowerCase().includes($)).slice(0,20):[]},[n,K,G]),Ui=()=>{d(null),m(_m),a(!0)},Lr=$=>{d($.id),m({nome:$.nome,periodo:$.periodo||"",professorId:$.professorId||""}),a(!0)},$n=()=>{d(null),m(_m),a(!1)},zi=$=>{$.preventDefault(),(async()=>{ae({tipo:"",mensagem:""}),x(!0);const U=h.nome.trim(),Z=h.periodo.trim(),ne=h.professorId,fe=s.find(ge=>ge.id===ne);if(!U||!Z||!ne||!fe){x(!1);return}try{if(!H)throw new Error("Banco de dados no configurado.");c?(await cn(Me(H,"classrooms",c),{nome:U,periodo:Z,professorId:ne,professorNome:fe.nome,updatedAt:Fe()}),ae({tipo:"sucesso",mensagem:"Dados da turma atualizados com sucesso."})):(await Cc(Oe(H,"classrooms"),{nome:U,periodo:Z,professorId:ne,professorNome:fe.nome,status:"ativa",createdAt:Fe(),updatedAt:Fe()}),ae({tipo:"sucesso",mensagem:"Turma cadastrada com sucesso."})),D(1),$n()}catch(ge){ae({tipo:"erro",mensagem:(ge==null?void 0:ge.message)||"No foi possvel salvar a turma."})}finally{x(!1)}})()},vt=$=>{(async()=>{if(!H)throw new Error("Banco de dados no configurado.");const U=t.find(Z=>Z.id===$);U&&await cn(Me(H,"classrooms",$),{status:U.status==="ativa"?"inativa":"ativa",updatedAt:Fe()})})().catch(U=>{ae({tipo:"erro",mensagem:(U==null?void 0:U.message)||"No foi possvel atualizar o status da turma."})})},Bn=$=>{we(le=>le===$?null:$),F(!1),Y("")},Bs=async $=>{try{if(!H||!K)throw new Error("Selecione uma turma para vincular alunos.");b(!0),ae({tipo:"",mensagem:""}),await cn(Me(H,"students",$.id),{turmaId:K,updatedAt:Fe()}),ae({tipo:"sucesso",mensagem:$.turmaId&&$.turmaId!==K?"Aluno transferido para a turma com sucesso.":"Aluno vinculado  turma com sucesso."})}catch(le){ae({tipo:"erro",mensagem:(le==null?void 0:le.message)||"No foi possvel vincular o aluno."})}finally{b(!1)}},$i=async $=>{try{if(!H)throw new Error("Dados no disponveis para remover aluno.");b(!0),ae({tipo:"",mensagem:""}),await cn(Me(H,"students",$),{turmaId:null,updatedAt:Fe()}),ae({tipo:"sucesso",mensagem:"Aluno removido da turma com sucesso."})}catch(le){ae({tipo:"erro",mensagem:(le==null?void 0:le.message)||"No foi possvel remover o aluno da turma."})}finally{b(!1)}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Turmas"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Organizao das turmas e perodos da escola."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Turmas"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>w($=>!$),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${v?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(wh,{size:16})}),u.jsx("button",{onClick:o?$n:Ui,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar turma",children:o?u.jsx(Ln,{size:16}):u.jsx(fc,{size:16})}),u.jsx("button",{onClick:o?$n:Ui,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:o?"Cancelar":"Adicionar turma"})]})]}),o&&u.jsxs("form",{onSubmit:zi,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome da turma",u.jsx("input",{value:h.nome,onChange:$=>m(le=>({...le,nome:$.target.value})),placeholder:"Nome da turma",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Perodo",u.jsx("select",{value:h.periodo,onChange:$=>m(le=>({...le,periodo:$.target.value})),className:"form-control !py-2.5",children:he.map($=>u.jsx("option",{value:$,children:$},$))})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Professor responsvel",u.jsxs("select",{value:h.professorId,onChange:$=>m(le=>({...le,professorId:$.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione"}),s.filter($=>$.status==="ativo"||$.id===h.professorId).map($=>u.jsx("option",{value:$.id,children:$.nome},$.id))]})]})]}),u.jsx("button",{type:"submit",disabled:O,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:c?"Salvar edio":"Salvar turma"})]}),te.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${te.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:te.mensagem}),u.jsxs("div",{className:`${v?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:p,onChange:$=>{_($.target.value),D(1)},placeholder:"Buscar por turma",className:"form-control !py-2.5"}),u.jsxs("select",{value:A,onChange:$=>{C($.target.value),D(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativa",children:"Ativa"}),u.jsx("option",{value:"inativa",children:"Inativa"})]}),u.jsxs("select",{value:R,onChange:$=>{E($.target.value),D(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os perodos"}),X.map($=>u.jsx("option",{value:$,children:$},$))]})]}),Ve&&u.jsxs("div",{className:"mt-5 rounded-xl border border-slate-200 bg-white/80 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h4",{className:"text-base font-bold text-slate-800",children:["Gerenciar alunos da turma: ",Ve.nome]}),u.jsx("button",{onClick:()=>we(null),className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),P?u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando alunos..."}):u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx("div",{className:"flex items-center justify-end",children:u.jsx("button",{onClick:()=>F(!0),className:"h-9 w-full md:w-auto px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors",children:"Buscar e vincular aluno"})}),u.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:["Alunos da turma: ",Ct.length]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:[Ct.map($=>{var le,U;return u.jsxs("div",{className:"flex items-center justify-between bg-slate-100 gap-3 rounded-lg border shadown-md border-slate-300 px-3 py-2",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-9 h-9 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:$.fotoUrl?u.jsx("img",{src:$.fotoUrl,alt:$.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-500 font-semibold",children:((U=(le=$.nome)==null?void 0:le.charAt(0))==null?void 0:U.toUpperCase())||"?"})}),u.jsx("span",{className:"text-sm text-slate-700 truncate",children:$.nome})]}),u.jsx("button",{disabled:y,onClick:()=>$i($.id),className:"h-7 px-2 rounded-md text-xs font-medium text-red-600 bg-red-50 hover:bg-red-100 disabled:opacity-50",children:"Remover"})]},$.id)}),Ct.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum aluno vinculado."})]})]}),u.jsx("div",{className:"text-xs text-slate-500",children:"Use Buscar e vincular aluno para localizar por nome e incluir na turma."})]})]}),B&&Ve&&u.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-2xl rounded-xl border border-slate-200 bg-white shadow-xl p-4 md:p-5",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-base font-bold text-slate-800",children:Ve.nome}),u.jsx("button",{onClick:()=>{F(!1),Y("")},className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),u.jsx("input",{value:G,onChange:$=>Y($.target.value),placeholder:"Digite o nome do aluno",className:"form-control !py-2.5 mb-3"}),!G.trim()&&u.jsx("div",{className:"text-sm text-slate-500 py-4",children:"Digite um nome para buscar alunos."}),G.trim()&&u.jsxs("div",{className:"flex flex-col gap-2 max-h-96 overflow-y-auto",children:[zn.map($=>{var Z,ne;const le=$.turmaId===K,U=$.turmaId&&!le;return u.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-lg border border-slate-200 px-3 py-2",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:$.fotoUrl?u.jsx("img",{src:$.fotoUrl,alt:$.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-500 font-semibold",children:((ne=(Z=$.nome)==null?void 0:Z.charAt(0))==null?void 0:ne.toUpperCase())||"?"})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-slate-700 truncate",children:$.nome}),le&&u.jsx("div",{className:"text-xs text-emerald-700",children:"J est nesta turma"}),U&&u.jsx("div",{className:"text-xs text-amber-700",children:"Est em outra turma"})]})]}),u.jsx("button",{disabled:y||le,onClick:()=>Bs($),className:"h-8 px-2 rounded-lg text-xs font-medium text-emerald-700 bg-emerald-50 hover:bg-emerald-100 disabled:opacity-50",children:le?"Vinculado":U?"Transferir":"Vincular"})]},$.id)}),zn.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum aluno encontrado."})]})]})}),k&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando turmas..."}),!k&&ke.map($=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${$.status==="ativa"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>Lr($),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(En,{}),"Editar"]}),u.jsxs("button",{onClick:()=>Bn($.id),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-primary bg-primary/15 border border-primary/30 hover:bg-primary/35 transition-colors flex flex-col items-center gap-1",children:[u.jsx(yl,{}),"Alunos"]}),u.jsxs("button",{onClick:()=>vt($.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${$.status==="ativa"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[$.status==="ativa"?u.jsx(As,{}):u.jsx(Ns,{}),$.status==="ativa"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2",children:[u.jsxs("div",{className:"font-medium text-slate-800 truncate",children:[$.nome," - ",$.periodo||"Sem perodo"]}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:$.professorNome||"No definido"})]})})]}),u.jsxs("div",{className:"grid grid-cols-3 md:hidden p-1",children:[u.jsx("button",{onClick:()=>Lr($),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(En,{})}),u.jsx("button",{onClick:()=>Bn($.id),className:"h-8 px-2 text-xs font-medium text-slate-700 border border-primary justify-center inline-flex items-center gap-1",children:u.jsx(Wl,{})}),u.jsx("button",{onClick:()=>vt($.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${$.status==="ativa"?"text-red-600":"text-emerald-700"}`,children:$.status==="ativa"?u.jsx(As,{}):u.jsx(Ns,{})})]})]},$.id)),!k&&ke.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhuma turma encontrada."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",_e," de ",Se]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:_e===1,onClick:()=>D($=>Math.max(1,$-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:_e===Se,onClick:()=>D($=>Math.min(Se,$+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}async function A3(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}function C3(){const{currentUser:t,userProfile:e}=ya(),[n,r]=j.useState(""),[s,i]=j.useState(""),[o,a]=j.useState(""),[c,d]=j.useState(""),[h,m]=j.useState(""),[p,_]=j.useState(""),[A,C]=j.useState(!1),[R,E]=j.useState(!1),[v,w]=j.useState(""),[N,D]=j.useState(""),[O,x]=j.useState(""),[y,b]=j.useState("");j.useEffect(()=>{r((e==null?void 0:e.nome)||""),i(Di((e==null?void 0:e.telefone)||"")),a((e==null?void 0:e.avatarUrl)||"")},[e]);const k=async S=>{var ae;const te=(ae=S.target.files)==null?void 0:ae[0];if(te)try{const K=await A3(te);a(K)}catch(K){D((K==null?void 0:K.message)||"No foi possvel carregar a imagem.")}finally{S.target.value=""}},T=async S=>{if(S.preventDefault(),!(!t||!H)){w(""),D(""),C(!0);try{await ns(Me(H,"users",t.uid),{uid:t.uid,role:(e==null?void 0:e.role)||"parent",email:(e==null?void 0:e.email)??null,authEmail:(e==null?void 0:e.authEmail)??null,username:(e==null?void 0:e.username)||"",nome:n.trim(),telefone:s.trim(),avatarUrl:o||null,updatedAt:Fe()},{merge:!0}),w("Perfil atualizado com sucesso.")}catch(te){D((te==null?void 0:te.message)||"No foi possvel atualizar o perfil.")}finally{C(!1)}}},P=async S=>{if(S.preventDefault(),!(!(t!=null&&t.email)||!(wt!=null&&wt.currentUser))){if(x(""),b(""),!c.trim()){b("Informe sua senha atual.");return}if(h.length<6){b("A nova senha deve ter pelo menos 6 caracteres.");return}if(h!==p){b("A confirmao da senha no confere.");return}E(!0);try{const te=Fi.credential(t.email,c);await J4(wt.currentUser,te),await eM(wt.currentUser,h),d(""),m(""),_(""),x("Senha atualizada com sucesso.")}catch(te){(te==null?void 0:te.code)==="auth/wrong-password"||(te==null?void 0:te.code)==="auth/invalid-credential"?b("Senha atual invlida."):b((te==null?void 0:te.message)||"No foi possvel alterar a senha.")}finally{E(!1)}}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Meu Perfil"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Atualize suas informaes e sua senha de acesso."})]}),u.jsxs("form",{onSubmit:T,className:"glass-panel p-5 border border-slate-200/60 flex flex-col gap-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Dados pessoais"}),N&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:N}),v&&u.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:v}),u.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[u.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:o?u.jsx("img",{src:o,alt:"Avatar do usurio",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-400 text-sm",children:"Sem avatar"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Avatar"}),u.jsx("input",{type:"file",accept:"image/*",onChange:k,className:"form-control !py-2 mt-1"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Nome",u.jsx("input",{value:n,onChange:S=>r(S.target.value),placeholder:"Nome",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["E-mail",u.jsx("input",{value:(e==null?void 0:e.email)||(t==null?void 0:t.email)||"",disabled:!0,className:"form-control !py-2.5 bg-slate-100 text-slate-500"})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600 md:col-span-2",children:["Telefone",u.jsx("input",{value:s,onChange:S=>i(Di(S.target.value)),placeholder:"(XX) XXXXX-XXXX",className:"form-control !py-2.5"})]})]}),u.jsx("button",{type:"submit",disabled:A,className:"h-10 px-4 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:"Salvar perfil"})]}),u.jsxs("form",{onSubmit:P,className:"glass-panel p-5 border border-slate-200/60 flex flex-col gap-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Alterar senha"}),y&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:y}),O&&u.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:O}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Senha atual",u.jsx("input",{type:"password",value:c,onChange:S=>d(S.target.value),placeholder:"Senha atual",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Nova senha",u.jsx("input",{type:"password",value:h,onChange:S=>m(S.target.value),placeholder:"Nova senha",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Confirmar nova senha",u.jsx("input",{type:"password",value:p,onChange:S=>_(S.target.value),placeholder:"Confirmar nova senha",className:"form-control !py-2.5",required:!0})]})]}),u.jsx("button",{type:"submit",disabled:R,className:"h-10 px-4 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:"Alterar senha"})]})]})}const Xw=[{key:"segunda",label:"Segunda-feira"},{key:"terca",label:"Tera-feira"},{key:"quarta",label:"Quarta-feira"},{key:"quinta",label:"Quinta-feira"},{key:"sexta",label:"Sexta-feira"}],k3=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],Yw=["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"];function bN(t){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function Jw(t){const e=new Date(t),n=e.getDay(),r=n===0?-6:1-n;return e.setDate(e.getDate()+r),bN(e)}function Zw(t,e){const n=new Date(t+"T00:00:00");return n.setDate(n.getDate()+e*7),bN(n)}function R3(t,e){const n=new Date(t+"T00:00:00");return n.setDate(n.getDate()+e),n}function P3(t){const e=new Date(t+"T00:00:00"),n=new Date(t+"T00:00:00");n.setDate(n.getDate()+4);const r=`${String(e.getDate()).padStart(2,"0")} ${Yw[e.getMonth()]}`,s=`${String(n.getDate()).padStart(2,"0")} ${Yw[n.getMonth()]} ${n.getFullYear()}`;return`${r}  ${s}`}const xm=()=>({segunda:"",terca:"",quarta:"",quinta:"",sexta:""});function j3(){const{currentUser:t}=ya(),[e,n]=j.useState(()=>Jw(new Date)),[r,s]=j.useState(xm()),[i,o]=j.useState(!0),[a,c]=j.useState(!1),[d,h]=j.useState(null);j.useEffect(()=>{if(!H)return;o(!0);const _=`semana_${e}`;fr(Me(H,"merendaSemanal",_)).then(A=>{if(A.exists()){const C=A.data();s({segunda:C.segunda||"",terca:C.terca||"",quarta:C.quarta||"",quinta:C.quinta||"",sexta:C.sexta||""}),h(_)}else s(xm()),h(null)}).catch(()=>{s(xm()),h(null)}).finally(()=>o(!1))},[e]);const m=async()=>{if(H){c(!0);try{const _=`semana_${e}`;await ns(Me(H,"merendaSemanal",_),{semanaInicio:e,segunda:r.segunda.trim(),terca:r.terca.trim(),quarta:r.quarta.trim(),quinta:r.quinta.trim(),sexta:r.sexta.trim(),updatedAt:Fe(),updatedBy:(t==null?void 0:t.uid)||""}),h(_),_n.success("Cardpio salvo com sucesso!")}catch(_){_n.error("Erro ao salvar cardpio. Tente novamente."),console.error(_)}finally{c(!1)}}},p=e===Jw(new Date);return u.jsxs("div",{className:"p-4 sm:p-6 max-w-3xl mx-auto",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[u.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center",children:u.jsx(So,{size:20,className:"text-primary"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"Cardpio Semanal"}),u.jsx("p",{className:"text-sm text-slate-500",children:"Cadastre o cardpio para cada dia da semana"})]})]}),u.jsxs("div",{className:"flex items-center justify-between bg-white border border-slate-200 rounded-xl px-4 py-3 mb-6 shadow-sm",children:[u.jsx("button",{onClick:()=>n(_=>Zw(_,-1)),className:"w-8 h-8 rounded-lg border border-slate-200 flex items-center justify-center text-slate-600 hover:bg-slate-50 transition-colors",children:u.jsx(xh,{size:16})}),u.jsxs("div",{className:"text-center",children:[u.jsx("span",{className:"text-sm font-semibold text-slate-800",children:P3(e)}),p&&u.jsx("span",{className:"ml-2 text-[11px] font-medium text-primary bg-primary/10 rounded-full px-2 py-0.5",children:"Semana atual"})]}),u.jsx("button",{onClick:()=>n(_=>Zw(_,1)),className:"w-8 h-8 rounded-lg border border-slate-200 flex items-center justify-center text-slate-600 hover:bg-slate-50 transition-colors",children:u.jsx(ua,{size:16})})]}),i?u.jsx("div",{className:"space-y-4",children:Xw.map(_=>u.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4 animate-pulse",children:[u.jsx("div",{className:"h-4 w-32 bg-slate-200 rounded mb-3"}),u.jsx("div",{className:"h-20 bg-slate-100 rounded-lg"})]},_.key))}):u.jsx("div",{className:"space-y-4",children:Xw.map((_,A)=>{const C=R3(e,A),R=`${k3[C.getDay()]}, ${String(C.getDate()).padStart(2,"0")}/${String(C.getMonth()+1).padStart(2,"0")}`;return u.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4 shadow-sm",children:[u.jsxs("label",{className:"flex items-center gap-2 mb-2",children:[u.jsx("span",{className:"text-sm font-semibold text-slate-700",children:_.label}),u.jsx("span",{className:"text-xs text-slate-400",children:R})]}),u.jsx("textarea",{value:r[_.key],onChange:E=>s(v=>({...v,[_.key]:E.target.value})),placeholder:"Descreva o cardpio do dia...",rows:3,className:"w-full text-sm text-slate-700 placeholder-slate-400 border border-slate-200 rounded-lg px-3 py-2 resize-none focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition"})]},_.key)})}),!i&&u.jsxs("div",{className:"mt-6",children:[u.jsxs("button",{onClick:m,disabled:a,className:"w-full sm:w-auto flex items-center justify-center gap-2 px-6 py-2.5 rounded-xl bg-primary text-white text-sm font-semibold hover:bg-primary/90 disabled:opacity-50 transition-all shadow-sm",children:[u.jsx(zC,{size:16}),a?"Salvando...":"Salvar cardpio"]}),d&&u.jsx("p",{className:"mt-2 text-xs text-slate-400",children:"Cardpio j registrado para esta semana  salvar ir sobrescrever."})]})]})}const eE=[{key:"segunda",label:"Segunda-feira"},{key:"terca",label:"Tera-feira"},{key:"quarta",label:"Quarta-feira"},{key:"quinta",label:"Quinta-feira"},{key:"sexta",label:"Sexta-feira"}],D3=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],tE=["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],V3=["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"];function SN(t){return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function nE(t){const e=new Date(t),n=e.getDay(),r=n===0?-6:1-n;return e.setDate(e.getDate()+r),SN(e)}function rE(t,e){const n=new Date(t+"T00:00:00");return n.setDate(n.getDate()+e*7),SN(n)}function M3(t,e){const n=new Date(t+"T00:00:00");return n.setDate(n.getDate()+e),n}function O3(t){const e=new Date(t+"T00:00:00"),n=new Date(t+"T00:00:00");n.setDate(n.getDate()+4);const r=`${String(e.getDate()).padStart(2,"0")} ${tE[e.getMonth()]}`,s=`${String(n.getDate()).padStart(2,"0")} ${tE[n.getMonth()]} ${n.getFullYear()}`;return`${r}  ${s}`}function L3(){const t=new Date().getDay();return["domingo","segunda","terca","quarta","quinta","sexta","sabado"][t]??null}function sE(){const[t,e]=j.useState(()=>nE(new Date)),[n,r]=j.useState(null),[s,i]=j.useState(!0),o=t===nE(new Date),a=o?L3():null;return j.useEffect(()=>{H&&(i(!0),fr(Me(H,"merendaSemanal",`semana_${t}`)).then(c=>r(c.exists()?c.data():null)).catch(()=>r(null)).finally(()=>i(!1)))},[t]),u.jsxs("div",{className:"p-4 sm:p-6 max-w-2xl mx-auto",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[u.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center",children:u.jsx(So,{size:20,className:"text-primary"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"Cardpio Semanal"}),u.jsx("p",{className:"text-sm text-slate-500",children:"Cardpio da escola"})]})]}),u.jsxs("div",{className:"flex items-center justify-between bg-white border border-slate-200 rounded-xl px-4 py-3 mb-6 shadow-sm",children:[u.jsx("button",{onClick:()=>e(c=>rE(c,-1)),className:"w-8 h-8 rounded-lg border border-slate-200 flex items-center justify-center text-slate-600 hover:bg-slate-50 transition-colors",children:u.jsx(xh,{size:16})}),u.jsxs("div",{className:"text-center",children:[u.jsx("span",{className:"text-sm font-semibold text-slate-800",children:O3(t)}),o&&u.jsx("span",{className:"ml-2 text-[11px] font-medium text-primary bg-primary/10 rounded-full px-2 py-0.5",children:"Esta semana"})]}),u.jsx("button",{onClick:()=>e(c=>rE(c,1)),className:"w-8 h-8 rounded-lg border border-slate-200 flex items-center justify-center text-slate-600 hover:bg-slate-50 transition-colors",children:u.jsx(ua,{size:16})})]}),s?u.jsx("div",{className:"space-y-3",children:eE.map(c=>u.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4 animate-pulse",children:[u.jsx("div",{className:"h-4 w-32 bg-slate-200 rounded mb-2"}),u.jsx("div",{className:"h-10 bg-slate-100 rounded-lg"})]},c.key))}):n?u.jsx("div",{className:"space-y-3",children:eE.map((c,d)=>{const h=M3(t,d),m=`${D3[h.getDay()]}, ${String(h.getDate()).padStart(2,"0")} de ${V3[h.getMonth()]}`,p=c.key===a,_=n[c.key]||"";return u.jsxs("div",{className:`bg-white border rounded-xl p-4 shadow-sm transition-all ${p?"border-primary ring-2 ring-primary/20":"border-slate-200"}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[u.jsxs("span",{className:`text-sm font-semibold ${p?"text-primary":"text-slate-700"}`,children:[c.label,p&&u.jsx("span",{className:"ml-2 text-[10px] font-medium bg-primary text-white rounded-full px-1.5 py-0.5 align-middle",children:"Hoje"})]}),u.jsx("span",{className:"text-xs text-slate-400",children:m})]}),_?u.jsx("p",{className:"text-sm text-slate-600 whitespace-pre-wrap",children:_}):u.jsx("p",{className:"text-sm text-slate-400 italic",children:"Sem cardpio informado"})]},c.key)})}):u.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[u.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 flex items-center justify-center mb-3",children:u.jsx(So,{size:24,className:"text-slate-400"})}),u.jsx("p",{className:"text-slate-600 font-medium",children:"Cardpio no cadastrado"}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"O cardpio desta semana ainda no foi publicado."})]})]})}const Qa=4,F3=5*1024*1024;function U3(t){return t?(t.toDate?t.toDate():new Date(t)).toLocaleDateString("pt-BR",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}):""}function wm(){const{currentUser:t,userProfile:e,userRole:n}=ya(),[r,s]=j.useState(""),[i,o]=j.useState([]),[a,c]=j.useState(!1),[d,h]=j.useState([]),[m,p]=j.useState(!0),[_,A]=j.useState(null),C=j.useRef(null);j.useEffect(()=>{if(!H||!(t!=null&&t.uid))return;const N=Nt(Oe(H,"feedback"),ct("uid","==",t.uid),tv("criadoEm","desc")),D=ut(N,O=>{h(O.docs.map(x=>({id:x.id,...x.data()}))),p(!1)},()=>p(!1));return()=>D()},[t==null?void 0:t.uid]);const R=N=>{const D=Array.from(N).filter(O=>O.type.startsWith("image/")?O.size>F3?(_n.error(`"${O.name}" excede 5 MB.`),!1):!0:(_n.error(`"${O.name}" no  uma imagem.`),!1));o(O=>{const x=Qa-O.length;return x<=0?(_n.error(`Limite de ${Qa} imagens atingido.`),O):[...O,...D.slice(0,x).map(y=>({file:y,preview:URL.createObjectURL(y)}))]})},E=N=>{o(D=>(URL.revokeObjectURL(D[N].preview),D.filter((O,x)=>x!==N)))},v=N=>{N.preventDefault(),R(N.dataTransfer.files)},w=async()=>{if(!r.trim()&&i.length===0){_n.error("Escreva uma mensagem ou adicione ao menos uma imagem.");return}if(H){c(!0);try{const N=[],D=[];for(const O of i){const x=O.file.name.replace(/\s+/g,"_"),y=`feedback/${t.uid}/${Date.now()}_${x}`,b=ed(io,y);await xN(b,O.file);const k=await wN(b);N.push(k),D.push(y)}await Cc(Oe(H,"feedback"),{uid:t.uid,nome:(e==null?void 0:e.nome)||t.displayName||"Usurio",role:n||"parent",mensagem:r.trim(),imagensUrls:N,imagensPaths:D,criadoEm:Fe(),lido:!1}),s(""),i.forEach(O=>URL.revokeObjectURL(O.preview)),o([]),_n.success("Mensagem enviada! Obrigado pela contribuio ")}catch(N){console.error(N),_n.error("Erro ao enviar. Tente novamente.")}finally{c(!1)}}};return u.jsxs("div",{className:"p-4 sm:p-6 max-w-2xl mx-auto",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[u.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center",children:u.jsx(Mu,{size:20,className:"text-amber-500"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-xl font-bold text-slate-800",children:"Fale com o Desenvolvedor"}),u.jsx("p",{className:"text-sm text-slate-500",children:"Sugestes, melhorias ou problemas  sua opinio  bem-vinda!"})]})]}),u.jsxs("div",{className:"bg-white border border-slate-200 rounded-2xl shadow-sm p-5 mb-6",children:[u.jsx("textarea",{value:r,onChange:N=>s(N.target.value),placeholder:"Descreva sua sugesto ou melhoria...",rows:5,className:"w-full text-sm text-slate-700 placeholder-slate-400 border border-slate-200 rounded-xl px-4 py-3 resize-none focus:outline-none focus:ring-2 focus:ring-primary/30 focus:border-primary transition"}),i.length<Qa&&u.jsxs("div",{onDragOver:N=>N.preventDefault(),onDrop:v,onClick:()=>{var N;return(N=C.current)==null?void 0:N.click()},className:"mt-3 flex items-center justify-center gap-2 border-2 border-dashed border-slate-200 rounded-xl py-4 text-slate-400 text-sm cursor-pointer hover:border-primary/40 hover:bg-primary/5 transition-colors select-none",children:[u.jsx(I_,{size:18}),u.jsxs("span",{children:["Adicionar imagens ",u.jsxs("span",{className:"text-slate-300",children:["(",i.length,"/",Qa,")"]})]}),u.jsx("input",{ref:C,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:N=>{R(N.target.files),N.target.value=""}})]}),i.length>0&&u.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[i.map((N,D)=>u.jsxs("div",{className:"relative w-20 h-20 rounded-lg overflow-hidden border border-slate-200 group",children:[u.jsx("img",{src:N.preview,alt:"",className:"w-full h-full object-cover cursor-pointer",onClick:()=>A(N.preview)}),u.jsx("button",{onClick:()=>E(D),className:"absolute top-0.5 right-0.5 w-5 h-5 rounded-full bg-red-500 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:u.jsx(Ln,{size:10})})]},D)),i.length<Qa&&u.jsx("button",{onClick:()=>{var N;return(N=C.current)==null?void 0:N.click()},className:"w-20 h-20 rounded-lg border-2 border-dashed border-slate-200 flex items-center justify-center text-slate-300 hover:border-primary/40 hover:text-primary/50 transition-colors",children:u.jsx(I_,{size:20})})]}),u.jsx("div",{className:"mt-4 flex justify-end",children:u.jsx("button",{onClick:w,disabled:a,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl bg-primary text-white text-sm font-semibold hover:bg-primary/90 disabled:opacity-50 transition-all shadow-sm",children:a?u.jsxs(u.Fragment,{children:[u.jsx(jC,{size:15,className:"animate-spin"})," Enviando..."]}):u.jsxs(u.Fragment,{children:[u.jsx(II,{size:15})," Enviar"]})})})]}),u.jsx("h2",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3",children:"Suas mensagens enviadas"}),m?u.jsx("div",{className:"space-y-3",children:[1,2].map(N=>u.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4 animate-pulse",children:[u.jsx("div",{className:"h-3 w-32 bg-slate-200 rounded mb-3"}),u.jsx("div",{className:"h-12 bg-slate-100 rounded"})]},N))}):d.length===0?u.jsx("div",{className:"text-center py-10 text-slate-400 text-sm",children:"Nenhuma mensagem enviada ainda."}):u.jsx("div",{className:"space-y-3",children:d.map(N=>{var D;return u.jsxs("div",{className:"bg-white border border-slate-200 rounded-xl p-4 shadow-sm",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("span",{className:"text-xs text-slate-400",children:U3(N.criadoEm)}),N.lido?u.jsx("span",{className:"text-[10px] font-medium text-emerald-600 bg-emerald-50 border border-emerald-100 rounded-full px-2 py-0.5",children:"Lido"}):u.jsx("span",{className:"text-[10px] font-medium text-slate-400 bg-slate-50 border border-slate-200 rounded-full px-2 py-0.5",children:"Enviado"})]}),N.mensagem&&u.jsx("p",{className:"text-sm text-slate-700 whitespace-pre-wrap mb-2",children:N.mensagem}),((D=N.imagensUrls)==null?void 0:D.length)>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:N.imagensUrls.map((O,x)=>u.jsx("img",{src:O,alt:"",className:"w-16 h-16 rounded-lg object-cover border border-slate-200 cursor-pointer hover:opacity-90 transition",onClick:()=>A(O)},x))})]},N.id)})}),_&&u.jsxs("div",{className:"fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4",onClick:()=>A(null),children:[u.jsx("button",{className:"absolute top-4 right-4 w-9 h-9 rounded-full bg-white/10 text-white flex items-center justify-center hover:bg-white/20 transition",onClick:()=>A(null),children:u.jsx(Ln,{size:18})}),u.jsx("img",{src:_,alt:"",className:"max-w-full max-h-[90vh] rounded-xl object-contain",onClick:N=>N.stopPropagation()})]})]})}function z3(){const{currentUser:t,userRole:e,userProfile:n,logout:r}=ya(),[s,i]=j.useState("caderneta"),[o,a]=j.useState("dashboard"),[c,d]=j.useState(null),[h,m]=j.useState(null),[p,_]=j.useState(null),[A,C]=j.useState([]),[R,E]=j.useState(!0),[v,w]=j.useState(!1),[N,D]=j.useState(!1),[O,x]=j.useState(()=>navigator.onLine?"online":"offline"),y=j.useRef(null);if(j.useEffect(()=>{e==="admin"&&!s.startsWith("admin-")&&s!=="perfil"&&i("admin-dashboard"),e==="parent"&&!["parent-inicio","calendario","comunicacao","merenda","vale-dev","perfil"].includes(s)&&i("parent-inicio")},[e,s]),j.useEffect(()=>{if(!H||e!=="teacher"||!(t!=null&&t.uid))return e!=="teacher"&&(C([]),_({})),E(!1),()=>{};E(!0);const X=Nt(Oe(H,"classrooms"),ct("professorId","==",t.uid)),he=ut(X,ue=>{const Se=ue.docs.map(_e=>{const ke=_e.data();return{id:_e.id,nome:ke.nome||"Sem nome",periodo:ke.periodo||""}}).sort((_e,ke)=>_e.nome.localeCompare(ke.nome,"pt-BR"));C(Se)},()=>{C([])});return()=>{he()}},[e,t==null?void 0:t.uid]),j.useEffect(()=>{if(!H||e!=="teacher"||A.length===0)return _({}),E(!1),()=>{};const X=A.map(Se=>Se.id),he=Nt(Oe(H,"students"),ct("turmaId","in",X)),ue=ut(he,Se=>{const _e={};Se.docs.forEach(ke=>{const Ve=ke.data();_e[ke.id]={id:ke.id,turmaId:Ve.turmaId||"",name:Ve.nome||"Sem nome",status:"pending",avatar:Ve.fotoUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(Ve.nome||"Aluno")}&background=e2e8f0&color=0f172a`}}),_(_e),E(!1)},Se=>{_({}),E(!1)});return()=>{ue()}},[e,A,H]),j.useEffect(()=>{if(!H||e!=="teacher"||A.length===0)return()=>{};const X=A.map(_e=>_e.id),he=new Date().toISOString().split("T")[0],ue=Nt(Oe(H,"cadernetaEntries"),ct("turmaId","in",X),ct("date","==",he)),Se=ut(ue,_e=>{_(ke=>{const Ve={...ke};return Object.keys(Ve).forEach(Ct=>{Ve[Ct].status="pending"}),_e.docs.forEach(Ct=>{const zn=Ct.data();Ve[zn.studentId]&&(Ve[zn.studentId].status=zn.status||"sent")}),Ve})});return()=>{Se()}},[e,A,H]),j.useEffect(()=>{const X=()=>{x("syncing"),y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{x("online")},1500)},he=()=>{y.current&&clearTimeout(y.current),x("offline")};return window.addEventListener("online",X),window.addEventListener("offline",he),()=>{window.removeEventListener("online",X),window.removeEventListener("offline",he),y.current&&clearTimeout(y.current)}},[]),!t)return u.jsx(u3,{});const b=X=>{d(X),a("diario")},k=X=>{m(X),a("aluno")},T=(X,he)=>{_(ue=>({...ue,[X]:{...ue[X],status:he}}))},P=()=>o==="dashboard"?u.jsx(Uw,{onOpenTurma:b,turmas:A,studentsStatus:p,carregando:R}):o==="diario"&&c?u.jsx(s3,{turma:c,studentsStatus:p,onBack:()=>a("dashboard"),onOpenStudent:k}):o==="aluno"&&h?u.jsx(i3,{student:p[h],turma:c,onBack:()=>a("diario"),onUpdateStatus:X=>T(h,X)}):u.jsx(Uw,{onOpenTurma:b,turmas:A,studentsStatus:p,carregando:R}),S=()=>{if(s==="perfil")return u.jsx(C3,{});if(s==="vale-dev")return u.jsx(wm,{});if(e==="admin")return s==="admin-dashboard"?u.jsx(p3,{}):s==="admin-calendar"?u.jsx(y3,{}):s==="admin-professores"?u.jsx(I3,{}):s==="admin-responsaveis"?u.jsx(S3,{}):s==="admin-alunos"?u.jsx(Qw,{}):s==="admin-turmas"?u.jsx(N3,{}):s==="admin-merenda"?u.jsx(j3,{}):s==="vale-dev"?u.jsx(wm,{}):u.jsx(Qw,{});if(e==="parent")return s==="calendario"?u.jsx(Fw,{}):s==="comunicacao"?u.jsx(Bw,{}):s==="merenda"?u.jsx(sE,{}):u.jsx(m3,{});switch(s){case"caderneta":return P();case"calendario":return u.jsx(Fw,{});case"comunicacao":return u.jsx(Bw,{});case"merenda":return u.jsx(sE,{});case"vale-dev":return u.jsx(wm,{});default:return P()}},te=X=>{i(X),w(!1),D(!1),X==="caderneta"&&a("dashboard")},ae=()=>{i("perfil"),w(!1),D(!1)},K=()=>e==="admin"?"Viso Geral":e==="parent"?"Incio":"Dashboard",we=e==="admin"?[{id:"admin-dashboard",label:"Dashboard",icon:gp},{id:"admin-calendar",label:"Calendrio",icon:gp},{id:"admin-professores",label:"Professores",icon:es},{id:"admin-turmas",label:"Turmas",icon:EI},{id:"admin-responsaveis",label:"Responsveis",icon:Wl},{id:"admin-alunos",label:"Alunos",icon:yl},{id:"admin-merenda",label:"Cardpio",icon:So},{id:"vale-dev",label:"Sugestes",icon:Mu}]:e==="parent"?[{id:"parent-inicio",label:K(),icon:yl},{id:"comunicacao",label:"Mensagens",icon:b_},{id:"merenda",label:"Cardpio",icon:So},{id:"vale-dev",label:"Sugestes",icon:Mu}]:[{id:"caderneta",label:K(),icon:yl},{id:"comunicacao",label:"Mensagens",icon:b_},{id:"merenda",label:"Cardpio",icon:So},{id:"vale-dev",label:"Sugestes",icon:Mu}],B=(n==null?void 0:n.nome)||(t==null?void 0:t.displayName)||"Usurio",F=(n==null?void 0:n.email)||(t==null?void 0:t.email)||"",G=(n==null?void 0:n.avatarUrl)||"",Y=O==="offline"?{label:"Offline",className:"bg-red-50 text-red-600 border-red-200",dotClassName:"bg-red-500"}:O==="syncing"?{label:"Sincronizando...",className:"bg-amber-50 text-amber-700 border-amber-200",dotClassName:"bg-amber-500"}:{label:"Online",className:"bg-emerald-50 text-emerald-700 border-emerald-200",dotClassName:"bg-emerald-500"};return u.jsxs("div",{className:"flex h-screen overflow-hidden bg-bg-app",children:[u.jsx(XV,{position:"top-right"}),v&&u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>w(!1)}),u.jsxs("div",{className:"lg:hidden fixed top-0 w-full h-16 bg-white border-b border-slate-200 flex items-center justify-between px-4 z-50",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>D(X=>!X),className:"w-9 h-9 rounded-lg border border-slate-200 bg-white text-slate-600 inline-flex items-center justify-center","aria-label":N?"Fechar menu":"Abrir menu",children:N?u.jsx(Ln,{size:18}):u.jsx(OC,{size:18})}),u.jsx("img",{src:"/pwa-192x192.png",alt:"Verdy",className:"w-8 h-8 rounded-lg object-cover shadow-sm"}),u.jsx("span",{className:"font-bold text-slate-800 tracking-tight",children:"Verdy"})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:`hidden sm:inline-flex items-center gap-1.5 px-2 py-1 rounded-full border text-[11px] font-medium ${Y.className}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${Y.dotClassName}`}),Y.label]}),u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:()=>w(X=>!X),className:"w-9 h-9 rounded-full bg-slate-100 border border-slate-200 overflow-hidden flex items-center justify-center text-slate-500",children:G?u.jsx("img",{src:G,alt:B,className:"w-full h-full object-cover"}):u.jsx(es,{size:18})}),v&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-56 rounded-xl border border-slate-200 bg-white shadow-lg p-2 z-20",children:[u.jsxs("div",{className:"px-3 py-2 border-b border-slate-100 mb-1",children:[u.jsx("div",{className:"text-xs font-semibold text-slate-800 truncate",children:B}),u.jsx("div",{className:"text-[11px] text-slate-500 truncate",children:F||"Conta ativa"})]}),u.jsxs("button",{onClick:()=>{w(!1),ae()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-700 hover:bg-slate-50",children:[u.jsx(es,{size:16}),"Meu perfil"]}),u.jsxs("button",{onClick:()=>{w(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50",children:[u.jsx(T_,{size:16}),"Sair do sistema"]})]})]})]})]}),N&&u.jsxs("div",{className:"lg:hidden fixed inset-0 z-40",children:[u.jsx("button",{onClick:()=>D(!1),className:"absolute inset-0 bg-slate-900/40","aria-label":"Fechar menu"}),u.jsxs("aside",{className:"absolute left-0 top-0 h-full w-full bg-white border-r border-slate-200 p-5 flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("img",{src:"/pwa-192x192.png",alt:"Verdy",className:"w-8 h-8 rounded-lg object-cover shadow-sm"}),u.jsx("span",{className:"font-bold text-slate-800 tracking-tight",children:"Verdy"})]}),u.jsx("button",{onClick:()=>D(!1),className:"w-8 h-8 rounded-lg border border-slate-200 text-slate-600 inline-flex items-center justify-center","aria-label":"Fechar menu",children:u.jsx(Ln,{size:16})})]}),u.jsx("nav",{className:"flex flex-col gap-2",children:we.map(X=>u.jsxs("button",{onClick:()=>te(X.id),className:`flex items-center gap-3 w-full text-left px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${s===X.id?"bg-primary text-white":"text-slate-600 hover:bg-slate-50"}`,children:[u.jsx(X.icon,{size:18}),X.label]},X.id))})]})]}),u.jsxs("aside",{className:"hidden lg:flex w-[280px] bg-white border-r border-slate-200 flex-col p-6 z-10 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-10 mt-2",children:[u.jsx("img",{src:"/pwa-192x192.png",alt:"Colgio Verdy",className:"w-10 h-10 rounded-xl object-cover shadow-md"}),u.jsx("h2",{className:"font-bold text-2xl text-slate-800 tracking-tight",children:"Colgio Verdy"})]}),u.jsx("nav",{className:"flex flex-col gap-2 flex-1 mt-4",children:we.map(X=>u.jsxs("button",{onClick:()=>te(X.id),className:`flex items-center gap-3 w-full text-left px-4 py-3.5 rounded-xl font-medium text-[15px] transition-all ${s===X.id?"bg-primary text-white shadow-md":"text-slate-500 hover:bg-slate-50 hover:text-primary"}`,children:[u.jsx(X.icon,{size:20}),X.label]},X.id))})]}),u.jsxs("main",{className:"flex-1 flex flex-col pt-16 lg:pt-0 overflow-hidden relative",children:[u.jsx("header",{className:"hidden lg:flex h-20 items-center justify-between px-8 bg-white border-b border-slate-200 shrink-0",children:u.jsxs("div",{className:"flex ml-auto items-center gap-6",children:[u.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-xs font-medium ${Y.className}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${Y.dotClassName}`}),Y.label]}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>w(X=>!X),className:"flex items-center gap-3 select-none hover:bg-slate-50 rounded-xl px-2 py-1.5 transition-colors",children:[u.jsx("div",{className:"w-11 h-11 rounded-full bg-slate-100 border-2 border-white shadow-sm overflow-hidden flex items-center justify-center text-slate-500",children:G?u.jsx("img",{src:G,alt:B,className:"w-full h-full object-cover"}):u.jsx(es,{size:20})}),u.jsxs("div",{className:"flex flex-col text-left",children:[u.jsx("span",{className:"font-semibold text-sm text-slate-800 uppercase",children:B}),u.jsx("span",{className:"text-xs text-slate-500 truncate max-w-[180px]",children:F||"Conta ativa"})]}),u.jsx(RC,{size:16,className:`text-slate-400 transition-transform ${v?"rotate-180":""}`})]}),v&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-56 rounded-xl border border-slate-200 bg-white shadow-lg p-2 z-20",children:[u.jsxs("button",{onClick:()=>{w(!1),ae()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-700 hover:bg-slate-50",children:[u.jsx(es,{size:16}),"Meu perfil"]}),u.jsxs("button",{onClick:()=>{w(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50",children:[u.jsx(T_,{size:16}),"Sair do sistema"]})]})]})]})}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 lg:p-8 pb-8",children:S()})]})]})}function $3(){return u.jsx(c3,{children:u.jsx(z3,{})})}NC({immediate:!0,onNeedRefresh(){window.location.reload()},onOfflineReady(){}});Em.createRoot(document.getElementById("root")).render(u.jsx(hA.StrictMode,{children:u.jsx($3,{})}));
