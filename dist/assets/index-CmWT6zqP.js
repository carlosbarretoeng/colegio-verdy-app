(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function CA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Hw={exports:{}},Zd={},Gw={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oc=Symbol.for("react.element"),kA=Symbol.for("react.portal"),RA=Symbol.for("react.fragment"),PA=Symbol.for("react.strict_mode"),DA=Symbol.for("react.profiler"),jA=Symbol.for("react.provider"),VA=Symbol.for("react.context"),OA=Symbol.for("react.forward_ref"),MA=Symbol.for("react.suspense"),LA=Symbol.for("react.memo"),FA=Symbol.for("react.lazy"),u_=Symbol.iterator;function UA(t){return t===null||typeof t!="object"?null:(t=u_&&t[u_]||t["@@iterator"],typeof t=="function"?t:null)}var Kw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ww=Object.assign,Qw={};function ra(t,e,n){this.props=t,this.context=e,this.refs=Qw,this.updater=n||Kw}ra.prototype.isReactComponent={};ra.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ra.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Yw(){}Yw.prototype=ra.prototype;function eg(t,e,n){this.props=t,this.context=e,this.refs=Qw,this.updater=n||Kw}var tg=eg.prototype=new Yw;tg.constructor=eg;Ww(tg,ra.prototype);tg.isPureReactComponent=!0;var d_=Array.isArray,Jw=Object.prototype.hasOwnProperty,ng={current:null},Xw={key:!0,ref:!0,__self:!0,__source:!0};function Zw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Jw.call(e,r)&&!Xw.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:oc,type:t,key:i,ref:o,props:s,_owner:ng.current}}function zA(t,e){return{$$typeof:oc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function rg(t){return typeof t=="object"&&t!==null&&t.$$typeof===oc}function BA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var h_=/\/+/g;function mf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?BA(""+t.key):e.toString(36)}function wu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case oc:case kA:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+mf(o,0):r,d_(s)?(n="",t!=null&&(n=t.replace(h_,"$&/")+"/"),wu(s,e,n,"",function(d){return d})):s!=null&&(rg(s)&&(s=zA(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(h_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",d_(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+mf(i,a);o+=wu(i,e,n,c,s)}else if(c=UA(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+mf(i,a++),o+=wu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function $c(t,e,n){if(t==null)return t;var r=[],s=0;return wu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function $A(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ht={current:null},Eu={transition:null},qA={ReactCurrentDispatcher:Ht,ReactCurrentBatchConfig:Eu,ReactCurrentOwner:ng};function eE(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:$c,forEach:function(t,e,n){$c(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return $c(t,function(){e++}),e},toArray:function(t){return $c(t,function(e){return e})||[]},only:function(t){if(!rg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xe.Component=ra;xe.Fragment=RA;xe.Profiler=DA;xe.PureComponent=eg;xe.StrictMode=PA;xe.Suspense=MA;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qA;xe.act=eE;xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ww({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=ng.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Jw.call(e,c)&&!Xw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:oc,type:t.type,key:s,ref:i,props:r,_owner:o}};xe.createContext=function(t){return t={$$typeof:VA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:jA,_context:t},t.Consumer=t};xe.createElement=Zw;xe.createFactory=function(t){var e=Zw.bind(null,t);return e.type=t,e};xe.createRef=function(){return{current:null}};xe.forwardRef=function(t){return{$$typeof:OA,render:t}};xe.isValidElement=rg;xe.lazy=function(t){return{$$typeof:FA,_payload:{_status:-1,_result:t},_init:$A}};xe.memo=function(t,e){return{$$typeof:LA,type:t,compare:e===void 0?null:e}};xe.startTransition=function(t){var e=Eu.transition;Eu.transition={};try{t()}finally{Eu.transition=e}};xe.unstable_act=eE;xe.useCallback=function(t,e){return Ht.current.useCallback(t,e)};xe.useContext=function(t){return Ht.current.useContext(t)};xe.useDebugValue=function(){};xe.useDeferredValue=function(t){return Ht.current.useDeferredValue(t)};xe.useEffect=function(t,e){return Ht.current.useEffect(t,e)};xe.useId=function(){return Ht.current.useId()};xe.useImperativeHandle=function(t,e,n){return Ht.current.useImperativeHandle(t,e,n)};xe.useInsertionEffect=function(t,e){return Ht.current.useInsertionEffect(t,e)};xe.useLayoutEffect=function(t,e){return Ht.current.useLayoutEffect(t,e)};xe.useMemo=function(t,e){return Ht.current.useMemo(t,e)};xe.useReducer=function(t,e,n){return Ht.current.useReducer(t,e,n)};xe.useRef=function(t){return Ht.current.useRef(t)};xe.useState=function(t){return Ht.current.useState(t)};xe.useSyncExternalStore=function(t,e,n){return Ht.current.useSyncExternalStore(t,e,n)};xe.useTransition=function(){return Ht.current.useTransition()};xe.version="18.3.1";Gw.exports=xe;var D=Gw.exports;const HA=CA(D);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GA=D,KA=Symbol.for("react.element"),WA=Symbol.for("react.fragment"),QA=Object.prototype.hasOwnProperty,YA=GA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,JA={key:!0,ref:!0,__self:!0,__source:!0};function tE(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)QA.call(e,r)&&!JA.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:KA,type:t,key:i,ref:o,props:s,_owner:YA.current}}Zd.Fragment=WA;Zd.jsx=tE;Zd.jsxs=tE;Hw.exports=Zd;var u=Hw.exports,_m={},nE={exports:{}},gn={},rE={exports:{}},sE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,F){var K=$.length;$.push(F);e:for(;0<K;){var J=K-1>>>1,Q=$[J];if(0<s(Q,F))$[J]=F,$[K]=Q,K=J;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var F=$[0],K=$.pop();if(K!==F){$[0]=K;e:for(var J=0,Q=$.length,me=Q>>>1;J<me;){var ue=2*(J+1)-1,Ne=$[ue],_e=ue+1,ke=$[_e];if(0>s(Ne,K))_e<Q&&0>s(ke,Ne)?($[J]=ke,$[_e]=K,J=_e):($[J]=Ne,$[ue]=K,J=ue);else if(_e<Q&&0>s(ke,K))$[J]=ke,$[_e]=K,J=_e;else break e}}return F}function s($,F){var K=$.sortIndex-F.sortIndex;return K!==0?K:$.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,m=null,p=3,x=!1,A=!1,C=!1,k=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w($){for(var F=n(d);F!==null;){if(F.callback===null)r(d);else if(F.startTime<=$)r(d),F.sortIndex=F.expirationTime,e(c,F);else break;F=n(d)}}function P($){if(C=!1,w($),!A)if(n(c)!==null)A=!0,W(j);else{var F=n(d);F!==null&&we(P,F.startTime-$)}}function j($,F){A=!1,C&&(C=!1,_(y),y=-1),x=!0;var K=p;try{for(w(F),m=n(c);m!==null&&(!(m.expirationTime>F)||$&&!I());){var J=m.callback;if(typeof J=="function"){m.callback=null,p=m.priorityLevel;var Q=J(m.expirationTime<=F);F=t.unstable_now(),typeof Q=="function"?m.callback=Q:m===n(c)&&r(c),w(F)}else r(c);m=n(c)}if(m!==null)var me=!0;else{var ue=n(d);ue!==null&&we(P,ue.startTime-F),me=!1}return me}finally{m=null,p=K,x=!1}}var L=!1,E=null,y=-1,b=5,N=-1;function I(){return!(t.unstable_now()-N<b)}function R(){if(E!==null){var $=t.unstable_now();N=$;var F=!0;try{F=E(!0,$)}finally{F?S():(L=!1,E=null)}}else L=!1}var S;if(typeof v=="function")S=function(){v(R)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,le=ie.port2;ie.port1.onmessage=R,S=function(){le.postMessage(null)}}else S=function(){k(R,0)};function W($){E=$,L||(L=!0,S())}function we($,F){y=k(function(){$(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){A||x||(A=!0,W(j))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function($){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var K=p;p=F;try{return $()}finally{p=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,F){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var K=p;p=$;try{return F()}finally{p=K}},t.unstable_scheduleCallback=function($,F,K){var J=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?J+K:J):K=J,$){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=K+Q,$={id:h++,callback:F,priorityLevel:$,startTime:K,expirationTime:Q,sortIndex:-1},K>J?($.sortIndex=K,e(d,$),n(c)===null&&$===n(d)&&(C?(_(y),y=-1):C=!0,we(P,K-J))):($.sortIndex=Q,e(c,$),A||x||(A=!0,W(j))),$},t.unstable_shouldYield=I,t.unstable_wrapCallback=function($){var F=p;return function(){var K=p;p=F;try{return $.apply(this,arguments)}finally{p=K}}}})(sE);rE.exports=sE;var XA=rE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZA=D,mn=XA;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iE=new Set,Sl={};function Pi(t,e){No(t,e),No(t+"Capture",e)}function No(t,e){for(Sl[t]=e,t=0;t<e.length;t++)iE.add(e[t])}var xr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xm=Object.prototype.hasOwnProperty,eN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f_={},m_={};function tN(t){return xm.call(m_,t)?!0:xm.call(f_,t)?!1:eN.test(t)?m_[t]=!0:(f_[t]=!0,!1)}function nN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function rN(t,e,n,r){if(e===null||typeof e>"u"||nN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Gt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Ct={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ct[t]=new Gt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ct[e]=new Gt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ct[t]=new Gt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ct[t]=new Gt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ct[t]=new Gt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ct[t]=new Gt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ct[t]=new Gt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ct[t]=new Gt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ct[t]=new Gt(t,5,!1,t.toLowerCase(),null,!1,!1)});var sg=/[\-:]([a-z])/g;function ig(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(sg,ig);Ct[e]=new Gt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(sg,ig);Ct[e]=new Gt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(sg,ig);Ct[e]=new Gt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ct[t]=new Gt(t,1,!1,t.toLowerCase(),null,!1,!1)});Ct.xlinkHref=new Gt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ct[t]=new Gt(t,1,!1,t.toLowerCase(),null,!0,!0)});function og(t,e,n,r){var s=Ct.hasOwnProperty(e)?Ct[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(rN(e,n,s,r)&&(n=null),r||s===null?tN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Pr=ZA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,qc=Symbol.for("react.element"),no=Symbol.for("react.portal"),ro=Symbol.for("react.fragment"),ag=Symbol.for("react.strict_mode"),wm=Symbol.for("react.profiler"),oE=Symbol.for("react.provider"),aE=Symbol.for("react.context"),lg=Symbol.for("react.forward_ref"),Em=Symbol.for("react.suspense"),Im=Symbol.for("react.suspense_list"),cg=Symbol.for("react.memo"),Qr=Symbol.for("react.lazy"),lE=Symbol.for("react.offscreen"),p_=Symbol.iterator;function ka(t){return t===null||typeof t!="object"?null:(t=p_&&t[p_]||t["@@iterator"],typeof t=="function"?t:null)}var Xe=Object.assign,pf;function Ka(t){if(pf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);pf=e&&e[1]||""}return`
`+pf+t}var gf=!1;function yf(t,e){if(!t||gf)return"";gf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{gf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ka(t):""}function sN(t){switch(t.tag){case 5:return Ka(t.type);case 16:return Ka("Lazy");case 13:return Ka("Suspense");case 19:return Ka("SuspenseList");case 0:case 2:case 15:return t=yf(t.type,!1),t;case 11:return t=yf(t.type.render,!1),t;case 1:return t=yf(t.type,!0),t;default:return""}}function Tm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ro:return"Fragment";case no:return"Portal";case wm:return"Profiler";case ag:return"StrictMode";case Em:return"Suspense";case Im:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case aE:return(t.displayName||"Context")+".Consumer";case oE:return(t._context.displayName||"Context")+".Provider";case lg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case cg:return e=t.displayName||null,e!==null?e:Tm(t.type)||"Memo";case Qr:e=t._payload,t=t._init;try{return Tm(t(e))}catch{}}return null}function iN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Tm(e);case 8:return e===ag?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function bs(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function cE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function oN(t){var e=cE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Hc(t){t._valueTracker||(t._valueTracker=oN(t))}function uE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=cE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Yu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function bm(t,e){var n=e.checked;return Xe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function g_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=bs(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function dE(t,e){e=e.checked,e!=null&&og(t,"checked",e,!1)}function Sm(t,e){dE(t,e);var n=bs(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Am(t,e.type,n):e.hasOwnProperty("defaultValue")&&Am(t,e.type,bs(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function y_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Am(t,e,n){(e!=="number"||Yu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Wa=Array.isArray;function yo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+bs(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Nm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return Xe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function v_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(Wa(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:bs(n)}}function hE(t,e){var n=bs(e.value),r=bs(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function __(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function fE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?fE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Gc,mE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Gc=Gc||document.createElement("div"),Gc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Al(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var sl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},aN=["Webkit","ms","Moz","O"];Object.keys(sl).forEach(function(t){aN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),sl[e]=sl[t]})});function pE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||sl.hasOwnProperty(t)&&sl[t]?(""+e).trim():e+"px"}function gE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=pE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var lN=Xe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function km(t,e){if(e){if(lN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Rm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pm=null;function ug(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Dm=null,vo=null,_o=null;function x_(t){if(t=cc(t)){if(typeof Dm!="function")throw Error(H(280));var e=t.stateNode;e&&(e=sh(e),Dm(t.stateNode,t.type,e))}}function yE(t){vo?_o?_o.push(t):_o=[t]:vo=t}function vE(){if(vo){var t=vo,e=_o;if(_o=vo=null,x_(t),e)for(t=0;t<e.length;t++)x_(e[t])}}function _E(t,e){return t(e)}function xE(){}var vf=!1;function wE(t,e,n){if(vf)return t(e,n);vf=!0;try{return _E(t,e,n)}finally{vf=!1,(vo!==null||_o!==null)&&(xE(),vE())}}function Nl(t,e){var n=t.stateNode;if(n===null)return null;var r=sh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var jm=!1;if(xr)try{var Ra={};Object.defineProperty(Ra,"passive",{get:function(){jm=!0}}),window.addEventListener("test",Ra,Ra),window.removeEventListener("test",Ra,Ra)}catch{jm=!1}function cN(t,e,n,r,s,i,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var il=!1,Ju=null,Xu=!1,Vm=null,uN={onError:function(t){il=!0,Ju=t}};function dN(t,e,n,r,s,i,o,a,c){il=!1,Ju=null,cN.apply(uN,arguments)}function hN(t,e,n,r,s,i,o,a,c){if(dN.apply(this,arguments),il){if(il){var d=Ju;il=!1,Ju=null}else throw Error(H(198));Xu||(Xu=!0,Vm=d)}}function Di(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function EE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function w_(t){if(Di(t)!==t)throw Error(H(188))}function fN(t){var e=t.alternate;if(!e){if(e=Di(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return w_(s),t;if(i===r)return w_(s),e;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function IE(t){return t=fN(t),t!==null?TE(t):null}function TE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=TE(t);if(e!==null)return e;t=t.sibling}return null}var bE=mn.unstable_scheduleCallback,E_=mn.unstable_cancelCallback,mN=mn.unstable_shouldYield,pN=mn.unstable_requestPaint,st=mn.unstable_now,gN=mn.unstable_getCurrentPriorityLevel,dg=mn.unstable_ImmediatePriority,SE=mn.unstable_UserBlockingPriority,Zu=mn.unstable_NormalPriority,yN=mn.unstable_LowPriority,AE=mn.unstable_IdlePriority,eh=null,tr=null;function vN(t){if(tr&&typeof tr.onCommitFiberRoot=="function")try{tr.onCommitFiberRoot(eh,t,void 0,(t.current.flags&128)===128)}catch{}}var Dn=Math.clz32?Math.clz32:wN,_N=Math.log,xN=Math.LN2;function wN(t){return t>>>=0,t===0?32:31-(_N(t)/xN|0)|0}var Kc=64,Wc=4194304;function Qa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ed(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Qa(a):(i&=o,i!==0&&(r=Qa(i)))}else o=n&~s,o!==0?r=Qa(o):i!==0&&(r=Qa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Dn(e),s=1<<n,r|=t[n],e&=~s;return r}function EN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function IN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Dn(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=EN(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function Om(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function NE(){var t=Kc;return Kc<<=1,!(Kc&4194240)&&(Kc=64),t}function _f(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ac(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Dn(e),t[e]=n}function TN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Dn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function hg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Dn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var De=0;function CE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var kE,fg,RE,PE,DE,Mm=!1,Qc=[],ds=null,hs=null,fs=null,Cl=new Map,kl=new Map,Jr=[],bN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function I_(t,e){switch(t){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":hs=null;break;case"mouseover":case"mouseout":fs=null;break;case"pointerover":case"pointerout":Cl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":kl.delete(e.pointerId)}}function Pa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=cc(e),e!==null&&fg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function SN(t,e,n,r,s){switch(e){case"focusin":return ds=Pa(ds,t,e,n,r,s),!0;case"dragenter":return hs=Pa(hs,t,e,n,r,s),!0;case"mouseover":return fs=Pa(fs,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Cl.set(i,Pa(Cl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,kl.set(i,Pa(kl.get(i)||null,t,e,n,r,s)),!0}return!1}function jE(t){var e=ii(t.target);if(e!==null){var n=Di(e);if(n!==null){if(e=n.tag,e===13){if(e=EE(n),e!==null){t.blockedOn=e,DE(t.priority,function(){RE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Iu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Lm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Pm=r,n.target.dispatchEvent(r),Pm=null}else return e=cc(n),e!==null&&fg(e),t.blockedOn=n,!1;e.shift()}return!0}function T_(t,e,n){Iu(t)&&n.delete(e)}function AN(){Mm=!1,ds!==null&&Iu(ds)&&(ds=null),hs!==null&&Iu(hs)&&(hs=null),fs!==null&&Iu(fs)&&(fs=null),Cl.forEach(T_),kl.forEach(T_)}function Da(t,e){t.blockedOn===e&&(t.blockedOn=null,Mm||(Mm=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,AN)))}function Rl(t){function e(s){return Da(s,t)}if(0<Qc.length){Da(Qc[0],t);for(var n=1;n<Qc.length;n++){var r=Qc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ds!==null&&Da(ds,t),hs!==null&&Da(hs,t),fs!==null&&Da(fs,t),Cl.forEach(e),kl.forEach(e),n=0;n<Jr.length;n++)r=Jr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jr.length&&(n=Jr[0],n.blockedOn===null);)jE(n),n.blockedOn===null&&Jr.shift()}var xo=Pr.ReactCurrentBatchConfig,td=!0;function NN(t,e,n,r){var s=De,i=xo.transition;xo.transition=null;try{De=1,mg(t,e,n,r)}finally{De=s,xo.transition=i}}function CN(t,e,n,r){var s=De,i=xo.transition;xo.transition=null;try{De=4,mg(t,e,n,r)}finally{De=s,xo.transition=i}}function mg(t,e,n,r){if(td){var s=Lm(t,e,n,r);if(s===null)Cf(t,e,r,nd,n),I_(t,r);else if(SN(s,t,e,n,r))r.stopPropagation();else if(I_(t,r),e&4&&-1<bN.indexOf(t)){for(;s!==null;){var i=cc(s);if(i!==null&&kE(i),i=Lm(t,e,n,r),i===null&&Cf(t,e,r,nd,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Cf(t,e,r,null,n)}}var nd=null;function Lm(t,e,n,r){if(nd=null,t=ug(r),t=ii(t),t!==null)if(e=Di(t),e===null)t=null;else if(n=e.tag,n===13){if(t=EE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return nd=t,null}function VE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(gN()){case dg:return 1;case SE:return 4;case Zu:case yN:return 16;case AE:return 536870912;default:return 16}default:return 16}}var as=null,pg=null,Tu=null;function OE(){if(Tu)return Tu;var t,e=pg,n=e.length,r,s="value"in as?as.value:as.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Tu=s.slice(t,1<r?1-r:void 0)}function bu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Yc(){return!0}function b_(){return!1}function yn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Yc:b_,this.isPropagationStopped=b_,this}return Xe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Yc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Yc)},persist:function(){},isPersistent:Yc}),e}var sa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gg=yn(sa),lc=Xe({},sa,{view:0,detail:0}),kN=yn(lc),xf,wf,ja,th=Xe({},lc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ja&&(ja&&t.type==="mousemove"?(xf=t.screenX-ja.screenX,wf=t.screenY-ja.screenY):wf=xf=0,ja=t),xf)},movementY:function(t){return"movementY"in t?t.movementY:wf}}),S_=yn(th),RN=Xe({},th,{dataTransfer:0}),PN=yn(RN),DN=Xe({},lc,{relatedTarget:0}),Ef=yn(DN),jN=Xe({},sa,{animationName:0,elapsedTime:0,pseudoElement:0}),VN=yn(jN),ON=Xe({},sa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),MN=yn(ON),LN=Xe({},sa,{data:0}),A_=yn(LN),FN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},UN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function BN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=zN[t])?!!e[t]:!1}function yg(){return BN}var $N=Xe({},lc,{key:function(t){if(t.key){var e=FN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?UN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yg,charCode:function(t){return t.type==="keypress"?bu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),qN=yn($N),HN=Xe({},th,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N_=yn(HN),GN=Xe({},lc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yg}),KN=yn(GN),WN=Xe({},sa,{propertyName:0,elapsedTime:0,pseudoElement:0}),QN=yn(WN),YN=Xe({},th,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),JN=yn(YN),XN=[9,13,27,32],vg=xr&&"CompositionEvent"in window,ol=null;xr&&"documentMode"in document&&(ol=document.documentMode);var ZN=xr&&"TextEvent"in window&&!ol,ME=xr&&(!vg||ol&&8<ol&&11>=ol),C_=" ",k_=!1;function LE(t,e){switch(t){case"keyup":return XN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function FE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var so=!1;function eC(t,e){switch(t){case"compositionend":return FE(e);case"keypress":return e.which!==32?null:(k_=!0,C_);case"textInput":return t=e.data,t===C_&&k_?null:t;default:return null}}function tC(t,e){if(so)return t==="compositionend"||!vg&&LE(t,e)?(t=OE(),Tu=pg=as=null,so=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return ME&&e.locale!=="ko"?null:e.data;default:return null}}var nC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function R_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!nC[t.type]:e==="textarea"}function UE(t,e,n,r){yE(r),e=rd(e,"onChange"),0<e.length&&(n=new gg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var al=null,Pl=null;function rC(t){JE(t,0)}function nh(t){var e=ao(t);if(uE(e))return t}function sC(t,e){if(t==="change")return e}var zE=!1;if(xr){var If;if(xr){var Tf="oninput"in document;if(!Tf){var P_=document.createElement("div");P_.setAttribute("oninput","return;"),Tf=typeof P_.oninput=="function"}If=Tf}else If=!1;zE=If&&(!document.documentMode||9<document.documentMode)}function D_(){al&&(al.detachEvent("onpropertychange",BE),Pl=al=null)}function BE(t){if(t.propertyName==="value"&&nh(Pl)){var e=[];UE(e,Pl,t,ug(t)),wE(rC,e)}}function iC(t,e,n){t==="focusin"?(D_(),al=e,Pl=n,al.attachEvent("onpropertychange",BE)):t==="focusout"&&D_()}function oC(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return nh(Pl)}function aC(t,e){if(t==="click")return nh(e)}function lC(t,e){if(t==="input"||t==="change")return nh(e)}function cC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Mn=typeof Object.is=="function"?Object.is:cC;function Dl(t,e){if(Mn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!xm.call(e,s)||!Mn(t[s],e[s]))return!1}return!0}function j_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function V_(t,e){var n=j_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=j_(n)}}function $E(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?$E(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qE(){for(var t=window,e=Yu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Yu(t.document)}return e}function _g(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function uC(t){var e=qE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&$E(n.ownerDocument.documentElement,n)){if(r!==null&&_g(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=V_(n,i);var o=V_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var dC=xr&&"documentMode"in document&&11>=document.documentMode,io=null,Fm=null,ll=null,Um=!1;function O_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Um||io==null||io!==Yu(r)||(r=io,"selectionStart"in r&&_g(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ll&&Dl(ll,r)||(ll=r,r=rd(Fm,"onSelect"),0<r.length&&(e=new gg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=io)))}function Jc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var oo={animationend:Jc("Animation","AnimationEnd"),animationiteration:Jc("Animation","AnimationIteration"),animationstart:Jc("Animation","AnimationStart"),transitionend:Jc("Transition","TransitionEnd")},bf={},HE={};xr&&(HE=document.createElement("div").style,"AnimationEvent"in window||(delete oo.animationend.animation,delete oo.animationiteration.animation,delete oo.animationstart.animation),"TransitionEvent"in window||delete oo.transitionend.transition);function rh(t){if(bf[t])return bf[t];if(!oo[t])return t;var e=oo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in HE)return bf[t]=e[n];return t}var GE=rh("animationend"),KE=rh("animationiteration"),WE=rh("animationstart"),QE=rh("transitionend"),YE=new Map,M_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function js(t,e){YE.set(t,e),Pi(e,[t])}for(var Sf=0;Sf<M_.length;Sf++){var Af=M_[Sf],hC=Af.toLowerCase(),fC=Af[0].toUpperCase()+Af.slice(1);js(hC,"on"+fC)}js(GE,"onAnimationEnd");js(KE,"onAnimationIteration");js(WE,"onAnimationStart");js("dblclick","onDoubleClick");js("focusin","onFocus");js("focusout","onBlur");js(QE,"onTransitionEnd");No("onMouseEnter",["mouseout","mouseover"]);No("onMouseLeave",["mouseout","mouseover"]);No("onPointerEnter",["pointerout","pointerover"]);No("onPointerLeave",["pointerout","pointerover"]);Pi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Pi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Pi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Pi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Pi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Pi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ya="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mC=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ya));function L_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,hN(r,e,void 0,t),t.currentTarget=null}function JE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;L_(s,a,d),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;L_(s,a,d),i=c}}}if(Xu)throw t=Vm,Xu=!1,Vm=null,t}function Be(t,e){var n=e[Hm];n===void 0&&(n=e[Hm]=new Set);var r=t+"__bubble";n.has(r)||(XE(e,t,2,!1),n.add(r))}function Nf(t,e,n){var r=0;e&&(r|=4),XE(n,t,r,e)}var Xc="_reactListening"+Math.random().toString(36).slice(2);function jl(t){if(!t[Xc]){t[Xc]=!0,iE.forEach(function(n){n!=="selectionchange"&&(mC.has(n)||Nf(n,!1,t),Nf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Xc]||(e[Xc]=!0,Nf("selectionchange",!1,e))}}function XE(t,e,n,r){switch(VE(e)){case 1:var s=NN;break;case 4:s=CN;break;default:s=mg}n=s.bind(null,e,n,t),s=void 0,!jm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Cf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ii(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}wE(function(){var d=i,h=ug(n),m=[];e:{var p=YE.get(t);if(p!==void 0){var x=gg,A=t;switch(t){case"keypress":if(bu(n)===0)break e;case"keydown":case"keyup":x=qN;break;case"focusin":A="focus",x=Ef;break;case"focusout":A="blur",x=Ef;break;case"beforeblur":case"afterblur":x=Ef;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=S_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=PN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=KN;break;case GE:case KE:case WE:x=VN;break;case QE:x=QN;break;case"scroll":x=kN;break;case"wheel":x=JN;break;case"copy":case"cut":case"paste":x=MN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=N_}var C=(e&4)!==0,k=!C&&t==="scroll",_=C?p!==null?p+"Capture":null:p;C=[];for(var v=d,w;v!==null;){w=v;var P=w.stateNode;if(w.tag===5&&P!==null&&(w=P,_!==null&&(P=Nl(v,_),P!=null&&C.push(Vl(v,P,w)))),k)break;v=v.return}0<C.length&&(p=new x(p,A,null,n,h),m.push({event:p,listeners:C}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",p&&n!==Pm&&(A=n.relatedTarget||n.fromElement)&&(ii(A)||A[wr]))break e;if((x||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,x?(A=n.relatedTarget||n.toElement,x=d,A=A?ii(A):null,A!==null&&(k=Di(A),A!==k||A.tag!==5&&A.tag!==6)&&(A=null)):(x=null,A=d),x!==A)){if(C=S_,P="onMouseLeave",_="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(C=N_,P="onPointerLeave",_="onPointerEnter",v="pointer"),k=x==null?p:ao(x),w=A==null?p:ao(A),p=new C(P,v+"leave",x,n,h),p.target=k,p.relatedTarget=w,P=null,ii(h)===d&&(C=new C(_,v+"enter",A,n,h),C.target=w,C.relatedTarget=k,P=C),k=P,x&&A)t:{for(C=x,_=A,v=0,w=C;w;w=$i(w))v++;for(w=0,P=_;P;P=$i(P))w++;for(;0<v-w;)C=$i(C),v--;for(;0<w-v;)_=$i(_),w--;for(;v--;){if(C===_||_!==null&&C===_.alternate)break t;C=$i(C),_=$i(_)}C=null}else C=null;x!==null&&F_(m,p,x,C,!1),A!==null&&k!==null&&F_(m,k,A,C,!0)}}e:{if(p=d?ao(d):window,x=p.nodeName&&p.nodeName.toLowerCase(),x==="select"||x==="input"&&p.type==="file")var j=sC;else if(R_(p))if(zE)j=lC;else{j=oC;var L=iC}else(x=p.nodeName)&&x.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(j=aC);if(j&&(j=j(t,d))){UE(m,j,n,h);break e}L&&L(t,p,d),t==="focusout"&&(L=p._wrapperState)&&L.controlled&&p.type==="number"&&Am(p,"number",p.value)}switch(L=d?ao(d):window,t){case"focusin":(R_(L)||L.contentEditable==="true")&&(io=L,Fm=d,ll=null);break;case"focusout":ll=Fm=io=null;break;case"mousedown":Um=!0;break;case"contextmenu":case"mouseup":case"dragend":Um=!1,O_(m,n,h);break;case"selectionchange":if(dC)break;case"keydown":case"keyup":O_(m,n,h)}var E;if(vg)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else so?LE(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(ME&&n.locale!=="ko"&&(so||y!=="onCompositionStart"?y==="onCompositionEnd"&&so&&(E=OE()):(as=h,pg="value"in as?as.value:as.textContent,so=!0)),L=rd(d,y),0<L.length&&(y=new A_(y,t,null,n,h),m.push({event:y,listeners:L}),E?y.data=E:(E=FE(n),E!==null&&(y.data=E)))),(E=ZN?eC(t,n):tC(t,n))&&(d=rd(d,"onBeforeInput"),0<d.length&&(h=new A_("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=E))}JE(m,e)})}function Vl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function rd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Nl(t,n),i!=null&&r.unshift(Vl(t,i,s)),i=Nl(t,e),i!=null&&r.push(Vl(t,i,s))),t=t.return}return r}function $i(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function F_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=Nl(n,i),c!=null&&o.unshift(Vl(n,c,a))):s||(c=Nl(n,i),c!=null&&o.push(Vl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var pC=/\r\n?/g,gC=/\u0000|\uFFFD/g;function U_(t){return(typeof t=="string"?t:""+t).replace(pC,`
`).replace(gC,"")}function Zc(t,e,n){if(e=U_(e),U_(t)!==e&&n)throw Error(H(425))}function sd(){}var zm=null,Bm=null;function $m(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var qm=typeof setTimeout=="function"?setTimeout:void 0,yC=typeof clearTimeout=="function"?clearTimeout:void 0,z_=typeof Promise=="function"?Promise:void 0,vC=typeof queueMicrotask=="function"?queueMicrotask:typeof z_<"u"?function(t){return z_.resolve(null).then(t).catch(_C)}:qm;function _C(t){setTimeout(function(){throw t})}function kf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Rl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Rl(e)}function ms(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function B_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ia=Math.random().toString(36).slice(2),Yn="__reactFiber$"+ia,Ol="__reactProps$"+ia,wr="__reactContainer$"+ia,Hm="__reactEvents$"+ia,xC="__reactListeners$"+ia,wC="__reactHandles$"+ia;function ii(t){var e=t[Yn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[wr]||n[Yn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=B_(t);t!==null;){if(n=t[Yn])return n;t=B_(t)}return e}t=n,n=t.parentNode}return null}function cc(t){return t=t[Yn]||t[wr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ao(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function sh(t){return t[Ol]||null}var Gm=[],lo=-1;function Vs(t){return{current:t}}function $e(t){0>lo||(t.current=Gm[lo],Gm[lo]=null,lo--)}function Le(t,e){lo++,Gm[lo]=t.current,t.current=e}var Ss={},Ft=Vs(Ss),en=Vs(!1),pi=Ss;function Co(t,e){var n=t.type.contextTypes;if(!n)return Ss;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function tn(t){return t=t.childContextTypes,t!=null}function id(){$e(en),$e(Ft)}function $_(t,e,n){if(Ft.current!==Ss)throw Error(H(168));Le(Ft,e),Le(en,n)}function ZE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,iN(t)||"Unknown",s));return Xe({},n,r)}function od(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ss,pi=Ft.current,Le(Ft,t),Le(en,en.current),!0}function q_(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=ZE(t,e,pi),r.__reactInternalMemoizedMergedChildContext=t,$e(en),$e(Ft),Le(Ft,t)):$e(en),Le(en,n)}var dr=null,ih=!1,Rf=!1;function eI(t){dr===null?dr=[t]:dr.push(t)}function EC(t){ih=!0,eI(t)}function Os(){if(!Rf&&dr!==null){Rf=!0;var t=0,e=De;try{var n=dr;for(De=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}dr=null,ih=!1}catch(s){throw dr!==null&&(dr=dr.slice(t+1)),bE(dg,Os),s}finally{De=e,Rf=!1}}return null}var co=[],uo=0,ad=null,ld=0,vn=[],_n=0,gi=null,hr=1,fr="";function Ys(t,e){co[uo++]=ld,co[uo++]=ad,ad=t,ld=e}function tI(t,e,n){vn[_n++]=hr,vn[_n++]=fr,vn[_n++]=gi,gi=t;var r=hr;t=fr;var s=32-Dn(r)-1;r&=~(1<<s),n+=1;var i=32-Dn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,hr=1<<32-Dn(e)+s|n<<s|r,fr=i+t}else hr=1<<i|n<<s|r,fr=t}function xg(t){t.return!==null&&(Ys(t,1),tI(t,1,0))}function wg(t){for(;t===ad;)ad=co[--uo],co[uo]=null,ld=co[--uo],co[uo]=null;for(;t===gi;)gi=vn[--_n],vn[_n]=null,fr=vn[--_n],vn[_n]=null,hr=vn[--_n],vn[_n]=null}var hn=null,ln=null,He=!1,Rn=null;function nI(t,e){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function H_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,hn=t,ln=ms(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,hn=t,ln=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=gi!==null?{id:hr,overflow:fr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,hn=t,ln=null,!0):!1;default:return!1}}function Km(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Wm(t){if(He){var e=ln;if(e){var n=e;if(!H_(t,e)){if(Km(t))throw Error(H(418));e=ms(n.nextSibling);var r=hn;e&&H_(t,e)?nI(r,n):(t.flags=t.flags&-4097|2,He=!1,hn=t)}}else{if(Km(t))throw Error(H(418));t.flags=t.flags&-4097|2,He=!1,hn=t}}}function G_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;hn=t}function eu(t){if(t!==hn)return!1;if(!He)return G_(t),He=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!$m(t.type,t.memoizedProps)),e&&(e=ln)){if(Km(t))throw rI(),Error(H(418));for(;e;)nI(t,e),e=ms(e.nextSibling)}if(G_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){ln=ms(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}ln=null}}else ln=hn?ms(t.stateNode.nextSibling):null;return!0}function rI(){for(var t=ln;t;)t=ms(t.nextSibling)}function ko(){ln=hn=null,He=!1}function Eg(t){Rn===null?Rn=[t]:Rn.push(t)}var IC=Pr.ReactCurrentBatchConfig;function Va(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function tu(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function K_(t){var e=t._init;return e(t._payload)}function sI(t){function e(_,v){if(t){var w=_.deletions;w===null?(_.deletions=[v],_.flags|=16):w.push(v)}}function n(_,v){if(!t)return null;for(;v!==null;)e(_,v),v=v.sibling;return null}function r(_,v){for(_=new Map;v!==null;)v.key!==null?_.set(v.key,v):_.set(v.index,v),v=v.sibling;return _}function s(_,v){return _=vs(_,v),_.index=0,_.sibling=null,_}function i(_,v,w){return _.index=w,t?(w=_.alternate,w!==null?(w=w.index,w<v?(_.flags|=2,v):w):(_.flags|=2,v)):(_.flags|=1048576,v)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function a(_,v,w,P){return v===null||v.tag!==6?(v=Lf(w,_.mode,P),v.return=_,v):(v=s(v,w),v.return=_,v)}function c(_,v,w,P){var j=w.type;return j===ro?h(_,v,w.props.children,P,w.key):v!==null&&(v.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Qr&&K_(j)===v.type)?(P=s(v,w.props),P.ref=Va(_,v,w),P.return=_,P):(P=Pu(w.type,w.key,w.props,null,_.mode,P),P.ref=Va(_,v,w),P.return=_,P)}function d(_,v,w,P){return v===null||v.tag!==4||v.stateNode.containerInfo!==w.containerInfo||v.stateNode.implementation!==w.implementation?(v=Ff(w,_.mode,P),v.return=_,v):(v=s(v,w.children||[]),v.return=_,v)}function h(_,v,w,P,j){return v===null||v.tag!==7?(v=ui(w,_.mode,P,j),v.return=_,v):(v=s(v,w),v.return=_,v)}function m(_,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Lf(""+v,_.mode,w),v.return=_,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case qc:return w=Pu(v.type,v.key,v.props,null,_.mode,w),w.ref=Va(_,null,v),w.return=_,w;case no:return v=Ff(v,_.mode,w),v.return=_,v;case Qr:var P=v._init;return m(_,P(v._payload),w)}if(Wa(v)||ka(v))return v=ui(v,_.mode,w,null),v.return=_,v;tu(_,v)}return null}function p(_,v,w,P){var j=v!==null?v.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return j!==null?null:a(_,v,""+w,P);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case qc:return w.key===j?c(_,v,w,P):null;case no:return w.key===j?d(_,v,w,P):null;case Qr:return j=w._init,p(_,v,j(w._payload),P)}if(Wa(w)||ka(w))return j!==null?null:h(_,v,w,P,null);tu(_,w)}return null}function x(_,v,w,P,j){if(typeof P=="string"&&P!==""||typeof P=="number")return _=_.get(w)||null,a(v,_,""+P,j);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case qc:return _=_.get(P.key===null?w:P.key)||null,c(v,_,P,j);case no:return _=_.get(P.key===null?w:P.key)||null,d(v,_,P,j);case Qr:var L=P._init;return x(_,v,w,L(P._payload),j)}if(Wa(P)||ka(P))return _=_.get(w)||null,h(v,_,P,j,null);tu(v,P)}return null}function A(_,v,w,P){for(var j=null,L=null,E=v,y=v=0,b=null;E!==null&&y<w.length;y++){E.index>y?(b=E,E=null):b=E.sibling;var N=p(_,E,w[y],P);if(N===null){E===null&&(E=b);break}t&&E&&N.alternate===null&&e(_,E),v=i(N,v,y),L===null?j=N:L.sibling=N,L=N,E=b}if(y===w.length)return n(_,E),He&&Ys(_,y),j;if(E===null){for(;y<w.length;y++)E=m(_,w[y],P),E!==null&&(v=i(E,v,y),L===null?j=E:L.sibling=E,L=E);return He&&Ys(_,y),j}for(E=r(_,E);y<w.length;y++)b=x(E,_,y,w[y],P),b!==null&&(t&&b.alternate!==null&&E.delete(b.key===null?y:b.key),v=i(b,v,y),L===null?j=b:L.sibling=b,L=b);return t&&E.forEach(function(I){return e(_,I)}),He&&Ys(_,y),j}function C(_,v,w,P){var j=ka(w);if(typeof j!="function")throw Error(H(150));if(w=j.call(w),w==null)throw Error(H(151));for(var L=j=null,E=v,y=v=0,b=null,N=w.next();E!==null&&!N.done;y++,N=w.next()){E.index>y?(b=E,E=null):b=E.sibling;var I=p(_,E,N.value,P);if(I===null){E===null&&(E=b);break}t&&E&&I.alternate===null&&e(_,E),v=i(I,v,y),L===null?j=I:L.sibling=I,L=I,E=b}if(N.done)return n(_,E),He&&Ys(_,y),j;if(E===null){for(;!N.done;y++,N=w.next())N=m(_,N.value,P),N!==null&&(v=i(N,v,y),L===null?j=N:L.sibling=N,L=N);return He&&Ys(_,y),j}for(E=r(_,E);!N.done;y++,N=w.next())N=x(E,_,y,N.value,P),N!==null&&(t&&N.alternate!==null&&E.delete(N.key===null?y:N.key),v=i(N,v,y),L===null?j=N:L.sibling=N,L=N);return t&&E.forEach(function(R){return e(_,R)}),He&&Ys(_,y),j}function k(_,v,w,P){if(typeof w=="object"&&w!==null&&w.type===ro&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case qc:e:{for(var j=w.key,L=v;L!==null;){if(L.key===j){if(j=w.type,j===ro){if(L.tag===7){n(_,L.sibling),v=s(L,w.props.children),v.return=_,_=v;break e}}else if(L.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Qr&&K_(j)===L.type){n(_,L.sibling),v=s(L,w.props),v.ref=Va(_,L,w),v.return=_,_=v;break e}n(_,L);break}else e(_,L);L=L.sibling}w.type===ro?(v=ui(w.props.children,_.mode,P,w.key),v.return=_,_=v):(P=Pu(w.type,w.key,w.props,null,_.mode,P),P.ref=Va(_,v,w),P.return=_,_=P)}return o(_);case no:e:{for(L=w.key;v!==null;){if(v.key===L)if(v.tag===4&&v.stateNode.containerInfo===w.containerInfo&&v.stateNode.implementation===w.implementation){n(_,v.sibling),v=s(v,w.children||[]),v.return=_,_=v;break e}else{n(_,v);break}else e(_,v);v=v.sibling}v=Ff(w,_.mode,P),v.return=_,_=v}return o(_);case Qr:return L=w._init,k(_,v,L(w._payload),P)}if(Wa(w))return A(_,v,w,P);if(ka(w))return C(_,v,w,P);tu(_,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,v!==null&&v.tag===6?(n(_,v.sibling),v=s(v,w),v.return=_,_=v):(n(_,v),v=Lf(w,_.mode,P),v.return=_,_=v),o(_)):n(_,v)}return k}var Ro=sI(!0),iI=sI(!1),cd=Vs(null),ud=null,ho=null,Ig=null;function Tg(){Ig=ho=ud=null}function bg(t){var e=cd.current;$e(cd),t._currentValue=e}function Qm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function wo(t,e){ud=t,Ig=ho=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Yt=!0),t.firstContext=null)}function Tn(t){var e=t._currentValue;if(Ig!==t)if(t={context:t,memoizedValue:e,next:null},ho===null){if(ud===null)throw Error(H(308));ho=t,ud.dependencies={lanes:0,firstContext:t}}else ho=ho.next=t;return e}var oi=null;function Sg(t){oi===null?oi=[t]:oi.push(t)}function oI(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Sg(e)):(n.next=s.next,s.next=n),e.interleaved=n,Er(t,r)}function Er(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Yr=!1;function Ag(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function aI(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function yr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ps(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Se&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Er(t,n)}return s=r.interleaved,s===null?(e.next=e,Sg(r)):(e.next=s.next,s.next=e),r.interleaved=e,Er(t,n)}function Su(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hg(t,n)}}function W_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function dd(t,e,n,r){var s=t.updateQueue;Yr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,h=d=c=null,a=i;do{var p=a.lane,x=a.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:x,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=t,C=a;switch(p=e,x=n,C.tag){case 1:if(A=C.payload,typeof A=="function"){m=A.call(x,m,p);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=C.payload,p=typeof A=="function"?A.call(x,m,p):A,p==null)break e;m=Xe({},m,p);break e;case 2:Yr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else x={eventTime:x,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=x,c=m):h=h.next=x,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(h===null&&(c=m),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);vi|=o,t.lanes=o,t.memoizedState=m}}function Q_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var uc={},nr=Vs(uc),Ml=Vs(uc),Ll=Vs(uc);function ai(t){if(t===uc)throw Error(H(174));return t}function Ng(t,e){switch(Le(Ll,e),Le(Ml,t),Le(nr,uc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Cm(e,t)}$e(nr),Le(nr,e)}function Po(){$e(nr),$e(Ml),$e(Ll)}function lI(t){ai(Ll.current);var e=ai(nr.current),n=Cm(e,t.type);e!==n&&(Le(Ml,t),Le(nr,n))}function Cg(t){Ml.current===t&&($e(nr),$e(Ml))}var We=Vs(0);function hd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pf=[];function kg(){for(var t=0;t<Pf.length;t++)Pf[t]._workInProgressVersionPrimary=null;Pf.length=0}var Au=Pr.ReactCurrentDispatcher,Df=Pr.ReactCurrentBatchConfig,yi=0,Je=null,dt=null,wt=null,fd=!1,cl=!1,Fl=0,TC=0;function Rt(){throw Error(H(321))}function Rg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Mn(t[n],e[n]))return!1;return!0}function Pg(t,e,n,r,s,i){if(yi=i,Je=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Au.current=t===null||t.memoizedState===null?NC:CC,t=n(r,s),cl){i=0;do{if(cl=!1,Fl=0,25<=i)throw Error(H(301));i+=1,wt=dt=null,e.updateQueue=null,Au.current=kC,t=n(r,s)}while(cl)}if(Au.current=md,e=dt!==null&&dt.next!==null,yi=0,wt=dt=Je=null,fd=!1,e)throw Error(H(300));return t}function Dg(){var t=Fl!==0;return Fl=0,t}function Kn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?Je.memoizedState=wt=t:wt=wt.next=t,wt}function bn(){if(dt===null){var t=Je.alternate;t=t!==null?t.memoizedState:null}else t=dt.next;var e=wt===null?Je.memoizedState:wt.next;if(e!==null)wt=e,dt=t;else{if(t===null)throw Error(H(310));dt=t,t={memoizedState:dt.memoizedState,baseState:dt.baseState,baseQueue:dt.baseQueue,queue:dt.queue,next:null},wt===null?Je.memoizedState=wt=t:wt=wt.next=t}return wt}function Ul(t,e){return typeof e=="function"?e(t):e}function jf(t){var e=bn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=dt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,d=i;do{var h=d.lane;if((yi&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=m,o=r):c=c.next=m,Je.lanes|=h,vi|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=a,Mn(r,e.memoizedState)||(Yt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Je.lanes|=i,vi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Vf(t){var e=bn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Mn(i,e.memoizedState)||(Yt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function cI(){}function uI(t,e){var n=Je,r=bn(),s=e(),i=!Mn(r.memoizedState,s);if(i&&(r.memoizedState=s,Yt=!0),r=r.queue,jg(fI.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||wt!==null&&wt.memoizedState.tag&1){if(n.flags|=2048,zl(9,hI.bind(null,n,r,s,e),void 0,null),Et===null)throw Error(H(349));yi&30||dI(n,e,s)}return s}function dI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Je.updateQueue,e===null?(e={lastEffect:null,stores:null},Je.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function hI(t,e,n,r){e.value=n,e.getSnapshot=r,mI(e)&&pI(t)}function fI(t,e,n){return n(function(){mI(e)&&pI(t)})}function mI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Mn(t,n)}catch{return!0}}function pI(t){var e=Er(t,1);e!==null&&jn(e,t,1,-1)}function Y_(t){var e=Kn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ul,lastRenderedState:t},e.queue=t,t=t.dispatch=AC.bind(null,Je,t),[e.memoizedState,t]}function zl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Je.updateQueue,e===null?(e={lastEffect:null,stores:null},Je.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function gI(){return bn().memoizedState}function Nu(t,e,n,r){var s=Kn();Je.flags|=t,s.memoizedState=zl(1|e,n,void 0,r===void 0?null:r)}function oh(t,e,n,r){var s=bn();r=r===void 0?null:r;var i=void 0;if(dt!==null){var o=dt.memoizedState;if(i=o.destroy,r!==null&&Rg(r,o.deps)){s.memoizedState=zl(e,n,i,r);return}}Je.flags|=t,s.memoizedState=zl(1|e,n,i,r)}function J_(t,e){return Nu(8390656,8,t,e)}function jg(t,e){return oh(2048,8,t,e)}function yI(t,e){return oh(4,2,t,e)}function vI(t,e){return oh(4,4,t,e)}function _I(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function xI(t,e,n){return n=n!=null?n.concat([t]):null,oh(4,4,_I.bind(null,e,t),n)}function Vg(){}function wI(t,e){var n=bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Rg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function EI(t,e){var n=bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Rg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function II(t,e,n){return yi&21?(Mn(n,e)||(n=NE(),Je.lanes|=n,vi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Yt=!0),t.memoizedState=n)}function bC(t,e){var n=De;De=n!==0&&4>n?n:4,t(!0);var r=Df.transition;Df.transition={};try{t(!1),e()}finally{De=n,Df.transition=r}}function TI(){return bn().memoizedState}function SC(t,e,n){var r=ys(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},bI(t))SI(e,n);else if(n=oI(t,e,n,r),n!==null){var s=$t();jn(n,t,r,s),AI(n,e,r)}}function AC(t,e,n){var r=ys(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(bI(t))SI(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Mn(a,o)){var c=e.interleaved;c===null?(s.next=s,Sg(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=oI(t,e,s,r),n!==null&&(s=$t(),jn(n,t,r,s),AI(n,e,r))}}function bI(t){var e=t.alternate;return t===Je||e!==null&&e===Je}function SI(t,e){cl=fd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function AI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,hg(t,n)}}var md={readContext:Tn,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},NC={readContext:Tn,useCallback:function(t,e){return Kn().memoizedState=[t,e===void 0?null:e],t},useContext:Tn,useEffect:J_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Nu(4194308,4,_I.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Nu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Nu(4,2,t,e)},useMemo:function(t,e){var n=Kn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Kn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=SC.bind(null,Je,t),[r.memoizedState,t]},useRef:function(t){var e=Kn();return t={current:t},e.memoizedState=t},useState:Y_,useDebugValue:Vg,useDeferredValue:function(t){return Kn().memoizedState=t},useTransition:function(){var t=Y_(!1),e=t[0];return t=bC.bind(null,t[1]),Kn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Je,s=Kn();if(He){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),Et===null)throw Error(H(349));yi&30||dI(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,J_(fI.bind(null,r,i,t),[t]),r.flags|=2048,zl(9,hI.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Kn(),e=Et.identifierPrefix;if(He){var n=fr,r=hr;n=(r&~(1<<32-Dn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Fl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=TC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},CC={readContext:Tn,useCallback:wI,useContext:Tn,useEffect:jg,useImperativeHandle:xI,useInsertionEffect:yI,useLayoutEffect:vI,useMemo:EI,useReducer:jf,useRef:gI,useState:function(){return jf(Ul)},useDebugValue:Vg,useDeferredValue:function(t){var e=bn();return II(e,dt.memoizedState,t)},useTransition:function(){var t=jf(Ul)[0],e=bn().memoizedState;return[t,e]},useMutableSource:cI,useSyncExternalStore:uI,useId:TI,unstable_isNewReconciler:!1},kC={readContext:Tn,useCallback:wI,useContext:Tn,useEffect:jg,useImperativeHandle:xI,useInsertionEffect:yI,useLayoutEffect:vI,useMemo:EI,useReducer:Vf,useRef:gI,useState:function(){return Vf(Ul)},useDebugValue:Vg,useDeferredValue:function(t){var e=bn();return dt===null?e.memoizedState=t:II(e,dt.memoizedState,t)},useTransition:function(){var t=Vf(Ul)[0],e=bn().memoizedState;return[t,e]},useMutableSource:cI,useSyncExternalStore:uI,useId:TI,unstable_isNewReconciler:!1};function Nn(t,e){if(t&&t.defaultProps){e=Xe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ym(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Xe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ah={isMounted:function(t){return(t=t._reactInternals)?Di(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=$t(),s=ys(t),i=yr(r,s);i.payload=e,n!=null&&(i.callback=n),e=ps(t,i,s),e!==null&&(jn(e,t,s,r),Su(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=$t(),s=ys(t),i=yr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ps(t,i,s),e!==null&&(jn(e,t,s,r),Su(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=$t(),r=ys(t),s=yr(n,r);s.tag=2,e!=null&&(s.callback=e),e=ps(t,s,r),e!==null&&(jn(e,t,r,n),Su(e,t,r))}};function X_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Dl(n,r)||!Dl(s,i):!0}function NI(t,e,n){var r=!1,s=Ss,i=e.contextType;return typeof i=="object"&&i!==null?i=Tn(i):(s=tn(e)?pi:Ft.current,r=e.contextTypes,i=(r=r!=null)?Co(t,s):Ss),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ah,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Z_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ah.enqueueReplaceState(e,e.state,null)}function Jm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Ag(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Tn(i):(i=tn(e)?pi:Ft.current,s.context=Co(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Ym(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&ah.enqueueReplaceState(s,s.state,null),dd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Do(t,e){try{var n="",r=e;do n+=sN(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Of(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Xm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var RC=typeof WeakMap=="function"?WeakMap:Map;function CI(t,e,n){n=yr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){gd||(gd=!0,lp=r),Xm(t,e)},n}function kI(t,e,n){n=yr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Xm(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Xm(t,e),typeof r!="function"&&(gs===null?gs=new Set([this]):gs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function e0(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new RC;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=HC.bind(null,t,e,n),e.then(t,t))}function t0(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function n0(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=yr(-1,1),e.tag=2,ps(n,e,1))),n.lanes|=1),t)}var PC=Pr.ReactCurrentOwner,Yt=!1;function Bt(t,e,n,r){e.child=t===null?iI(e,null,n,r):Ro(e,t.child,n,r)}function r0(t,e,n,r,s){n=n.render;var i=e.ref;return wo(e,s),r=Pg(t,e,n,r,i,s),n=Dg(),t!==null&&!Yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ir(t,e,s)):(He&&n&&xg(e),e.flags|=1,Bt(t,e,r,s),e.child)}function s0(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!$g(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,RI(t,e,i,r,s)):(t=Pu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Dl,n(o,r)&&t.ref===e.ref)return Ir(t,e,s)}return e.flags|=1,t=vs(i,r),t.ref=e.ref,t.return=e,e.child=t}function RI(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Dl(i,r)&&t.ref===e.ref)if(Yt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Yt=!0);else return e.lanes=t.lanes,Ir(t,e,s)}return Zm(t,e,n,r,s)}function PI(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Le(mo,sn),sn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Le(mo,sn),sn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Le(mo,sn),sn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Le(mo,sn),sn|=r;return Bt(t,e,s,n),e.child}function DI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Zm(t,e,n,r,s){var i=tn(n)?pi:Ft.current;return i=Co(e,i),wo(e,s),n=Pg(t,e,n,r,i,s),r=Dg(),t!==null&&!Yt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ir(t,e,s)):(He&&r&&xg(e),e.flags|=1,Bt(t,e,n,s),e.child)}function i0(t,e,n,r,s){if(tn(n)){var i=!0;od(e)}else i=!1;if(wo(e,s),e.stateNode===null)Cu(t,e),NI(e,n,r),Jm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Tn(d):(d=tn(n)?pi:Ft.current,d=Co(e,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==d)&&Z_(e,o,r,d),Yr=!1;var p=e.memoizedState;o.state=p,dd(e,r,o,s),c=e.memoizedState,a!==r||p!==c||en.current||Yr?(typeof h=="function"&&(Ym(e,n,h,r),c=e.memoizedState),(a=Yr||X_(e,n,a,r,p,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,aI(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:Nn(e.type,a),o.props=d,m=e.pendingProps,p=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Tn(c):(c=tn(n)?pi:Ft.current,c=Co(e,c));var x=n.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||p!==c)&&Z_(e,o,r,c),Yr=!1,p=e.memoizedState,o.state=p,dd(e,r,o,s);var A=e.memoizedState;a!==m||p!==A||en.current||Yr?(typeof x=="function"&&(Ym(e,n,x,r),A=e.memoizedState),(d=Yr||X_(e,n,d,r,p,A,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return ep(t,e,n,r,i,s)}function ep(t,e,n,r,s,i){DI(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&q_(e,n,!1),Ir(t,e,i);r=e.stateNode,PC.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ro(e,t.child,null,i),e.child=Ro(e,null,a,i)):Bt(t,e,a,i),e.memoizedState=r.state,s&&q_(e,n,!0),e.child}function jI(t){var e=t.stateNode;e.pendingContext?$_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$_(t,e.context,!1),Ng(t,e.containerInfo)}function o0(t,e,n,r,s){return ko(),Eg(s),e.flags|=256,Bt(t,e,n,r),e.child}var tp={dehydrated:null,treeContext:null,retryLane:0};function np(t){return{baseLanes:t,cachePool:null,transitions:null}}function VI(t,e,n){var r=e.pendingProps,s=We.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Le(We,s&1),t===null)return Wm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=uh(o,r,0,null),t=ui(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=np(n),e.memoizedState=tp,t):Og(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return DC(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=vs(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=vs(a,i):(i=ui(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?np(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=tp,r}return i=t.child,t=i.sibling,r=vs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Og(t,e){return e=uh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function nu(t,e,n,r){return r!==null&&Eg(r),Ro(e,t.child,null,n),t=Og(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function DC(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=Of(Error(H(422))),nu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=uh({mode:"visible",children:r.children},s,0,null),i=ui(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ro(e,t.child,null,o),e.child.memoizedState=np(o),e.memoizedState=tp,i);if(!(e.mode&1))return nu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(H(419)),r=Of(i,r,void 0),nu(t,e,o,r)}if(a=(o&t.childLanes)!==0,Yt||a){if(r=Et,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Er(t,s),jn(r,t,s,-1))}return Bg(),r=Of(Error(H(421))),nu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=GC.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,ln=ms(s.nextSibling),hn=e,He=!0,Rn=null,t!==null&&(vn[_n++]=hr,vn[_n++]=fr,vn[_n++]=gi,hr=t.id,fr=t.overflow,gi=e),e=Og(e,r.children),e.flags|=4096,e)}function a0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Qm(t.return,e,n)}function Mf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function OI(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Bt(t,e,r.children,n),r=We.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&a0(t,n,e);else if(t.tag===19)a0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Le(We,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&hd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Mf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&hd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Mf(e,!0,n,null,i);break;case"together":Mf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Cu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ir(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),vi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=vs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function jC(t,e,n){switch(e.tag){case 3:jI(e),ko();break;case 5:lI(e);break;case 1:tn(e.type)&&od(e);break;case 4:Ng(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Le(cd,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Le(We,We.current&1),e.flags|=128,null):n&e.child.childLanes?VI(t,e,n):(Le(We,We.current&1),t=Ir(t,e,n),t!==null?t.sibling:null);Le(We,We.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return OI(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Le(We,We.current),r)break;return null;case 22:case 23:return e.lanes=0,PI(t,e,n)}return Ir(t,e,n)}var MI,rp,LI,FI;MI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};rp=function(){};LI=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ai(nr.current);var i=null;switch(n){case"input":s=bm(t,s),r=bm(t,r),i=[];break;case"select":s=Xe({},s,{value:void 0}),r=Xe({},r,{value:void 0}),i=[];break;case"textarea":s=Nm(t,s),r=Nm(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=sd)}km(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Sl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Sl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Be("scroll",t),i||a===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};FI=function(t,e,n,r){n!==r&&(e.flags|=4)};function Oa(t,e){if(!He)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Pt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function VC(t,e,n){var r=e.pendingProps;switch(wg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(e),null;case 1:return tn(e.type)&&id(),Pt(e),null;case 3:return r=e.stateNode,Po(),$e(en),$e(Ft),kg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(eu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rn!==null&&(dp(Rn),Rn=null))),rp(t,e),Pt(e),null;case 5:Cg(e);var s=ai(Ll.current);if(n=e.type,t!==null&&e.stateNode!=null)LI(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return Pt(e),null}if(t=ai(nr.current),eu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Yn]=e,r[Ol]=i,t=(e.mode&1)!==0,n){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(s=0;s<Ya.length;s++)Be(Ya[s],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":g_(r,i),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Be("invalid",r);break;case"textarea":v_(r,i),Be("invalid",r)}km(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Zc(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Zc(r.textContent,a,t),s=["children",""+a]):Sl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Be("scroll",r)}switch(n){case"input":Hc(r),y_(r,i,!0);break;case"textarea":Hc(r),__(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=sd)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=fE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Yn]=e,t[Ol]=r,MI(t,e,!1,!1),e.stateNode=t;e:{switch(o=Rm(n,r),n){case"dialog":Be("cancel",t),Be("close",t),s=r;break;case"iframe":case"object":case"embed":Be("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ya.length;s++)Be(Ya[s],t);s=r;break;case"source":Be("error",t),s=r;break;case"img":case"image":case"link":Be("error",t),Be("load",t),s=r;break;case"details":Be("toggle",t),s=r;break;case"input":g_(t,r),s=bm(t,r),Be("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Xe({},r,{value:void 0}),Be("invalid",t);break;case"textarea":v_(t,r),s=Nm(t,r),Be("invalid",t);break;default:s=r}km(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?gE(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&mE(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Al(t,c):typeof c=="number"&&Al(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Sl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Be("scroll",t):c!=null&&og(t,i,c,o))}switch(n){case"input":Hc(t),y_(t,r,!1);break;case"textarea":Hc(t),__(t);break;case"option":r.value!=null&&t.setAttribute("value",""+bs(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?yo(t,!!r.multiple,i,!1):r.defaultValue!=null&&yo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=sd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Pt(e),null;case 6:if(t&&e.stateNode!=null)FI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=ai(Ll.current),ai(nr.current),eu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Yn]=e,(i=r.nodeValue!==n)&&(t=hn,t!==null))switch(t.tag){case 3:Zc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Zc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Yn]=e,e.stateNode=r}return Pt(e),null;case 13:if($e(We),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(He&&ln!==null&&e.mode&1&&!(e.flags&128))rI(),ko(),e.flags|=98560,i=!1;else if(i=eu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Yn]=e}else ko(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Pt(e),i=!1}else Rn!==null&&(dp(Rn),Rn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||We.current&1?ft===0&&(ft=3):Bg())),e.updateQueue!==null&&(e.flags|=4),Pt(e),null);case 4:return Po(),rp(t,e),t===null&&jl(e.stateNode.containerInfo),Pt(e),null;case 10:return bg(e.type._context),Pt(e),null;case 17:return tn(e.type)&&id(),Pt(e),null;case 19:if($e(We),i=e.memoizedState,i===null)return Pt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Oa(i,!1);else{if(ft!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=hd(t),o!==null){for(e.flags|=128,Oa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Le(We,We.current&1|2),e.child}t=t.sibling}i.tail!==null&&st()>jo&&(e.flags|=128,r=!0,Oa(i,!1),e.lanes=4194304)}else{if(!r)if(t=hd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Oa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!He)return Pt(e),null}else 2*st()-i.renderingStartTime>jo&&n!==1073741824&&(e.flags|=128,r=!0,Oa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=st(),e.sibling=null,n=We.current,Le(We,r?n&1|2:n&1),e):(Pt(e),null);case 22:case 23:return zg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?sn&1073741824&&(Pt(e),e.subtreeFlags&6&&(e.flags|=8192)):Pt(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function OC(t,e){switch(wg(e),e.tag){case 1:return tn(e.type)&&id(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Po(),$e(en),$e(Ft),kg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Cg(e),null;case 13:if($e(We),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));ko()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return $e(We),null;case 4:return Po(),null;case 10:return bg(e.type._context),null;case 22:case 23:return zg(),null;case 24:return null;default:return null}}var ru=!1,Ot=!1,MC=typeof WeakSet=="function"?WeakSet:Set,re=null;function fo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){et(t,e,r)}else n.current=null}function sp(t,e,n){try{n()}catch(r){et(t,e,r)}}var l0=!1;function LC(t,e){if(zm=td,t=qE(),_g(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,d=0,h=0,m=t,p=null;t:for(;;){for(var x;m!==n||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)p=m,m=x;for(;;){if(m===t)break t;if(p===n&&++d===s&&(a=o),p===i&&++h===r&&(c=o),(x=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=x}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bm={focusedElem:t,selectionRange:n},td=!1,re=e;re!==null;)if(e=re,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,re=t;else for(;re!==null;){e=re;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var C=A.memoizedProps,k=A.memoizedState,_=e.stateNode,v=_.getSnapshotBeforeUpdate(e.elementType===e.type?C:Nn(e.type,C),k);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(P){et(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,re=t;break}re=e.return}return A=l0,l0=!1,A}function ul(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&sp(e,n,i)}s=s.next}while(s!==r)}}function lh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function ip(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function UI(t){var e=t.alternate;e!==null&&(t.alternate=null,UI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Yn],delete e[Ol],delete e[Hm],delete e[xC],delete e[wC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function zI(t){return t.tag===5||t.tag===3||t.tag===4}function c0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||zI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function op(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=sd));else if(r!==4&&(t=t.child,t!==null))for(op(t,e,n),t=t.sibling;t!==null;)op(t,e,n),t=t.sibling}function ap(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(ap(t,e,n),t=t.sibling;t!==null;)ap(t,e,n),t=t.sibling}var Tt=null,Cn=!1;function qr(t,e,n){for(n=n.child;n!==null;)BI(t,e,n),n=n.sibling}function BI(t,e,n){if(tr&&typeof tr.onCommitFiberUnmount=="function")try{tr.onCommitFiberUnmount(eh,n)}catch{}switch(n.tag){case 5:Ot||fo(n,e);case 6:var r=Tt,s=Cn;Tt=null,qr(t,e,n),Tt=r,Cn=s,Tt!==null&&(Cn?(t=Tt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Tt.removeChild(n.stateNode));break;case 18:Tt!==null&&(Cn?(t=Tt,n=n.stateNode,t.nodeType===8?kf(t.parentNode,n):t.nodeType===1&&kf(t,n),Rl(t)):kf(Tt,n.stateNode));break;case 4:r=Tt,s=Cn,Tt=n.stateNode.containerInfo,Cn=!0,qr(t,e,n),Tt=r,Cn=s;break;case 0:case 11:case 14:case 15:if(!Ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&sp(n,e,o),s=s.next}while(s!==r)}qr(t,e,n);break;case 1:if(!Ot&&(fo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){et(n,e,a)}qr(t,e,n);break;case 21:qr(t,e,n);break;case 22:n.mode&1?(Ot=(r=Ot)||n.memoizedState!==null,qr(t,e,n),Ot=r):qr(t,e,n);break;default:qr(t,e,n)}}function u0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new MC),e.forEach(function(r){var s=KC.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function An(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Tt=a.stateNode,Cn=!1;break e;case 3:Tt=a.stateNode.containerInfo,Cn=!0;break e;case 4:Tt=a.stateNode.containerInfo,Cn=!0;break e}a=a.return}if(Tt===null)throw Error(H(160));BI(i,o,s),Tt=null,Cn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){et(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)$I(e,t),e=e.sibling}function $I(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(An(e,t),Gn(t),r&4){try{ul(3,t,t.return),lh(3,t)}catch(C){et(t,t.return,C)}try{ul(5,t,t.return)}catch(C){et(t,t.return,C)}}break;case 1:An(e,t),Gn(t),r&512&&n!==null&&fo(n,n.return);break;case 5:if(An(e,t),Gn(t),r&512&&n!==null&&fo(n,n.return),t.flags&32){var s=t.stateNode;try{Al(s,"")}catch(C){et(t,t.return,C)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&dE(s,i),Rm(a,o);var d=Rm(a,i);for(o=0;o<c.length;o+=2){var h=c[o],m=c[o+1];h==="style"?gE(s,m):h==="dangerouslySetInnerHTML"?mE(s,m):h==="children"?Al(s,m):og(s,h,m,d)}switch(a){case"input":Sm(s,i);break;case"textarea":hE(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?yo(s,!!i.multiple,x,!1):p!==!!i.multiple&&(i.defaultValue!=null?yo(s,!!i.multiple,i.defaultValue,!0):yo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ol]=i}catch(C){et(t,t.return,C)}}break;case 6:if(An(e,t),Gn(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(C){et(t,t.return,C)}}break;case 3:if(An(e,t),Gn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Rl(e.containerInfo)}catch(C){et(t,t.return,C)}break;case 4:An(e,t),Gn(t);break;case 13:An(e,t),Gn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Fg=st())),r&4&&u0(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Ot=(d=Ot)||h,An(e,t),Ot=d):An(e,t),Gn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(re=t,h=t.child;h!==null;){for(m=re=h;re!==null;){switch(p=re,x=p.child,p.tag){case 0:case 11:case 14:case 15:ul(4,p,p.return);break;case 1:fo(p,p.return);var A=p.stateNode;if(typeof A.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(C){et(r,n,C)}}break;case 5:fo(p,p.return);break;case 22:if(p.memoizedState!==null){h0(m);continue}}x!==null?(x.return=p,re=x):h0(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=pE("display",o))}catch(C){et(t,t.return,C)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(C){et(t,t.return,C)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:An(e,t),Gn(t),r&4&&u0(t);break;case 21:break;default:An(e,t),Gn(t)}}function Gn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(zI(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Al(s,""),r.flags&=-33);var i=c0(t);ap(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=c0(t);op(t,a,o);break;default:throw Error(H(161))}}catch(c){et(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function FC(t,e,n){re=t,qI(t)}function qI(t,e,n){for(var r=(t.mode&1)!==0;re!==null;){var s=re,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||ru;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Ot;a=ru;var d=Ot;if(ru=o,(Ot=c)&&!d)for(re=s;re!==null;)o=re,c=o.child,o.tag===22&&o.memoizedState!==null?f0(s):c!==null?(c.return=o,re=c):f0(s);for(;i!==null;)re=i,qI(i),i=i.sibling;re=s,ru=a,Ot=d}d0(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,re=i):d0(t)}}function d0(t){for(;re!==null;){var e=re;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ot||lh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ot)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Nn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Q_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Q_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Rl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Ot||e.flags&512&&ip(e)}catch(p){et(e,e.return,p)}}if(e===t){re=null;break}if(n=e.sibling,n!==null){n.return=e.return,re=n;break}re=e.return}}function h0(t){for(;re!==null;){var e=re;if(e===t){re=null;break}var n=e.sibling;if(n!==null){n.return=e.return,re=n;break}re=e.return}}function f0(t){for(;re!==null;){var e=re;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{lh(4,e)}catch(c){et(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){et(e,s,c)}}var i=e.return;try{ip(e)}catch(c){et(e,i,c)}break;case 5:var o=e.return;try{ip(e)}catch(c){et(e,o,c)}}}catch(c){et(e,e.return,c)}if(e===t){re=null;break}var a=e.sibling;if(a!==null){a.return=e.return,re=a;break}re=e.return}}var UC=Math.ceil,pd=Pr.ReactCurrentDispatcher,Mg=Pr.ReactCurrentOwner,En=Pr.ReactCurrentBatchConfig,Se=0,Et=null,lt=null,Nt=0,sn=0,mo=Vs(0),ft=0,Bl=null,vi=0,ch=0,Lg=0,dl=null,Wt=null,Fg=0,jo=1/0,ur=null,gd=!1,lp=null,gs=null,su=!1,ls=null,yd=0,hl=0,cp=null,ku=-1,Ru=0;function $t(){return Se&6?st():ku!==-1?ku:ku=st()}function ys(t){return t.mode&1?Se&2&&Nt!==0?Nt&-Nt:IC.transition!==null?(Ru===0&&(Ru=NE()),Ru):(t=De,t!==0||(t=window.event,t=t===void 0?16:VE(t.type)),t):1}function jn(t,e,n,r){if(50<hl)throw hl=0,cp=null,Error(H(185));ac(t,n,r),(!(Se&2)||t!==Et)&&(t===Et&&(!(Se&2)&&(ch|=n),ft===4&&Xr(t,Nt)),nn(t,r),n===1&&Se===0&&!(e.mode&1)&&(jo=st()+500,ih&&Os()))}function nn(t,e){var n=t.callbackNode;IN(t,e);var r=ed(t,t===Et?Nt:0);if(r===0)n!==null&&E_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&E_(n),e===1)t.tag===0?EC(m0.bind(null,t)):eI(m0.bind(null,t)),vC(function(){!(Se&6)&&Os()}),n=null;else{switch(CE(r)){case 1:n=dg;break;case 4:n=SE;break;case 16:n=Zu;break;case 536870912:n=AE;break;default:n=Zu}n=XI(n,HI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function HI(t,e){if(ku=-1,Ru=0,Se&6)throw Error(H(327));var n=t.callbackNode;if(Eo()&&t.callbackNode!==n)return null;var r=ed(t,t===Et?Nt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=vd(t,r);else{e=r;var s=Se;Se|=2;var i=KI();(Et!==t||Nt!==e)&&(ur=null,jo=st()+500,ci(t,e));do try{$C();break}catch(a){GI(t,a)}while(!0);Tg(),pd.current=i,Se=s,lt!==null?e=0:(Et=null,Nt=0,e=ft)}if(e!==0){if(e===2&&(s=Om(t),s!==0&&(r=s,e=up(t,s))),e===1)throw n=Bl,ci(t,0),Xr(t,r),nn(t,st()),n;if(e===6)Xr(t,r);else{if(s=t.current.alternate,!(r&30)&&!zC(s)&&(e=vd(t,r),e===2&&(i=Om(t),i!==0&&(r=i,e=up(t,i))),e===1))throw n=Bl,ci(t,0),Xr(t,r),nn(t,st()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:Js(t,Wt,ur);break;case 3:if(Xr(t,r),(r&130023424)===r&&(e=Fg+500-st(),10<e)){if(ed(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){$t(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=qm(Js.bind(null,t,Wt,ur),e);break}Js(t,Wt,ur);break;case 4:if(Xr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Dn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=st()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*UC(r/1960))-r,10<r){t.timeoutHandle=qm(Js.bind(null,t,Wt,ur),r);break}Js(t,Wt,ur);break;case 5:Js(t,Wt,ur);break;default:throw Error(H(329))}}}return nn(t,st()),t.callbackNode===n?HI.bind(null,t):null}function up(t,e){var n=dl;return t.current.memoizedState.isDehydrated&&(ci(t,e).flags|=256),t=vd(t,e),t!==2&&(e=Wt,Wt=n,e!==null&&dp(e)),t}function dp(t){Wt===null?Wt=t:Wt.push.apply(Wt,t)}function zC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Mn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xr(t,e){for(e&=~Lg,e&=~ch,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Dn(e),r=1<<n;t[n]=-1,e&=~r}}function m0(t){if(Se&6)throw Error(H(327));Eo();var e=ed(t,0);if(!(e&1))return nn(t,st()),null;var n=vd(t,e);if(t.tag!==0&&n===2){var r=Om(t);r!==0&&(e=r,n=up(t,r))}if(n===1)throw n=Bl,ci(t,0),Xr(t,e),nn(t,st()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Js(t,Wt,ur),nn(t,st()),null}function Ug(t,e){var n=Se;Se|=1;try{return t(e)}finally{Se=n,Se===0&&(jo=st()+500,ih&&Os())}}function _i(t){ls!==null&&ls.tag===0&&!(Se&6)&&Eo();var e=Se;Se|=1;var n=En.transition,r=De;try{if(En.transition=null,De=1,t)return t()}finally{De=r,En.transition=n,Se=e,!(Se&6)&&Os()}}function zg(){sn=mo.current,$e(mo)}function ci(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,yC(n)),lt!==null)for(n=lt.return;n!==null;){var r=n;switch(wg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&id();break;case 3:Po(),$e(en),$e(Ft),kg();break;case 5:Cg(r);break;case 4:Po();break;case 13:$e(We);break;case 19:$e(We);break;case 10:bg(r.type._context);break;case 22:case 23:zg()}n=n.return}if(Et=t,lt=t=vs(t.current,null),Nt=sn=e,ft=0,Bl=null,Lg=ch=vi=0,Wt=dl=null,oi!==null){for(e=0;e<oi.length;e++)if(n=oi[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}oi=null}return t}function GI(t,e){do{var n=lt;try{if(Tg(),Au.current=md,fd){for(var r=Je.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}fd=!1}if(yi=0,wt=dt=Je=null,cl=!1,Fl=0,Mg.current=null,n===null||n.return===null){ft=1,Bl=e,lt=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=Nt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=t0(o);if(x!==null){x.flags&=-257,n0(x,o,a,i,e),x.mode&1&&e0(i,d,e),e=x,c=d;var A=e.updateQueue;if(A===null){var C=new Set;C.add(c),e.updateQueue=C}else A.add(c);break e}else{if(!(e&1)){e0(i,d,e),Bg();break e}c=Error(H(426))}}else if(He&&a.mode&1){var k=t0(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),n0(k,o,a,i,e),Eg(Do(c,a));break e}}i=c=Do(c,a),ft!==4&&(ft=2),dl===null?dl=[i]:dl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var _=CI(i,c,e);W_(i,_);break e;case 1:a=c;var v=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(gs===null||!gs.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=kI(i,a,e);W_(i,P);break e}}i=i.return}while(i!==null)}QI(n)}catch(j){e=j,lt===n&&n!==null&&(lt=n=n.return);continue}break}while(!0)}function KI(){var t=pd.current;return pd.current=md,t===null?md:t}function Bg(){(ft===0||ft===3||ft===2)&&(ft=4),Et===null||!(vi&268435455)&&!(ch&268435455)||Xr(Et,Nt)}function vd(t,e){var n=Se;Se|=2;var r=KI();(Et!==t||Nt!==e)&&(ur=null,ci(t,e));do try{BC();break}catch(s){GI(t,s)}while(!0);if(Tg(),Se=n,pd.current=r,lt!==null)throw Error(H(261));return Et=null,Nt=0,ft}function BC(){for(;lt!==null;)WI(lt)}function $C(){for(;lt!==null&&!mN();)WI(lt)}function WI(t){var e=JI(t.alternate,t,sn);t.memoizedProps=t.pendingProps,e===null?QI(t):lt=e,Mg.current=null}function QI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=OC(n,e),n!==null){n.flags&=32767,lt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ft=6,lt=null;return}}else if(n=VC(n,e,sn),n!==null){lt=n;return}if(e=e.sibling,e!==null){lt=e;return}lt=e=t}while(e!==null);ft===0&&(ft=5)}function Js(t,e,n){var r=De,s=En.transition;try{En.transition=null,De=1,qC(t,e,n,r)}finally{En.transition=s,De=r}return null}function qC(t,e,n,r){do Eo();while(ls!==null);if(Se&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(TN(t,i),t===Et&&(lt=Et=null,Nt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||su||(su=!0,XI(Zu,function(){return Eo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=En.transition,En.transition=null;var o=De;De=1;var a=Se;Se|=4,Mg.current=null,LC(t,n),$I(n,t),uC(Bm),td=!!zm,Bm=zm=null,t.current=n,FC(n),pN(),Se=a,De=o,En.transition=i}else t.current=n;if(su&&(su=!1,ls=t,yd=s),i=t.pendingLanes,i===0&&(gs=null),vN(n.stateNode),nn(t,st()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(gd)throw gd=!1,t=lp,lp=null,t;return yd&1&&t.tag!==0&&Eo(),i=t.pendingLanes,i&1?t===cp?hl++:(hl=0,cp=t):hl=0,Os(),null}function Eo(){if(ls!==null){var t=CE(yd),e=En.transition,n=De;try{if(En.transition=null,De=16>t?16:t,ls===null)var r=!1;else{if(t=ls,ls=null,yd=0,Se&6)throw Error(H(331));var s=Se;for(Se|=4,re=t.current;re!==null;){var i=re,o=i.child;if(re.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(re=d;re!==null;){var h=re;switch(h.tag){case 0:case 11:case 15:ul(8,h,i)}var m=h.child;if(m!==null)m.return=h,re=m;else for(;re!==null;){h=re;var p=h.sibling,x=h.return;if(UI(h),h===d){re=null;break}if(p!==null){p.return=x,re=p;break}re=x}}}var A=i.alternate;if(A!==null){var C=A.child;if(C!==null){A.child=null;do{var k=C.sibling;C.sibling=null,C=k}while(C!==null)}}re=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,re=o;else e:for(;re!==null;){if(i=re,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ul(9,i,i.return)}var _=i.sibling;if(_!==null){_.return=i.return,re=_;break e}re=i.return}}var v=t.current;for(re=v;re!==null;){o=re;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,re=w;else e:for(o=v;re!==null;){if(a=re,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:lh(9,a)}}catch(j){et(a,a.return,j)}if(a===o){re=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,re=P;break e}re=a.return}}if(Se=s,Os(),tr&&typeof tr.onPostCommitFiberRoot=="function")try{tr.onPostCommitFiberRoot(eh,t)}catch{}r=!0}return r}finally{De=n,En.transition=e}}return!1}function p0(t,e,n){e=Do(n,e),e=CI(t,e,1),t=ps(t,e,1),e=$t(),t!==null&&(ac(t,1,e),nn(t,e))}function et(t,e,n){if(t.tag===3)p0(t,t,n);else for(;e!==null;){if(e.tag===3){p0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(gs===null||!gs.has(r))){t=Do(n,t),t=kI(e,t,1),e=ps(e,t,1),t=$t(),e!==null&&(ac(e,1,t),nn(e,t));break}}e=e.return}}function HC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=$t(),t.pingedLanes|=t.suspendedLanes&n,Et===t&&(Nt&n)===n&&(ft===4||ft===3&&(Nt&130023424)===Nt&&500>st()-Fg?ci(t,0):Lg|=n),nn(t,e)}function YI(t,e){e===0&&(t.mode&1?(e=Wc,Wc<<=1,!(Wc&130023424)&&(Wc=4194304)):e=1);var n=$t();t=Er(t,e),t!==null&&(ac(t,e,n),nn(t,n))}function GC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),YI(t,n)}function KC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),YI(t,n)}var JI;JI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||en.current)Yt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Yt=!1,jC(t,e,n);Yt=!!(t.flags&131072)}else Yt=!1,He&&e.flags&1048576&&tI(e,ld,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Cu(t,e),t=e.pendingProps;var s=Co(e,Ft.current);wo(e,n),s=Pg(null,e,r,t,s,n);var i=Dg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,tn(r)?(i=!0,od(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Ag(e),s.updater=ah,e.stateNode=s,s._reactInternals=e,Jm(e,r,t,n),e=ep(null,e,r,!0,i,n)):(e.tag=0,He&&i&&xg(e),Bt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Cu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=QC(r),t=Nn(r,t),s){case 0:e=Zm(null,e,r,t,n);break e;case 1:e=i0(null,e,r,t,n);break e;case 11:e=r0(null,e,r,t,n);break e;case 14:e=s0(null,e,r,Nn(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),Zm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),i0(t,e,r,s,n);case 3:e:{if(jI(e),t===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,aI(t,e),dd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Do(Error(H(423)),e),e=o0(t,e,r,n,s);break e}else if(r!==s){s=Do(Error(H(424)),e),e=o0(t,e,r,n,s);break e}else for(ln=ms(e.stateNode.containerInfo.firstChild),hn=e,He=!0,Rn=null,n=iI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ko(),r===s){e=Ir(t,e,n);break e}Bt(t,e,r,n)}e=e.child}return e;case 5:return lI(e),t===null&&Wm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,$m(r,s)?o=null:i!==null&&$m(r,i)&&(e.flags|=32),DI(t,e),Bt(t,e,o,n),e.child;case 6:return t===null&&Wm(e),null;case 13:return VI(t,e,n);case 4:return Ng(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ro(e,null,r,n):Bt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),r0(t,e,r,s,n);case 7:return Bt(t,e,e.pendingProps,n),e.child;case 8:return Bt(t,e,e.pendingProps.children,n),e.child;case 12:return Bt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Le(cd,r._currentValue),r._currentValue=o,i!==null)if(Mn(i.value,o)){if(i.children===s.children&&!en.current){e=Ir(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=yr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Qm(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Qm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Bt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,wo(e,n),s=Tn(s),r=r(s),e.flags|=1,Bt(t,e,r,n),e.child;case 14:return r=e.type,s=Nn(r,e.pendingProps),s=Nn(r.type,s),s0(t,e,r,s,n);case 15:return RI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Nn(r,s),Cu(t,e),e.tag=1,tn(r)?(t=!0,od(e)):t=!1,wo(e,n),NI(e,r,s),Jm(e,r,s,n),ep(null,e,r,!0,t,n);case 19:return OI(t,e,n);case 22:return PI(t,e,n)}throw Error(H(156,e.tag))};function XI(t,e){return bE(t,e)}function WC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(t,e,n,r){return new WC(t,e,n,r)}function $g(t){return t=t.prototype,!(!t||!t.isReactComponent)}function QC(t){if(typeof t=="function")return $g(t)?1:0;if(t!=null){if(t=t.$$typeof,t===lg)return 11;if(t===cg)return 14}return 2}function vs(t,e){var n=t.alternate;return n===null?(n=xn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Pu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")$g(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ro:return ui(n.children,s,i,e);case ag:o=8,s|=8;break;case wm:return t=xn(12,n,e,s|2),t.elementType=wm,t.lanes=i,t;case Em:return t=xn(13,n,e,s),t.elementType=Em,t.lanes=i,t;case Im:return t=xn(19,n,e,s),t.elementType=Im,t.lanes=i,t;case lE:return uh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case oE:o=10;break e;case aE:o=9;break e;case lg:o=11;break e;case cg:o=14;break e;case Qr:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=xn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function ui(t,e,n,r){return t=xn(7,t,r,e),t.lanes=n,t}function uh(t,e,n,r){return t=xn(22,t,r,e),t.elementType=lE,t.lanes=n,t.stateNode={isHidden:!1},t}function Lf(t,e,n){return t=xn(6,t,null,e),t.lanes=n,t}function Ff(t,e,n){return e=xn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function YC(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=_f(0),this.expirationTimes=_f(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_f(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function qg(t,e,n,r,s,i,o,a,c){return t=new YC(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=xn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ag(i),t}function JC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:no,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function ZI(t){if(!t)return Ss;t=t._reactInternals;e:{if(Di(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(tn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(tn(n))return ZE(t,n,e)}return e}function e1(t,e,n,r,s,i,o,a,c){return t=qg(n,r,!0,t,s,i,o,a,c),t.context=ZI(null),n=t.current,r=$t(),s=ys(n),i=yr(r,s),i.callback=e??null,ps(n,i,s),t.current.lanes=s,ac(t,s,r),nn(t,r),t}function dh(t,e,n,r){var s=e.current,i=$t(),o=ys(s);return n=ZI(n),e.context===null?e.context=n:e.pendingContext=n,e=yr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ps(s,e,o),t!==null&&(jn(t,s,o,i),Su(t,s,o)),o}function _d(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function g0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Hg(t,e){g0(t,e),(t=t.alternate)&&g0(t,e)}function XC(){return null}var t1=typeof reportError=="function"?reportError:function(t){console.error(t)};function Gg(t){this._internalRoot=t}hh.prototype.render=Gg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));dh(t,e,null,null)};hh.prototype.unmount=Gg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_i(function(){dh(null,t,null,null)}),e[wr]=null}};function hh(t){this._internalRoot=t}hh.prototype.unstable_scheduleHydration=function(t){if(t){var e=PE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jr.length&&e!==0&&e<Jr[n].priority;n++);Jr.splice(n,0,t),n===0&&jE(t)}};function Kg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function fh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function y0(){}function ZC(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=_d(o);i.call(d)}}var o=e1(e,r,t,0,null,!1,!1,"",y0);return t._reactRootContainer=o,t[wr]=o.current,jl(t.nodeType===8?t.parentNode:t),_i(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=_d(c);a.call(d)}}var c=qg(t,0,!1,null,null,!1,!1,"",y0);return t._reactRootContainer=c,t[wr]=c.current,jl(t.nodeType===8?t.parentNode:t),_i(function(){dh(e,c,n,r)}),c}function mh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=_d(o);a.call(c)}}dh(e,o,t,s)}else o=ZC(n,e,t,s,r);return _d(o)}kE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Qa(e.pendingLanes);n!==0&&(hg(e,n|1),nn(e,st()),!(Se&6)&&(jo=st()+500,Os()))}break;case 13:_i(function(){var r=Er(t,1);if(r!==null){var s=$t();jn(r,t,1,s)}}),Hg(t,1)}};fg=function(t){if(t.tag===13){var e=Er(t,134217728);if(e!==null){var n=$t();jn(e,t,134217728,n)}Hg(t,134217728)}};RE=function(t){if(t.tag===13){var e=ys(t),n=Er(t,e);if(n!==null){var r=$t();jn(n,t,e,r)}Hg(t,e)}};PE=function(){return De};DE=function(t,e){var n=De;try{return De=t,e()}finally{De=n}};Dm=function(t,e,n){switch(e){case"input":if(Sm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=sh(r);if(!s)throw Error(H(90));uE(r),Sm(r,s)}}}break;case"textarea":hE(t,n);break;case"select":e=n.value,e!=null&&yo(t,!!n.multiple,e,!1)}};_E=Ug;xE=_i;var ek={usingClientEntryPoint:!1,Events:[cc,ao,sh,yE,vE,Ug]},Ma={findFiberByHostInstance:ii,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},tk={bundleType:Ma.bundleType,version:Ma.version,rendererPackageName:Ma.rendererPackageName,rendererConfig:Ma.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=IE(t),t===null?null:t.stateNode},findFiberByHostInstance:Ma.findFiberByHostInstance||XC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iu.isDisabled&&iu.supportsFiber)try{eh=iu.inject(tk),tr=iu}catch{}}gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ek;gn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Kg(e))throw Error(H(200));return JC(t,e,null,n)};gn.createRoot=function(t,e){if(!Kg(t))throw Error(H(299));var n=!1,r="",s=t1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=qg(t,1,!1,null,null,n,!1,r,s),t[wr]=e.current,jl(t.nodeType===8?t.parentNode:t),new Gg(e)};gn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=IE(e),t=t===null?null:t.stateNode,t};gn.flushSync=function(t){return _i(t)};gn.hydrate=function(t,e,n){if(!fh(e))throw Error(H(200));return mh(null,t,e,!0,n)};gn.hydrateRoot=function(t,e,n){if(!Kg(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=t1;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=e1(e,null,t,1,n??null,s,!1,i,o),t[wr]=e.current,jl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new hh(e)};gn.render=function(t,e,n){if(!fh(e))throw Error(H(200));return mh(null,t,e,!1,n)};gn.unmountComponentAtNode=function(t){if(!fh(t))throw Error(H(40));return t._reactRootContainer?(_i(function(){mh(null,null,t,!1,function(){t._reactRootContainer=null,t[wr]=null})}),!0):!1};gn.unstable_batchedUpdates=Ug;gn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!fh(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return mh(t,e,n,!1,r)};gn.version="18.3.1-next-f1338f8080-20240426";function n1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n1)}catch(t){console.error(t)}}n1(),nE.exports=gn;var nk=nE.exports,v0=nk;_m.createRoot=v0.createRoot,_m.hydrateRoot=v0.hydrateRoot;const rk="modulepreload",sk=function(t){return"/"+t},_0={},ik=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=sk(c),c in _0)return;_0[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":rk,d||(m.as="script"),m.crossOrigin="",m.href=c,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((p,x)=>{m.addEventListener("load",p),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function ok(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,c;const d=async(m=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(a=await ik(async()=>{const{Workbox:m}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/sw.js",{scope:"/",type:"classic"})).catch(m=>{o==null||o(m)}),!a)return;a.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),a.addEventListener("installed",m=>{m.isUpdate||r==null||r()}),a.register({immediate:e}).then(m=>{i?i("/sw.js",m):s==null||s(m)}).catch(m=>{o==null||o(m)})}}return c=h(),d}var ak={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const lk=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ge=(t,e)=>{const n=D.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:a,...c},d)=>D.createElement("svg",{ref:d,...ak,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${lk(t)}`,...c},[...e.map(([h,m])=>D.createElement(h,m)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n},r1=ge("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),x0=ge("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Wg=ge("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),fl=ge("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),hp=ge("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),fp=ge("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ck=ge("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),s1=ge("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),uk=ge("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),i1=ge("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ph=ge("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),dk=ge("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Qg=ge("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),o1=ge("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),gh=ge("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),Uf=ge("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),hk=ge("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),w0=ge("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),fk=ge("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),mk=ge("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),a1=ge("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),pk=ge("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),gk=ge("MessageSquareDashed",[["path",{d:"M3 6V5c0-1.1.9-2 2-2h2",key:"9usibi"}],["path",{d:"M11 3h3",key:"1c3ji7"}],["path",{d:"M18 3h1c1.1 0 2 .9 2 2",key:"19esxn"}],["path",{d:"M21 9v2",key:"p14lih"}],["path",{d:"M21 15c0 1.1-.9 2-2 2h-1",key:"1fo1j8"}],["path",{d:"M14 17h-3",key:"1w4p2m"}],["path",{d:"m7 17-4 4v-5",key:"ph9x1h"}],["path",{d:"M3 12v-2",key:"856n1q"}]]),E0=ge("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),l1=ge("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),yk=ge("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),mp=ge("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),wn=ge("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),vk=ge("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),dc=ge("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),c1=ge("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),_k=ge("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),xk=ge("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),As=ge("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ns=ge("ShieldMinus",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M8 11h8",key:"vwpz6n"}]]),I0=ge("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),wk=ge("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Ek=ge("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),xd=ge("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Zr=ge("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),$l=ge("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Tr=ge("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Ik=()=>{};var T0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Tk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},d1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|a>>4;let p=(a&15)<<2|d>>6,x=d&63;c||(x=64,o||(p=64)),r.push(n[h],n[m],n[p],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(u1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Tk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||m==null)throw new bk;const p=i<<2|a>>4;if(r.push(p),d!==64){const x=a<<4&240|d>>2;if(r.push(x),m!==64){const A=d<<6&192|m;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Sk=function(t){const e=u1(t);return d1.encodeByteArray(e,!0)},wd=function(t){return Sk(t).replace(/\./g,"")},h1=function(t){try{return d1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=()=>f1().__FIREBASE_DEFAULTS__,Nk=()=>{if(typeof process>"u"||typeof T0>"u")return;const t=T0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Ck=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&h1(t[1]);return e&&JSON.parse(e)},yh=()=>{try{return Ik()||Ak()||Nk()||Ck()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},m1=t=>{var e,n;return(n=(e=yh())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},p1=t=>{const e=m1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},g1=()=>{var t;return(t=yh())==null?void 0:t.config},y1=t=>{var e;return(e=yh())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function vh(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[wd(JSON.stringify(n)),wd(JSON.stringify(o)),""].join(".")}const ml={};function Pk(){const t={prod:[],emulator:[]};for(const e of Object.keys(ml))ml[e]?t.emulator.push(e):t.prod.push(e);return t}function Dk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let b0=!1;function Yg(t,e){if(typeof window>"u"||typeof document>"u"||!ar(window.location.host)||ml[t]===e||ml[t]||b0)return;ml[t]=e;function n(p){return`__firebase__banner__${p}`}const r="__firebase__banner",i=Pk().prod.length>0;function o(){const p=document.getElementById(r);p&&p.remove()}function a(p){p.style.display="flex",p.style.background="#7faaf0",p.style.position="fixed",p.style.bottom="5px",p.style.left="5px",p.style.padding=".5em",p.style.borderRadius="5px",p.style.alignItems="center"}function c(p,x){p.setAttribute("width","24"),p.setAttribute("id",x),p.setAttribute("height","24"),p.setAttribute("viewBox","0 0 24 24"),p.setAttribute("fill","none"),p.style.marginLeft="-6px"}function d(){const p=document.createElement("span");return p.style.cursor="pointer",p.style.marginLeft="16px",p.style.fontSize="24px",p.innerHTML=" &times;",p.onclick=()=>{b0=!0,o()},p}function h(p,x){p.setAttribute("id",x),p.innerText="Learn more",p.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",p.setAttribute("target","__blank"),p.style.paddingLeft="5px",p.style.textDecoration="underline"}function m(){const p=Dk(r),x=n("text"),A=document.getElementById(x)||document.createElement("span"),C=n("learnmore"),k=document.getElementById(C)||document.createElement("a"),_=n("preprendIcon"),v=document.getElementById(_)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(p.created){const w=p.element;a(w),h(k,C);const P=d();c(v,_),w.append(v,A,k,P),document.body.appendChild(w)}i?(A.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(gt())}function v1(){var e;const t=(e=yh())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Vk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Ok(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Mk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Lk(){const t=gt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function _1(){return!v1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function x1(){return!v1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function w1(){try{return typeof indexedDB=="object"}catch{return!1}}function Fk(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk="FirebaseError";class Un extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Uk,Object.setPrototypeOf(this,Un.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hc.prototype.create)}}class hc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?zk(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Un(s,a,r)}}function zk(t,e){return t.replace(Bk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Bk=/\{\$([^}]+)}/g;function $k(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function xi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(S0(i)&&S0(o)){if(!xi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function S0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ja(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Xa(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function qk(t,e){const n=new Hk(t,e);return n.subscribe.bind(n)}class Hk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Gk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=zf),s.error===void 0&&(s.error=zf),s.complete===void 0&&(s.complete=zf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Gk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function zf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(t){return t&&t._delegate?t._delegate:t}class br{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new kk;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Qk(e))try{this.getOrInitializeService({instanceIdentifier:Xs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Xs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xs){return this.instances.has(e)}getOptions(e=Xs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Wk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xs){return this.component?this.component.multipleInstances?e:Xs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Wk(t){return t===Xs?void 0:t}function Qk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Kk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const Jk={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},Xk=Ee.INFO,Zk={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},eR=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Zk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Jg{constructor(e){this.name=e,this._logLevel=Xk,this._logHandler=eR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Jk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const tR=(t,e)=>e.some(n=>t instanceof n);let A0,N0;function nR(){return A0||(A0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function rR(){return N0||(N0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const E1=new WeakMap,pp=new WeakMap,I1=new WeakMap,Bf=new WeakMap,Xg=new WeakMap;function sR(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(_s(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&E1.set(n,t)}).catch(()=>{}),Xg.set(e,t),e}function iR(t){if(pp.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});pp.set(t,e)}let gp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return pp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||I1.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return _s(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function oR(t){gp=t(gp)}function aR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call($f(this),e,...n);return I1.set(r,e.sort?e.sort():[e]),_s(r)}:rR().includes(t)?function(...e){return t.apply($f(this),e),_s(E1.get(this))}:function(...e){return _s(t.apply($f(this),e))}}function lR(t){return typeof t=="function"?aR(t):(t instanceof IDBTransaction&&iR(t),tR(t,nR())?new Proxy(t,gp):t)}function _s(t){if(t instanceof IDBRequest)return sR(t);if(Bf.has(t))return Bf.get(t);const e=lR(t);return e!==t&&(Bf.set(t,e),Xg.set(e,t)),e}const $f=t=>Xg.get(t);function cR(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=_s(o);return r&&o.addEventListener("upgradeneeded",c=>{r(_s(o.result),c.oldVersion,c.newVersion,_s(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const uR=["get","getKey","getAll","getAllKeys","count"],dR=["put","add","delete","clear"],qf=new Map;function C0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(qf.get(e))return qf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=dR.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||uR.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&c.done]))[0]};return qf.set(e,i),i}oR(t=>({...t,get:(e,n,r)=>C0(e,n)||t.get(e,n,r),has:(e,n)=>!!C0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(fR(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function fR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const yp="@firebase/app",k0="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sr=new Jg("@firebase/app"),mR="@firebase/app-compat",pR="@firebase/analytics-compat",gR="@firebase/analytics",yR="@firebase/app-check-compat",vR="@firebase/app-check",_R="@firebase/auth",xR="@firebase/auth-compat",wR="@firebase/database",ER="@firebase/data-connect",IR="@firebase/database-compat",TR="@firebase/functions",bR="@firebase/functions-compat",SR="@firebase/installations",AR="@firebase/installations-compat",NR="@firebase/messaging",CR="@firebase/messaging-compat",kR="@firebase/performance",RR="@firebase/performance-compat",PR="@firebase/remote-config",DR="@firebase/remote-config-compat",jR="@firebase/storage",VR="@firebase/storage-compat",OR="@firebase/firestore",MR="@firebase/ai",LR="@firebase/firestore-compat",FR="firebase",UR="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="[DEFAULT]",zR={[yp]:"fire-core",[mR]:"fire-core-compat",[gR]:"fire-analytics",[pR]:"fire-analytics-compat",[vR]:"fire-app-check",[yR]:"fire-app-check-compat",[_R]:"fire-auth",[xR]:"fire-auth-compat",[wR]:"fire-rtdb",[ER]:"fire-data-connect",[IR]:"fire-rtdb-compat",[TR]:"fire-fn",[bR]:"fire-fn-compat",[SR]:"fire-iid",[AR]:"fire-iid-compat",[NR]:"fire-fcm",[CR]:"fire-fcm-compat",[kR]:"fire-perf",[RR]:"fire-perf-compat",[PR]:"fire-rc",[DR]:"fire-rc-compat",[jR]:"fire-gcs",[VR]:"fire-gcs-compat",[OR]:"fire-fst",[LR]:"fire-fst-compat",[MR]:"fire-vertex","fire-js":"fire-js",[FR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed=new Map,BR=new Map,_p=new Map;function R0(t,e){try{t.container.addComponent(e)}catch(n){Sr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Cs(t){const e=t.name;if(_p.has(e))return Sr.debug(`There were multiple attempts to register component ${e}.`),!1;_p.set(e,t);for(const n of Ed.values())R0(n,t);for(const n of BR.values())R0(n,t);return!0}function mc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},xs=new hc("app","Firebase",$R);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new br("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw xs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji=UR;function T1(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:vp,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw xs.create("bad-app-name",{appName:String(s)});if(n||(n=g1()),!n)throw xs.create("no-options");const i=Ed.get(s);if(i){if(xi(n,i.options)&&xi(r,i.config))return i;throw xs.create("duplicate-app",{appName:s})}const o=new Yk(s);for(const c of _p.values())o.addComponent(c);const a=new qR(n,r,o);return Ed.set(s,a),a}function Zg(t=vp){const e=Ed.get(t);if(!e&&t===vp&&g1())return T1();if(!e)throw xs.create("no-app",{appName:t});return e}function In(t,e,n){let r=zR[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Sr.warn(o.join(" "));return}Cs(new br(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR="firebase-heartbeat-database",GR=1,ql="firebase-heartbeat-store";let Hf=null;function b1(){return Hf||(Hf=cR(HR,GR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ql)}catch(n){console.warn(n)}}}}).catch(t=>{throw xs.create("idb-open",{originalErrorMessage:t.message})})),Hf}async function KR(t){try{const n=(await b1()).transaction(ql),r=await n.objectStore(ql).get(S1(t));return await n.done,r}catch(e){if(e instanceof Un)Sr.warn(e.message);else{const n=xs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Sr.warn(n.message)}}}async function P0(t,e){try{const r=(await b1()).transaction(ql,"readwrite");await r.objectStore(ql).put(e,S1(t)),await r.done}catch(n){if(n instanceof Un)Sr.warn(n.message);else{const r=xs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Sr.warn(r.message)}}}function S1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR=1024,QR=30;class YR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new XR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=D0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>QR){const o=ZR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Sr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=D0(),{heartbeatsToSend:r,unsentEntries:s}=JR(this._heartbeatsCache.heartbeats),i=wd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Sr.warn(n),""}}}function D0(){return new Date().toISOString().substring(0,10)}function JR(t,e=WR){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),j0(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),j0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class XR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return w1()?Fk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await KR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return P0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return P0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function j0(t){return wd(JSON.stringify({version:2,heartbeats:t})).length}function ZR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e2(t){Cs(new br("platform-logger",e=>new hR(e),"PRIVATE")),Cs(new br("heartbeat",e=>new YR(e),"PRIVATE")),In(yp,k0,t),In(yp,k0,"esm2020"),In("fire-js","")}e2("");var V0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ws,A1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,y){function b(){}b.prototype=y.prototype,E.F=y.prototype,E.prototype=new b,E.prototype.constructor=E,E.D=function(N,I,R){for(var S=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)S[ie-2]=arguments[ie];return y.prototype[I].apply(N,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,y,b){b||(b=0);const N=Array(16);if(typeof y=="string")for(var I=0;I<16;++I)N[I]=y.charCodeAt(b++)|y.charCodeAt(b++)<<8|y.charCodeAt(b++)<<16|y.charCodeAt(b++)<<24;else for(I=0;I<16;++I)N[I]=y[b++]|y[b++]<<8|y[b++]<<16|y[b++]<<24;y=E.g[0],b=E.g[1],I=E.g[2];let R=E.g[3],S;S=y+(R^b&(I^R))+N[0]+3614090360&4294967295,y=b+(S<<7&4294967295|S>>>25),S=R+(I^y&(b^I))+N[1]+3905402710&4294967295,R=y+(S<<12&4294967295|S>>>20),S=I+(b^R&(y^b))+N[2]+606105819&4294967295,I=R+(S<<17&4294967295|S>>>15),S=b+(y^I&(R^y))+N[3]+3250441966&4294967295,b=I+(S<<22&4294967295|S>>>10),S=y+(R^b&(I^R))+N[4]+4118548399&4294967295,y=b+(S<<7&4294967295|S>>>25),S=R+(I^y&(b^I))+N[5]+1200080426&4294967295,R=y+(S<<12&4294967295|S>>>20),S=I+(b^R&(y^b))+N[6]+2821735955&4294967295,I=R+(S<<17&4294967295|S>>>15),S=b+(y^I&(R^y))+N[7]+4249261313&4294967295,b=I+(S<<22&4294967295|S>>>10),S=y+(R^b&(I^R))+N[8]+1770035416&4294967295,y=b+(S<<7&4294967295|S>>>25),S=R+(I^y&(b^I))+N[9]+2336552879&4294967295,R=y+(S<<12&4294967295|S>>>20),S=I+(b^R&(y^b))+N[10]+4294925233&4294967295,I=R+(S<<17&4294967295|S>>>15),S=b+(y^I&(R^y))+N[11]+2304563134&4294967295,b=I+(S<<22&4294967295|S>>>10),S=y+(R^b&(I^R))+N[12]+1804603682&4294967295,y=b+(S<<7&4294967295|S>>>25),S=R+(I^y&(b^I))+N[13]+4254626195&4294967295,R=y+(S<<12&4294967295|S>>>20),S=I+(b^R&(y^b))+N[14]+2792965006&4294967295,I=R+(S<<17&4294967295|S>>>15),S=b+(y^I&(R^y))+N[15]+1236535329&4294967295,b=I+(S<<22&4294967295|S>>>10),S=y+(I^R&(b^I))+N[1]+4129170786&4294967295,y=b+(S<<5&4294967295|S>>>27),S=R+(b^I&(y^b))+N[6]+3225465664&4294967295,R=y+(S<<9&4294967295|S>>>23),S=I+(y^b&(R^y))+N[11]+643717713&4294967295,I=R+(S<<14&4294967295|S>>>18),S=b+(R^y&(I^R))+N[0]+3921069994&4294967295,b=I+(S<<20&4294967295|S>>>12),S=y+(I^R&(b^I))+N[5]+3593408605&4294967295,y=b+(S<<5&4294967295|S>>>27),S=R+(b^I&(y^b))+N[10]+38016083&4294967295,R=y+(S<<9&4294967295|S>>>23),S=I+(y^b&(R^y))+N[15]+3634488961&4294967295,I=R+(S<<14&4294967295|S>>>18),S=b+(R^y&(I^R))+N[4]+3889429448&4294967295,b=I+(S<<20&4294967295|S>>>12),S=y+(I^R&(b^I))+N[9]+568446438&4294967295,y=b+(S<<5&4294967295|S>>>27),S=R+(b^I&(y^b))+N[14]+3275163606&4294967295,R=y+(S<<9&4294967295|S>>>23),S=I+(y^b&(R^y))+N[3]+4107603335&4294967295,I=R+(S<<14&4294967295|S>>>18),S=b+(R^y&(I^R))+N[8]+1163531501&4294967295,b=I+(S<<20&4294967295|S>>>12),S=y+(I^R&(b^I))+N[13]+2850285829&4294967295,y=b+(S<<5&4294967295|S>>>27),S=R+(b^I&(y^b))+N[2]+4243563512&4294967295,R=y+(S<<9&4294967295|S>>>23),S=I+(y^b&(R^y))+N[7]+1735328473&4294967295,I=R+(S<<14&4294967295|S>>>18),S=b+(R^y&(I^R))+N[12]+2368359562&4294967295,b=I+(S<<20&4294967295|S>>>12),S=y+(b^I^R)+N[5]+4294588738&4294967295,y=b+(S<<4&4294967295|S>>>28),S=R+(y^b^I)+N[8]+2272392833&4294967295,R=y+(S<<11&4294967295|S>>>21),S=I+(R^y^b)+N[11]+1839030562&4294967295,I=R+(S<<16&4294967295|S>>>16),S=b+(I^R^y)+N[14]+4259657740&4294967295,b=I+(S<<23&4294967295|S>>>9),S=y+(b^I^R)+N[1]+2763975236&4294967295,y=b+(S<<4&4294967295|S>>>28),S=R+(y^b^I)+N[4]+1272893353&4294967295,R=y+(S<<11&4294967295|S>>>21),S=I+(R^y^b)+N[7]+4139469664&4294967295,I=R+(S<<16&4294967295|S>>>16),S=b+(I^R^y)+N[10]+3200236656&4294967295,b=I+(S<<23&4294967295|S>>>9),S=y+(b^I^R)+N[13]+681279174&4294967295,y=b+(S<<4&4294967295|S>>>28),S=R+(y^b^I)+N[0]+3936430074&4294967295,R=y+(S<<11&4294967295|S>>>21),S=I+(R^y^b)+N[3]+3572445317&4294967295,I=R+(S<<16&4294967295|S>>>16),S=b+(I^R^y)+N[6]+76029189&4294967295,b=I+(S<<23&4294967295|S>>>9),S=y+(b^I^R)+N[9]+3654602809&4294967295,y=b+(S<<4&4294967295|S>>>28),S=R+(y^b^I)+N[12]+3873151461&4294967295,R=y+(S<<11&4294967295|S>>>21),S=I+(R^y^b)+N[15]+530742520&4294967295,I=R+(S<<16&4294967295|S>>>16),S=b+(I^R^y)+N[2]+3299628645&4294967295,b=I+(S<<23&4294967295|S>>>9),S=y+(I^(b|~R))+N[0]+4096336452&4294967295,y=b+(S<<6&4294967295|S>>>26),S=R+(b^(y|~I))+N[7]+1126891415&4294967295,R=y+(S<<10&4294967295|S>>>22),S=I+(y^(R|~b))+N[14]+2878612391&4294967295,I=R+(S<<15&4294967295|S>>>17),S=b+(R^(I|~y))+N[5]+4237533241&4294967295,b=I+(S<<21&4294967295|S>>>11),S=y+(I^(b|~R))+N[12]+1700485571&4294967295,y=b+(S<<6&4294967295|S>>>26),S=R+(b^(y|~I))+N[3]+2399980690&4294967295,R=y+(S<<10&4294967295|S>>>22),S=I+(y^(R|~b))+N[10]+4293915773&4294967295,I=R+(S<<15&4294967295|S>>>17),S=b+(R^(I|~y))+N[1]+2240044497&4294967295,b=I+(S<<21&4294967295|S>>>11),S=y+(I^(b|~R))+N[8]+1873313359&4294967295,y=b+(S<<6&4294967295|S>>>26),S=R+(b^(y|~I))+N[15]+4264355552&4294967295,R=y+(S<<10&4294967295|S>>>22),S=I+(y^(R|~b))+N[6]+2734768916&4294967295,I=R+(S<<15&4294967295|S>>>17),S=b+(R^(I|~y))+N[13]+1309151649&4294967295,b=I+(S<<21&4294967295|S>>>11),S=y+(I^(b|~R))+N[4]+4149444226&4294967295,y=b+(S<<6&4294967295|S>>>26),S=R+(b^(y|~I))+N[11]+3174756917&4294967295,R=y+(S<<10&4294967295|S>>>22),S=I+(y^(R|~b))+N[2]+718787259&4294967295,I=R+(S<<15&4294967295|S>>>17),S=b+(R^(I|~y))+N[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(I+(S<<21&4294967295|S>>>11))&4294967295,E.g[2]=E.g[2]+I&4294967295,E.g[3]=E.g[3]+R&4294967295}r.prototype.v=function(E,y){y===void 0&&(y=E.length);const b=y-this.blockSize,N=this.C;let I=this.h,R=0;for(;R<y;){if(I==0)for(;R<=b;)s(this,E,R),R+=this.blockSize;if(typeof E=="string"){for(;R<y;)if(N[I++]=E.charCodeAt(R++),I==this.blockSize){s(this,N),I=0;break}}else for(;R<y;)if(N[I++]=E[R++],I==this.blockSize){s(this,N),I=0;break}}this.h=I,this.o+=y},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;y=this.o*8;for(var b=E.length-8;b<E.length;++b)E[b]=y&255,y/=256;for(this.v(E),E=Array(16),y=0,b=0;b<4;++b)for(let N=0;N<32;N+=8)E[y++]=this.g[b]>>>N&255;return E};function i(E,y){var b=a;return Object.prototype.hasOwnProperty.call(b,E)?b[E]:b[E]=y(E)}function o(E,y){this.h=y;const b=[];let N=!0;for(let I=E.length-1;I>=0;I--){const R=E[I]|0;N&&R==y||(b[I]=R,N=!1)}this.g=b}var a={};function c(E){return-128<=E&&E<128?i(E,function(y){return new o([y|0],y<0?-1:0)}):new o([E|0],E<0?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return k(d(-E));const y=[];let b=1;for(let N=0;E>=b;N++)y[N]=E/b|0,b*=4294967296;return new o(y,0)}function h(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return k(h(E.substring(1),y));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const b=d(Math.pow(y,8));let N=m;for(let R=0;R<E.length;R+=8){var I=Math.min(8,E.length-R);const S=parseInt(E.substring(R,R+I),y);I<8?(I=d(Math.pow(y,I)),N=N.j(I).add(d(S))):(N=N.j(b),N=N.add(d(S)))}return N}var m=c(0),p=c(1),x=c(16777216);t=o.prototype,t.m=function(){if(C(this))return-k(this).m();let E=0,y=1;for(let b=0;b<this.g.length;b++){const N=this.i(b);E+=(N>=0?N:4294967296+N)*y,y*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(A(this))return"0";if(C(this))return"-"+k(this).toString(E);const y=d(Math.pow(E,6));var b=this;let N="";for(;;){const I=P(b,y).g;b=_(b,I.j(y));let R=((b.g.length>0?b.g[0]:b.h)>>>0).toString(E);if(b=I,A(b))return R+N;for(;R.length<6;)R="0"+R;N=R+N}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function A(E){if(E.h!=0)return!1;for(let y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function C(E){return E.h==-1}t.l=function(E){return E=_(this,E),C(E)?-1:A(E)?0:1};function k(E){const y=E.g.length,b=[];for(let N=0;N<y;N++)b[N]=~E.g[N];return new o(b,~E.h).add(p)}t.abs=function(){return C(this)?k(this):this},t.add=function(E){const y=Math.max(this.g.length,E.g.length),b=[];let N=0;for(let I=0;I<=y;I++){let R=N+(this.i(I)&65535)+(E.i(I)&65535),S=(R>>>16)+(this.i(I)>>>16)+(E.i(I)>>>16);N=S>>>16,R&=65535,S&=65535,b[I]=S<<16|R}return new o(b,b[b.length-1]&-2147483648?-1:0)};function _(E,y){return E.add(k(y))}t.j=function(E){if(A(this)||A(E))return m;if(C(this))return C(E)?k(this).j(k(E)):k(k(this).j(E));if(C(E))return k(this.j(k(E)));if(this.l(x)<0&&E.l(x)<0)return d(this.m()*E.m());const y=this.g.length+E.g.length,b=[];for(var N=0;N<2*y;N++)b[N]=0;for(N=0;N<this.g.length;N++)for(let I=0;I<E.g.length;I++){const R=this.i(N)>>>16,S=this.i(N)&65535,ie=E.i(I)>>>16,le=E.i(I)&65535;b[2*N+2*I]+=S*le,v(b,2*N+2*I),b[2*N+2*I+1]+=R*le,v(b,2*N+2*I+1),b[2*N+2*I+1]+=S*ie,v(b,2*N+2*I+1),b[2*N+2*I+2]+=R*ie,v(b,2*N+2*I+2)}for(E=0;E<y;E++)b[E]=b[2*E+1]<<16|b[2*E];for(E=y;E<2*y;E++)b[E]=0;return new o(b,0)};function v(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function w(E,y){this.g=E,this.h=y}function P(E,y){if(A(y))throw Error("division by zero");if(A(E))return new w(m,m);if(C(E))return y=P(k(E),y),new w(k(y.g),k(y.h));if(C(y))return y=P(E,k(y)),new w(k(y.g),y.h);if(E.g.length>30){if(C(E)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var b=p,N=y;N.l(E)<=0;)b=j(b),N=j(N);var I=L(b,1),R=L(N,1);for(N=L(N,2),b=L(b,2);!A(N);){var S=R.add(N);S.l(E)<=0&&(I=I.add(b),R=S),N=L(N,1),b=L(b,1)}return y=_(E,I.j(y)),new w(I,y)}for(I=m;E.l(y)>=0;){for(b=Math.max(1,Math.floor(E.m()/y.m())),N=Math.ceil(Math.log(b)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),R=d(b),S=R.j(y);C(S)||S.l(E)>0;)b-=N,R=d(b),S=R.j(y);A(R)&&(R=p),I=I.add(R),E=_(E,S)}return new w(I,E)}t.B=function(E){return P(this,E).h},t.and=function(E){const y=Math.max(this.g.length,E.g.length),b=[];for(let N=0;N<y;N++)b[N]=this.i(N)&E.i(N);return new o(b,this.h&E.h)},t.or=function(E){const y=Math.max(this.g.length,E.g.length),b=[];for(let N=0;N<y;N++)b[N]=this.i(N)|E.i(N);return new o(b,this.h|E.h)},t.xor=function(E){const y=Math.max(this.g.length,E.g.length),b=[];for(let N=0;N<y;N++)b[N]=this.i(N)^E.i(N);return new o(b,this.h^E.h)};function j(E){const y=E.g.length+1,b=[];for(let N=0;N<y;N++)b[N]=E.i(N)<<1|E.i(N-1)>>>31;return new o(b,E.h)}function L(E,y){const b=y>>5;y%=32;const N=E.g.length-b,I=[];for(let R=0;R<N;R++)I[R]=y>0?E.i(R+b)>>>y|E.i(R+b+1)<<32-y:E.i(R+b);return new o(I,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,A1=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,ws=o}).apply(typeof V0<"u"?V0:typeof self<"u"?self:typeof window<"u"?window:{});var ou=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var N1,Za,C1,Du,xp,k1,R1,P1;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof ou=="object"&&ou];for(var f=0;f<l.length;++f){var g=l[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(l,f){if(f)e:{var g=r;l=l.split(".");for(var T=0;T<l.length-1;T++){var O=l[T];if(!(O in g))break e;g=g[O]}l=l[l.length-1],T=g[l],f=f(T),f!=T&&f!=null&&e(g,l,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(f){var g=[],T;for(T in f)Object.prototype.hasOwnProperty.call(f,T)&&g.push([T,f[T]]);return g}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function c(l,f,g){return l.call.apply(l.bind,arguments)}function d(l,f,g){return d=c,d.apply(null,arguments)}function h(l,f){var g=Array.prototype.slice.call(arguments,1);return function(){var T=g.slice();return T.push.apply(T,arguments),l.apply(this,T)}}function m(l,f){function g(){}g.prototype=f.prototype,l.Z=f.prototype,l.prototype=new g,l.prototype.constructor=l,l.Ob=function(T,O,M){for(var X=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)X[ye-2]=arguments[ye];return f.prototype[O].apply(T,X)}}var p=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function x(l){const f=l.length;if(f>0){const g=Array(f);for(let T=0;T<f;T++)g[T]=l[T];return g}return[]}function A(l,f){for(let T=1;T<arguments.length;T++){const O=arguments[T];var g=typeof O;if(g=g!="object"?g:O?Array.isArray(O)?"array":g:"null",g=="array"||g=="object"&&typeof O.length=="number"){g=l.length||0;const M=O.length||0;l.length=g+M;for(let X=0;X<M;X++)l[g+X]=O[X]}else l.push(O)}}class C{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function k(l){o.setTimeout(()=>{throw l},0)}function _(){var l=E;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class v{constructor(){this.h=this.g=null}add(f,g){const T=w.get();T.set(f,g),this.h?this.h.next=T:this.g=T,this.h=T}}var w=new C(()=>new P,l=>l.reset());class P{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let j,L=!1,E=new v,y=()=>{const l=Promise.resolve(void 0);j=()=>{l.then(b)}};function b(){for(var l;l=_();){try{l.h.call(l.g)}catch(g){k(g)}var f=w;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}L=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var R=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const g=()=>{};o.addEventListener("test",g,f),o.removeEventListener("test",g,f)}catch{}return l}();function S(l){return/^[\s\xa0]*$/.test(l)}function ie(l,f){I.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}m(ie,I),ie.prototype.init=function(l,f){const g=this.type=l.type,T=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(g=="mouseover"?f=l.fromElement:g=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&ie.Z.h.call(this)},ie.prototype.h=function(){ie.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var le="closure_listenable_"+(Math.random()*1e6|0),W=0;function we(l,f,g,T,O){this.listener=l,this.proxy=null,this.src=f,this.type=g,this.capture=!!T,this.ha=O,this.key=++W,this.da=this.fa=!1}function $(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function F(l,f,g){for(const T in l)f.call(g,l[T],T,l)}function K(l,f){for(const g in l)f.call(void 0,l[g],g,l)}function J(l){const f={};for(const g in l)f[g]=l[g];return f}const Q="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(l,f){let g,T;for(let O=1;O<arguments.length;O++){T=arguments[O];for(g in T)l[g]=T[g];for(let M=0;M<Q.length;M++)g=Q[M],Object.prototype.hasOwnProperty.call(T,g)&&(l[g]=T[g])}}function ue(l){this.src=l,this.g={},this.h=0}ue.prototype.add=function(l,f,g,T,O){const M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);const X=_e(l,f,T,O);return X>-1?(f=l[X],g||(f.fa=!1)):(f=new we(f,this.src,M,!!T,O),f.fa=g,l.push(f)),f};function Ne(l,f){const g=f.type;if(g in l.g){var T=l.g[g],O=Array.prototype.indexOf.call(T,f,void 0),M;(M=O>=0)&&Array.prototype.splice.call(T,O,1),M&&($(f),l.g[g].length==0&&(delete l.g[g],l.h--))}}function _e(l,f,g,T){for(let O=0;O<l.length;++O){const M=l[O];if(!M.da&&M.listener==f&&M.capture==!!g&&M.ha==T)return O}return-1}var ke="closure_lm_"+(Math.random()*1e6|0),Ve={};function kt(l,f,g,T,O){if(Array.isArray(f)){for(let M=0;M<f.length;M++)kt(l,f[M],g,T,O);return null}return g=Fi(g),l&&l[le]?l.J(f,g,a(T)?!!T.capture:!1,O):zn(l,f,g,!1,T,O)}function zn(l,f,g,T,O,M){if(!f)throw Error("Invalid event type");const X=a(O)?!!O.capture:!!O;let ye=$n(l);if(ye||(l[ke]=ye=new ue(l)),g=ye.add(f,g,T,X,M),g.proxy)return g;if(T=Mi(),g.proxy=T,T.src=l,T.listener=g,l.addEventListener)R||(O=X),O===void 0&&(O=!1),l.addEventListener(f.toString(),T,O);else if(l.attachEvent)l.attachEvent(Li(f.toString()),T);else if(l.addListener&&l.removeListener)l.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Mi(){function l(g){return f.call(l.src,l.listener,g)}const f=vt;return l}function Mr(l,f,g,T,O){if(Array.isArray(f))for(var M=0;M<f.length;M++)Mr(l,f[M],g,T,O);else T=a(T)?!!T.capture:!!T,g=Fi(g),l&&l[le]?(l=l.i,M=String(f).toString(),M in l.g&&(f=l.g[M],g=_e(f,g,T,O),g>-1&&($(f[g]),Array.prototype.splice.call(f,g,1),f.length==0&&(delete l.g[M],l.h--)))):l&&(l=$n(l))&&(f=l.g[f.toString()],l=-1,f&&(l=_e(f,g,T,O)),(g=l>-1?f[l]:null)&&Bn(g))}function Bn(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[le])Ne(f.i,l);else{var g=l.type,T=l.proxy;f.removeEventListener?f.removeEventListener(g,T,l.capture):f.detachEvent?f.detachEvent(Li(g),T):f.addListener&&f.removeListener&&f.removeListener(T),(g=$n(f))?(Ne(g,l),g.h==0&&(g.src=null,f[ke]=null)):$(l)}}}function Li(l){return l in Ve?Ve[l]:Ve[l]="on"+l}function vt(l,f){if(l.da)l=!0;else{f=new ie(f,this);const g=l.listener,T=l.ha||l.src;l.fa&&Bn(l),l=g.call(T,f)}return l}function $n(l){return l=l[ke],l instanceof ue?l:null}var $s="__closure_events_fn_"+(Math.random()*1e9>>>0);function Fi(l){return typeof l=="function"?l:(l[$s]||(l[$s]=function(f){return l.handleEvent(f)}),l[$s])}function B(){N.call(this),this.i=new ue(this),this.M=this,this.G=null}m(B,N),B.prototype[le]=!0,B.prototype.removeEventListener=function(l,f,g,T){Mr(this,l,f,g,T)};function ce(l,f){var g,T=l.G;if(T)for(g=[];T;T=T.G)g.push(T);if(l=l.M,T=f.type||f,typeof f=="string")f=new I(f,l);else if(f instanceof I)f.target=f.target||l;else{var O=f;f=new I(T,l),me(f,O)}O=!0;let M,X;if(g)for(X=g.length-1;X>=0;X--)M=f.g=g[X],O=U(M,T,!0,f)&&O;if(M=f.g=l,O=U(M,T,!0,f)&&O,O=U(M,T,!1,f)&&O,g)for(X=0;X<g.length;X++)M=f.g=g[X],O=U(M,T,!1,f)&&O}B.prototype.N=function(){if(B.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const g=l.g[f];for(let T=0;T<g.length;T++)$(g[T]);delete l.g[f],l.h--}}this.G=null},B.prototype.J=function(l,f,g,T){return this.i.add(String(l),f,!1,g,T)},B.prototype.K=function(l,f,g,T){return this.i.add(String(l),f,!0,g,T)};function U(l,f,g,T){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let O=!0;for(let M=0;M<f.length;++M){const X=f[M];if(X&&!X.da&&X.capture==g){const ye=X.listener,ut=X.ha||X.src;X.fa&&Ne(l.i,X),O=ye.call(ut,T)!==!1&&O}}return O&&!T.defaultPrevented}function Z(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(l,f||0)}function ne(l){l.g=Z(()=>{l.g=null,l.i&&(l.i=!1,ne(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class he extends N{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ne(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pe(l){N.call(this),this.h=l,this.g={}}m(pe,N);var Ce=[];function Sn(l){F(l.g,function(f,g){this.g.hasOwnProperty(g)&&Bn(f)},l),l.g={}}pe.prototype.N=function(){pe.Z.N.call(this),Sn(this)},pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kt=o.JSON.stringify,Yh=o.JSON.parse,oA=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function _v(){}function xv(){}var pa={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Jh(){I.call(this,"d")}m(Jh,I);function Xh(){I.call(this,"c")}m(Xh,I);var qs={},wv=null;function Pc(){return wv=wv||new B}qs.Ia="serverreachability";function Ev(l){I.call(this,qs.Ia,l)}m(Ev,I);function ga(l){const f=Pc();ce(f,new Ev(f))}qs.STAT_EVENT="statevent";function Iv(l,f){I.call(this,qs.STAT_EVENT,l),this.stat=f}m(Iv,I);function Ut(l){const f=Pc();ce(f,new Iv(f,l))}qs.Ja="timingevent";function Tv(l,f){I.call(this,qs.Ja,l),this.size=f}m(Tv,I);function ya(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},f)}function va(){this.g=!0}va.prototype.ua=function(){this.g=!1};function aA(l,f,g,T,O,M){l.info(function(){if(l.g)if(M){var X="",ye=M.split("&");for(let Oe=0;Oe<ye.length;Oe++){var ut=ye[Oe].split("=");if(ut.length>1){const _t=ut[0];ut=ut[1];const Hn=_t.split("_");X=Hn.length>=2&&Hn[1]=="type"?X+(_t+"="+ut+"&"):X+(_t+"=redacted&")}}}else X=null;else X=M;return"XMLHTTP REQ ("+T+") [attempt "+O+"]: "+f+`
`+g+`
`+X})}function lA(l,f,g,T,O,M,X){l.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+O+"]: "+f+`
`+g+`
`+M+" "+X})}function Ui(l,f,g,T){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+uA(l,g)+(T?" "+T:"")})}function cA(l,f){l.info(function(){return"TIMEOUT: "+f})}va.prototype.info=function(){};function uA(l,f){if(!l.g)return f;if(!f)return null;try{const M=JSON.parse(f);if(M){for(l=0;l<M.length;l++)if(Array.isArray(M[l])){var g=M[l];if(!(g.length<2)){var T=g[1];if(Array.isArray(T)&&!(T.length<1)){var O=T[0];if(O!="noop"&&O!="stop"&&O!="close")for(let X=1;X<T.length;X++)T[X]=""}}}}return Kt(M)}catch{return f}}var Dc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},bv={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Sv;function Zh(){}m(Zh,_v),Zh.prototype.g=function(){return new XMLHttpRequest},Sv=new Zh;function _a(l){return encodeURIComponent(String(l))}function dA(l){var f=1;l=l.split(":");const g=[];for(;f>0&&l.length;)g.push(l.shift()),f--;return l.length&&g.push(l.join(":")),g}function Lr(l,f,g,T){this.j=l,this.i=f,this.l=g,this.S=T||1,this.V=new pe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Av}function Av(){this.i=null,this.g="",this.h=!1}var Nv={},ef={};function tf(l,f,g){l.M=1,l.A=Vc(qn(f)),l.u=g,l.R=!0,Cv(l,null)}function Cv(l,f){l.F=Date.now(),jc(l),l.B=qn(l.A);var g=l.B,T=l.S;Array.isArray(T)||(T=[String(T)]),Bv(g.i,"t",T),l.C=0,g=l.j.L,l.h=new Av,l.g=o_(l.j,g?f:null,!l.u),l.P>0&&(l.O=new he(d(l.Y,l,l.g),l.P)),f=l.V,g=l.g,T=l.ba;var O="readystatechange";Array.isArray(O)||(O&&(Ce[0]=O.toString()),O=Ce);for(let M=0;M<O.length;M++){const X=kt(g,O[M],T||f.handleEvent,!1,f.h||f);if(!X)break;f.g[X.key]=X}f=l.J?J(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),ga(),aA(l.i,l.v,l.B,l.l,l.S,l.u)}Lr.prototype.ba=function(l){l=l.target;const f=this.O;f&&zr(l)==3?f.j():this.Y(l)},Lr.prototype.Y=function(l){try{if(l==this.g)e:{const ye=zr(this.g),ut=this.g.ya(),Oe=this.g.ca();if(!(ye<3)&&(ye!=3||this.g&&(this.h.h||this.g.la()||Qv(this.g)))){this.K||ye!=4||ut==7||(ut==8||Oe<=0?ga(3):ga(2)),nf(this);var f=this.g.ca();this.X=f;var g=hA(this);if(this.o=f==200,lA(this.i,this.v,this.B,this.l,this.S,ye,f),this.o){if(this.U&&!this.L){t:{if(this.g){var T,O=this.g;if((T=O.g?O.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(T)){var M=T;break t}}M=null}if(l=M)Ui(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,rf(this,l);else{this.o=!1,this.m=3,Ut(12),Hs(this),xa(this);break e}}if(this.R){l=!0;let _t;for(;!this.K&&this.C<g.length;)if(_t=fA(this,g),_t==ef){ye==4&&(this.m=4,Ut(14),l=!1),Ui(this.i,this.l,null,"[Incomplete Response]");break}else if(_t==Nv){this.m=4,Ut(15),Ui(this.i,this.l,g,"[Invalid Chunk]"),l=!1;break}else Ui(this.i,this.l,_t,null),rf(this,_t);if(kv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ye!=4||g.length!=0||this.h.h||(this.m=1,Ut(16),l=!1),this.o=this.o&&l,!l)Ui(this.i,this.l,g,"[Invalid Chunked Response]"),Hs(this),xa(this);else if(g.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+g.length),hf(X),X.P=!0,Ut(11))}}else Ui(this.i,this.l,g,null),rf(this,g);ye==4&&Hs(this),this.o&&!this.K&&(ye==4?n_(this.j,this):(this.o=!1,jc(this)))}else AA(this.g),f==400&&g.indexOf("Unknown SID")>0?(this.m=3,Ut(12)):(this.m=0,Ut(13)),Hs(this),xa(this)}}}catch{}finally{}};function hA(l){if(!kv(l))return l.g.la();const f=Qv(l.g);if(f==="")return"";let g="";const T=f.length,O=zr(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Hs(l),xa(l),"";l.h.i=new o.TextDecoder}for(let M=0;M<T;M++)l.h.h=!0,g+=l.h.i.decode(f[M],{stream:!(O&&M==T-1)});return f.length=0,l.h.g+=g,l.C=0,l.h.g}function kv(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function fA(l,f){var g=l.C,T=f.indexOf(`
`,g);return T==-1?ef:(g=Number(f.substring(g,T)),isNaN(g)?Nv:(T+=1,T+g>f.length?ef:(f=f.slice(T,T+g),l.C=T+g,f)))}Lr.prototype.cancel=function(){this.K=!0,Hs(this)};function jc(l){l.T=Date.now()+l.H,Rv(l,l.H)}function Rv(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=ya(d(l.aa,l),f)}function nf(l){l.D&&(o.clearTimeout(l.D),l.D=null)}Lr.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(cA(this.i,this.B),this.M!=2&&(ga(),Ut(17)),Hs(this),this.m=2,xa(this)):Rv(this,this.T-l)};function xa(l){l.j.I==0||l.K||n_(l.j,l)}function Hs(l){nf(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,Sn(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function rf(l,f){try{var g=l.j;if(g.I!=0&&(g.g==l||sf(g.h,l))){if(!l.L&&sf(g.h,l)&&g.I==3){try{var T=g.Ba.g.parse(f)}catch{T=null}if(Array.isArray(T)&&T.length==3){var O=T;if(O[0]==0){e:if(!g.v){if(g.g)if(g.g.F+3e3<l.F)Uc(g),Lc(g);else break e;df(g),Ut(18)}}else g.xa=O[1],0<g.xa-g.K&&O[2]<37500&&g.F&&g.A==0&&!g.C&&(g.C=ya(d(g.Va,g),6e3));jv(g.h)<=1&&g.ta&&(g.ta=void 0)}else Ks(g,11)}else if((l.L||g.g==l)&&Uc(g),!S(f))for(O=g.Ba.g.parse(f),f=0;f<O.length;f++){let Oe=O[f];const _t=Oe[0];if(!(_t<=g.K))if(g.K=_t,Oe=Oe[1],g.I==2)if(Oe[0]=="c"){g.M=Oe[1],g.ba=Oe[2];const Hn=Oe[3];Hn!=null&&(g.ka=Hn,g.j.info("VER="+g.ka));const Ws=Oe[4];Ws!=null&&(g.za=Ws,g.j.info("SVER="+g.za));const Br=Oe[5];Br!=null&&typeof Br=="number"&&Br>0&&(T=1.5*Br,g.O=T,g.j.info("backChannelRequestTimeoutMs_="+T)),T=g;const $r=l.g;if($r){const Bc=$r.g?$r.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bc){var M=T.h;M.g||Bc.indexOf("spdy")==-1&&Bc.indexOf("quic")==-1&&Bc.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(of(M,M.h),M.h=null))}if(T.G){const ff=$r.g?$r.g.getResponseHeader("X-HTTP-Session-Id"):null;ff&&(T.wa=ff,ze(T.J,T.G,ff))}}g.I=3,g.l&&g.l.ra(),g.aa&&(g.T=Date.now()-l.F,g.j.info("Handshake RTT: "+g.T+"ms")),T=g;var X=l;if(T.na=i_(T,T.L?T.ba:null,T.W),X.L){Vv(T.h,X);var ye=X,ut=T.O;ut&&(ye.H=ut),ye.D&&(nf(ye),jc(ye)),T.g=X}else e_(T);g.i.length>0&&Fc(g)}else Oe[0]!="stop"&&Oe[0]!="close"||Ks(g,7);else g.I==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?Ks(g,7):uf(g):Oe[0]!="noop"&&g.l&&g.l.qa(Oe),g.A=0)}}ga(4)}catch{}}var mA=class{constructor(l,f){this.g=l,this.map=f}};function Pv(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Dv(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function jv(l){return l.h?1:l.g?l.g.size:0}function sf(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function of(l,f){l.g?l.g.add(f):l.h=f}function Vv(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Pv.prototype.cancel=function(){if(this.i=Ov(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Ov(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const g of l.g.values())f=f.concat(g.G);return f}return x(l.i)}var Mv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pA(l,f){if(l){l=l.split("&");for(let g=0;g<l.length;g++){const T=l[g].indexOf("=");let O,M=null;T>=0?(O=l[g].substring(0,T),M=l[g].substring(T+1)):O=l[g],f(O,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Fr(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof Fr?(this.l=l.l,wa(this,l.j),this.o=l.o,this.g=l.g,Ea(this,l.u),this.h=l.h,af(this,$v(l.i)),this.m=l.m):l&&(f=String(l).match(Mv))?(this.l=!1,wa(this,f[1]||"",!0),this.o=Ia(f[2]||""),this.g=Ia(f[3]||"",!0),Ea(this,f[4]),this.h=Ia(f[5]||"",!0),af(this,f[6]||"",!0),this.m=Ia(f[7]||"")):(this.l=!1,this.i=new ba(null,this.l))}Fr.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(Ta(f,Lv,!0),":");var g=this.g;return(g||f=="file")&&(l.push("//"),(f=this.o)&&l.push(Ta(f,Lv,!0),"@"),l.push(_a(g).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.u,g!=null&&l.push(":",String(g))),(g=this.h)&&(this.g&&g.charAt(0)!="/"&&l.push("/"),l.push(Ta(g,g.charAt(0)=="/"?vA:yA,!0))),(g=this.i.toString())&&l.push("?",g),(g=this.m)&&l.push("#",Ta(g,xA)),l.join("")},Fr.prototype.resolve=function(l){const f=qn(this);let g=!!l.j;g?wa(f,l.j):g=!!l.o,g?f.o=l.o:g=!!l.g,g?f.g=l.g:g=l.u!=null;var T=l.h;if(g)Ea(f,l.u);else if(g=!!l.h){if(T.charAt(0)!="/")if(this.g&&!this.h)T="/"+T;else{var O=f.h.lastIndexOf("/");O!=-1&&(T=f.h.slice(0,O+1)+T)}if(O=T,O==".."||O==".")T="";else if(O.indexOf("./")!=-1||O.indexOf("/.")!=-1){T=O.lastIndexOf("/",0)==0,O=O.split("/");const M=[];for(let X=0;X<O.length;){const ye=O[X++];ye=="."?T&&X==O.length&&M.push(""):ye==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),T&&X==O.length&&M.push("")):(M.push(ye),T=!0)}T=M.join("/")}else T=O}return g?f.h=T:g=l.i.toString()!=="",g?af(f,$v(l.i)):g=!!l.m,g&&(f.m=l.m),f};function qn(l){return new Fr(l)}function wa(l,f,g){l.j=g?Ia(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function Ea(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function af(l,f,g){f instanceof ba?(l.i=f,wA(l.i,l.l)):(g||(f=Ta(f,_A)),l.i=new ba(f,l.l))}function ze(l,f,g){l.i.set(f,g)}function Vc(l){return ze(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function Ia(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Ta(l,f,g){return typeof l=="string"?(l=encodeURI(l).replace(f,gA),g&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function gA(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Lv=/[#\/\?@]/g,yA=/[#\?:]/g,vA=/[#\?]/g,_A=/[#\?@]/g,xA=/#/g;function ba(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Gs(l){l.g||(l.g=new Map,l.h=0,l.i&&pA(l.i,function(f,g){l.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=ba.prototype,t.add=function(l,f){Gs(this),this.i=null,l=zi(this,l);let g=this.g.get(l);return g||this.g.set(l,g=[]),g.push(f),this.h+=1,this};function Fv(l,f){Gs(l),f=zi(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Uv(l,f){return Gs(l),f=zi(l,f),l.g.has(f)}t.forEach=function(l,f){Gs(this),this.g.forEach(function(g,T){g.forEach(function(O){l.call(f,O,T,this)},this)},this)};function zv(l,f){Gs(l);let g=[];if(typeof f=="string")Uv(l,f)&&(g=g.concat(l.g.get(zi(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)g=g.concat(l[f]);return g}t.set=function(l,f){return Gs(this),this.i=null,l=zi(this,l),Uv(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=zv(this,l),l.length>0?String(l[0]):f):f};function Bv(l,f,g){Fv(l,f),g.length>0&&(l.i=null,l.g.set(zi(l,f),x(g)),l.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let T=0;T<f.length;T++){var g=f[T];const O=_a(g);g=zv(this,g);for(let M=0;M<g.length;M++){let X=O;g[M]!==""&&(X+="="+_a(g[M])),l.push(X)}}return this.i=l.join("&")};function $v(l){const f=new ba;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function zi(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function wA(l,f){f&&!l.j&&(Gs(l),l.i=null,l.g.forEach(function(g,T){const O=T.toLowerCase();T!=O&&(Fv(this,T),Bv(this,O,g))},l)),l.j=f}function EA(l,f){const g=new va;if(o.Image){const T=new Image;T.onload=h(Ur,g,"TestLoadImage: loaded",!0,f,T),T.onerror=h(Ur,g,"TestLoadImage: error",!1,f,T),T.onabort=h(Ur,g,"TestLoadImage: abort",!1,f,T),T.ontimeout=h(Ur,g,"TestLoadImage: timeout",!1,f,T),o.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=l}else f(!1)}function IA(l,f){const g=new va,T=new AbortController,O=setTimeout(()=>{T.abort(),Ur(g,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:T.signal}).then(M=>{clearTimeout(O),M.ok?Ur(g,"TestPingServer: ok",!0,f):Ur(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(O),Ur(g,"TestPingServer: error",!1,f)})}function Ur(l,f,g,T,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),T(g)}catch{}}function TA(){this.g=new oA}function lf(l){this.i=l.Sb||null,this.h=l.ab||!1}m(lf,_v),lf.prototype.g=function(){return new Oc(this.i,this.h)};function Oc(l,f){B.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Oc,B),t=Oc.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,Aa(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Sa(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Aa(this)),this.g&&(this.readyState=3,Aa(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;qv(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function qv(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?Sa(this):Aa(this),this.readyState==3&&qv(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,Sa(this))},t.Na=function(l){this.g&&(this.response=l,Sa(this))},t.ga=function(){this.g&&Sa(this)};function Sa(l){l.readyState=4,l.l=null,l.j=null,l.B=null,Aa(l)}t.setRequestHeader=function(l,f){this.A.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,l.push(g[0]+": "+g[1]),g=f.next();return l.join(`\r
`)};function Aa(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Oc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Hv(l){let f="";return F(l,function(g,T){f+=T,f+=":",f+=g,f+=`\r
`}),f}function cf(l,f,g){e:{for(T in g){var T=!1;break e}T=!0}T||(g=Hv(g),typeof l=="string"?g!=null&&_a(g):ze(l,f,g))}function Ze(l){B.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Ze,B);var bA=/^https?$/i,SA=["POST","PUT"];t=Ze.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,f,g,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Sv.g(),this.g.onreadystatechange=p(d(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(M){Gv(this,M);return}if(l=g||"",g=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var O in T)g.set(O,T[O]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const M of T.keys())g.set(M,T.get(M));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(g.keys()).find(M=>M.toLowerCase()=="content-type"),O=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(SA,f,void 0)>=0)||T||O||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,X]of g)this.g.setRequestHeader(M,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(M){Gv(this,M)}};function Gv(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,Kv(l),Mc(l)}function Kv(l){l.A||(l.A=!0,ce(l,"complete"),ce(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,ce(this,"complete"),ce(this,"abort"),Mc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Mc(this,!0)),Ze.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Wv(this):this.Xa())},t.Xa=function(){Wv(this)};function Wv(l){if(l.h&&typeof i<"u"){if(l.v&&zr(l)==4)setTimeout(l.Ca.bind(l),0);else if(ce(l,"readystatechange"),zr(l)==4){l.h=!1;try{const M=l.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var T;if(T=M===0){let X=String(l.D).match(Mv)[1]||null;!X&&o.self&&o.self.location&&(X=o.self.location.protocol.slice(0,-1)),T=!bA.test(X?X.toLowerCase():"")}g=T}if(g)ce(l,"complete"),ce(l,"success");else{l.o=6;try{var O=zr(l)>2?l.g.statusText:""}catch{O=""}l.l=O+" ["+l.ca()+"]",Kv(l)}}finally{Mc(l)}}}}function Mc(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const g=l.g;l.g=null,f||ce(l,"ready");try{g.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function zr(l){return l.g?l.g.readyState:0}t.ca=function(){try{return zr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Yh(f)}};function Qv(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function AA(l){const f={};l=(l.g&&zr(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<l.length;T++){if(S(l[T]))continue;var g=dA(l[T]);const O=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const M=f[O]||[];f[O]=M,M.push(g)}K(f,function(T){return T.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function Na(l,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[l]||f}function Yv(l){this.za=0,this.i=[],this.j=new va,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Na("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Na("baseRetryDelayMs",5e3,l),this.Za=Na("retryDelaySeedMs",1e4,l),this.Ta=Na("forwardChannelMaxRetries",2,l),this.va=Na("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Pv(l&&l.concurrentRequestLimit),this.Ba=new TA,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Yv.prototype,t.ka=8,t.I=1,t.connect=function(l,f,g,T){Ut(0),this.W=l,this.H=f||{},g&&T!==void 0&&(this.H.OSID=g,this.H.OAID=T),this.F=this.X,this.J=i_(this,null,this.W),Fc(this)};function uf(l){if(Jv(l),l.I==3){var f=l.V++,g=qn(l.J);if(ze(g,"SID",l.M),ze(g,"RID",f),ze(g,"TYPE","terminate"),Ca(l,g),f=new Lr(l,l.j,f),f.M=2,f.A=Vc(qn(g)),g=!1,o.navigator&&o.navigator.sendBeacon)try{g=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!g&&o.Image&&(new Image().src=f.A,g=!0),g||(f.g=o_(f.j,null),f.g.ea(f.A)),f.F=Date.now(),jc(f)}s_(l)}function Lc(l){l.g&&(hf(l),l.g.cancel(),l.g=null)}function Jv(l){Lc(l),l.v&&(o.clearTimeout(l.v),l.v=null),Uc(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function Fc(l){if(!Dv(l.h)&&!l.m){l.m=!0;var f=l.Ea;j||y(),L||(j(),L=!0),E.add(f,l),l.D=0}}function NA(l,f){return jv(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=ya(d(l.Ea,l,f),r_(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const O=new Lr(this,this.j,l);let M=this.o;if(this.U&&(M?(M=J(M),me(M,this.U)):M=this.U),this.u!==null||this.R||(O.J=M,M=null),this.S)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var T=this.i[g];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(f+=T,f>4096){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=Zv(this,O,f),g=qn(this.J),ze(g,"RID",l),ze(g,"CVER",22),this.G&&ze(g,"X-HTTP-Session-Id",this.G),Ca(this,g),M&&(this.R?f="headers="+_a(Hv(M))+"&"+f:this.u&&cf(g,this.u,M)),of(this.h,O),this.Ra&&ze(g,"TYPE","init"),this.S?(ze(g,"$req",f),ze(g,"SID","null"),O.U=!0,tf(O,g,null)):tf(O,g,f),this.I=2}}else this.I==3&&(l?Xv(this,l):this.i.length==0||Dv(this.h)||Xv(this))};function Xv(l,f){var g;f?g=f.l:g=l.V++;const T=qn(l.J);ze(T,"SID",l.M),ze(T,"RID",g),ze(T,"AID",l.K),Ca(l,T),l.u&&l.o&&cf(T,l.u,l.o),g=new Lr(l,l.j,g,l.D+1),l.u===null&&(g.J=l.o),f&&(l.i=f.G.concat(l.i)),f=Zv(l,g,1e3),g.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),of(l.h,g),tf(g,T,f)}function Ca(l,f){l.H&&F(l.H,function(g,T){ze(f,T,g)}),l.l&&F({},function(g,T){ze(f,T,g)})}function Zv(l,f,g){g=Math.min(l.i.length,g);const T=l.l?d(l.l.Ka,l.l,l):null;e:{var O=l.i;let ye=-1;for(;;){const ut=["count="+g];ye==-1?g>0?(ye=O[0].g,ut.push("ofs="+ye)):ye=0:ut.push("ofs="+ye);let Oe=!0;for(let _t=0;_t<g;_t++){var M=O[_t].g;const Hn=O[_t].map;if(M-=ye,M<0)ye=Math.max(0,O[_t].g-100),Oe=!1;else try{M="req"+M+"_"||"";try{var X=Hn instanceof Map?Hn:Object.entries(Hn);for(const[Ws,Br]of X){let $r=Br;a(Br)&&($r=Kt(Br)),ut.push(M+Ws+"="+encodeURIComponent($r))}}catch(Ws){throw ut.push(M+"type="+encodeURIComponent("_badmap")),Ws}}catch{T&&T(Hn)}}if(Oe){X=ut.join("&");break e}}X=void 0}return l=l.i.splice(0,g),f.G=l,X}function e_(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;j||y(),L||(j(),L=!0),E.add(f,l),l.A=0}}function df(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=ya(d(l.Da,l),r_(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,t_(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=ya(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ut(10),Lc(this),t_(this))};function hf(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function t_(l){l.g=new Lr(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=qn(l.na);ze(f,"RID","rpc"),ze(f,"SID",l.M),ze(f,"AID",l.K),ze(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&ze(f,"TO",l.ia),ze(f,"TYPE","xmlhttp"),Ca(l,f),l.u&&l.o&&cf(f,l.u,l.o),l.O&&(l.g.H=l.O);var g=l.g;l=l.ba,g.M=1,g.A=Vc(qn(f)),g.u=null,g.R=!0,Cv(g,l)}t.Va=function(){this.C!=null&&(this.C=null,Lc(this),df(this),Ut(19))};function Uc(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function n_(l,f){var g=null;if(l.g==f){Uc(l),hf(l),l.g=null;var T=2}else if(sf(l.h,f))g=f.G,Vv(l.h,f),T=1;else return;if(l.I!=0){if(f.o)if(T==1){g=f.u?f.u.length:0,f=Date.now()-f.F;var O=l.D;T=Pc(),ce(T,new Tv(T,g)),Fc(l)}else e_(l);else if(O=f.m,O==3||O==0&&f.X>0||!(T==1&&NA(l,f)||T==2&&df(l)))switch(g&&g.length>0&&(f=l.h,f.i=f.i.concat(g)),O){case 1:Ks(l,5);break;case 4:Ks(l,10);break;case 3:Ks(l,6);break;default:Ks(l,2)}}}function r_(l,f){let g=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(g*=2),g*f}function Ks(l,f){if(l.j.info("Error code "+f),f==2){var g=d(l.bb,l),T=l.Ua;const O=!T;T=new Fr(T||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||wa(T,"https"),Vc(T),O?EA(T.toString(),g):IA(T.toString(),g)}else Ut(2);l.I=0,l.l&&l.l.pa(f),s_(l),Jv(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Ut(2)):(this.j.info("Failed to ping google.com"),Ut(1))};function s_(l){if(l.I=0,l.ja=[],l.l){const f=Ov(l.h);(f.length!=0||l.i.length!=0)&&(A(l.ja,f),A(l.ja,l.i),l.h.i.length=0,x(l.i),l.i.length=0),l.l.oa()}}function i_(l,f,g){var T=g instanceof Fr?qn(g):new Fr(g);if(T.g!="")f&&(T.g=f+"."+T.g),Ea(T,T.u);else{var O=o.location;T=O.protocol,f=f?f+"."+O.hostname:O.hostname,O=+O.port;const M=new Fr(null);T&&wa(M,T),f&&(M.g=f),O&&Ea(M,O),g&&(M.h=g),T=M}return g=l.G,f=l.wa,g&&f&&ze(T,g,f),ze(T,"VER",l.ka),Ca(l,T),T}function o_(l,f,g){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new Ze(new lf({ab:g})):new Ze(l.ma),f.Fa(l.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function a_(){}t=a_.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function zc(){}zc.prototype.g=function(l,f){return new rn(l,f)};function rn(l,f){B.call(this),this.g=new Yv(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!S(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!S(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Bi(this)}m(rn,B),rn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},rn.prototype.close=function(){uf(this.g)},rn.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var g={};g.__data__=l,l=g}else this.v&&(g={},g.__data__=Kt(l),l=g);f.i.push(new mA(f.Ya++,l)),f.I==3&&Fc(f)},rn.prototype.N=function(){this.g.l=null,delete this.j,uf(this.g),delete this.g,rn.Z.N.call(this)};function l_(l){Jh.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const g in f){l=g;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}m(l_,Jh);function c_(){Xh.call(this),this.status=1}m(c_,Xh);function Bi(l){this.g=l}m(Bi,a_),Bi.prototype.ra=function(){ce(this.g,"a")},Bi.prototype.qa=function(l){ce(this.g,new l_(l))},Bi.prototype.pa=function(l){ce(this.g,new c_)},Bi.prototype.oa=function(){ce(this.g,"b")},zc.prototype.createWebChannel=zc.prototype.g,rn.prototype.send=rn.prototype.o,rn.prototype.open=rn.prototype.m,rn.prototype.close=rn.prototype.close,P1=function(){return new zc},R1=function(){return Pc()},k1=qs,xp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Dc.NO_ERROR=0,Dc.TIMEOUT=8,Dc.HTTP_ERROR=6,Du=Dc,bv.COMPLETE="complete",C1=bv,xv.EventType=pa,pa.OPEN="a",pa.CLOSE="b",pa.ERROR="c",pa.MESSAGE="d",B.prototype.listen=B.prototype.J,Za=xv,Ze.prototype.listenOnce=Ze.prototype.K,Ze.prototype.getLastError=Ze.prototype.Ha,Ze.prototype.getLastErrorCode=Ze.prototype.ya,Ze.prototype.getStatus=Ze.prototype.ca,Ze.prototype.getResponseJson=Ze.prototype.La,Ze.prototype.getResponseText=Ze.prototype.la,Ze.prototype.send=Ze.prototype.ea,Ze.prototype.setWithCredentials=Ze.prototype.Fa,N1=Ze}).apply(typeof ou<"u"?ou:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}jt.UNAUTHENTICATED=new jt(null),jt.GOOGLE_CREDENTIALS=new jt("google-credentials-uid"),jt.FIRST_PARTY=new jt("first-party-uid"),jt.MOCK_USER=new jt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oa="12.9.0";function t2(t){oa=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wi=new Jg("@firebase/firestore");function Ji(){return wi.logLevel}function q(t,...e){if(wi.logLevel<=Ee.DEBUG){const n=e.map(ey);wi.debug(`Firestore (${oa}): ${t}`,...n)}}function it(t,...e){if(wi.logLevel<=Ee.ERROR){const n=e.map(ey);wi.error(`Firestore (${oa}): ${t}`,...n)}}function Vo(t,...e){if(wi.logLevel<=Ee.WARN){const n=e.map(ey);wi.warn(`Firestore (${oa}): ${t}`,...n)}}function ey(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,D1(t,r,n)}function D1(t,e,n){let r=`FIRESTORE (${oa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw it(r),new Error(r)}function oe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||D1(e,s,r)}function se(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends Un{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class r2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(jt.UNAUTHENTICATED))}shutdown(){}}class s2{constructor(e){this.t=e,this.currentUser=jt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){oe(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new Vn;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Vn,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Vn)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(oe(typeof r.accessToken=="string",31837,{l:r}),new n2(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string",2055,{h:e}),new jt(e)}}class i2{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=jt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class o2{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new i2(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(jt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class O0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class a2{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){oe(this.o===void 0,3512);const r=i=>{i.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new O0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(oe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new O0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=l2(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function fe(t,e){return t<e?-1:t>e?1:0}function wp(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Gf(s)===Gf(i)?fe(s,i):Gf(s)?1:-1}return fe(t.length,e.length)}const c2=55296,u2=57343;function Gf(t){const e=t.charCodeAt(0);return e>=c2&&e<=u2}function Oo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function j1(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0="__name__";class Wn{constructor(e,n,r){n===void 0?n=0:n>e.length&&te(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&te(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Wn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Wn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Wn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return fe(e.length,n.length)}static compareSegments(e,n){const r=Wn.isNumericId(e),s=Wn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Wn.extractNumericId(e).compare(Wn.extractNumericId(n)):wp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ws.fromString(e.substring(4,e.length-2))}}class be extends Wn{construct(e,n,r){return new be(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new be(n)}static emptyPath(){return new be([])}}const d2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qe extends Wn{construct(e,n,r){return new Qe(e,n,r)}static isValidIdentifier(e){return d2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===M0}static keyField(){return new Qe([M0])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new G(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new G(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new G(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Qe(n)}static emptyPath(){return new Qe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(be.fromString(e))}static fromName(e){return new ee(be.fromString(e).popFirst(5))}static empty(){return new ee(be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&be.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return be.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new be(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(t,e,n){if(!n)throw new G(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function h2(t,e,n,r){if(e===!0&&r===!0)throw new G(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function L0(t){if(!ee.isDocumentKey(t))throw new G(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function F0(t){if(ee.isDocumentKey(t))throw new G(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function O1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function _h(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":te(12329,{type:typeof t})}function qt(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new G(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=_h(t);throw new G(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ct(t,e){const n={typeString:t};return e&&(n.value=e),n}function pc(t,e){if(!O1(t))throw new G(z.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new G(z.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U0=-62135596800,z0=1e6;class Re{static now(){return Re.fromMillis(Date.now())}static fromDate(e){return Re.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*z0);return new Re(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new G(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<U0)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/z0}_compareTo(e){return this.seconds===e.seconds?fe(this.nanoseconds,e.nanoseconds):fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Re._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pc(e,Re._jsonSchema))return new Re(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-U0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Re._jsonSchemaVersion="firestore/timestamp/1.0",Re._jsonSchema={type:ct("string",Re._jsonSchemaVersion),seconds:ct("number"),nanoseconds:ct("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ae{static fromTimestamp(e){return new ae(e)}static min(){return new ae(new Re(0,0))}static max(){return new ae(new Re(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mo=-1;class Id{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Ep(t){return t.fields.find(e=>e.kind===2)}function Zs(t){return t.fields.filter(e=>e.kind!==2)}Id.UNKNOWN_ID=-1;class ju{constructor(e,n){this.fieldPath=e,this.kind=n}}class Hl{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Hl(0,pn.min())}}function M1(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ae.fromTimestamp(r===1e9?new Re(n+1,0):new Re(n,r));return new pn(s,ee.empty(),e)}function L1(t){return new pn(t.readTime,t.key,Mo)}class pn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new pn(ae.min(),ee.empty(),Mo)}static max(){return new pn(ae.max(),ee.empty(),Mo)}}function ny(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ee.comparator(t.documentKey,e.documentKey),n!==0?n:fe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class U1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ms(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==F1)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new V((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof V?n:V.resolve(n)}catch(n){return V.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):V.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):V.reject(n)}static resolve(e){return new V((n,r)=>{n(e)})}static reject(e){return new V((n,r)=>{r(e)})}static waitFor(e){return new V((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=V.resolve(!1);for(const r of e)n=n.next(s=>s?V.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new V((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new V((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const on="SimpleDb";class xh{static open(e,n,r,s){try{return new xh(n,e.transaction(s,r))}catch(i){throw new pl(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new Vn,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new pl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=ry(r.target.error);this.S.reject(new pl(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(q(on,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new m2(n)}}class Es{static delete(e){return q(on,"Removing database:",e),ti(f1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!w1())return!1;if(Es.F())return!0;const e=gt(),n=Es.M(e),r=0<n&&n<10,s=z1(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,Es.M(gt())===12.2&&it("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(q(on,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new pl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new G(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new G(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new pl(e,o))},s.onupgradeneeded=i=>{q(on,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{q(on,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=n=>this.K(n)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=xh.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),V.reject(d))).toPromise();return c.catch(()=>{}),await a.D,c}catch(a){const c=a,d=c.name!=="FirebaseError"&&o<3;if(q(on,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function z1(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class f2{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return ti(this.U.delete())}}class pl extends G{constructor(e,n){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ls(t){return t.name==="IndexedDbTransactionError"}class m2{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(q(on,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(q(on,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),ti(r)}add(e){return q(on,"ADD",this.store.name,e,e),ti(this.store.add(e))}get(e){return ti(this.store.get(e)).next(n=>(n===void 0&&(n=null),q(on,"GET",this.store.name,e,n),n))}delete(e){return q(on,"DELETE",this.store.name,e),ti(this.store.delete(e))}count(){return q(on,"COUNT",this.store.name),ti(this.store.count())}H(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new V((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.J(i,(a,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new V((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){q(on,"DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const s=this.cursor(r);return this.J(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.J(s,n)}te(e){const n=this.cursor({});return new V((r,s)=>{n.onerror=i=>{const o=ry(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}J(e,n){const r=[];return new V((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new f2(a),d=n(a.primaryKey,a.value,c);if(d instanceof V){const h=d.catch(m=>(c.done(),V.reject(m)));r.push(h)}c.isDone?s():c.G===null?a.continue():a.continue(c.G)}}).next(()=>V.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ti(t){return new V((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=ry(r.target.error);n(s)}})}let B0=!1;function ry(t){const e=Es.M(gt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new G("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return B0||(B0=!0,setTimeout(()=>{throw r},0)),r}}return t}const gl="IndexBackfiller";class p2{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){q(gl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();q(gl,`Documents written: ${n}`)}catch(n){Ls(n)?q(gl,"Ignoring IndexedDB error during index backfill: ",n):await Ms(n)}await this.re(6e4)})}}class g2{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return V.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return q(gl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(q(gl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=L1(i);ny(o,r)>0&&(r=o)}),new pn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Jt.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di=-1;function gc(t){return t==null}function Gl(t){return t===0&&1/t==-1/0}function B1(t){return typeof t=="number"&&Number.isInteger(t)&&!Gl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td="";function Mt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=$0(e)),e=y2(t.get(n),e);return $0(e)}function y2(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Td:n+="";break;default:n+=i}}return n}function $0(t){return t+Td+""}function Jn(t){const e=t.length;if(oe(e>=2,64408,{path:t}),e===2)return oe(t.charAt(0)===Td&&t.charAt(1)==="",56145,{path:t}),be.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Td,i);switch((o<0||o>n)&&te(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:te(61167,{path:t})}i=o+2}return new be(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ei="remoteDocuments",yc="owner",qi="owner",Kl="mutationQueues",v2="userId",kn="mutations",q0="batchId",li="userMutationsIndex",H0=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(t,e){return[t,Mt(e)]}function $1(t,e,n){return[t,Mt(e),n]}const _2={},Lo="documentMutations",bd="remoteDocumentsV14",x2=["prefixPath","collectionGroup","readTime","documentId"],Ou="documentKeyIndex",w2=["prefixPath","collectionGroup","documentId"],q1="collectionGroupIndex",E2=["collectionGroup","readTime","prefixPath","documentId"],Wl="remoteDocumentGlobal",Ip="remoteDocumentGlobalKey",Fo="targets",H1="queryTargetsIndex",I2=["canonicalId","targetId"],Uo="targetDocuments",T2=["targetId","path"],sy="documentTargetsIndex",b2=["path","targetId"],Sd="targetGlobalKey",hi="targetGlobal",Ql="collectionParents",S2=["collectionId","parent"],zo="clientMetadata",A2="clientId",wh="bundles",N2="bundleId",Eh="namedQueries",C2="name",iy="indexConfiguration",k2="indexId",Tp="collectionGroupIndex",R2="collectionGroup",yl="indexState",P2=["indexId","uid"],G1="sequenceNumberIndex",D2=["uid","sequenceNumber"],vl="indexEntries",j2=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],K1="documentKeyIndex",V2=["indexId","uid","orderedDocumentKey"],Ih="documentOverlays",O2=["userId","collectionPath","documentId"],bp="collectionPathOverlayIndex",M2=["userId","collectionPath","largestBatchId"],W1="collectionGroupOverlayIndex",L2=["userId","collectionGroup","largestBatchId"],oy="globals",F2="name",Q1=[Kl,kn,Lo,ei,Fo,yc,hi,Uo,zo,Wl,Ql,wh,Eh],U2=[...Q1,Ih],Y1=[Kl,kn,Lo,bd,Fo,yc,hi,Uo,zo,Wl,Ql,wh,Eh,Ih],J1=Y1,ay=[...J1,iy,yl,vl],z2=ay,X1=[...ay,oy],B2=X1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sp extends U1{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function yt(t,e){const n=se(t);return Es.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Fs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Z1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e,n){this.comparator=e,this.root=n||bt.EMPTY}insert(e,n){return new Ue(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,bt.BLACK,null,null))}remove(e){return new Ue(this.comparator,this.root.remove(e,this.comparator).copy(null,null,bt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new au(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new au(this.root,e,this.comparator,!1)}getReverseIterator(){return new au(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new au(this.root,e,this.comparator,!0)}}class au{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class bt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??bt.RED,this.left=s??bt.EMPTY,this.right=i??bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new bt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return bt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw te(27949);return e+(this.isRed()?0:1)}}bt.EMPTY=null,bt.RED=!0,bt.BLACK=!1;bt.EMPTY=new class{constructor(){this.size=0}get key(){throw te(57766)}get value(){throw te(16141)}get color(){throw te(16727)}get left(){throw te(29726)}get right(){throw te(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new bt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class je{constructor(e){this.comparator=e,this.data=new Ue(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new K0(this.data.getIterator())}getIteratorFrom(e){return new K0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof je)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new je(this.comparator);return n.data=e,n}}class K0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Hi(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.fields=e,e.sort(Qe.comparator)}static empty(){return new Xt([])}unionWith(e){let n=new je(Qe.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Xt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Oo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new eT("Invalid base64 string: "+i):i}}(e);return new ot(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new ot(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ot.EMPTY_BYTE_STRING=new ot("");const $2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ar(t){if(oe(!!t,39018),typeof t=="string"){let e=0;const n=$2.exec(t);if(oe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:qe(t.seconds),nanos:qe(t.nanos)}}function qe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Nr(t){return typeof t=="string"?ot.fromBase64String(t):ot.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT="server_timestamp",nT="__type__",rT="__previous_value__",sT="__local_write_time__";function ly(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[nT])==null?void 0:r.stringValue)===tT}function Th(t){const e=t.mapValue.fields[rT];return ly(e)?Th(e):e}function Yl(t){const e=Ar(t.mapValue.fields[sT].timestampValue);return new Re(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e,n,r,s,i,o,a,c,d,h,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=m}}const Ad="(default)";class Ei{constructor(e,n){this.projectId=e,this.database=n||Ad}static empty(){return new Ei("","")}get isDefaultDatabase(){return this.database===Ad}isEqual(e){return e instanceof Ei&&e.projectId===this.projectId&&e.database===this.database}}function H2(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new G(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ei(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cy="__type__",iT="__max__",cs={mapValue:{fields:{__type__:{stringValue:iT}}}},uy="__vector__",Bo="value",Mu={nullValue:"NULL_VALUE"};function ks(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ly(t)?4:oT(t)?9007199254740991:bh(t)?10:11:te(28295,{value:t})}function or(t,e){if(t===e)return!0;const n=ks(t);if(n!==ks(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yl(t).isEqual(Yl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ar(s.timestampValue),a=Ar(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Nr(s.bytesValue).isEqual(Nr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return qe(s.geoPointValue.latitude)===qe(i.geoPointValue.latitude)&&qe(s.geoPointValue.longitude)===qe(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return qe(s.integerValue)===qe(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=qe(s.doubleValue),a=qe(i.doubleValue);return o===a?Gl(o)===Gl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Oo(t.arrayValue.values||[],e.arrayValue.values||[],or);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(G0(o)!==G0(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!or(o[c],a[c])))return!1;return!0}(t,e);default:return te(52216,{left:t})}}function Jl(t,e){return(t.values||[]).find(n=>or(n,e))!==void 0}function Rs(t,e){if(t===e)return 0;const n=ks(t),r=ks(e);if(n!==r)return fe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return fe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=qe(i.integerValue||i.doubleValue),c=qe(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return W0(t.timestampValue,e.timestampValue);case 4:return W0(Yl(t),Yl(e));case 5:return wp(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Nr(i),c=Nr(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const h=fe(a[d],c[d]);if(h!==0)return h}return fe(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=fe(qe(i.latitude),qe(o.latitude));return a!==0?a:fe(qe(i.longitude),qe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Q0(t.arrayValue,e.arrayValue);case 10:return function(i,o){var p,x,A,C;const a=i.fields||{},c=o.fields||{},d=(p=a[Bo])==null?void 0:p.arrayValue,h=(x=c[Bo])==null?void 0:x.arrayValue,m=fe(((A=d==null?void 0:d.values)==null?void 0:A.length)||0,((C=h==null?void 0:h.values)==null?void 0:C.length)||0);return m!==0?m:Q0(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===cs.mapValue&&o===cs.mapValue)return 0;if(i===cs.mapValue)return 1;if(o===cs.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let m=0;m<c.length&&m<h.length;++m){const p=wp(c[m],h[m]);if(p!==0)return p;const x=Rs(a[c[m]],d[h[m]]);if(x!==0)return x}return fe(c.length,h.length)}(t.mapValue,e.mapValue);default:throw te(23264,{he:n})}}function W0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return fe(t,e);const n=Ar(t),r=Ar(e),s=fe(n.seconds,r.seconds);return s!==0?s:fe(n.nanos,r.nanos)}function Q0(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Rs(n[s],r[s]);if(i)return i}return fe(n.length,r.length)}function $o(t){return Ap(t)}function Ap(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ar(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Nr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Ap(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Ap(n.fields[o])}`;return s+"}"}(t.mapValue):te(61005,{value:t})}function Lu(t){switch(ks(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Th(t);return e?16+Lu(e):16;case 5:return 2*t.stringValue.length;case 6:return Nr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+Lu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Fs(r.fields,(i,o)=>{s+=i.length+Lu(o)}),s}(t.mapValue);default:throw te(13486,{value:t})}}function Xl(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Np(t){return!!t&&"integerValue"in t}function Zl(t){return!!t&&"arrayValue"in t}function Y0(t){return!!t&&"nullValue"in t}function J0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Fu(t){return!!t&&"mapValue"in t}function bh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[cy])==null?void 0:r.stringValue)===uy}function _l(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Fs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=_l(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=_l(t.arrayValue.values[n]);return e}return{...t}}function oT(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===iT}const aT={mapValue:{fields:{[cy]:{stringValue:uy},[Bo]:{arrayValue:{}}}}};function G2(t){return"nullValue"in t?Mu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Xl(Ei.empty(),ee.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?bh(t)?aT:{mapValue:{}}:te(35942,{value:t})}function K2(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Xl(Ei.empty(),ee.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?aT:"mapValue"in t?bh(t)?{mapValue:{}}:cs:te(61959,{value:t})}function X0(t,e){const n=Rs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Z0(t,e){const n=Rs(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.value=e}static empty(){return new At({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Fu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=_l(n)}setAll(e){let n=Qe.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=_l(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Fu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return or(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Fu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Fs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new At(_l(this.value))}}function lT(t){const e=[];return Fs(t.fields,(n,r)=>{const s=new Qe([n]);if(Fu(r)){const i=lT(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Xt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ge(e,0,ae.min(),ae.min(),ae.min(),At.empty(),0)}static newFoundDocument(e,n,r,s){return new Ge(e,1,n,ae.min(),r,s,0)}static newNoDocument(e,n){return new Ge(e,2,n,ae.min(),ae.min(),At.empty(),0)}static newUnknownDocument(e,n){return new Ge(e,3,n,ae.min(),ae.min(),At.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=At.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=At.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ge&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ge(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,n){this.position=e,this.inclusive=n}}function ex(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),n.key):r=Rs(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function tx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!or(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,n="asc"){this.field=e,this.dir=n}}function W2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{}class Ie extends cT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Q2(e,n,r):n==="array-contains"?new X2(e,r):n==="in"?new pT(e,r):n==="not-in"?new Z2(e,r):n==="array-contains-any"?new eP(e,r):new Ie(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Y2(e,r):new J2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Rs(n,this.value)):n!==null&&ks(this.value)===ks(n)&&this.matchesComparison(Rs(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Pe extends cT{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Pe(e,n)}matches(e){return Ho(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Ho(t){return t.op==="and"}function Cp(t){return t.op==="or"}function dy(t){return uT(t)&&Ho(t)}function uT(t){for(const e of t.filters)if(e instanceof Pe)return!1;return!0}function kp(t){if(t instanceof Ie)return t.field.canonicalString()+t.op.toString()+$o(t.value);if(dy(t))return t.filters.map(e=>kp(e)).join(",");{const e=t.filters.map(n=>kp(n)).join(",");return`${t.op}(${e})`}}function dT(t,e){return t instanceof Ie?function(r,s){return s instanceof Ie&&r.op===s.op&&r.field.isEqual(s.field)&&or(r.value,s.value)}(t,e):t instanceof Pe?function(r,s){return s instanceof Pe&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&dT(o,s.filters[a]),!0):!1}(t,e):void te(19439)}function hT(t,e){const n=t.filters.concat(e);return Pe.create(n,t.op)}function fT(t){return t instanceof Ie?function(n){return`${n.field.canonicalString()} ${n.op} ${$o(n.value)}`}(t):t instanceof Pe?function(n){return n.op.toString()+" {"+n.getFilters().map(fT).join(" ,")+"}"}(t):"Filter"}class Q2 extends Ie{constructor(e,n,r){super(e,n,r),this.key=ee.fromName(r.referenceValue)}matches(e){const n=ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class Y2 extends Ie{constructor(e,n){super(e,"in",n),this.keys=mT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class J2 extends Ie{constructor(e,n){super(e,"not-in",n),this.keys=mT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function mT(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ee.fromName(r.referenceValue))}class X2 extends Ie{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Zl(n)&&Jl(n.arrayValue,this.value)}}class pT extends Ie{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Jl(this.value.arrayValue,n)}}class Z2 extends Ie{constructor(e,n){super(e,"not-in",n)}matches(e){if(Jl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Jl(this.value.arrayValue,n)}}class eP extends Ie{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Zl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Jl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Rp(t,e=null,n=[],r=[],s=null,i=null,o=null){return new tP(t,e,n,r,s,i,o)}function Ii(t){const e=se(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>kp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),gc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$o(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$o(r)).join(",")),e.Te=n}return e.Te}function vc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!W2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!dT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!tx(t.startAt,e.startAt)&&tx(t.endAt,e.endAt)}function Nd(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Cd(t,e){return t.filters.filter(n=>n instanceof Ie&&n.field.isEqual(e))}function nx(t,e,n){let r=Mu,s=!0;for(const i of Cd(t,e)){let o=Mu,a=!0;switch(i.op){case"<":case"<=":o=G2(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Mu}X0({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];X0({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function rx(t,e,n){let r=cs,s=!0;for(const i of Cd(t,e)){let o=cs,a=!0;switch(i.op){case">=":case">":o=K2(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=cs}Z0({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];Z0({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function gT(t,e,n,r,s,i,o,a){return new aa(t,e,n,r,s,i,o,a)}function _c(t){return new aa(t)}function sx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function nP(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function yT(t){return t.collectionGroup!==null}function xl(t){const e=se(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new je(Qe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new ec(i,r))}),n.has(Qe.keyField().canonicalString())||e.Ie.push(new ec(Qe.keyField(),r))}return e.Ie}function fn(t){const e=se(t);return e.Ee||(e.Ee=rP(e,xl(t))),e.Ee}function rP(t,e){if(t.limitType==="F")return Rp(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ec(s.field,i)});const n=t.endAt?new qo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new qo(t.startAt.position,t.startAt.inclusive):null;return Rp(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Pp(t,e){const n=t.filters.concat([e]);return new aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function sP(t,e){const n=t.explicitOrderBy.concat([e]);return new aa(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function kd(t,e,n){return new aa(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Sh(t,e){return vc(fn(t),fn(e))&&t.limitType===e.limitType}function vT(t){return`${Ii(fn(t))}|lt:${t.limitType}`}function Xi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>fT(s)).join(", ")}]`),gc(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>$o(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>$o(s)).join(",")),`Target(${r})`}(fn(t))}; limitType=${t.limitType})`}function xc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of xl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const d=ex(o,a,c);return o.inclusive?d<=0:d<0}(r.startAt,xl(r),s)||r.endAt&&!function(o,a,c){const d=ex(o,a,c);return o.inclusive?d>=0:d>0}(r.endAt,xl(r),s))}(t,e)}function _T(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function xT(t){return(e,n)=>{let r=!1;for(const s of xl(t)){const i=iP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function iP(t,e,n){const r=t.field.isKeyField()?ee.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),d=a.data.field(i);return c!==null&&d!==null?Rs(c,d):te(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return te(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Fs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Z1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oP=new Ue(ee.comparator);function cn(){return oP}const wT=new Ue(ee.comparator);function el(...t){let e=wT;for(const n of t)e=e.insert(n.key,n);return e}function ET(t){let e=wT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Xn(){return wl()}function IT(){return wl()}function wl(){return new Dr(t=>t.toString(),(t,e)=>t.isEqual(e))}const aP=new Ue(ee.comparator),lP=new je(ee.comparator);function ve(...t){let e=lP;for(const n of t)e=e.add(n);return e}const cP=new je(fe);function hy(){return cP}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gl(e)?"-0":e}}function TT(t){return{integerValue:""+t}}function uP(t,e){return B1(e)?TT(e):fy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(){this._=void 0}}function dP(t,e,n){return t instanceof Go?function(s,i){const o={fields:{[nT]:{stringValue:tT},[sT]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&ly(i)&&(i=Th(i)),i&&(o.fields[rT]=i),{mapValue:o}}(n,e):t instanceof Ko?ST(t,e):t instanceof Wo?AT(t,e):function(s,i){const o=bT(s,i),a=ix(o)+ix(s.Ae);return Np(o)&&Np(s.Ae)?TT(a):fy(s.serializer,a)}(t,e)}function hP(t,e,n){return t instanceof Ko?ST(t,e):t instanceof Wo?AT(t,e):n}function bT(t,e){return t instanceof tc?function(r){return Np(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Go extends Ah{}class Ko extends Ah{constructor(e){super(),this.elements=e}}function ST(t,e){const n=NT(e);for(const r of t.elements)n.some(s=>or(s,r))||n.push(r);return{arrayValue:{values:n}}}class Wo extends Ah{constructor(e){super(),this.elements=e}}function AT(t,e){let n=NT(e);for(const r of t.elements)n=n.filter(s=>!or(s,r));return{arrayValue:{values:n}}}class tc extends Ah{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function ix(t){return qe(t.integerValue||t.doubleValue)}function NT(t){return Zl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CT{constructor(e,n){this.field=e,this.transform=n}}function fP(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Ko&&s instanceof Ko||r instanceof Wo&&s instanceof Wo?Oo(r.elements,s.elements,or):r instanceof tc&&s instanceof tc?or(r.Ae,s.Ae):r instanceof Go&&s instanceof Go}(t.transform,e.transform)}class mP{constructor(e,n){this.version=e,this.transformResults=n}}class Ke{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ke}static exists(e){return new Ke(void 0,e)}static updateTime(e){return new Ke(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Uu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Nh{}function kT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ca(t.key,Ke.none()):new la(t.key,t.data,Ke.none());{const n=t.data,r=At.empty();let s=new je(Qe.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new jr(t.key,r,new Xt(s.toArray()),Ke.none())}}function pP(t,e,n){t instanceof la?function(s,i,o){const a=s.value.clone(),c=ax(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof jr?function(s,i,o){if(!Uu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=ax(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(RT(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function El(t,e,n,r){return t instanceof la?function(i,o,a,c){if(!Uu(i.precondition,o))return a;const d=i.value.clone(),h=lx(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof jr?function(i,o,a,c){if(!Uu(i.precondition,o))return a;const d=lx(i.fieldTransforms,c,o),h=o.data;return h.setAll(RT(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,a){return Uu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function gP(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=bT(r.transform,s||null);i!=null&&(n===null&&(n=At.empty()),n.set(r.field,i))}return n||null}function ox(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Oo(r,s,(i,o)=>fP(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class la extends Nh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class jr extends Nh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function RT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function ax(t,e,n){const r=new Map;oe(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,hP(o,a,n[s]))}return r}function lx(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,dP(i,o,e))}return r}class ca extends Nh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class my extends Nh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&pP(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=El(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=El(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=IT();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=kT(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ae.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ve())}isEqual(e){return this.batchId===e.batchId&&Oo(this.mutations,e.mutations,(n,r)=>ox(n,r))&&Oo(this.baseMutations,e.baseMutations,(n,r)=>ox(n,r))}}class gy{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){oe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return aP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new gy(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var at,Te;function PT(t){switch(t){case z.OK:return te(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return te(15467,{code:t})}}function DT(t){if(t===void 0)return it("GRPC error has no .code"),z.UNKNOWN;switch(t){case at.OK:return z.OK;case at.CANCELLED:return z.CANCELLED;case at.UNKNOWN:return z.UNKNOWN;case at.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case at.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case at.INTERNAL:return z.INTERNAL;case at.UNAVAILABLE:return z.UNAVAILABLE;case at.UNAUTHENTICATED:return z.UNAUTHENTICATED;case at.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case at.NOT_FOUND:return z.NOT_FOUND;case at.ALREADY_EXISTS:return z.ALREADY_EXISTS;case at.PERMISSION_DENIED:return z.PERMISSION_DENIED;case at.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case at.ABORTED:return z.ABORTED;case at.OUT_OF_RANGE:return z.OUT_OF_RANGE;case at.UNIMPLEMENTED:return z.UNIMPLEMENTED;case at.DATA_LOSS:return z.DATA_LOSS;default:return te(39323,{code:t})}}(Te=at||(at={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vP(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _P=new ws([4294967295,4294967295],0);function cx(t){const e=vP().encode(t),n=new A1;return n.update(e),new Uint8Array(n.digest())}function ux(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new ws([n,r],0),new ws([s,i],0)]}class vy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new tl(`Invalid padding: ${n}`);if(r<0)throw new tl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new tl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new tl(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=ws.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(ws.fromNumber(r)));return s.compare(_P)===1&&(s=new ws([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=cx(e),[r,s]=ux(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new vy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=cx(e),[r,s]=ux(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class tl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Ec.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new wc(ae.min(),s,new Ue(fe),cn(),ve())}}class Ec{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Ec(r,n,ve(),ve(),ve())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=s}}class jT{constructor(e,n){this.targetId=e,this.Ce=n}}class VT{constructor(e,n,r=ot.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class dx{constructor(){this.ve=0,this.Fe=hx(),this.Me=ot.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ve(),n=ve(),r=ve();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:te(38017,{changeType:i})}}),new Ec(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=hx()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,oe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class xP{constructor(e){this.Ge=e,this.ze=new Map,this.je=cn(),this.He=lu(),this.Je=lu(),this.Ze=new Ue(fe)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:te(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(Nd(i))if(r===0){const o=new ee(i.path);this.et(n,o,Ge.newNoDocument(o,ae.min()))}else oe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Nr(r).toUint8Array()}catch(c){if(c instanceof eT)return Vo("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new vy(o,s,i)}catch(c){return Vo(c instanceof tl?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&Nd(a.target)){const c=new ee(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Ge.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.Ke())}});let r=ve();this.Je.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new wc(e,n,this.Ze,this.je,r);return this.je=cn(),this.He=lu(),this.Je=lu(),this.Ze=new Ue(fe),s}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.qe(n,1):s.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new dx,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new je(fe),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new je(fe),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new dx),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function lu(){return new Ue(ee.comparator)}function hx(){return new Ue(ee.comparator)}const wP={asc:"ASCENDING",desc:"DESCENDING"},EP={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IP={and:"AND",or:"OR"};class TP{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Dp(t,e){return t.useProto3Json||gc(e)?e:{value:e}}function Qo(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function OT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function bP(t,e){return Qo(t,e.toTimestamp())}function It(t){return oe(!!t,49232),ae.fromTimestamp(function(n){const r=Ar(n);return new Re(r.seconds,r.nanos)}(t))}function _y(t,e){return jp(t,e).canonicalString()}function jp(t,e){const n=function(s){return new be(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function MT(t){const e=be.fromString(t);return oe(GT(e),10190,{key:e.toString()}),e}function nc(t,e){return _y(t.databaseId,e.path)}function vr(t,e){const n=MT(e);if(n.get(1)!==t.databaseId.projectId)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new G(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ee(UT(n))}function LT(t,e){return _y(t.databaseId,e)}function FT(t){const e=MT(t);return e.length===4?be.emptyPath():UT(e)}function Vp(t){return new be(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function UT(t){return oe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function fx(t,e,n){return{name:nc(t,e),fields:n.value.mapValue.fields}}function SP(t,e,n){const r=vr(t,e.name),s=It(e.updateTime),i=e.createTime?It(e.createTime):ae.min(),o=new At({mapValue:{fields:e.fields}}),a=Ge.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function AP(t,e){return"found"in e?function(r,s){oe(!!s.found,43571),s.found.name,s.found.updateTime;const i=vr(r,s.found.name),o=It(s.found.updateTime),a=s.found.createTime?It(s.found.createTime):ae.min(),c=new At({mapValue:{fields:s.found.fields}});return Ge.newFoundDocument(i,o,a,c)}(t,e):"missing"in e?function(r,s){oe(!!s.missing,3894),oe(!!s.readTime,22933);const i=vr(r,s.missing),o=It(s.readTime);return Ge.newNoDocument(i,o)}(t,e):te(7234,{result:e})}function NP(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:te(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(oe(h===void 0||typeof h=="string",58123),ot.fromBase64String(h||"")):(oe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),ot.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?z.UNKNOWN:DT(d.code);return new G(h,d.message||"")}(o);n=new VT(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=vr(t,r.document.name),i=It(r.document.updateTime),o=r.document.createTime?It(r.document.createTime):ae.min(),a=new At({mapValue:{fields:r.document.fields}}),c=Ge.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new zu(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=vr(t,r.document),i=r.readTime?It(r.readTime):ae.min(),o=Ge.newNoDocument(s,i),a=r.removedTargetIds||[];n=new zu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=vr(t,r.document),i=r.removedTargetIds||[];n=new zu([],i,s,null)}else{if(!("filter"in e))return te(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new yP(s,i),a=r.targetId;n=new jT(a,o)}}return n}function rc(t,e){let n;if(e instanceof la)n={update:fx(t,e.key,e.value)};else if(e instanceof ca)n={delete:nc(t,e.key)};else if(e instanceof jr)n={update:fx(t,e.key,e.data),updateMask:jP(e.fieldMask)};else{if(!(e instanceof my))return te(16599,{dt:e.type});n={verify:nc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Go)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ko)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Wo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof tc)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw te(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:bP(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:te(27497)}(t,e.precondition)),n}function Op(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Ke.updateTime(It(i.updateTime)):i.exists!==void 0?Ke.exists(i.exists):Ke.none()}(e.currentDocument):Ke.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)oe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Go;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];c=new Ko(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];c=new Wo(h)}else"increment"in a?c=new tc(o,a.increment):te(16584,{proto:a});const d=Qe.fromServerFormat(a.fieldPath);return new CT(d,c)}(t,s)):[];if(e.update){e.update.name;const s=vr(t,e.update.name),i=new At({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new Xt(d.map(h=>Qe.fromServerFormat(h)))}(e.updateMask);return new jr(s,i,o,n,r)}return new la(s,i,n,r)}if(e.delete){const s=vr(t,e.delete);return new ca(s,n)}if(e.verify){const s=vr(t,e.verify);return new my(s,n)}return te(1463,{proto:e})}function CP(t,e){return t&&t.length>0?(oe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?It(s.updateTime):It(i);return o.isEqual(ae.min())&&(o=It(i)),new mP(o,s.transformResults||[])}(n,e))):[]}function zT(t,e){return{documents:[LT(t,e.path)]}}function BT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=LT(t,s);const i=function(d){if(d.length!==0)return HT(Pe.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(p){return{field:Zi(p.field),direction:RP(p.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Dp(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function $T(t){let e=FT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){oe(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(m){const p=qT(m);return p instanceof Pe&&dy(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(p=>function(A){return new ec(eo(A.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(m){let p;return p=typeof m=="object"?m.value:m,gc(p)?null:p}(n.limit));let c=null;n.startAt&&(c=function(m){const p=!!m.before,x=m.values||[];return new qo(x,p)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const p=!m.before,x=m.values||[];return new qo(x,p)}(n.endAt)),gT(e,s,o,i,a,"F",c,d)}function kP(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return te(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function qT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=eo(n.unaryFilter.field);return Ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=eo(n.unaryFilter.field);return Ie.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=eo(n.unaryFilter.field);return Ie.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=eo(n.unaryFilter.field);return Ie.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return te(61313);default:return te(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ie.create(eo(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return te(58110);default:return te(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Pe.create(n.compositeFilter.filters.map(r=>qT(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return te(1026)}}(n.compositeFilter.op))}(t):te(30097,{filter:t})}function RP(t){return wP[t]}function PP(t){return EP[t]}function DP(t){return IP[t]}function Zi(t){return{fieldPath:t.canonicalString()}}function eo(t){return Qe.fromServerFormat(t.fieldPath)}function HT(t){return t instanceof Ie?function(n){if(n.op==="=="){if(J0(n.value))return{unaryFilter:{field:Zi(n.field),op:"IS_NAN"}};if(Y0(n.value))return{unaryFilter:{field:Zi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(J0(n.value))return{unaryFilter:{field:Zi(n.field),op:"IS_NOT_NAN"}};if(Y0(n.value))return{unaryFilter:{field:Zi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zi(n.field),op:PP(n.op),value:n.value}}}(t):t instanceof Pe?function(n){const r=n.getFilters().map(s=>HT(s));return r.length===1?r[0]:{compositeFilter:{op:DP(n.op),filters:r}}}(t):te(54877,{filter:t})}function jP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function GT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function KT(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mr{constructor(e,n,r,s,i=ae.min(),o=ae.min(),a=ot.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new mr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new mr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e){this.yt=e}}function VP(t,e){let n;if(e.document)n=SP(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ee.fromSegments(e.noDocument.path),s=bi(e.noDocument.readTime);n=Ge.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return te(56709);{const r=ee.fromSegments(e.unknownDocument.path),s=bi(e.unknownDocument.version);n=Ge.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Re(s[0],s[1]);return ae.fromTimestamp(i)}(e.readTime)),n}function mx(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Rd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:nc(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Qo(i,o.version.toTimestamp()),createTime:Qo(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ti(e.version)};else{if(!e.isUnknownDocument())return te(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Ti(e.version)}}return r}function Rd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ti(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function bi(t){const e=new Re(t.seconds,t.nanoseconds);return ae.fromTimestamp(e)}function ni(t,e){const n=(e.baseMutations||[]).map(i=>Op(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Op(t.yt,i)),s=Re.fromMillis(e.localWriteTimeMs);return new py(e.batchId,s,n,r)}function nl(t){const e=bi(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?bi(t.lastLimboFreeSnapshotVersion):ae.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return oe(o===1,1966,{count:o}),fn(_c(FT(i.documents[0])))}(t.query):function(i){return fn($T(i))}(t.query),new mr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,ot.fromBase64String(t.resumeToken))}function QT(t,e){const n=Ti(e.snapshotVersion),r=Ti(e.lastLimboFreeSnapshotVersion);let s;s=Nd(e.target)?zT(t.yt,e.target):BT(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ii(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function YT(t){const e=$T({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?kd(e,e.limit,"L"):e}function Kf(t,e){return new yy(e.largestBatchId,Op(t.yt,e.overlayMutation))}function px(t,e){const n=e.path.lastSegment();return[t,Mt(e.path.popLast()),n]}function gx(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ti(r.readTime),documentKey:Mt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{getBundleMetadata(e,n){return yx(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:bi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return yx(e).put(function(s){return{bundleId:s.id,createTime:Ti(It(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return vx(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:YT(i.bundledQuery),readTime:bi(i.readTime)}}(r)})}saveNamedQuery(e,n){return vx(e).put(function(s){return{name:s.name,readTime:Ti(It(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function yx(t){return yt(t,wh)}function vx(t){return yt(t,Eh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ch{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Ch(e,r)}getOverlay(e,n){return La(e).get(px(this.userId,n)).next(r=>r?Kf(this.serializer,r):null)}getOverlays(e,n){const r=Xn();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new yy(n,o);s.push(this.bt(e,a))}),V.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Mt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(La(e).X(bp,a))}),V.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Xn(),i=Mt(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return La(e).H(bp,o).next(a=>{for(const c of a){const d=Kf(this.serializer,c);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Xn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return La(e).ee({index:W1,range:a},(c,d,h)=>{const m=Kf(this.serializer,d);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):h.done()}).next(()=>i)}bt(e,n){return La(e).put(function(s,i,o){const[a,c,d]=px(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:rc(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function La(t){return yt(t,Ih)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{St(e){return yt(e,oy)}getSessionToken(e){return this.St(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?ot.fromUint8Array(r):ot.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.St(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(qe(e.integerValue));else if("doubleValue"in e){const r=qe(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Gl(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=Ar(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Nr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?oT(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):bh(e)?this.kt(e.mapValue,n):(this.Kt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.qt(e.arrayValue,n),this.Nt(n)):te(19022,{Ut:e})}Ot(e,n){this.Ft(n,25),this.$t(e,n)}$t(e,n){n.xt(e)}Kt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=Bo,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(qe(i)),this.Ot(s,n),this.Ct(r[s],n)}qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),ee.fromName(e).path.forEach(r=>{this.Ft(n,60),this.$t(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}ri.Wt=new ri;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gi=255;function LP(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function _x(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=LP(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class FP{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ht(r.value),r=n.next();this.Jt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const s=n.codePointAt(0);this.Ht(240|s>>>18),this.Ht(128|63&s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s)}}this.Jt()}Yt(e){const n=this.en(e),r=_x(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=_x(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(Gi),this.sn(255)}_n(){this.an(Gi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Gi?(this.sn(Gi),this.sn(0)):this.sn(n)}Ht(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Gi?(this.an(Gi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class UP{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class zP{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Fa{constructor(){this.cn=new FP,this.ascending=new UP(this.cn),this.descending=new zP(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n,r,s){this.hn=e,this.Pn=n,this.Tn=r,this.In=s}En(){const e=this.In.length,n=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.In,0),n!==e?r.set([0],this.In.length):++r[r.length-1],new si(this.hn,this.Pn,this.Tn,r)}Rn(e,n,r){return{indexId:this.hn,uid:e,arrayValue:Bu(this.Tn),directionalValue:Bu(this.In),orderedDocumentKey:Bu(n),documentKey:r.path.toArray()}}An(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Hr(t,e){let n=t.hn-e.hn;return n!==0?n:(n=xx(t.Tn,e.Tn),n!==0?n:(n=xx(t.In,e.In),n!==0?n:ee.comparator(t.Pn,e.Pn)))}function xx(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Bu(t){return x1()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function wx(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class Ex{constructor(e){this.Vn=new je((n,r)=>Qe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(oe(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const n=Ep(e);if(n!==void 0&&!this.pn(n))return!1;const r=Zs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.pn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){const a=this.Vn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.yn(a,c)||!this.wn(this.dn[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.dn.length||!this.wn(this.dn[o++],a))return!1}return!0}bn(){if(this.fn)return null;let e=new je(Qe.comparator);const n=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new ju(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new ju(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new ju(r.field,r.dir==="asc"?0:1)));return new Id(Id.UNKNOWN_ID,this.collectionId,n,Hl.empty())}pn(e){for(const n of this.mn)if(this.yn(n,e))return!0;return!1}yn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}wn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JT(t){var n,r;if(oe(t instanceof Ie||t instanceof Pe,20012),t instanceof Ie){if(t instanceof pT){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Ie.create(t.field,"==",i)))||[];return Pe.create(s,"or")}return t}const e=t.filters.map(s=>JT(s));return Pe.create(e,t.op)}function BP(t){if(t.getFilters().length===0)return[];const e=Fp(JT(t));return oe(XT(e),7391),Mp(e)||Lp(e)?[e]:e.getFilters()}function Mp(t){return t instanceof Ie}function Lp(t){return t instanceof Pe&&dy(t)}function XT(t){return Mp(t)||Lp(t)||function(n){if(n instanceof Pe&&Cp(n)){for(const r of n.getFilters())if(!Mp(r)&&!Lp(r))return!1;return!0}return!1}(t)}function Fp(t){if(oe(t instanceof Ie||t instanceof Pe,34018),t instanceof Ie)return t;if(t.filters.length===1)return Fp(t.filters[0]);const e=t.filters.map(r=>Fp(r));let n=Pe.create(e,t.op);return n=Pd(n),XT(n)?n:(oe(n instanceof Pe,64498),oe(Ho(n),40251),oe(n.filters.length>1,57927),n.filters.reduce((r,s)=>xy(r,s)))}function xy(t,e){let n;return oe(t instanceof Ie||t instanceof Pe,38388),oe(e instanceof Ie||e instanceof Pe,25473),n=t instanceof Ie?e instanceof Ie?function(s,i){return Pe.create([s,i],"and")}(t,e):Ix(t,e):e instanceof Ie?Ix(e,t):function(s,i){if(oe(s.filters.length>0&&i.filters.length>0,48005),Ho(s)&&Ho(i))return hT(s,i.getFilters());const o=Cp(s)?s:i,a=Cp(s)?i:s,c=o.filters.map(d=>xy(d,a));return Pe.create(c,"or")}(t,e),Pd(n)}function Ix(t,e){if(Ho(e))return hT(e,t.getFilters());{const n=e.filters.map(r=>xy(t,r));return Pe.create(n,"or")}}function Pd(t){if(oe(t instanceof Ie||t instanceof Pe,11850),t instanceof Ie)return t;const e=t.getFilters();if(e.length===1)return Pd(e[0]);if(uT(t))return t;const n=e.map(s=>Pd(s)),r=[];return n.forEach(s=>{s instanceof Ie?r.push(s):s instanceof Pe&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Pe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this.Sn=new wy}addToCollectionParentIndex(e,n){return this.Sn.add(n),V.resolve()}getCollectionParents(e,n){return V.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return V.resolve()}deleteFieldIndex(e,n){return V.resolve()}deleteAllFieldIndexes(e){return V.resolve()}createTargetIndexes(e,n){return V.resolve()}getDocumentsMatchingTarget(e,n){return V.resolve(null)}getIndexType(e,n){return V.resolve(0)}getFieldIndexes(e,n){return V.resolve([])}getNextCollectionGroupToUpdate(e){return V.resolve(null)}getMinOffset(e,n){return V.resolve(pn.min())}getMinOffsetFromCollectionGroup(e,n){return V.resolve(pn.min())}updateCollectionGroup(e,n,r){return V.resolve()}updateIndexEntries(e,n){return V.resolve()}}class wy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new je(be.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new je(be.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx="IndexedDbIndexManager",cu=new Uint8Array(0);class qP{constructor(e,n){this.databaseId=n,this.Dn=new wy,this.Cn=new Dr(r=>Ii(r),(r,s)=>vc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Dn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Dn.add(n)});const i={collectionId:r,parent:Mt(s)};return bx(e).put(i)}return V.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[j1(n),""],!1,!0);return bx(e).H(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Jn(o.parent))}return r})}addFieldIndex(e,n){const r=Ua(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Wi(e);return i.next(a=>{o.put(gx(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Ua(e),s=Wi(e),i=Ki(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Ua(e),r=Ki(e),s=Wi(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return V.forEach(this.vn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new Ex(r).bn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Ki(e);let s=!0;const i=new Map;return V.forEach(this.vn(n),o=>this.Fn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ve();const a=[];return V.forEach(i,(c,d)=>{q(Tx,`Using index ${function(w){return`id=${w.indexId}|cg=${w.collectionGroup}|f=${w.fields.map(P=>`${P.fieldPath}:${P.kind}`).join(",")}`}(c)} to execute ${Ii(n)}`);const h=function(w,P){const j=Ep(P);if(j===void 0)return null;for(const L of Cd(w,j.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(d,c),m=function(w,P){const j=new Map;for(const L of Zs(P))for(const E of Cd(w,L.fieldPath))switch(E.op){case"==":case"in":j.set(L.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return j.set(L.fieldPath.canonicalString(),E.value),Array.from(j.values())}return null}(d,c),p=function(w,P){const j=[];let L=!0;for(const E of Zs(P)){const y=E.kind===0?nx(w,E.fieldPath,w.startAt):rx(w,E.fieldPath,w.startAt);j.push(y.value),L&&(L=y.inclusive)}return new qo(j,L)}(d,c),x=function(w,P){const j=[];let L=!0;for(const E of Zs(P)){const y=E.kind===0?rx(w,E.fieldPath,w.endAt):nx(w,E.fieldPath,w.endAt);j.push(y.value),L&&(L=y.inclusive)}return new qo(j,L)}(d,c),A=this.Mn(c,d,p),C=this.Mn(c,d,x),k=this.xn(c,d,m),_=this.On(c.indexId,h,A,p.inclusive,C,x.inclusive,k);return V.forEach(_,v=>r.Z(v,n.limit).next(w=>{w.forEach(P=>{const j=ee.fromSegments(P.documentKey);o.has(j)||(o=o.add(j),a.push(j))})}))}).next(()=>a)}return V.resolve(null)})}vn(e){let n=this.Cn.get(e);return n||(e.filters.length===0?n=[e]:n=BP(Pe.create(e.filters,"and")).map(r=>Rp(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,n),n)}On(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),d=c/(n!=null?n.length:1),h=[];for(let m=0;m<c;++m){const p=n?this.Nn(n[m/d]):cu,x=this.Bn(e,p,r[m%d],s),A=this.Ln(e,p,i[m%d],o),C=a.map(k=>this.Bn(e,p,k,!0));h.push(...this.createRange(x,A,C))}return h}Bn(e,n,r,s){const i=new si(e,ee.empty(),n,r);return s?i:i.En()}Ln(e,n,r,s){const i=new si(e,ee.empty(),n,r);return s?i.En():i}Fn(e,n){const r=new Ex(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.gn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.vn(n);return V.forEach(s,i=>this.Fn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let d=new je(Qe.comparator),h=!1;for(const m of c.filters)for(const p of m.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?h=!0:d=d.add(p.field));for(const m of c.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}kn(e,n){const r=new Fa;for(const s of Zs(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.ln(s.kind);ri.Wt.Dt(i,o)}return r.un()}Nn(e){const n=new Fa;return ri.Wt.Dt(e,n.ln(0)),n.un()}Kn(e,n){const r=new Fa;return ri.Wt.Dt(Xl(this.databaseId,n),r.ln(function(i){const o=Zs(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}xn(e,n,r){if(r===null)return[];let s=[];s.push(new Fa);let i=0;for(const o of Zs(e)){const a=r[i++];for(const c of s)if(this.qn(n,o.fieldPath)&&Zl(a))s=this.Un(s,o,a);else{const d=c.ln(o.kind);ri.Wt.Dt(a,d)}}return this.$n(s)}Mn(e,n,r){return this.xn(e,n,r.position)}$n(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Un(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new Fa;c.seed(a.un()),ri.Wt.Dt(o,c.ln(n.kind)),i.push(c)}return i}qn(e,n){return!!e.filters.find(r=>r instanceof Ie&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Ua(e),s=Wi(e);return(n?r.H(Tp,IDBKeyRange.bound(n,n)):r.H()).next(i=>{const o=[];return V.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(h,m){const p=m?new Hl(m.sequenceNumber,new pn(bi(m.readTime),new ee(Jn(m.documentKey)),m.largestBatchId)):Hl.empty(),x=h.fields.map(([A,C])=>new ju(Qe.fromServerFormat(A),C));return new Id(h.indexId,h.collectionGroup,x,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:fe(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Ua(e),i=Wi(e);return this.Wn(e).next(o=>s.H(Tp,IDBKeyRange.bound(n,n)).next(a=>V.forEach(a,c=>i.put(gx(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return V.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?V.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),V.forEach(a,c=>this.Qn(e,s,c).next(d=>{const h=this.Gn(i,c);return d.isEqual(h)?V.resolve():this.zn(e,i,c,d,h)}))))})}jn(e,n,r,s){return Ki(e).put(s.Rn(this.uid,this.Kn(r,n.key),n.key))}Hn(e,n,r,s){return Ki(e).delete(s.An(this.uid,this.Kn(r,n.key),n.key))}Qn(e,n,r){const s=Ki(e);let i=new je(Hr);return s.ee({index:K1,range:IDBKeyRange.only([r.indexId,this.uid,Bu(this.Kn(r,n))])},(o,a)=>{i=i.add(new si(r.indexId,n,wx(a.arrayValue),wx(a.directionalValue)))}).next(()=>i)}Gn(e,n){let r=new je(Hr);const s=this.kn(n,e);if(s==null)return r;const i=Ep(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Zl(o))for(const a of o.arrayValue.values||[])r=r.add(new si(n.indexId,e.key,this.Nn(a),s))}else r=r.add(new si(n.indexId,e.key,cu,s));return r}zn(e,n,r,s,i){q(Tx,"Updating index entries for document '%s'",n.key);const o=[];return function(c,d,h,m,p){const x=c.getIterator(),A=d.getIterator();let C=Hi(x),k=Hi(A);for(;C||k;){let _=!1,v=!1;if(C&&k){const w=h(C,k);w<0?v=!0:w>0&&(_=!0)}else C!=null?v=!0:_=!0;_?(m(k),k=Hi(A)):v?(p(C),C=Hi(x)):(C=Hi(x),k=Hi(A))}}(s,i,Hr,a=>{o.push(this.jn(e,n,r,a))},a=>{o.push(this.Hn(e,n,r,a))}),V.waitFor(o)}Wn(e){let n=1;return Wi(e).ee({index:G1,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Hr(o,a)).filter((o,a,c)=>!a||Hr(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Hr(o,e),c=Hr(o,n);if(a===0)s[0]=e.En();else if(a>0&&c<0)s.push(o),s.push(o.En());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Jn(s[o],s[o+1]))return[];const a=s[o].An(this.uid,cu,ee.empty()),c=s[o+1].An(this.uid,cu,ee.empty());i.push(IDBKeyRange.bound(a,c))}return i}Jn(e,n){return Hr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Sx)}getMinOffset(e,n){return V.mapArray(this.vn(n),r=>this.Fn(e,r).next(s=>s||te(44426))).next(Sx)}}function bx(t){return yt(t,Ql)}function Ki(t){return yt(t,vl)}function Ua(t){return yt(t,iy)}function Wi(t){return yt(t,yl)}function Sx(t){oe(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;ny(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new pn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ax={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ZT=41943040;class Vt{static withCacheSize(e){return new Vt(e,Vt.DEFAULT_COLLECTION_PERCENTILE,Vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eb(t,e,n){const r=t.store(kn),s=t.store(Lo),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.ee({range:o},(h,m,p)=>(a++,p.delete()));i.push(c.next(()=>{oe(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const m=$1(e,h.key.path,n.batchId);i.push(s.delete(m)),d.push(h.key)}return V.waitFor(i).next(()=>d)}function Dd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw te(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Vt.DEFAULT_COLLECTION_PERCENTILE=10,Vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Vt.DEFAULT=new Vt(ZT,Vt.DEFAULT_COLLECTION_PERCENTILE,Vt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Vt.DISABLED=new Vt(-1,0,0);class kh{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Zn={}}static wt(e,n,r,s){oe(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new kh(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Gr(e).ee({index:li,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=to(e),o=Gr(e);return o.add({}).next(a=>{oe(typeof a=="number",49019);const c=new py(a,n,r,s),d=function(x,A,C){const k=C.baseMutations.map(v=>rc(x.yt,v)),_=C.mutations.map(v=>rc(x.yt,v));return{userId:A,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:k,mutations:_}}(this.serializer,this.userId,c),h=[];let m=new je((p,x)=>fe(p.canonicalString(),x.canonicalString()));for(const p of s){const x=$1(this.userId,p.key.path,a);m=m.add(p.key.path.popLast()),h.push(o.put(d)),h.push(i.put(x,_2))}return m.forEach(p=>{h.push(this.indexManager.addToCollectionParentIndex(e,p))}),e.addOnCommittedListener(()=>{this.Zn[a]=c.keys()}),V.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return Gr(e).get(n).next(r=>r?(oe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),ni(this.serializer,r)):null)}Xn(e,n){return this.Zn[n]?V.resolve(this.Zn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Zn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Gr(e).ee({index:li,range:s},(o,a,c)=>{a.userId===this.userId&&(oe(a.batchId>=r,47524,{Yn:r}),i=ni(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=di;return Gr(e).ee({index:li,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,di],[this.userId,Number.POSITIVE_INFINITY]);return Gr(e).H(li,n).next(r=>r.map(s=>ni(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Vu(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return to(e).ee({range:s},(o,a,c)=>{const[d,h,m]=o,p=Jn(h);if(d===this.userId&&n.path.isEqual(p))return Gr(e).get(m).next(x=>{if(!x)throw te(61480,{er:o,batchId:m});oe(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:m}),i.push(ni(this.serializer,x))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new je(fe);const s=[];return n.forEach(i=>{const o=Vu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=to(e).ee({range:a},(d,h,m)=>{const[p,x,A]=d,C=Jn(x);p===this.userId&&i.path.isEqual(C)?r=r.add(A):m.done()});s.push(c)}),V.waitFor(s).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Vu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new je(fe);return to(e).ee({range:o},(c,d,h)=>{const[m,p,x]=c,A=Jn(p);m===this.userId&&r.isPrefixOf(A)?A.length===s&&(a=a.add(x)):h.done()}).next(()=>this.tr(e,a))}tr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Gr(e).get(i).next(o=>{if(o===null)throw te(35274,{batchId:i});oe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(ni(this.serializer,o))}))}),V.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return eb(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.nr(n.batchId)}),V.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return V.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return to(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=Jn(i[1]);s.push(c)}else a.done()}).next(()=>{oe(s.length===0,56720,{rr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return tb(e,this.userId,n)}ir(e){return nb(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:di,lastStreamToken:""})}}function tb(t,e,n){const r=Vu(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return to(t).ee({range:i,Y:!0},(a,c,d)=>{const[h,m,p]=a;h===e&&m===s&&(o=!0),d.done()}).next(()=>o)}function Gr(t){return yt(t,kn)}function to(t){return yt(t,Lo)}function nb(t){return yt(t,Kl)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Si(0)}static ar(){return new Si(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HP{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.ur(e).next(n=>{const r=new Si(n.highestTargetId);return n.highestTargetId=r.next(),this.cr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(n=>ae.fromTimestamp(new Re(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.ur(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.cr(e,s)))}addTargetData(e,n){return this.lr(e,n).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(n,r),this.cr(e,r))))}updateTargetData(e,n){return this.lr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Qi(e).delete(n.targetId)).next(()=>this.ur(e)).next(r=>(oe(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Qi(e).ee((o,a)=>{const c=nl(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>V.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Qi(e).ee((r,s)=>{const i=nl(s);n(i)})}ur(e){return Nx(e).get(Sd).next(n=>(oe(n!==null,2888),n))}cr(e,n){return Nx(e).put(Sd,n)}lr(e,n){return Qi(e).put(QT(this.serializer,n))}hr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ii(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Qi(e).ee({range:s,index:H1},(o,a,c)=>{const d=nl(a);vc(n,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=es(e);return n.forEach(o=>{const a=Mt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),V.waitFor(s)}removeMatchingKeys(e,n,r){const s=es(e);return V.forEach(n,i=>{const o=Mt(i.path);return V.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=es(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=es(e);let i=ve();return s.ee({range:r,Y:!0},(o,a,c)=>{const d=Jn(o[1]),h=new ee(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=Mt(n.path),s=IDBKeyRange.bound([r],[j1(r)],!1,!0);let i=0;return es(e).ee({index:sy,Y:!0,range:s},([o,a],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return Qi(e).get(n).next(r=>r?nl(r):null)}}function Qi(t){return yt(t,Fo)}function Nx(t){return yt(t,hi)}function es(t){return yt(t,Uo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="LruGarbageCollector",rb=1048576;function kx([t,e],[n,r]){const s=fe(t,n);return s===0?fe(e,r):s}class GP{constructor(e){this.Pr=e,this.buffer=new je(kx),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();kx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class sb{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){q(Cx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ls(n)?q(Cx,"Ignoring IndexedDB error during garbage collection: ",n):await Ms(n)}await this.Ar(3e5)})}}class KP{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return V.resolve(Jt.ce);const r=new GP(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.mr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),V.resolve(Ax)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ax):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,s,i,o,a,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),Ji()<=Ee.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${m} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),V.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function ib(t,e){return new KP(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(e,n){this.db=e,this.garbageCollector=ib(this,n)}dr(e){const n=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}mr(e,n){return this.yr(e,(r,s)=>n(s))}addReference(e,n,r){return uu(e,r)}removeReference(e,n,r){return uu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return uu(e,n)}wr(e,n){return function(s,i){let o=!1;return nb(s).te(a=>tb(s,a,i).next(c=>(c&&(o=!0),V.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.yr(e,(o,a)=>{if(a<=n){const c=this.wr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ae.min()),es(e).delete(function(m){return[0,Mt(m.path)]}(o))))});s.push(c)}}).next(()=>V.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return uu(e,n)}yr(e,n){const r=es(e);let s,i=Jt.ce;return r.ee({index:sy},([o,a],{path:c,sequenceNumber:d})=>{o===0?(i!==Jt.ce&&n(new ee(Jn(s)),i),i=d,s=c):i=Jt.ce}).next(()=>{i!==Jt.ce&&n(new ee(Jn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function uu(t,e){return es(t).put(function(r,s){return{targetId:0,path:Mt(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(){this.changes=new Dr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ge.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?V.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Qs(e).put(r)}removeEntry(e,n,r){return Qs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Rd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.br(e,r)))}getEntry(e,n){let r=Ge.newInvalidDocument(n);return Qs(e).ee({index:Ou,range:IDBKeyRange.only(za(n))},(s,i)=>{r=this.Sr(n,i)}).next(()=>r)}Dr(e,n){let r={size:0,document:Ge.newInvalidDocument(n)};return Qs(e).ee({index:Ou,range:IDBKeyRange.only(za(n))},(s,i)=>{r={document:this.Sr(n,i),size:Dd(i)}}).next(()=>r)}getEntries(e,n){let r=cn();return this.Cr(e,n,(s,i)=>{const o=this.Sr(s,i);r=r.insert(s,o)}).next(()=>r)}vr(e,n){let r=cn(),s=new Ue(ee.comparator);return this.Cr(e,n,(i,o)=>{const a=this.Sr(i,o);r=r.insert(i,a),s=s.insert(i,Dd(o))}).next(()=>({documents:r,Fr:s}))}Cr(e,n,r){if(n.isEmpty())return V.resolve();let s=new je(Dx);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(za(s.first()),za(s.last())),o=s.getIterator();let a=o.getNext();return Qs(e).ee({index:Ou,range:i},(c,d,h)=>{const m=ee.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&Dx(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(za(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Rd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Qs(e).H(IDBKeyRange.bound(a,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=cn();for(const m of d){const p=this.Sr(ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);p.isFoundDocument()&&(xc(n,p)||s.has(p.key))&&(h=h.insert(p.key,p))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=cn();const o=Px(n,r),a=Px(n,pn.max());return Qs(e).ee({index:q1,range:IDBKeyRange.bound(o,a,!0)},(c,d,h)=>{const m=this.Sr(ee.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new YP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Rx(e).get(Ip).next(n=>(oe(!!n,20021),n))}br(e,n){return Rx(e).put(Ip,n)}Sr(e,n){if(n){const r=VP(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ae.min())))return r}return Ge.newInvalidDocument(e)}}function ab(t){return new QP(t)}class YP extends ob{constructor(e,n){super(),this.Mr=e,this.trackRemovals=n,this.Or=new Dr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new je((i,o)=>fe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Or.get(i);if(n.push(this.Mr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=mx(this.Mr.serializer,o);s=s.add(i.path.popLast());const d=Dd(c);r+=d-a.size,n.push(this.Mr.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=mx(this.Mr.serializer,o.convertToNoDocument(ae.min()));n.push(this.Mr.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Mr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Mr.updateMetadata(e,r)),V.waitFor(n)}getFromCache(e,n){return this.Mr.Dr(e,n).next(r=>(this.Or.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Mr.vr(e,n).next(({documents:r,Fr:s})=>(s.forEach((i,o)=>{this.Or.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function Rx(t){return yt(t,Wl)}function Qs(t){return yt(t,bd)}function za(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Px(t,e){const n=e.documentKey.path.toArray();return[t,Rd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Dx(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=fe(n[i],r[i]),s)return s;return s=fe(n.length,r.length),s||(s=fe(n[n.length-2],r[r.length-2]),s||fe(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&El(r.mutation,s,Xt.empty(),Re.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ve()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ve()){const s=Xn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=el();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Xn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ve()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=cn();const o=wl(),a=function(){return wl()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof jr)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),El(h.mutation,d,h.mutation.getFieldMask(),Re.now())):o.set(d.key,Xt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new JP(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=wl();let s=new Ue((o,a)=>o-a),i=ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||Xt.empty();h=a.applyToLocalView(d,h),r.set(c,h);const m=(s.get(a.batchId)||ve()).add(c);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,h=c.value,m=IT();h.forEach(p=>{if(!i.has(p)){const x=kT(n.get(p),r.get(p));x!==null&&m.set(p,x),i=i.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return V.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return nP(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):V.resolve(Xn());let a=Mo,c=i;return o.next(d=>V.forEach(d,(h,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(h)?V.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,ve())).next(h=>({batchId:a,changes:ET(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ee(n)).next(r=>{let s=el();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=el();return this.indexManager.getCollectionParents(e,i).next(a=>V.forEach(a,c=>{const d=function(m,p){return new aa(p,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((m,p)=>{o=o.insert(m,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Ge.newInvalidDocument(h)))});let a=el();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&El(h.mutation,d,Xt.empty(),Re.now()),xc(n,d)&&(a=a.insert(c,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return V.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:It(s.createTime)}}(n)),V.resolve()}getNamedQuery(e,n){return V.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(s){return{name:s.name,query:YT(s.bundledQuery),readTime:It(s.readTime)}}(n)),V.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZP{constructor(){this.overlays=new Ue(ee.comparator),this.Lr=new Map}getOverlay(e,n){return V.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Xn();return V.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),V.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Lr.delete(r)),V.resolve()}getOverlaysForCollection(e,n,r){const s=Xn(),i=n.length+1,o=new ee(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return V.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ue((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Xn(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Xn(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return V.resolve(a)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(r.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new yy(n,r));let i=this.Lr.get(n);i===void 0&&(i=ve(),this.Lr.set(n,i)),this.Lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(){this.sessionToken=ot.EMPTY_BYTE_STRING}getSessionToken(e){return V.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,V.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(){this.kr=new je(xt.Kr),this.qr=new je(xt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new xt(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new xt(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new ee(new be([])),r=new xt(n,e),s=new xt(n,e+1),i=[];return this.qr.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new ee(new be([])),r=new xt(n,e),s=new xt(n,e+1);let i=ve();return this.qr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new xt(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class xt{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return ee.comparator(e.key,n.key)||fe(e.Hr,n.Hr)}static Ur(e,n){return fe(e.Hr,n.Hr)||ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new je(xt.Kr)}checkEmpty(e){return V.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new py(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Jr=this.Jr.add(new xt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return V.resolve(o)}lookupMutationBatch(e,n){return V.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return V.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return V.resolve(this.mutationQueue.length===0?di:this.Yn-1)}getAllMutationBatches(e){return V.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new xt(n,0),s=new xt(n,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([r,s],o=>{const a=this.Zr(o.Hr);i.push(a)}),V.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new je(fe);return n.forEach(s=>{const i=new xt(s,0),o=new xt(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],a=>{r=r.add(a.Hr)})}),V.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ee.isDocumentKey(i)||(i=i.child(""));const o=new xt(new ee(i),0);let a=new je(fe);return this.Jr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(c.Hr)),!0)},o),V.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){oe(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return V.forEach(n.mutations,s=>{const i=new xt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new xt(n,0),s=this.Jr.firstAfterOrEqual(r);return V.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,V.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e){this.ti=e,this.docs=function(){return new Ue(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return V.resolve(r?r.document.mutableCopy():Ge.newInvalidDocument(n))}getEntries(e,n){let r=cn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ge.newInvalidDocument(s))}),V.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=cn();const o=n.path,a=new ee(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||ny(L1(h),r)<=0||(s.has(h.key)||xc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return V.resolve(i)}getAllFromCollectionGroup(e,n,r,s){te(9500)}ni(e,n){return V.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new rD(this)}getSize(e){return V.resolve(this.size)}}class rD extends ob{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(r)}),V.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(e){this.persistence=e,this.ri=new Dr(n=>Ii(n),vc),this.lastRemoteSnapshotVersion=ae.min(),this.highestTargetId=0,this.ii=0,this.si=new Ey,this.targetCount=0,this.oi=Si._r()}forEachTarget(e,n){return this.ri.forEach((r,s)=>n(s)),V.resolve()}getLastRemoteSnapshotVersion(e){return V.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return V.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),V.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),V.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Si(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,V.resolve()}updateTargetData(e,n){return this.lr(n),V.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,V.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),V.waitFor(i).next(()=>s)}getTargetCount(e){return V.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return V.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),V.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),V.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),V.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return V.resolve(r)}containsKey(e,n){return V.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e,n){this._i={},this.overlays={},this.ai=new Jt(0),this.ui=!1,this.ui=!0,this.ci=new eD,this.referenceDelegate=e(this),this.li=new sD(this),this.indexManager=new $P,this.remoteDocumentCache=function(s){return new nD(s)}(r=>this.referenceDelegate.hi(r)),this.serializer=new WT(n),this.Pi=new XP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new ZP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new tD(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const s=new iD(this.ai.next());return this.referenceDelegate.Ti(),r(s).next(i=>this.referenceDelegate.Ii(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return V.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class iD extends U1{constructor(e){super(),this.currentSequenceNumber=e}}class Rh{constructor(e){this.persistence=e,this.Ri=new Ey,this.Ai=null}static Vi(e){return new Rh(e)}get di(){if(this.Ai)return this.Ai;throw te(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),V.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),V.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),V.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(s=>this.di.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.di.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return V.forEach(this.di,r=>{const s=ee.fromPath(r);return this.mi(e,s).next(i=>{i||n.removeEntry(s,ae.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return V.or([()=>V.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class jd{constructor(e,n){this.persistence=e,this.fi=new Dr(r=>Mt(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=ib(this,n)}static Vi(e,n){return new jd(e,n)}Ti(){}Ii(e){return V.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return V.forEach(this.fi,(r,s)=>this.wr(e,r,s).next(i=>i?V.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,ae.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),V.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),V.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),V.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),V.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Lu(e.data.value)),n}wr(e,n,r){return V.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.fi.get(n);return V.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oD{constructor(e){this.serializer=e}k(e,n,r,s){const i=new xh("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(yc)}(e),function(c){c.createObjectStore(Kl,{keyPath:v2}),c.createObjectStore(kn,{keyPath:q0,autoIncrement:!0}).createIndex(li,H0,{unique:!0}),c.createObjectStore(Lo)}(e),jx(e),function(c){c.createObjectStore(ei)}(e));let o=V.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(Uo),c.deleteObjectStore(Fo),c.deleteObjectStore(hi)}(e),jx(e)),o=o.next(()=>function(c){const d=c.store(hi),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ae.min().toTimestamp(),targetCount:0};return d.put(Sd,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,d){return d.store(kn).H().next(m=>{c.deleteObjectStore(kn),c.createObjectStore(kn,{keyPath:q0,autoIncrement:!0}).createIndex(li,H0,{unique:!0});const p=d.store(kn),x=m.map(A=>p.put(A));return V.waitFor(x)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(zo,{keyPath:A2})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.gi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Wl)}(e),this.pi(i)))),r<7&&s>=7&&(o=o.next(()=>this.yi(i))),r<8&&s>=8&&(o=o.next(()=>this.wi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.bi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(wh,{keyPath:N2})})(e),function(c){c.createObjectStore(Eh,{keyPath:C2})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore(Ih,{keyPath:O2});d.createIndex(bp,M2,{unique:!1}),d.createIndex(W1,L2,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore(bd,{keyPath:x2});d.createIndex(Ou,w2),d.createIndex(q1,E2)}(e)).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(ei))),r<14&&s>=14&&(o=o.next(()=>this.Di(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(iy,{keyPath:k2,autoIncrement:!0}).createIndex(Tp,R2,{unique:!1}),c.createObjectStore(yl,{keyPath:P2}).createIndex(G1,D2,{unique:!1}),c.createObjectStore(vl,{keyPath:j2}).createIndex(K1,V2,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(yl).clear()}).next(()=>{n.objectStore(vl).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(oy,{keyPath:F2})})(e)})),r<18&&s>=18&&x1()&&(o=o.next(()=>{n.objectStore(yl).clear()}).next(()=>{n.objectStore(vl).clear()})),o}pi(e){let n=0;return e.store(ei).ee((r,s)=>{n+=Dd(s)}).next(()=>{const r={byteSize:n};return e.store(Wl).put(Ip,r)})}gi(e){const n=e.store(Kl),r=e.store(kn);return n.H().next(s=>V.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,di],[i.userId,i.lastAcknowledgedBatchId]);return r.H(li,o).next(a=>V.forEach(a,c=>{oe(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const d=ni(this.serializer,c);return eb(e,i.userId,d).next(()=>{})}))}))}yi(e){const n=e.store(Uo),r=e.store(ei);return e.store(hi).get(Sd).next(s=>{const i=[];return r.ee((o,a)=>{const c=new be(o),d=function(m){return[0,Mt(m)]}(c);i.push(n.get(d).next(h=>h?V.resolve():(m=>n.put({targetId:0,path:Mt(m),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>V.waitFor(i))})}wi(e,n){e.createObjectStore(Ql,{keyPath:S2});const r=n.store(Ql),s=new wy,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Mt(c)})}};return n.store(ei).ee({Y:!0},(o,a)=>{const c=new be(o);return i(c.popLast())}).next(()=>n.store(Lo).ee({Y:!0},([o,a,c],d)=>{const h=Jn(a);return i(h.popLast())}))}bi(e){const n=e.store(Fo);return n.ee((r,s)=>{const i=nl(s),o=QT(this.serializer,i);return n.put(o)})}Si(e,n){const r=n.store(ei),s=[];return r.ee((i,o)=>{const a=n.store(bd),c=function(m){return m.document?new ee(be.fromString(m.document.name).popFirst(5)):m.noDocument?ee.fromSegments(m.noDocument.path):m.unknownDocument?ee.fromSegments(m.unknownDocument.path):te(36783)}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>V.waitFor(s))}Di(e,n){const r=n.store(kn),s=ab(this.serializer),i=new Iy(Rh.Vi,this.serializer.yt);return r.H().next(o=>{const a=new Map;return o.forEach(c=>{let d=a.get(c.userId)??ve();ni(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),V.forEach(a,(c,d)=>{const h=new jt(d),m=Ch.wt(this.serializer,h),p=i.getIndexManager(h),x=kh.wt(h,this.serializer,p,i.referenceDelegate);return new lb(s,x,m,p).recalculateAndSaveOverlaysForDocumentKeys(new Sp(n,Jt.ce),c).next()})})}}function jx(t){t.createObjectStore(Uo,{keyPath:T2}).createIndex(sy,b2,{unique:!0}),t.createObjectStore(Fo,{keyPath:"targetId"}).createIndex(H1,I2,{unique:!0}),t.createObjectStore(hi)}const Kr="IndexedDbPersistence",Wf=18e5,Qf=5e3,Yf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",aD="main";class Ty{constructor(e,n,r,s,i,o,a,c,d,h,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Ci=i,this.window=o,this.document=a,this.Fi=d,this.Mi=h,this.xi=m,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=p=>Promise.resolve(),!Ty.v())throw new G(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new WP(this,s),this.Ki=n+aD,this.serializer=new WT(c),this.qi=new Es(this.Ki,this.xi,new oD(this.serializer)),this.ci=new MP,this.li=new HP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ab(this.serializer),this.Pi=new OP,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,h===!1&&it(Kr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new G(z.FAILED_PRECONDITION,Yf);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new Jt(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>du(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(n=>{n||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(n=>this.isPrimary&&!n?this.Ji(e).next(()=>!1):!!n&&this.Zi(e).next(()=>!0))).catch(e=>{if(Ls(e))return q(Kr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q(Kr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return Ba(e).get(qi).next(n=>V.resolve(this.Xi(n)))}Yi(e){return du(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,Wf)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=yt(n,zo);return r.H().next(s=>{const i=this.ns(s,Wf),o=s.filter(a=>i.indexOf(a)===-1);return V.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ui)for(const n of e)this.Ui.removeItem(this.rs(n.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?V.resolve(!0):Ba(e).get(qi).next(n=>{if(n!==null&&this.ts(n.leaseTimestampMs,Qf)&&!this.ss(n.ownerId)){if(this.Xi(n)&&this.networkEnabled)return!0;if(!this.Xi(n)){if(!n.allowTabSynchronization)throw new G(z.FAILED_PRECONDITION,Yf);return!1}}return!(!this.networkEnabled||!this.inForeground)||du(e).H().next(r=>this.ns(r,Qf).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&q(Kr,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[yc,zo],e=>{const n=new Sp(e,Jt.ce);return this.Ji(n).next(()=>this.Yi(n))}),this.qi.close(),this.ls()}ns(e,n){return e.filter(r=>this.ts(r.updateTimeMs,n)&&!this.ss(r.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>du(e).H().next(n=>this.ns(n,Wf).map(r=>r.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,n){return kh.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new qP(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Ch.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,n,r){q(Kr,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?B2:c===17?X1:c===16?z2:c===15?ay:c===14?J1:c===13?Y1:c===12?U2:c===11?Q1:void te(60245)}(this.xi);let o;return this.qi.runTransaction(e,s,i,a=>(o=new Sp(a,this.ai?this.ai.next():Jt.ce),n==="readwrite-primary"?this.ji(o).next(c=>!!c||this.Hi(o)).next(c=>{if(!c)throw it(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new G(z.FAILED_PRECONDITION,F1);return r(o)}).next(c=>this.Zi(o).next(()=>c)):this.Ps(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ps(e){return Ba(e).get(qi).next(n=>{if(n!==null&&this.ts(n.leaseTimestampMs,Qf)&&!this.ss(n.ownerId)&&!this.Xi(n)&&!(this.Mi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new G(z.FAILED_PRECONDITION,Yf)})}Zi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ba(e).put(qi,n)}static v(){return Es.v()}Ji(e){const n=Ba(e);return n.get(qi).next(r=>this.Xi(r)?(q(Kr,"Releasing primary lease."),n.delete(qi)):V.resolve())}ts(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(it(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const n=/(?:Version|Mobile)\/1[456]/;_1()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var n;try{const r=((n=this.Ui)==null?void 0:n.getItem(this.rs(e)))!==null;return q(Kr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return it(Kr,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){it("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ba(t){return yt(t,yc)}function du(t){return yt(t,zo)}function cb(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=s}static Es(e,n){let r=ve(),s=ve();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new by(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return _1()?8:z1(gt())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.gs(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ps(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new lD;return this.ys(e,n,o).next(a=>{if(i.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>i.result)}ws(e,n,r,s){return r.documentReadCount<this.Vs?(Ji()<=Ee.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Xi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),V.resolve()):(Ji()<=Ee.DEBUG&&q("QueryEngine","Query:",Xi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(Ji()<=Ee.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Xi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,fn(n))):V.resolve())}gs(e,n){if(sx(n))return V.resolve(null);let r=fn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=kd(n,null,"F"),r=fn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ve(...i);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.bs(n,a);return this.Ss(n,d,o,c.readTime)?this.gs(e,kd(n,null,"F")):this.Ds(e,d,n,c)}))})))}ps(e,n,r,s){return sx(n)||s.isEqual(ae.min())?V.resolve(null):this.fs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ss(n,o,r,s)?V.resolve(null):(Ji()<=Ee.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Xi(n)),this.Ds(e,o,n,M1(s,Mo)).next(a=>a))})}bs(e,n){let r=new je(xT(e));return n.forEach((s,i)=>{xc(e,i)&&(r=r.add(i))}),r}Ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ys(e,n,r){return Ji()<=Ee.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Xi(n)),this.fs.getDocumentsMatchingQuery(e,n,pn.min(),r)}Ds(e,n,r,s){return this.fs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy="LocalStore",cD=3e8;class uD{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.vs=new Ue(fe),this.Fs=new Dr(i=>Ii(i),vc),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new lb(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function db(t,e,n,r){return new uD(t,e,n,r)}async function hb(t,e){const n=se(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=ve();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function dD(t,e){const n=se(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,c,d,h){const m=d.batch,p=m.keys();let x=V.resolve();return p.forEach(A=>{x=x.next(()=>h.getEntry(c,A)).next(C=>{const k=d.docVersions.get(A);oe(k!==null,48541),C.version.compareTo(k)<0&&(m.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),h.addEntry(C)))})}),x.next(()=>a.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ve();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function fb(t){const e=se(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function hD(t,e){const n=se(t),r=e.snapshotVersion;let s=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});s=n.vs;const a=[];e.targetChanges.forEach((h,m)=>{const p=s.get(m);if(!p)return;a.push(n.li.removeMatchingKeys(i,h.removedDocuments,m).next(()=>n.li.addMatchingKeys(i,h.addedDocuments,m)));let x=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(ot.EMPTY_BYTE_STRING,ae.min()).withLastLimboFreeSnapshotVersion(ae.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,r)),s=s.insert(m,x),function(C,k,_){return C.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=cD?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(p,x,h)&&a.push(n.li.updateTargetData(i,x))});let c=cn(),d=ve();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(fD(i,o,e.documentUpdates).next(h=>{c=h.Bs,d=h.Ls})),!r.isEqual(ae.min())){const h=n.li.getLastRemoteSnapshotVersion(i).next(m=>n.li.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return V.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.vs=s,i))}function fD(t,e,n){let r=ve(),s=ve();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=cn();return n.forEach((a,c)=>{const d=i.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(ae.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):q(Sy,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{Bs:o,Ls:s}})}function mD(t,e){const n=se(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=di),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Vd(t,e){const n=se(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.li.getTargetData(r,e).next(i=>i?(s=i,V.resolve(s)):n.li.allocateTargetId(r).next(o=>(s=new mr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.vs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function Yo(t,e,n){const r=se(t),s=r.vs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ls(o))throw o;q(Sy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(s.target)}function Up(t,e,n){const r=se(t);let s=ae.min(),i=ve();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const m=se(c),p=m.Fs.get(h);return p!==void 0?V.resolve(m.vs.get(p)):m.li.getTargetData(d,h)}(r,o,fn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:ae.min(),n?i:ve())).next(a=>(gb(r,_T(e),a),{documents:a,ks:i})))}function mb(t,e){const n=se(t),r=se(n.li),s=n.vs.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.At(i,e).next(o=>o?o.target:null))}function pb(t,e){const n=se(t),r=n.Ms.get(e)||ae.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.xs.getAllFromCollectionGroup(s,e,M1(r,Mo),Number.MAX_SAFE_INTEGER)).then(s=>(gb(n,e,s),s))}function gb(t,e,n){let r=t.Ms.get(e)||ae.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ms.set(e,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yb="firestore_clients";function Vx(t,e){return`${yb}_${t}_${e}`}const vb="firestore_mutations";function Ox(t,e,n){let r=`${vb}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const _b="firestore_targets";function Jf(t,e){return`${_b}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qn="SharedClientState";class Od{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static $s(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new G(s.error.code,s.error.message))),o?new Od(e,n,s.state,i):(it(Qn,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Il{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static $s(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new G(r.error.code,r.error.message))),i?new Il(e,r.state,s):(it(Qn,`Failed to parse target state for ID '${e}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Md{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static $s(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=hy();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=B1(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Md(e,i):(it(Qn,`Failed to parse client data for instance '${e}': ${n}`),null)}}class Ay{constructor(e,n){this.clientId=e,this.onlineState=n}static $s(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Ay(n.clientId,n.onlineState):(it(Qn,`Failed to parse online state: ${e}`),null)}}class zp{constructor(){this.activeTargetIds=hy()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Xf{constructor(e,n,r,s,i){this.window=e,this.Ci=n,this.persistenceKey=r,this.zs=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new Ue(fe),this.started=!1,this.Zs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=Vx(this.persistenceKey,this.zs),this.Ys=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Js=this.Js.insert(this.zs,new zp),this.eo=new RegExp(`^${yb}_${o}_([^_]*)$`),this.no=new RegExp(`^${vb}_${o}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${_b}_${o}_(\\d+)$`),this.io=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.so=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const s=this.getItem(Vx(this.persistenceKey,r));if(s){const i=Md.$s(r,s);i&&(this.Js=this.Js.insert(i.clientId,i))}}this.oo();const n=this.storage.getItem(this.io);if(n){const r=this._o(n);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let n=!1;return this.Js.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,n,r){this.co(e,n,r),this.lo(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(Jf(this.persistenceKey,e));if(s){const i=Il.$s(e,s);i&&(r=i.state)}}return n&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Jf(this.persistenceKey,e))}updateQueryState(e,n,r){this.Po(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.lo(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return q(Qn,"READ",e,n),n}setItem(e,n){q(Qn,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){q(Qn,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const n=e;if(n.storageArea===this.storage){if(q(Qn,"EVENT",n.key,n.newValue),n.key===this.Xs)return void it("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.eo.test(n.key)){if(n.newValue==null){const r=this.Eo(n.key);return this.Ro(r,null)}{const r=this.Ao(n.key,n.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(n.key)){if(n.newValue!==null){const r=this.Vo(n.key,n.newValue);if(r)return this.mo(r)}}else if(this.ro.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(n.key===this.io){if(n.newValue!==null){const r=this._o(n.newValue);if(r)return this.ao(r)}}else if(n.key===this.Ys){const r=function(i){let o=Jt.ce;if(i!=null)try{const a=JSON.parse(i);oe(typeof a=="number",30636,{yo:i}),o=a}catch(a){it(Qn,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Jt.ce&&this.sequenceNumberHandler(r)}else if(n.key===this.so){const r=this.wo(n.newValue);await Promise.all(r.map(s=>this.syncEngine.bo(s)))}}}else this.Zs.push(n)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,n,r){const s=new Od(this.currentUser,e,n,r),i=Ox(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Ws())}lo(e){const n=Ox(this.persistenceKey,this.currentUser,e);this.removeItem(n)}To(e){const n={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(n))}Po(e,n,r){const s=Jf(this.persistenceKey,e),i=new Il(e,n,r);this.setItem(s,i.Ws())}Io(e){const n=JSON.stringify(Array.from(e));this.setItem(this.so,n)}Eo(e){const n=this.eo.exec(e);return n?n[1]:null}Ao(e,n){const r=this.Eo(e);return Md.$s(r,n)}Vo(e,n){const r=this.no.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Od.$s(new jt(i),s,n)}fo(e,n){const r=this.ro.exec(e),s=Number(r[1]);return Il.$s(s,n)}_o(e){return Ay.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);q(Qn,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,n){const r=n?this.Js.insert(e,n):this.Js.remove(e),s=this.uo(this.Js),i=this.uo(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Co(o,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let n=hy();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class xb{constructor(){this.vo=new zp,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new zp,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mx="ConnectivityMonitor";class Lx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){q(Mx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){q(Mx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hu=null;function Bp(){return hu===null?hu=function(){return 268435456+Math.round(2147483648*Math.random())}():hu++,"0x"+hu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf="RestConnection",gD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class yD{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.$o=this.databaseId.database===Ad?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=Bp(),a=this.Qo(e,n.toUriEncodedString());q(Zf,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,s,i);const{host:d}=new URL(a),h=ar(d);return this.zo(e,a,c,r,h).then(m=>(q(Zf,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Vo(Zf,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+oa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Qo(e,n){const r=gD[e];let s=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vD{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dt="WebChannelConnection",$a=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(s){setTimeout(()=>{throw s},0)}})};class Io extends yD{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!Io.c_){const e=R1();$a(e,k1.STAT_EVENT,n=>{n.stat===xp.PROXY?q(Dt,"STAT_EVENT: detected buffering proxy"):n.stat===xp.NOPROXY&&q(Dt,"STAT_EVENT: detected no buffering proxy")}),Io.c_=!0}}zo(e,n,r,s,i){const o=Bp();return new Promise((a,c)=>{const d=new N1;d.setWithCredentials(!0),d.listenOnce(C1.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Du.NO_ERROR:const m=d.getResponseJson();q(Dt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case Du.TIMEOUT:q(Dt,`RPC '${e}' ${o} timed out`),c(new G(z.DEADLINE_EXCEEDED,"Request time out"));break;case Du.HTTP_ERROR:const p=d.getStatus();if(q(Dt,`RPC '${e}' ${o} failed with status:`,p,"response text:",d.getResponseText()),p>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const A=x==null?void 0:x.error;if(A&&A.status&&A.message){const C=function(_){const v=_.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(v)>=0?v:z.UNKNOWN}(A.status);c(new G(C,A.message))}else c(new G(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new G(z.UNAVAILABLE,"Connection failed."));break;default:te(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{q(Dt,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);q(Dt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=Bp(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const d=i.join("");q(Dt,`Creating RPC '${e}' stream ${s}: ${d}`,a);const h=o.createWebChannel(d,a);this.I_(h);let m=!1,p=!1;const x=new vD({Ho:A=>{p?q(Dt,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(m||(q(Dt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),q(Dt,`RPC '${e}' stream ${s} sending:`,A),h.send(A))},Jo:()=>h.close()});return $a(h,Za.EventType.OPEN,()=>{p||(q(Dt,`RPC '${e}' stream ${s} transport opened.`),x.i_())}),$a(h,Za.EventType.CLOSE,()=>{p||(p=!0,q(Dt,`RPC '${e}' stream ${s} transport closed`),x.o_(),this.E_(h))}),$a(h,Za.EventType.ERROR,A=>{p||(p=!0,Vo(Dt,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),x.o_(new G(z.UNAVAILABLE,"The operation could not be completed")))}),$a(h,Za.EventType.MESSAGE,A=>{var C;if(!p){const k=A.data[0];oe(!!k,16349);const _=k,v=(_==null?void 0:_.error)||((C=_[0])==null?void 0:C.error);if(v){q(Dt,`RPC '${e}' stream ${s} received error:`,v);const w=v.status;let P=function(E){const y=at[E];if(y!==void 0)return DT(y)}(w),j=v.message;w==="NOT_FOUND"&&j.includes("database")&&j.includes("does not exist")&&j.includes(this.databaseId.database)&&Vo(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),P===void 0&&(P=z.INTERNAL,j="Unknown error status: "+w+" with message "+v.message),p=!0,x.o_(new G(P,j)),h.close()}else q(Dt,`RPC '${e}' stream ${s} received:`,k),x.__(k)}}),Io.u_(),setTimeout(()=>{x.s_()},0),x}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return P1()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(t){return new Io(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wb(){return typeof window<"u"?window:null}function $u(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(t){return new TP(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Io.c_=!1;class Ny{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=s,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="PersistentStream";class Eb{constructor(e,n,r,s,i,o,a,c){this.Ci=e,this.b_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ny(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(it(n.toString()),it("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new G(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.H_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return q(Fx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(q(Fx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class xD extends Eb{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=NP(this.serializer,e),r=function(i){if(!("targetChange"in i))return ae.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ae.min():o.readTime?It(o.readTime):ae.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Vp(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=Nd(c)?{documents:zT(i,c)}:{query:BT(i,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=OT(i,o.resumeToken);const d=Dp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(ae.min())>0){a.readTime=Qo(i,o.snapshotVersion.toTimestamp());const d=Dp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=kP(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Vp(this.serializer),n.removeTarget=e,this.K_(n)}}class wD extends Eb{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=CP(e.writeResults,e.commitTime),r=It(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Vp(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>rc(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ED{}class ID extends ED{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,jp(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new G(z.UNKNOWN,i.toString())})}jo(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,jp(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(z.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function TD(t,e,n,r){return new ID(t,e,n,r)}class bD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(it(n),this.aa=!1):q("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ai="RemoteStore";class SD{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Vi(this)&&(q(Ai,"Restarting streams for network reachability change."),await async function(c){const d=se(c);d.Ea.add(4),await Ic(d),d.Va.set("Unknown"),d.Ea.delete(4),await Dh(d)}(this))})}),this.Va=new bD(r,s)}}async function Dh(t){if(Vi(t))for(const e of t.Ra)await e(!0)}async function Ic(t){for(const e of t.Ra)await e(!1)}function jh(t,e){const n=se(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),Ry(n)?ky(n):da(n).O_()&&Cy(n,e))}function Jo(t,e){const n=se(t),r=da(n);n.Ia.delete(e),r.O_()&&Ib(n,e),n.Ia.size===0&&(r.O_()?r.L_():Vi(n)&&n.Va.set("Unknown"))}function Cy(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ae.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}da(t).Z_(e)}function Ib(t,e){t.da.$e(e),da(t).X_(e)}function ky(t){t.da=new xP({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),da(t).start(),t.Va.ua()}function Ry(t){return Vi(t)&&!da(t).x_()&&t.Ia.size>0}function Vi(t){return se(t).Ea.size===0}function Tb(t){t.da=void 0}async function AD(t){t.Va.set("Online")}async function ND(t){t.Ia.forEach((e,n)=>{Cy(t,e)})}async function CD(t,e){Tb(t),Ry(t)?(t.Va.ha(e),ky(t)):t.Va.set("Unknown")}async function kD(t,e,n){if(t.Va.set("Online"),e instanceof VT&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.da.removeTarget(a))}(t,e)}catch(r){q(Ai,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ld(t,r)}else if(e instanceof zu?t.da.Xe(e):e instanceof jT?t.da.st(e):t.da.tt(e),!n.isEqual(ae.min()))try{const r=await fb(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.da.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(ot.EMPTY_BYTE_STRING,h.snapshotVersion)),Ib(i,c);const m=new mr(h.target,c,d,h.sequenceNumber);Cy(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){q(Ai,"Failed to raise snapshot:",r),await Ld(t,r)}}async function Ld(t,e,n){if(!Ls(e))throw e;t.Ea.add(1),await Ic(t),t.Va.set("Offline"),n||(n=()=>fb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q(Ai,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Dh(t)})}function bb(t,e){return e().catch(n=>Ld(t,n,e))}async function ua(t){const e=se(t),n=Ps(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:di;for(;RD(e);)try{const s=await mD(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,PD(e,s)}catch(s){await Ld(e,s)}Sb(e)&&Ab(e)}function RD(t){return Vi(t)&&t.Ta.length<10}function PD(t,e){t.Ta.push(e);const n=Ps(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function Sb(t){return Vi(t)&&!Ps(t).x_()&&t.Ta.length>0}function Ab(t){Ps(t).start()}async function DD(t){Ps(t).ra()}async function jD(t){const e=Ps(t);for(const n of t.Ta)e.ea(n.mutations)}async function VD(t,e,n){const r=t.Ta.shift(),s=gy.from(r,e,n);await bb(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ua(t)}async function OD(t,e){e&&Ps(t).Y_&&await async function(r,s){if(function(o){return PT(o)&&o!==z.ABORTED}(s.code)){const i=r.Ta.shift();Ps(r).B_(),await bb(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ua(r)}}(t,e),Sb(t)&&Ab(t)}async function Ux(t,e){const n=se(t);n.asyncQueue.verifyOperationInProgress(),q(Ai,"RemoteStore received new credentials");const r=Vi(n);n.Ea.add(3),await Ic(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Dh(n)}async function $p(t,e){const n=se(t);e?(n.Ea.delete(2),await Dh(n)):e||(n.Ea.add(2),await Ic(n),n.Va.set("Unknown"))}function da(t){return t.ma||(t.ma=function(n,r,s){const i=se(n);return i.sa(),new xD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:AD.bind(null,t),Yo:ND.bind(null,t),t_:CD.bind(null,t),J_:kD.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),Ry(t)?ky(t):t.Va.set("Unknown")):(await t.ma.stop(),Tb(t))})),t.ma}function Ps(t){return t.fa||(t.fa=function(n,r,s){const i=se(n);return i.sa(),new wD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:DD.bind(null,t),t_:OD.bind(null,t),ta:jD.bind(null,t),na:VD.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await ua(t)):(await t.fa.stop(),t.Ta.length>0&&(q(Ai,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Vn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Py(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dy(t,e){if(it("AsyncQueue",`${e}: ${t}`),Ls(t))return new G(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class To{static emptySet(e){return new To(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ee.comparator(n.key,r.key):(n,r)=>ee.comparator(n.key,r.key),this.keyedMap=el(),this.sortedSet=new Ue(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof To)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new To;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(){this.ga=new Ue(ee.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):te(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Xo{constructor(e,n,r,s,i,o,a,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Xo(e,n,To.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Sh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class LD{constructor(){this.queries=Bx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=se(n),i=s.queries;s.queries=Bx(),i.forEach((o,a)=>{for(const c of a.ba)c.onError(r)})})(this,new G(z.ABORTED,"Firestore shutting down"))}}function Bx(){return new Dr(t=>vT(t),Sh)}async function jy(t,e){const n=se(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.Da()&&(r=2):(i=new MD,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Dy(o,`Initialization of query '${Xi(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.ba.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&Oy(n)}async function Vy(t,e){const n=se(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?s=e.Da()?0:1:!i.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function FD(t,e){const n=se(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.ba)a.Fa(s)&&(r=!0);o.wa=s}}r&&Oy(n)}function UD(t,e,n){const r=se(t),s=r.queries.get(e);if(s)for(const i of s.ba)i.onError(n);r.queries.delete(e)}function Oy(t){t.Ca.forEach(e=>{e.next()})}var qp,$x;($x=qp||(qp={})).Ma="default",$x.Cache="cache";class My{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Xo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Xo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==qp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e){this.key=e}}class Cb{constructor(e){this.key=e}}class zD{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ve(),this.mutatedKeys=ve(),this.eu=xT(e),this.tu=new To(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new zx,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,m)=>{const p=s.get(h),x=xc(this.query,m)?m:null,A=!!p&&this.mutatedKeys.has(p.key),C=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let k=!1;p&&x?p.data.isEqual(x.data)?A!==C&&(r.track({type:3,doc:x}),k=!0):this.su(p,x)||(r.track({type:2,doc:x}),k=!0,(c&&this.eu(x,c)>0||d&&this.eu(x,d)<0)&&(a=!0)):!p&&x?(r.track({type:0,doc:x}),k=!0):p&&!x&&(r.track({type:1,doc:p}),k=!0,(c||d)&&(a=!0)),k&&(x?(o=o.add(x),i=C?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,m)=>function(x,A){const C=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return te(20277,{Vt:k})}};return C(x)-C(A)}(h.type,m.type)||this.eu(h.doc,m.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],c=this.Ya.size===0&&this.current&&!s?1:0,d=c!==this.Xa;return this.Xa=c,o.length!==0||d?{snapshot:new Xo(this.query,e.tu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ve(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new Cb(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new Nb(r))}),n}cu(e){this.Za=e.ks,this.Ya=ve();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Xo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const ha="SyncEngine";class BD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class $D{constructor(e){this.key=e,this.hu=!1}}class qD{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Dr(a=>vT(a),Sh),this.Iu=new Map,this.Eu=new Set,this.Ru=new Ue(ee.comparator),this.Au=new Map,this.Vu=new Ey,this.du={},this.mu=new Map,this.fu=Si.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function HD(t,e,n=!0){const r=Vh(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await kb(r,e,n,!0),s}async function GD(t,e){const n=Vh(t);await kb(n,e,!0,!1)}async function kb(t,e,n,r){const s=await Vd(t.localStore,fn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await Ly(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&jh(t.remoteStore,s),a}async function Ly(t,e,n,r,s){t.pu=(m,p,x)=>async function(C,k,_,v){let w=k.view.ru(_);w.Ss&&(w=await Up(C.localStore,k.query,!1).then(({documents:E})=>k.view.ru(E,w)));const P=v&&v.targetChanges.get(k.targetId),j=v&&v.targetMismatches.get(k.targetId)!=null,L=k.view.applyChanges(w,C.isPrimaryClient,P,j);return Hp(C,k.targetId,L.au),L.snapshot}(t,m,p,x);const i=await Up(t.localStore,e,!0),o=new zD(e,i.ks),a=o.ru(i.documents),c=Ec.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,c);Hp(t,n,d.au);const h=new BD(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function KD(t,e,n){const r=se(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!Sh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Yo(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Jo(r.remoteStore,s.targetId),Zo(r,s.targetId)}).catch(Ms)):(Zo(r,s.targetId),await Yo(r.localStore,s.targetId,!0))}async function WD(t,e){const n=se(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Jo(n.remoteStore,r.targetId))}async function QD(t,e,n){const r=By(t);try{const s=await function(o,a){const c=se(o),d=Re.now(),h=a.reduce((x,A)=>x.add(A.key),ve());let m,p;return c.persistence.runTransaction("Locally write mutations","readwrite",x=>{let A=cn(),C=ve();return c.xs.getEntries(x,h).next(k=>{A=k,A.forEach((_,v)=>{v.isValidDocument()||(C=C.add(_))})}).next(()=>c.localDocuments.getOverlayedDocuments(x,A)).next(k=>{m=k;const _=[];for(const v of a){const w=gP(v,m.get(v.key).overlayedDocument);w!=null&&_.push(new jr(v.key,w,lT(w.value.mapValue),Ke.exists(!0)))}return c.mutationQueue.addMutationBatch(x,d,_,a)}).next(k=>{p=k;const _=k.applyToLocalDocumentSet(m,C);return c.documentOverlayCache.saveOverlays(x,k.batchId,_)})}).then(()=>({batchId:p.batchId,changes:ET(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let d=o.du[o.currentUser.toKey()];d||(d=new Ue(fe)),d=d.insert(a,c),o.du[o.currentUser.toKey()]=d}(r,s.batchId,n),await Us(r,s.changes),await ua(r.remoteStore)}catch(s){const i=Dy(s,"Failed to persist write");n.reject(i)}}async function Rb(t,e){const n=se(t);try{const r=await hD(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?oe(o.hu,14607):s.removedDocuments.size>0&&(oe(o.hu,42227),o.hu=!1))}),await Us(n,r,e)}catch(r){await Ms(r)}}function qx(t,e,n){const r=se(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=se(o);c.onlineState=a;let d=!1;c.queries.forEach((h,m)=>{for(const p of m.ba)p.va(a)&&(d=!0)}),d&&Oy(c)}(r.eventManager,e),s.length&&r.Pu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function YD(t,e,n){const r=se(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Ue(ee.comparator);o=o.insert(i,Ge.newNoDocument(i,ae.min()));const a=ve().add(i),c=new wc(ae.min(),new Map,new Ue(fe),o,a);await Rb(r,c),r.Ru=r.Ru.remove(i),r.Au.delete(e),zy(r)}else await Yo(r.localStore,e,!1).then(()=>Zo(r,e,n)).catch(Ms)}async function JD(t,e){const n=se(t),r=e.batch.batchId;try{const s=await dD(n.localStore,e);Uy(n,r,null),Fy(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Us(n,s)}catch(s){await Ms(s)}}async function XD(t,e,n){const r=se(t);try{const s=await function(o,a){const c=se(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(m=>(oe(m!==null,37113),h=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);Uy(r,e,n),Fy(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Us(r,s)}catch(s){await Ms(s)}}function Fy(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Uy(t,e,n){const r=se(t);let s=r.du[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.du[r.currentUser.toKey()]=s}}function Zo(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||Pb(t,r)})}function Pb(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(Jo(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),zy(t))}function Hp(t,e,n){for(const r of n)r instanceof Nb?(t.Vu.addReference(r.key,e),ZD(t,r)):r instanceof Cb?(q(ha,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||Pb(t,r.key)):te(19791,{wu:r})}function ZD(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(q(ha,"New document in limbo: "+n),t.Eu.add(r),zy(t))}function zy(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ee(be.fromString(e)),r=t.fu.next();t.Au.set(r,new $D(n)),t.Ru=t.Ru.insert(n,r),jh(t.remoteStore,new mr(fn(_c(n.path)),r,"TargetPurposeLimboResolution",Jt.ce))}}async function Us(t,e,n){const r=se(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){s.push(d);const m=by.Es(c.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Pu.J_(s),await async function(c,d){const h=se(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>V.forEach(d,p=>V.forEach(p.Ts,x=>h.persistence.referenceDelegate.addReference(m,p.targetId,x)).next(()=>V.forEach(p.Is,x=>h.persistence.referenceDelegate.removeReference(m,p.targetId,x)))))}catch(m){if(!Ls(m))throw m;q(Sy,"Failed to update sequence numbers: "+m)}for(const m of d){const p=m.targetId;if(!m.fromCache){const x=h.vs.get(p),A=x.snapshotVersion,C=x.withLastLimboFreeSnapshotVersion(A);h.vs=h.vs.insert(p,C)}}}(r.localStore,i))}async function ej(t,e){const n=se(t);if(!n.currentUser.isEqual(e)){q(ha,"User change. New user:",e.toKey());const r=await hb(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(c=>{c.reject(new G(z.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Us(n,r.Ns)}}function tj(t,e){const n=se(t),r=n.Au.get(e);if(r&&r.hu)return ve().add(r.key);{let s=ve();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function nj(t,e){const n=se(t),r=await Up(n.localStore,e.query,!0),s=e.view.cu(r);return n.isPrimaryClient&&Hp(n,e.targetId,s.au),s}async function rj(t,e){const n=se(t);return pb(n.localStore,e).then(r=>Us(n,r))}async function sj(t,e,n,r){const s=se(t),i=await function(a,c){const d=se(a),h=se(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",m=>h.Xn(m,c).next(p=>p?d.localDocuments.getDocuments(m,p):V.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await ua(s.remoteStore):n==="acknowledged"||n==="rejected"?(Uy(s,e,r||null),Fy(s,e),function(a,c){se(se(a).mutationQueue).nr(c)}(s.localStore,e)):te(6720,"Unknown batchState",{bu:n}),await Us(s,i)):q(ha,"Cannot apply mutation batch with id: "+e)}async function ij(t,e){const n=se(t);if(Vh(n),By(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await Hx(n,r.toArray());n.gu=!0,await $p(n.remoteStore,!0);for(const i of s)jh(n.remoteStore,i)}else if(e===!1&&n.gu!==!1){const r=[];let s=Promise.resolve();n.Iu.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Zo(n,o),Yo(n.localStore,o,!0))),Jo(n.remoteStore,o)}),await s,await Hx(n,r),function(o){const a=se(o);a.Au.forEach((c,d)=>{Jo(a.remoteStore,d)}),a.Vu.zr(),a.Au=new Map,a.Ru=new Ue(ee.comparator)}(n),n.gu=!1,await $p(n.remoteStore,!1)}}async function Hx(t,e,n){const r=se(t),s=[],i=[];for(const o of e){let a;const c=r.Iu.get(o);if(c&&c.length!==0){a=await Vd(r.localStore,fn(c[0]));for(const d of c){const h=r.Tu.get(d),m=await nj(r,h);m.snapshot&&i.push(m.snapshot)}}else{const d=await mb(r.localStore,o);a=await Vd(r.localStore,d),await Ly(r,Db(d),o,!1,a.resumeToken)}s.push(a)}return r.Pu.J_(i),s}function Db(t){return gT(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function oj(t){return function(n){return se(se(n).persistence).hs()}(se(t).localStore)}async function aj(t,e,n,r){const s=se(t);if(s.gu)return void q(ha,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await pb(s.localStore,_T(i[0])),a=wc.createSynthesizedRemoteEventForCurrentChange(e,n==="current",ot.EMPTY_BYTE_STRING);await Us(s,o,a);break}case"rejected":await Yo(s.localStore,e,!0),Zo(s,e,r);break;default:te(64155,n)}}async function lj(t,e,n){const r=Vh(t);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){q(ha,"Adding an already active target "+s);continue}const i=await mb(r.localStore,s),o=await Vd(r.localStore,i);await Ly(r,Db(i),o.targetId,!1,o.resumeToken),jh(r.remoteStore,o)}for(const s of n)r.Iu.has(s)&&await Yo(r.localStore,s,!1).then(()=>{Jo(r.remoteStore,s),Zo(r,s)}).catch(Ms)}}function Vh(t){const e=se(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Rb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=tj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=YD.bind(null,e),e.Pu.J_=FD.bind(null,e.eventManager),e.Pu.yu=UD.bind(null,e.eventManager),e}function By(t){const e=se(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=JD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=XD.bind(null,e),e}class sc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ph(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return db(this.persistence,new ub,e.initialUser,this.serializer)}Cu(e){return new Iy(Rh.Vi,this.serializer)}Du(e){return new xb}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sc.provider={build:()=>new sc};class jb extends sc{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){oe(this.persistence.referenceDelegate instanceof jd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new sb(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Vt.withCacheSize(this.cacheSizeBytes):Vt.DEFAULT;return new Iy(r=>jd.Vi(r,n),this.serializer)}}class Vb extends sc{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await By(this.xu.syncEngine),await ua(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return db(this.persistence,new ub,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new sb(r,e.asyncQueue,n)}Mu(e,n){const r=new g2(n,this.persistence);return new p2(e.asyncQueue,r)}Cu(e){const n=cb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Vt.withCacheSize(this.cacheSizeBytes):Vt.DEFAULT;return new Ty(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,wb(),$u(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new xb}}class cj extends Vb{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof Xf&&(this.sharedClientState.syncEngine={So:sj.bind(null,n),Do:aj.bind(null,n),Co:lj.bind(null,n),hs:oj.bind(null,n),bo:rj.bind(null,n)},await this.sharedClientState.start()),await this.persistence.zi(async r=>{await ij(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=wb();if(!Xf.v(n))throw new G(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=cb(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Xf(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class ea{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>qx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ej.bind(null,this.syncEngine),await $p(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new LD}()}createDatastore(e){const n=Ph(e.databaseInfo.databaseId),r=_D(e.databaseInfo);return TD(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new SD(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>qx(this.syncEngine,n,0),function(){return Lx.v()?new Lx:new pD}())}createSyncEngine(e,n){return function(s,i,o,a,c,d,h){const m=new qD(s,i,o,a,c,d);return h&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=se(s);q(Ai,"RemoteStore shutting down."),i.Ea.add(5),await Ic(i),i.Aa.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}ea.provider={build:()=>new ea};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):it("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uj=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new G(z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(s,i){const o=se(s),a={documents:i.map(m=>nc(o.serializer,m))},c=await o.jo("BatchGetDocuments",o.serializer.databaseId,be.emptyPath(),a,i.length),d=new Map;c.forEach(m=>{const p=AP(o.serializer,m);d.set(p.key.toString(),p)});const h=[];return i.forEach(m=>{const p=d.get(m.toString());oe(!!p,55234,{key:m}),h.push(p)}),h}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ca(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=ee.fromPath(r);this.mutations.push(new my(s,this.precondition(s)))}),await async function(r,s){const i=se(r),o={writes:s.map(a=>rc(i.serializer,a))};await i.Wo("Commit",i.serializer.databaseId,be.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw te(50498,{Gu:e.constructor.name});n=ae.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new G(z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ae.min())?Ke.exists(!1):Ke.updateTime(n):Ke.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ae.min()))throw new G(z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ke.updateTime(n)}return Ke.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.zu=r.maxAttempts,this.M_=new Ny(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Hu()}Hu(){this.M_.p_(async()=>{const e=new uj(this.datastore),n=this.Ju(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Zu(s)}))}).catch(r=>{this.Zu(r)})})}Ju(e){try{const n=this.updateFunction(e);return!gc(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Zu(e){this.zu>0&&this.Xu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Hu(),Promise.resolve()))):this.deferred.reject(e)}Xu(e){if((e==null?void 0:e.name)==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!PT(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ds="FirestoreClient";class hj{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=s,this.user=jt.UNAUTHENTICATED,this.clientId=ty.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{q(Ds,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(q(Ds,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Vn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Dy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function em(t,e){t.asyncQueue.verifyOperationInProgress(),q(Ds,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await hb(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Gx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await fj(t);q(Ds,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Ux(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Ux(e.remoteStore,s)),t._onlineComponents=e}async function fj(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q(Ds,"Using user provided OfflineComponentProvider");try{await em(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Vo("Error using user provided cache. Falling back to memory cache: "+n),await em(t,new sc)}}else q(Ds,"Using default OfflineComponentProvider"),await em(t,new jb(void 0));return t._offlineComponents}async function qy(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q(Ds,"Using user provided OnlineComponentProvider"),await Gx(t,t._uninitializedComponentsProvider._online)):(q(Ds,"Using default OnlineComponentProvider"),await Gx(t,new ea))),t._onlineComponents}function mj(t){return qy(t).then(e=>e.syncEngine)}function pj(t){return qy(t).then(e=>e.datastore)}async function Fd(t){const e=await qy(t),n=e.eventManager;return n.onListen=HD.bind(null,e.syncEngine),n.onUnlisten=KD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=GD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=WD.bind(null,e.syncEngine),n}function gj(t,e,n,r){const s=new $y(r),i=new My(e,s,n);return t.asyncQueue.enqueueAndForget(async()=>jy(await Fd(t),i)),()=>{s.Nu(),t.asyncQueue.enqueueAndForget(async()=>Vy(await Fd(t),i))}}function yj(t,e,n={}){const r=new Vn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new $y({next:p=>{h.Nu(),o.enqueueAndForget(()=>Vy(i,m));const x=p.docs.has(a);!x&&p.fromCache?d.reject(new G(z.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&p.fromCache&&c&&c.source==="server"?d.reject(new G(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new My(_c(a.path),h,{includeMetadataChanges:!0,Ka:!0});return jy(i,m)}(await Fd(t),t.asyncQueue,e,n,r)),r.promise}function vj(t,e,n={}){const r=new Vn;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new $y({next:p=>{h.Nu(),o.enqueueAndForget(()=>Vy(i,m)),p.fromCache&&c.source==="server"?d.reject(new G(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(p)},error:p=>d.reject(p)}),m=new My(a,h,{includeMetadataChanges:!0,Ka:!0});return jy(i,m)}(await Fd(t),t.asyncQueue,e,n,r)),r.promise}function _j(t,e){const n=new Vn;return t.asyncQueue.enqueueAndForget(async()=>QD(await mj(t),e,n)),n.promise}function xj(t,e,n){const r=new Vn;return t.asyncQueue.enqueueAndForget(async()=>{const s=await pj(t);new dj(t.asyncQueue,s,n,e,r).ju()}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ob(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj="ComponentProvider",Kx=new Map;function Ej(t,e,n,r,s){return new q2(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,Ob(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij="firestore.googleapis.com",Wx=!0;class Qx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new G(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ij,this.ssl=Wx}else this.host=e.host,this.ssl=e.ssl??Wx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=ZT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<rb)throw new G(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}h2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ob(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new G(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hy{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new r2;switch(r.type){case"firstParty":return new o2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Kx.get(n);r&&(q(wj,"Removing Datastore"),Kx.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Vr(this.firestore,e,this._query)}}class Ye{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Is(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ye(this.firestore,e,this._key)}toJSON(){return{type:Ye._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(pc(n,Ye._jsonSchema))return new Ye(e,r||null,new ee(be.fromString(n.referencePath)))}}Ye._jsonSchemaVersion="firestore/documentReference/1.0",Ye._jsonSchema={type:ct("string",Ye._jsonSchemaVersion),referencePath:ct("string")};class Is extends Vr{constructor(e,n,r){super(e,n,_c(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ye(this.firestore,null,new ee(e))}withConverter(e){return new Is(this.firestore,e,this._path)}}function Fe(t,e,...n){if(t=Ae(t),V1("collection","path",e),t instanceof Hy){const r=be.fromString(e,...n);return F0(r),new Is(t,null,r)}{if(!(t instanceof Ye||t instanceof Is))throw new G(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(be.fromString(e,...n));return F0(r),new Is(t.firestore,null,r)}}function tt(t,e,...n){if(t=Ae(t),arguments.length===1&&(e=ty.newId()),V1("doc","path",e),t instanceof Hy){const r=be.fromString(e,...n);return L0(r),new Ye(t,null,new ee(r))}{if(!(t instanceof Ye||t instanceof Is))throw new G(z.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(be.fromString(e,...n));return L0(r),new Ye(t.firestore,t instanceof Is?t.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yx="AsyncQueue";class Jx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ny(this,"async_queue_retry"),this._c=()=>{const r=$u();r&&q(Yx,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=$u();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=$u();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new Vn;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ls(e))throw e;q(Yx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,it("INTERNAL UNHANDLED ERROR: ",Xx(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=Py.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&te(47125,{Pc:Xx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Xx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ln extends Hy{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Jx,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Jx(e),this._firestoreClient=void 0,await e}}}function Zx(t,e,n){n||(n=Ad);const r=mc(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(xi(i,e))return s;throw new G(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new G(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<rb)throw new G(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&ar(e.host)&&vh(e.host),r.initialize({options:e,instanceIdentifier:n})}function fa(t){if(t._terminated)throw new G(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Tj(t),t._firestoreClient}function Tj(t){var r,s,i,o;const e=t._freezeSettings(),n=Ej(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(s=t._app)==null?void 0:s.options.apiKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new hj(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const d=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this._byteString=e}static fromBase64String(e){try{return new an(ot.fromBase64String(e))}catch(n){throw new G(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new an(ot.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:an._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pc(e,an._jsonSchema))return an.fromBase64String(e.bytes)}}an._jsonSchemaVersion="firestore/bytes/1.0",an._jsonSchema={type:ct("string",an._jsonSchemaVersion),bytes:ct("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new G(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new G(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new G(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return fe(this._lat,e._lat)||fe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:rr._jsonSchemaVersion}}static fromJSON(e){if(pc(e,rr._jsonSchema))return new rr(e.latitude,e.longitude)}}rr._jsonSchemaVersion="firestore/geoPoint/1.0",rr._jsonSchema={type:ct("string",rr._jsonSchemaVersion),latitude:ct("number"),longitude:ct("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class On{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:On._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pc(e,On._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new On(e.vectorValues);throw new G(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}On._jsonSchemaVersion="firestore/vectorValue/1.0",On._jsonSchema={type:ct("string",On._jsonSchemaVersion),vectorValues:ct("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bj=/^__.*__$/;class Sj{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new jr(e,this.data,this.fieldMask,n,this.fieldTransforms):new la(e,this.data,n,this.fieldTransforms)}}class Mb{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new jr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Lb(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw te(40011,{dataSource:t})}}class Gy{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Gy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return Ud(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Lb(this.dataSource)&&bj.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class Aj{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ph(e)}createContext(e,n,r,s=!1){return new Gy({dataSource:e,methodName:n,targetDoc:r,path:Qe.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ma(t){const e=t._freezeSettings(),n=Ph(t._databaseId);return new Aj(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Mh(t,e,n,r,s,i={}){const o=t.createContext(i.merge||i.mergeFields?2:0,e,n,s);Yy("Data must be an object, but it was:",o,r);const a=Fb(r,o);let c,d;if(i.merge)c=new Xt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const m of i.mergeFields){const p=Ni(e,m,n);if(!o.contains(p))throw new G(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);Bb(h,p)||h.push(p)}c=new Xt(h),d=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=o.fieldTransforms;return new Sj(new At(a),c,d)}class Lh extends Oh{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lh}}class Ky extends Oh{_toFieldTransform(e){return new CT(e.path,new Go)}isEqual(e){return e instanceof Ky}}function Wy(t,e,n,r){const s=t.createContext(1,e,n);Yy("Data must be an object, but it was:",s,r);const i=[],o=At.empty();Fs(r,(c,d)=>{const h=zb(e,c,n);d=Ae(d);const m=s.childContextForFieldPath(h);if(d instanceof Lh)i.push(h);else{const p=bc(d,m);p!=null&&(i.push(h),o.set(h,p))}});const a=new Xt(i);return new Mb(o,a,s.fieldTransforms)}function Qy(t,e,n,r,s,i){const o=t.createContext(1,e,n),a=[Ni(e,r,n)],c=[s];if(i.length%2!=0)throw new G(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)a.push(Ni(e,i[p])),c.push(i[p+1]);const d=[],h=At.empty();for(let p=a.length-1;p>=0;--p)if(!Bb(d,a[p])){const x=a[p];let A=c[p];A=Ae(A);const C=o.childContextForFieldPath(x);if(A instanceof Lh)d.push(x);else{const k=bc(A,C);k!=null&&(d.push(x),h.set(x,k))}}const m=new Xt(d);return new Mb(h,m,o.fieldTransforms)}function Nj(t,e,n,r=!1){return bc(n,t.createContext(r?4:3,e))}function bc(t,e){if(Ub(t=Ae(t)))return Yy("Unsupported field value:",e,t),Fb(t,e);if(t instanceof Oh)return function(r,s){if(!Lb(s.dataSource))throw s.createError(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=bc(a,s.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Ae(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return uP(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Re.fromDate(r);return{timestampValue:Qo(s.serializer,i)}}if(r instanceof Re){const i=new Re(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Qo(s.serializer,i)}}if(r instanceof rr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof an)return{bytesValue:OT(s.serializer,r._byteString)};if(r instanceof Ye){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:_y(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof On)return function(o,a){const c=o instanceof On?o.toArray():o;return{mapValue:{fields:{[cy]:{stringValue:uy},[Bo]:{arrayValue:{values:c.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return fy(a.serializer,h)})}}}}}}(r,s);if(KT(r))return r._toProto(s.serializer);throw s.createError(`Unsupported field value: ${_h(r)}`)}(t,e)}function Fb(t,e){const n={};return Z1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Fs(t,(r,s)=>{const i=bc(s,e.childContextForField(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Ub(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Re||t instanceof rr||t instanceof an||t instanceof Ye||t instanceof Oh||t instanceof On||KT(t))}function Yy(t,e,n){if(!Ub(n)||!O1(n)){const r=_h(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Ni(t,e,n){if((e=Ae(e))instanceof Tc)return e._internalPath;if(typeof e=="string")return zb(t,e);throw Ud("Field path arguments must be of type string or ",t,!1,void 0,n)}const Cj=new RegExp("[~\\*/\\[\\]]");function zb(t,e,n){if(e.search(Cj)>=0)throw Ud(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Tc(...e.split("."))._internalPath}catch{throw Ud(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ud(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new G(z.INVALID_ARGUMENT,a+t+c)}function Bb(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{convertValue(e,n="none"){switch(ks(e)){case 0:return null;case 1:return e.booleanValue;case 2:return qe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Nr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw te(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Fs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Bo].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>qe(o.doubleValue));return new On(n)}convertGeoPoint(e){return new rr(qe(e.latitude),qe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Th(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Yl(e));default:return null}}convertTimestamp(e){const n=Ar(e);return new Re(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=be.fromString(e);oe(GT(r),9688,{name:e});const s=new Ei(r.get(1),r.get(3)),i=new ee(r.popFirst(5));return s.isEqual(n)||it(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh extends $b{constructor(e){super(),this.firestore=e}convertBytes(e){return new an(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,n)}}function Me(){return new Ky("serverTimestamp")}const ew="@firebase/firestore",tw="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ye(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new kj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(Ni("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class kj extends zd{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qb(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new G(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Jy{}class Xy extends Jy{}function Lt(t,e,...n){let r=[];e instanceof Jy&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof Zy).length,a=i.filter(c=>c instanceof Uh).length;if(o>1||o>0&&a>0)throw new G(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Uh extends Xy{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Uh(e,n,r)}_apply(e){const n=this._parse(e);return Gb(e._query,n),new Vr(e.firestore,e.converter,Pp(e._query,n))}_parse(e){const n=ma(e.firestore);return function(i,o,a,c,d,h,m){let p;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new G(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){sw(m,h);const A=[];for(const C of m)A.push(rw(c,i,C));p={arrayValue:{values:A}}}else p=rw(c,i,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||sw(m,h),p=Nj(a,o,m,h==="in"||h==="not-in");return Ie.create(d,h,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function mt(t,e,n){const r=e,s=Ni("where",t);return Uh._create(s,r,n)}class Zy extends Jy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Zy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Pe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)Gb(o,c),o=Pp(o,c)}(e._query,n),new Vr(e.firestore,e.converter,Pp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class ev extends Xy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new ev(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new G(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ec(i,o)}(e._query,this._field,this._direction);return new Vr(e.firestore,e.converter,sP(e._query,n))}}function Hb(t,e="asc"){const n=e,r=Ni("orderBy",t);return ev._create(r,n)}class tv extends Xy{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new tv(e,n,r)}_apply(e){return new Vr(e.firestore,e.converter,kd(e._query,this._limit,this._limitType))}}function Rj(t){return tv._create("limit",t,"F")}function rw(t,e,n){if(typeof(n=Ae(n))=="string"){if(n==="")throw new G(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yT(e)&&n.indexOf("/")!==-1)throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(be.fromString(n));if(!ee.isDocumentKey(r))throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Xl(t,new ee(r))}if(n instanceof Ye)return Xl(t,n._key);throw new G(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${_h(n)}.`)}function sw(t,e){if(!Array.isArray(t)||t.length===0)throw new G(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Gb(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function zh(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Pj extends $b{constructor(e){super(),this.firestore=e}convertBytes(e){return new an(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ye(this.firestore,null,n)}}class Dj{constructor(e){this.kind="memory",this._onlineComponentProvider=ea.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new jb(void 0)}}toJSON(){return{kind:this.kind}}}class jj{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=Fj(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function Vj(t){return new Dj(t)}function Oj(t){return new jj(t)}class Mj{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ea.provider,this._offlineComponentProvider={build:n=>new Vb(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Lj{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ea.provider,this._offlineComponentProvider={build:n=>new cj(n,e==null?void 0:e.cacheSizeBytes)}}}function Fj(t){return new Mj(t==null?void 0:t.forceOwnership)}function Uj(){return new Lj}class po{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ts extends zd{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new qu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ni("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new G(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Ts._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Ts._jsonSchemaVersion="firestore/documentSnapshot/1.0",Ts._jsonSchema={type:ct("string",Ts._jsonSchemaVersion),bundleSource:ct("string","DocumentSnapshot"),bundleName:ct("string"),bundle:ct("string")};class qu extends Ts{data(e={}){return super.data(e)}}class fi{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new po(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new qu(this._firestore,this._userDataWriter,r.key,r,new po(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new G(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new qu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new po(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new qu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new po(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:zj(a.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new G(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fi._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ty.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function zj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return te(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fi._jsonSchemaVersion="firestore/querySnapshot/1.0",fi._jsonSchema={type:ct("string",fi._jsonSchemaVersion),bundleSource:ct("string","QuerySnapshot"),bundleName:ct("string"),bundle:ct("string")};const Bj={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=ma(e)}set(e,n,r){this._verifyNotCommitted();const s=us(e,this._firestore),i=zh(s.converter,n,r),o=Mh(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Ke.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=us(e,this._firestore);let o;return o=typeof(n=Ae(n))=="string"||n instanceof Tc?Qy(this._dataReader,"WriteBatch.update",i._key,n,r,s):Wy(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Ke.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=us(e,this._firestore);return this._mutations=this._mutations.concat(new ca(n._key,Ke.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new G(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function us(t,e){if((t=Ae(t)).firestore!==e)throw new G(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qj{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=ma(e)}get(e){const n=us(e,this._firestore),r=new Pj(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return te(24041);const i=s[0];if(i.isFoundDocument())return new zd(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new zd(this._firestore,r,n._key,null,n.converter);throw te(18433,{doc:i})})}set(e,n,r){const s=us(e,this._firestore),i=zh(s.converter,n,r),o=Mh(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=us(e,this._firestore);let o;return o=typeof(n=Ae(n))=="string"||n instanceof Tc?Qy(this._dataReader,"Transaction.update",i._key,n,r,s):Wy(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=us(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hj extends qj{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=us(e,this._firestore),r=new Fh(this._firestore);return super.get(e).then(s=>new Ts(this._firestore,r,n._key,s._document,new po(!1,!1),n.converter))}}function Gj(t,e,n){t=qt(t,Ln);const r={...Bj,...n};(function(o){if(o.maxAttempts<1)throw new G(z.INVALID_ARGUMENT,"Max attempts must be at least 1")})(r);const s=fa(t);return xj(s,i=>e(new Hj(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(t){t=qt(t,Ye);const e=qt(t.firestore,Ln),n=fa(e);return yj(n,t._key).then(r=>Kb(e,t,r))}function Gp(t){t=qt(t,Vr);const e=qt(t.firestore,Ln),n=fa(e),r=new Fh(e);return qb(t._query),vj(n,t._query).then(s=>new fi(e,r,t,s))}function Bd(t,e,n){t=qt(t,Ye);const r=qt(t.firestore,Ln),s=zh(t.converter,e,n),i=ma(r);return Sc(r,[Mh(i,"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ke.none())])}function un(t,e,n,...r){t=qt(t,Ye);const s=qt(t.firestore,Ln),i=ma(s);let o;return o=typeof(e=Ae(e))=="string"||e instanceof Tc?Qy(i,"updateDoc",t._key,e,n,r):Wy(i,"updateDoc",t._key,e),Sc(s,[o.toMutation(t._key,Ke.exists(!0))])}function Kj(t){return Sc(qt(t.firestore,Ln),[new ca(t._key,Ke.none())])}function Bh(t,e){const n=qt(t.firestore,Ln),r=tt(t),s=zh(t.converter,e),i=ma(t.firestore);return Sc(n,[Mh(i,"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Ke.exists(!1))]).then(()=>r)}function pt(t,...e){var d,h,m;t=Ae(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||nw(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(nw(e[r])){const p=e[r];e[r]=(d=p.next)==null?void 0:d.bind(p),e[r+1]=(h=p.error)==null?void 0:h.bind(p),e[r+2]=(m=p.complete)==null?void 0:m.bind(p)}let i,o,a;if(t instanceof Ye)o=qt(t.firestore,Ln),a=_c(t._key.path),i={next:p=>{e[r]&&e[r](Kb(o,t,p))},error:e[r+1],complete:e[r+2]};else{const p=qt(t,Vr);o=qt(p.firestore,Ln),a=p._query;const x=new Fh(o);i={next:A=>{e[r]&&e[r](new fi(o,x,p,A))},error:e[r+1],complete:e[r+2]},qb(t._query)}const c=fa(o);return gj(c,a,s,i)}function Sc(t,e){const n=fa(t);return _j(n,e)}function Kb(t,e,n){const r=n.docs.get(e._key),s=new Fh(t);return new Ts(t,s,e._key,r,new po(n.hasPendingWrites,n.fromCache),e.converter)}function Wj(t){return t=qt(t,Ln),fa(t),new $j(t,e=>Sc(t,e))}(function(e,n=!0){t2(ji),Cs(new br("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Ln(new s2(r.getProvider("auth-internal")),new a2(o,r.getProvider("app-check-internal")),H2(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),In(ew,tw,e),In(ew,tw,"esm2020")})();let Qj={data:""},Yj=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||Qj},Jj=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Xj=/\/\*[^]*?\*\/|  +/g,iw=/\n+/g,ts=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?ts(o,i):i+"{"+ts(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=ts(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=ts.p?ts.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},cr={},Wb=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+Wb(t[n]);return e}return t},Zj=(t,e,n,r,s)=>{let i=Wb(t),o=cr[i]||(cr[i]=(c=>{let d=0,h=11;for(;d<c.length;)h=101*h+c.charCodeAt(d++)>>>0;return"go"+h})(i));if(!cr[o]){let c=i!==t?t:(d=>{let h,m,p=[{}];for(;h=Jj.exec(d.replace(Xj,""));)h[4]?p.shift():h[3]?(m=h[3].replace(iw," ").trim(),p.unshift(p[0][m]=p[0][m]||{})):p[0][h[1]]=h[2].replace(iw," ").trim();return p[0]})(t);cr[o]=ts(s?{["@keyframes "+o]:c}:c,n?"":"."+o)}let a=n&&cr.g?cr.g:null;return n&&(cr.g=cr[o]),((c,d,h,m)=>{m?d.data=d.data.replace(m,c):d.data.indexOf(c)===-1&&(d.data=h?c+d.data:d.data+c)})(cr[o],e,r,a),o},eV=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(n),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=c?"."+c:a&&typeof a=="object"?a.props?"":ts(a,""):a===!1?"":a}return r+s+(o??"")},"");function $h(t){let e=this||{},n=t.call?t(e.p):t;return Zj(n.unshift?n.raw?eV(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,Yj(e.target),e.g,e.o,e.k)}let Qb,Kp,Wp;$h.bind({g:1});let Cr=$h.bind({k:1});function tV(t,e,n,r){ts.p=e,Qb=t,Kp=n,Wp=r}function zs(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),c=a.className||s.className;n.p=Object.assign({theme:Kp&&Kp()},a),n.o=/ *go\d+/.test(c),a.className=$h.apply(n,r)+(c?" "+c:"");let d=t;return t[0]&&(d=a.as||t,delete a.as),Wp&&d[0]&&Wp(a),Qb(d,a)}return s}}var nV=t=>typeof t=="function",$d=(t,e)=>nV(t)?t(e):t,rV=(()=>{let t=0;return()=>(++t).toString()})(),Yb=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),sV=20,nv="default",Jb=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return Jb(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Hu=[],Xb={toasts:[],pausedAt:void 0,settings:{toastLimit:sV}},Zn={},Zb=(t,e=nv)=>{Zn[e]=Jb(Zn[e]||Xb,t),Hu.forEach(([n,r])=>{n===e&&r(Zn[e])})},eS=t=>Object.keys(Zn).forEach(e=>Zb(t,e)),iV=t=>Object.keys(Zn).find(e=>Zn[e].toasts.some(n=>n.id===t)),qh=(t=nv)=>e=>{Zb(e,t)},oV={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},aV=(t={},e=nv)=>{let[n,r]=D.useState(Zn[e]||Xb),s=D.useRef(Zn[e]);D.useEffect(()=>(s.current!==Zn[e]&&r(Zn[e]),Hu.push([e,r]),()=>{let o=Hu.findIndex(([a])=>a===e);o>-1&&Hu.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var a,c,d;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((a=t[o.type])==null?void 0:a.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((c=t[o.type])==null?void 0:c.duration)||(t==null?void 0:t.duration)||oV[o.type],style:{...t.style,...(d=t[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:i}},lV=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||rV()}),Ac=t=>(e,n)=>{let r=lV(e,t,n);return qh(r.toasterId||iV(r.id))({type:2,toast:r}),r.id},ht=(t,e)=>Ac("blank")(t,e);ht.error=Ac("error");ht.success=Ac("success");ht.loading=Ac("loading");ht.custom=Ac("custom");ht.dismiss=(t,e)=>{let n={type:3,toastId:t};e?qh(e)(n):eS(n)};ht.dismissAll=t=>ht.dismiss(void 0,t);ht.remove=(t,e)=>{let n={type:4,toastId:t};e?qh(e)(n):eS(n)};ht.removeAll=t=>ht.remove(void 0,t);ht.promise=(t,e,n)=>{let r=ht.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?$d(e.success,s):void 0;return i?ht.success(i,{id:r,...n,...n==null?void 0:n.success}):ht.dismiss(r),s}).catch(s=>{let i=e.error?$d(e.error,s):void 0;i?ht.error(i,{id:r,...n,...n==null?void 0:n.error}):ht.dismiss(r)}),t};var cV=1e3,uV=(t,e="default")=>{let{toasts:n,pausedAt:r}=aV(t,e),s=D.useRef(new Map).current,i=D.useCallback((m,p=cV)=>{if(s.has(m))return;let x=setTimeout(()=>{s.delete(m),o({type:4,toastId:m})},p);s.set(m,x)},[]);D.useEffect(()=>{if(r)return;let m=Date.now(),p=n.map(x=>{if(x.duration===1/0)return;let A=(x.duration||0)+x.pauseDuration-(m-x.createdAt);if(A<0){x.visible&&ht.dismiss(x.id);return}return setTimeout(()=>ht.dismiss(x.id,e),A)});return()=>{p.forEach(x=>x&&clearTimeout(x))}},[n,r,e]);let o=D.useCallback(qh(e),[e]),a=D.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=D.useCallback((m,p)=>{o({type:1,toast:{id:m,height:p}})},[o]),d=D.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),h=D.useCallback((m,p)=>{let{reverseOrder:x=!1,gutter:A=8,defaultPosition:C}=p||{},k=n.filter(w=>(w.position||C)===(m.position||C)&&w.height),_=k.findIndex(w=>w.id===m.id),v=k.filter((w,P)=>P<_&&w.visible).length;return k.filter(w=>w.visible).slice(...x?[v+1]:[0,v]).reduce((w,P)=>w+(P.height||0)+A,0)},[n]);return D.useEffect(()=>{n.forEach(m=>{if(m.dismissed)i(m.id,m.removeDelay);else{let p=s.get(m.id);p&&(clearTimeout(p),s.delete(m.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:c,startPause:a,endPause:d,calculateOffset:h}}},dV=Cr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,hV=Cr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,fV=Cr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,mV=zs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${hV} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${fV} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,pV=Cr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,gV=zs("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${pV} 1s linear infinite;
`,yV=Cr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,vV=Cr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,_V=zs("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${yV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${vV} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,xV=zs("div")`
  position: absolute;
`,wV=zs("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,EV=Cr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,IV=zs("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${EV} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,TV=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?D.createElement(IV,null,e):e:n==="blank"?null:D.createElement(wV,null,D.createElement(gV,{...r}),n!=="loading"&&D.createElement(xV,null,n==="error"?D.createElement(mV,{...r}):D.createElement(_V,{...r})))},bV=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,SV=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,AV="0%{opacity:0;} 100%{opacity:1;}",NV="0%{opacity:1;} 100%{opacity:0;}",CV=zs("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,kV=zs("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,RV=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=Yb()?[AV,NV]:[bV(n),SV(n)];return{animation:e?`${Cr(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Cr(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},PV=D.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?RV(t.position||e||"top-center",t.visible):{opacity:0},i=D.createElement(TV,{toast:t}),o=D.createElement(kV,{...t.ariaProps},$d(t.message,t));return D.createElement(CV,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):D.createElement(D.Fragment,null,i,o))});tV(D.createElement);var DV=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=D.useCallback(o=>{if(o){let a=()=>{let c=o.getBoundingClientRect().height;r(t,c)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return D.createElement("div",{ref:i,className:e,style:n},s)},jV=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Yb()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},VV=$h`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,fu=16,OV=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:c,handlers:d}=uV(n,i);return D.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:fu,left:fu,right:fu,bottom:fu,pointerEvents:"none",...o},className:a,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(h=>{let m=h.position||e,p=d.calculateOffset(h,{reverseOrder:t,gutter:r,defaultPosition:e}),x=jV(m,p);return D.createElement(DV,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?VV:"",style:x},h.type==="custom"?$d(h.message,h):s?s(h):D.createElement(PV,{toast:h,position:m}))}))},mu=ht,MV="firebase",LV="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In(MV,LV,"app");function tS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const FV=tS,nS=new hc("auth","Firebase",tS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qd=new Jg("@firebase/auth");function UV(t,...e){qd.logLevel<=Ee.WARN&&qd.warn(`Auth (${ji}): ${t}`,...e)}function Gu(t,...e){qd.logLevel<=Ee.ERROR&&qd.error(`Auth (${ji}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fn(t,...e){throw rv(t,...e)}function sr(t,...e){return rv(t,...e)}function rS(t,e,n){const r={...FV(),[e]:n};return new hc("auth","Firebase",r).create(e,{appName:t.name})}function _r(t){return rS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return nS.create(t,...e)}function de(t,e,...n){if(!t)throw rv(e,...n)}function pr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Gu(e),new Error(e)}function kr(t,e){t||pr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qp(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function zV(){return ow()==="http:"||ow()==="https:"}function ow(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(zV()||Ok()||"connection"in navigator)?navigator.onLine:!0}function $V(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e,n){this.shortDelay=e,this.longDelay=n,kr(n>e,"Short delay should be less than long delay!"),this.isMobile=jk()||Mk()}get(){return BV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(t,e){kr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;pr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;pr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;pr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],GV=new Nc(3e4,6e4);function Or(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function lr(t,e,n,r,s={}){return iS(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=fc({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...i};return Vk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ar(t.emulatorConfig.host)&&(d.credentials="include"),sS.fetch()(await oS(t,t.config.apiHost,n,a),d)})}async function iS(t,e,n){t._canInitEmulator=!1;const r={...qV,...e};try{const s=new WV(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw pu(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw pu(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw pu(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw pu(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw rS(t,h,d);Fn(t,h)}}catch(s){if(s instanceof Un)throw s;Fn(t,"network-request-failed",{message:String(s)})}}async function Cc(t,e,n,r,s={}){const i=await lr(t,e,n,r,s);return"mfaPendingCredential"in i&&Fn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function oS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?sv(t.config,s):`${t.config.apiScheme}://${s}`;return HV.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function KV(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class WV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(sr(this.auth,"network-request-failed")),GV.get())})}}function pu(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=sr(t,e,r);return s.customData._tokenResponse=n,s}function aw(t){return t!==void 0&&t.enterprise!==void 0}class QV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return KV(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function YV(t,e){return lr(t,"GET","/v2/recaptchaConfig",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JV(t,e){return lr(t,"POST","/v1/accounts:delete",e)}async function Hd(t,e){return lr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function XV(t,e=!1){const n=Ae(t),r=await n.getIdToken(e),s=iv(r);de(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Tl(nm(s.auth_time)),issuedAtTime:Tl(nm(s.iat)),expirationTime:Tl(nm(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function nm(t){return Number(t)*1e3}function iv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Gu("JWT malformed, contained fewer than 3 sections"),null;try{const s=h1(n);return s?JSON.parse(s):(Gu("Failed to decode base64 JWT payload"),null)}catch(s){return Gu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function lw(t){const e=iv(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ta(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Un&&ZV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function ZV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Tl(this.lastLoginAt),this.creationTime=Tl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gd(t){var m;const e=t.auth,n=await t.getIdToken(),r=await ta(t,Hd(e,{idToken:n}));de(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?aS(s.providerUserInfo):[],o=n4(t.providerData,i),a=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Yp(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function t4(t){const e=Ae(t);await Gd(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function n4(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function aS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r4(t,e){const n=await iS(t,{},async()=>{const r=fc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await oS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&ar(t.emulatorConfig.host)&&(c.credentials="include"),sS.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function s4(t,e){return lr(t,"POST","/v2/accounts:revokeToken",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):lw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){de(e.length!==0,"internal-error");const n=lw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await r4(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new bo;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(de(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(de(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new bo,this.toJSON())}_performRefresh(){return pr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wr(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Pn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new e4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Yp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await ta(this,this.stsTokenManager.getToken(this.auth,e));return de(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return XV(this,e)}reload(){return t4(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Pn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Gd(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qt(this.auth.app))return Promise.reject(_r(this.auth));const e=await this.getIdToken();return await ta(this,JV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:m,emailVerified:p,isAnonymous:x,providerData:A,stsTokenManager:C}=n;de(m&&C,e,"internal-error");const k=bo.fromJSON(this.name,C);de(typeof m=="string",e,"internal-error"),Wr(r,e.name),Wr(s,e.name),de(typeof p=="boolean",e,"internal-error"),de(typeof x=="boolean",e,"internal-error"),Wr(i,e.name),Wr(o,e.name),Wr(a,e.name),Wr(c,e.name),Wr(d,e.name),Wr(h,e.name);const _=new Pn({uid:m,auth:e,email:s,emailVerified:p,displayName:r,isAnonymous:x,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:k,createdAt:d,lastLoginAt:h});return A&&Array.isArray(A)&&(_.providerData=A.map(v=>({...v}))),c&&(_._redirectEventId=c),_}static async _fromIdTokenResponse(e,n,r=!1){const s=new bo;s.updateFromServerResponse(n);const i=new Pn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Gd(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];de(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?aS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new bo;a.updateFromIdToken(r);const c=new Pn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Yp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cw=new Map;function gr(t){kr(t instanceof Function,"Expected a class definition");let e=cw.get(t);return e?(kr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,cw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}lS.type="NONE";const uw=lS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(t,e,n){return`firebase:${t}:${e}:${n}`}class So{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ku(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ku("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Hd(this.auth,{idToken:e}).catch(()=>{});return n?Pn._fromGetAccountInfoResponse(this.auth,n,e):null}return Pn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new So(gr(uw),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||gr(uw);const o=Ku(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let m;if(typeof h=="string"){const p=await Hd(e,{idToken:h}).catch(()=>{});if(!p)break;m=await Pn._fromGetAccountInfoResponse(e,p,h)}else m=Pn._fromJSON(e,h);d!==i&&(a=m),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new So(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new So(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(hS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(cS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(mS(e))return"Blackberry";if(pS(e))return"Webos";if(uS(e))return"Safari";if((e.includes("chrome/")||dS(e))&&!e.includes("edge/"))return"Chrome";if(fS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function cS(t=gt()){return/firefox\//i.test(t)}function uS(t=gt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dS(t=gt()){return/crios\//i.test(t)}function hS(t=gt()){return/iemobile/i.test(t)}function fS(t=gt()){return/android/i.test(t)}function mS(t=gt()){return/blackberry/i.test(t)}function pS(t=gt()){return/webos/i.test(t)}function ov(t=gt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function i4(t=gt()){var e;return ov(t)&&!!((e=window.navigator)!=null&&e.standalone)}function o4(){return Lk()&&document.documentMode===10}function gS(t=gt()){return ov(t)||fS(t)||pS(t)||mS(t)||/windows phone/i.test(t)||hS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yS(t,e=[]){let n;switch(t){case"Browser":n=dw(gt());break;case"Worker":n=`${dw(gt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ji}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l4(t,e={}){return lr(t,"GET","/v2/passwordPolicy",Or(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4=6;class u4{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??c4,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d4{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new hw(this),this.idTokenSubscription=new hw(this),this.beforeStateQueue=new a4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=gr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await So.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Hd(this,{idToken:e}),r=await Pn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Qt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Gd(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$V()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qt(this.app))return Promise.reject(_r(this));const n=e?Ae(e):null;return n&&de(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qt(this.app)?Promise.reject(_r(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qt(this.app)?Promise.reject(_r(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await l4(this),n=new u4(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new hc("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await s4(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&gr(e)||this._popupRedirectResolver;de(n,this,"argument-error"),this.redirectPersistenceManager=await So.create(this,[gr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=yS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Qt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&UV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Bs(t){return Ae(t)}class hw{constructor(e){this.auth=e,this.observer=null,this.addObserver=qk(n=>this.observer=n)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function h4(t){Hh=t}function vS(t){return Hh.loadJS(t)}function f4(){return Hh.recaptchaEnterpriseScript}function m4(){return Hh.gapiScript}function p4(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class g4{constructor(){this.enterprise=new y4}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class y4{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const v4="recaptcha-enterprise",_S="NO_RECAPTCHA";class _4{constructor(e){this.type=v4,this.auth=Bs(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{YV(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new QV(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;aw(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(_S)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new g4().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&aw(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=f4();c.length!==0&&(c+=a),vS(c).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function fw(t,e,n,r=!1,s=!1){const i=new _4(t);let o;if(s)o=_S;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Kd(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await fw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await fw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x4(t,e){const n=mc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(xi(i,e??{}))return s;Fn(s,"already-initialized")}return n.initialize({options:e})}function w4(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(gr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function E4(t,e,n){const r=Bs(t);de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=xS(e),{host:o,port:a}=I4(e),c=a===null?"":`:${a}`,d={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){de(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),de(xi(d,r.config.emulator)&&xi(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,ar(o)?(vh(`${i}//${o}${c}`),Yg("Auth",!0)):T4()}function xS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function I4(t){const e=xS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:mw(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:mw(o)}}}function mw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function T4(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return pr("not implemented")}_getIdTokenResponse(e){return pr("not implemented")}_linkToIdToken(e,n){return pr("not implemented")}_getReauthenticationResolver(e){return pr("not implemented")}}async function b4(t,e){return lr(t,"POST","/v1/accounts:update",e)}async function S4(t,e){return lr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A4(t,e){return Cc(t,"POST","/v1/accounts:signInWithPassword",Or(t,e))}async function N4(t,e){return lr(t,"POST","/v1/accounts:sendOobCode",Or(t,e))}async function C4(t,e){return N4(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k4(t,e){return Cc(t,"POST","/v1/accounts:signInWithEmailLink",Or(t,e))}async function R4(t,e){return Cc(t,"POST","/v1/accounts:signInWithEmailLink",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic extends av{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new ic(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ic(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kd(e,n,"signInWithPassword",A4);case"emailLink":return k4(e,{email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Kd(e,r,"signUpPassword",S4);case"emailLink":return R4(e,{idToken:n,email:this._email,oobCode:this._password});default:Fn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ao(t,e){return Cc(t,"POST","/v1/accounts:signInWithIdp",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4="http://localhost";class Ci extends av{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ci(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Fn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ci(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ao(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ao(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ao(e,n)}buildRequest(){const e={requestUri:P4,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=fc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D4(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function j4(t){const e=Ja(Xa(t)).link,n=e?Ja(Xa(e)).deep_link_id:null,r=Ja(Xa(t)).deep_link_id;return(r?Ja(Xa(r)).link:null)||r||n||e||t}class lv{constructor(e){const n=Ja(Xa(e)),r=n.apiKey??null,s=n.oobCode??null,i=D4(n.mode??null);de(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=j4(e);try{return new lv(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oi{constructor(){this.providerId=Oi.PROVIDER_ID}static credential(e,n){return ic._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=lv.parseLink(n);return de(r,"argument-error"),ic._fromEmailAndCode(e,r.code,r.tenantId)}}Oi.PROVIDER_ID="password";Oi.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Oi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc extends wS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends kc{constructor(){super("facebook.com")}static credential(e){return Ci._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ns.credential(e.oauthAccessToken)}catch{return null}}}ns.FACEBOOK_SIGN_IN_METHOD="facebook.com";ns.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends kc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ci._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return rs.credential(n,r)}catch{return null}}}rs.GOOGLE_SIGN_IN_METHOD="google.com";rs.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends kc{constructor(){super("github.com")}static credential(e){return Ci._fromParams({providerId:ss.PROVIDER_ID,signInMethod:ss.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ss.credentialFromTaggedObject(e)}static credentialFromError(e){return ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ss.credential(e.oauthAccessToken)}catch{return null}}}ss.GITHUB_SIGN_IN_METHOD="github.com";ss.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is extends kc{constructor(){super("twitter.com")}static credential(e,n){return Ci._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return is.credentialFromTaggedObject(e)}static credentialFromError(e){return is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return is.credential(n,r)}catch{return null}}}is.TWITTER_SIGN_IN_METHOD="twitter.com";is.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V4(t,e){return Cc(t,"POST","/v1/accounts:signUp",Or(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ki{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Pn._fromIdTokenResponse(e,r,s),o=pw(r);return new ki({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=pw(r);return new ki({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function pw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd extends Un{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Wd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Wd(e,n,r,s)}}function ES(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Wd._fromErrorAndOperation(t,i,e,r):i})}async function O4(t,e,n=!1){const r=await ta(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ki._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IS(t,e,n=!1){const{auth:r}=t;if(Qt(r.app))return Promise.reject(_r(r));const s="reauthenticate";try{const i=await ta(t,ES(r,s,e,t),n);de(i.idToken,r,"internal-error");const o=iv(i.idToken);de(o,r,"internal-error");const{sub:a}=o;return de(t.uid===a,r,"user-mismatch"),ki._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Fn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TS(t,e,n=!1){if(Qt(t.app))return Promise.reject(_r(t));const r="signIn",s=await ES(t,r,e),i=await ki._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function M4(t,e){return TS(Bs(t),e)}async function L4(t,e){return IS(Ae(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bS(t){const e=Bs(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function SS(t,e,n){const r=Bs(t);await Kd(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",C4)}async function F4(t,e,n){if(Qt(t.app))return Promise.reject(_r(t));const r=Bs(t),o=await Kd(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",V4).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&bS(t),c}),a=await ki._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function U4(t,e,n){return Qt(t.app)?Promise.reject(_r(t)):M4(Ae(t),Oi.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&bS(t),r})}function z4(t,e){return B4(Ae(t),null,e)}async function B4(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await ta(t,b4(r,i));await t._updateTokensIfNecessary(o,!0)}function $4(t,e,n,r){return Ae(t).onIdTokenChanged(e,n,r)}function q4(t,e,n){return Ae(t).beforeAuthStateChanged(e,n)}function H4(t,e,n,r){return Ae(t).onAuthStateChanged(e,n,r)}function G4(t){return Ae(t).signOut()}async function K4(t){return Ae(t).delete()}const Qd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Qd,"1"),this.storage.removeItem(Qd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4=1e3,Q4=10;class NS extends AS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=gS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);o4()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Q4):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},W4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}NS.type="LOCAL";const Y4=NS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS extends AS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}CS.type="SESSION";const kS=CS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J4(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Gh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),c=await J4(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Gh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const d=cv("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const p=m;if(p.data.eventId===d)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(p.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(){return window}function Z4(t){ir().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(){return typeof ir().WorkerGlobalScope<"u"&&typeof ir().importScripts=="function"}async function eO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function tO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function nO(){return RS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS="firebaseLocalStorageDb",rO=1,Yd="firebaseLocalStorage",DS="fbase_key";class Rc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Kh(t,e){return t.transaction([Yd],e?"readwrite":"readonly").objectStore(Yd)}function sO(){const t=indexedDB.deleteDatabase(PS);return new Rc(t).toPromise()}function Jp(){const t=indexedDB.open(PS,rO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Yd,{keyPath:DS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Yd)?e(r):(r.close(),await sO(),e(await Jp()))})})}async function gw(t,e,n){const r=Kh(t,!0).put({[DS]:e,value:n});return new Rc(r).toPromise()}async function iO(t,e){const n=Kh(t,!1).get(e),r=await new Rc(n).toPromise();return r===void 0?null:r.value}function yw(t,e){const n=Kh(t,!0).delete(e);return new Rc(n).toPromise()}const oO=800,aO=3;class jS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Jp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>aO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return RS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Gh._getInstance(nO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await eO(),!this.activeServiceWorker)return;this.sender=new X4(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||tO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Jp();return await gw(e,Qd,"1"),await yw(e,Qd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>gw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>iO(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>yw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Kh(s,!1).getAll();return new Rc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),oO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}jS.type="LOCAL";const lO=jS;new Nc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cO(t,e){return e?gr(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv extends av{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ao(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ao(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ao(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function uO(t){return TS(t.auth,new uv(t),t.bypassAuthState)}function dO(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),IS(n,new uv(t),t.bypassAuthState)}async function hO(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),O4(n,new uv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return uO;case"linkViaPopup":case"linkViaRedirect":return hO;case"reauthViaPopup":case"reauthViaRedirect":return dO;default:Fn(this.auth,"internal-error")}}resolve(e){kr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){kr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=new Nc(2e3,1e4);class go extends VS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,go.currentPopupAction&&go.currentPopupAction.cancel(),go.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){kr(this.filter.length===1,"Popup operations only handle one event");const e=cv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(sr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(sr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,go.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(sr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,fO.get())};e()}}go.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mO="pendingRedirect",Wu=new Map;class pO extends VS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Wu.get(this.auth._key());if(!e){try{const r=await gO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Wu.set(this.auth._key(),e)}return this.bypassAuthState||Wu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function gO(t,e){const n=_O(e),r=vO(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function yO(t,e){Wu.set(t._key(),e)}function vO(t){return gr(t._redirectPersistence)}function _O(t){return Ku(mO,t.config.apiKey,t.name)}async function xO(t,e,n=!1){if(Qt(t.app))return Promise.reject(_r(t));const r=Bs(t),s=cO(r,e),o=await new pO(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO=10*60*1e3;class EO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!IO(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!OS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(sr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=wO&&this.cachedEventUids.clear(),this.cachedEventUids.has(vw(e))}saveEventToCache(e){this.cachedEventUids.add(vw(e)),this.lastProcessedEventTime=Date.now()}}function vw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function OS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function IO(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return OS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TO(t,e={}){return lr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,SO=/^https?/;async function AO(t){if(t.config.emulator)return;const{authorizedDomains:e}=await TO(t);for(const n of e)try{if(NO(n))return}catch{}Fn(t,"unauthorized-domain")}function NO(t){const e=Qp(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!SO.test(n))return!1;if(bO.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CO=new Nc(3e4,6e4);function _w(){const t=ir().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function kO(t){return new Promise((e,n)=>{var s,i,o;function r(){_w(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_w(),n(sr(t,"network-request-failed"))},timeout:CO.get()})}if((i=(s=ir().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=ir().gapi)!=null&&o.load)r();else{const a=p4("iframefcb");return ir()[a]=()=>{gapi.load?r():n(sr(t,"network-request-failed"))},vS(`${m4()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Qu=null,e})}let Qu=null;function RO(t){return Qu=Qu||kO(t),Qu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO=new Nc(5e3,15e3),DO="__/auth/iframe",jO="emulator/auth/iframe",VO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},OO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function MO(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?sv(e,jO):`https://${t.config.authDomain}/${DO}`,r={apiKey:e.apiKey,appName:t.name,v:ji},s=OO.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${fc(r).slice(1)}`}async function LO(t){const e=await RO(t),n=ir().gapi;return de(n,t,"internal-error"),e.open({where:document.body,url:MO(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VO,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=sr(t,"network-request-failed"),a=ir().setTimeout(()=>{i(o)},PO.get());function c(){ir().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},UO=500,zO=600,BO="_blank",$O="http://localhost";class xw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function qO(t,e,n,r=UO,s=zO){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...FO,width:r.toString(),height:s.toString(),top:i,left:o},d=gt().toLowerCase();n&&(a=dS(d)?BO:n),cS(d)&&(e=e||$O,c.scrollbars="yes");const h=Object.entries(c).reduce((p,[x,A])=>`${p}${x}=${A},`,"");if(i4(d)&&a!=="_self")return HO(e||"",a),new xw(null);const m=window.open(e||"",a,h);de(m,t,"popup-blocked");try{m.focus()}catch{}return new xw(m)}function HO(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO="__/auth/handler",KO="emulator/auth/handler",WO=encodeURIComponent("fac");async function ww(t,e,n,r,s,i){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ji,eventId:s};if(e instanceof wS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",$k(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))o[h]=m}if(e instanceof kc){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),d=c?`#${WO}=${encodeURIComponent(c)}`:"";return`${QO(t)}?${fc(a).slice(1)}${d}`}function QO({config:t}){return t.emulator?sv(t,KO):`https://${t.authDomain}/${GO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rm="webStorageSupport";class YO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=kS,this._completeRedirectFn=xO,this._overrideRedirectResult=yO}async _openPopup(e,n,r,s){var o;kr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await ww(e,n,r,Qp(),s);return qO(e,i,cv())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await ww(e,n,r,Qp(),s);return Z4(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(kr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await LO(e),r=new EO(e);return n.register("authEvent",s=>(de(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(rm,{type:rm},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[rm];i!==void 0&&n(!!i),Fn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=AO(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return gS()||uS()||ov()}}const JO=YO;var Ew="@firebase/auth",Iw="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZO(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eM(t){Cs(new br("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:yS(t)},d=new d4(r,s,i,c);return w4(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Cs(new br("auth-internal",e=>{const n=Bs(e.getProvider("auth").getImmediate());return(r=>new XO(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),In(Ew,Iw,ZO(t)),In(Ew,Iw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM=5*60,nM=y1("authIdTokenMaxAge")||tM;let Tw=null;const rM=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>nM)return;const s=n==null?void 0:n.token;Tw!==s&&(Tw=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function sM(t=Zg()){const e=mc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=x4(t,{popupRedirectResolver:JO,persistence:[lO,Y4,kS]}),r=y1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=rM(i.toString());q4(n,o,()=>o(n.currentUser)),$4(n,a=>o(a))}}const s=m1("auth");return s&&E4(n,`http://${s}`),n}function iM(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}h4({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=sr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",iM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eM("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM="type.googleapis.com/google.protobuf.Int64Value",aM="type.googleapis.com/google.protobuf.UInt64Value";function MS(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Jd(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Jd(e));if(typeof t=="function"||typeof t=="object")return MS(t,e=>Jd(e));throw new Error("Data cannot be encoded in JSON: "+t)}function na(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case oM:case aM:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>na(e)):typeof t=="function"||typeof t=="object"?MS(t,e=>na(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dv="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bw={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Zt extends Un{constructor(e,n,r){super(`${dv}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,Zt.prototype)}}function lM(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Xd(t,e){let n=lM(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!bw[o])return new Zt("internal","internal");n=bw[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=na(s))}}catch{}return n==="ok"?null:new Zt(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cM{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Qt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp="us-central1",uM=/^data: (.*?)(?:\n|$)/;function dM(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new Zt("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class hM{constructor(e,n,r,s,i=Xp,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new cM(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=Xp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function fM(t,e,n){const r=ar(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(vh(t.emulatorOrigin+"/backends"),Yg("Functions",!0))}function mM(t,e,n){const r=s=>gM(t,e,s,{});return r.stream=(s,i)=>vM(t,e,s,i),r}function LS(t){return t.emulatorOrigin&&ar(t.emulatorOrigin)?"include":void 0}async function pM(t,e,n,r,s){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:LS(s)})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function FS(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function gM(t,e,n,r){const s=t._url(e);return yM(t,s,n,r)}async function yM(t,e,n,r){n=Jd(n);const s={data:n},i=await FS(t,r),o=r.timeout||7e4,a=dM(o),c=await Promise.race([pM(e,s,i,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!c)throw new Zt("cancelled","Firebase Functions instance was deleted.");const d=Xd(c.status,c.json);if(d)throw d;if(!c.json)throw new Zt("internal","Response is not valid JSON object.");let h=c.json.data;if(typeof h>"u"&&(h=c.json.result),typeof h>"u")throw new Zt("internal","Response is missing data field.");return{data:na(h)}}function vM(t,e,n,r){const s=t._url(e);return _M(t,s,n,r||{})}async function _M(t,e,n,r){var p;n=Jd(n);const s={data:n},i=await FS(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal,credentials:LS(t)})}catch(x){if(x instanceof Error&&x.name==="AbortError"){const C=new Zt("cancelled","Request was cancelled.");return{data:Promise.reject(C),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(C)}}}}}}const A=Xd(0,null);return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}let a,c;const d=new Promise((x,A)=>{a=x,c=A});(p=r==null?void 0:r.signal)==null||p.addEventListener("abort",()=>{const x=new Zt("cancelled","Request was cancelled.");c(x)});const h=o.body.getReader(),m=xM(h,a,c,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const x=m.getReader();return{async next(){const{value:A,done:C}=await x.read();return{value:A,done:C}},async return(){return await x.cancel(),{done:!0,value:void 0}}}}},data:d}}function xM(t,e,n,r){const s=(o,a)=>{const c=o.match(uM);if(!c)return;const d=c[1];try{const h=JSON.parse(d);if("result"in h){e(na(h.result));return}if("message"in h){a.enqueue(na(h.message));return}if("error"in h){const m=Xd(0,h);a.error(m),n(m);return}}catch(h){if(h instanceof Zt){a.error(h),n(h);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return c();async function c(){if(r!=null&&r.aborted){const d=new Zt("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const p=new Zt("cancelled","Request was cancelled");o.error(p),n(p),await t.cancel();return}a+=i.decode(d,{stream:!0});const m=a.split(`
`);a=m.pop()||"";for(const p of m)p.trim()&&s(p.trim(),o);return c()}catch(d){const h=d instanceof Zt?d:Xd(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const Sw="@firebase/functions",Aw="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wM="auth-internal",EM="app-check-internal",IM="messaging-internal";function TM(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(wM),o=n.getProvider(IM),a=n.getProvider(EM);return new hM(s,i,o,a,r)};Cs(new br(dv,e,"PUBLIC").setMultipleInstances(!0)),In(Sw,Aw,t),In(Sw,Aw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bM(t=Zg(),e=Xp){const r=mc(Ae(t),dv).getImmediate({identifier:e}),s=p1("functions");return s&&SM(r,...s),r}function SM(t,e,n){fM(Ae(t),e,n)}function US(t,e,n){return mM(Ae(t),e)}TM();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS="firebasestorage.googleapis.com",BS="storageBucket",AM=2*60*1e3,NM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt extends Un{constructor(e,n,r=0){super(sm(e),`Firebase Storage: ${n} (${sm(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,rt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return sm(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var nt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(nt||(nt={}));function sm(t){return"storage/"+t}function hv(){const t="An unknown error occurred, please check the error payload for server response.";return new rt(nt.UNKNOWN,t)}function CM(t){return new rt(nt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function kM(t){return new rt(nt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function RM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new rt(nt.UNAUTHENTICATED,t)}function PM(){return new rt(nt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function DM(t){return new rt(nt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function jM(){return new rt(nt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function VM(){return new rt(nt.CANCELED,"User canceled the upload/download.")}function OM(t){return new rt(nt.INVALID_URL,"Invalid URL '"+t+"'.")}function MM(t){return new rt(nt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function LM(){return new rt(nt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+BS+"' property when initializing the app?")}function FM(){return new rt(nt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function UM(){return new rt(nt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function zM(t){return new rt(nt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Zp(t){return new rt(nt.INVALID_ARGUMENT,t)}function $S(){return new rt(nt.APP_DELETED,"The Firebase app was deleted.")}function BM(t){return new rt(nt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function bl(t,e){return new rt(nt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function qa(t){throw new rt(nt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=dn.makeFromUrl(e,n)}catch{return new dn(e,"")}if(r.path==="")return r;throw MM(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(P){P.path_=decodeURIComponent(P.path)}const h="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",x=new RegExp(`^https?://${m}/${h}/b/${s}/o${p}`,"i"),A={bucket:1,path:3},C=n===zS?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",_=new RegExp(`^https?://${C}/${s}/${k}`,"i"),w=[{regex:a,indices:c,postModify:i},{regex:x,indices:A,postModify:d},{regex:_,indices:{bucket:1,path:2},postModify:d}];for(let P=0;P<w.length;P++){const j=w[P],L=j.regex.exec(e);if(L){const E=L[j.indices.bucket];let y=L[j.indices.path];y||(y=""),r=new dn(E,y),j.postModify(r);break}}if(r==null)throw OM(e);return r}}class $M{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qM(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let d=!1;function h(...k){d||(d=!0,e.apply(null,k))}function m(k){s=setTimeout(()=>{s=null,t(x,c())},k)}function p(){i&&clearTimeout(i)}function x(k,..._){if(d){p();return}if(k){p(),h.call(null,k,..._);return}if(c()||o){p(),h.call(null,k,..._);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,m(w)}let A=!1;function C(k){A||(A=!0,p(),!d&&(s!==null?(k||(a=2),clearTimeout(s),m(0)):k||(a=1)))}return m(0),i=setTimeout(()=>{o=!0,C(!0)},n),C}function HM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GM(t){return t!==void 0}function KM(t){return typeof t=="object"&&!Array.isArray(t)}function fv(t){return typeof t=="string"||t instanceof String}function Nw(t){return mv()&&t instanceof Blob}function mv(){return typeof Blob<"u"}function Cw(t,e,n,r){if(r<e)throw Zp(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Zp(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wh(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function qS(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var mi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(mi||(mi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,n,r,s,i,o,a,c,d,h,m,p=!0,x=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=m,this.retry=p,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,C)=>{this.resolve_=A,this.reject_=C,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new gu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===mi.NO_ERROR,c=i.getStatus();if(!a||WM(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===mi.ABORT;r(!1,new gu(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new gu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());GM(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=hv();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?$S():VM();o(c)}else{const c=jM();o(c)}};this.canceled_?n(!1,new gu(!1,null,!0)):this.backoffId_=qM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&HM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class gu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function YM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function JM(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function XM(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ZM(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function eL(t,e,n,r,s,i,o=!0,a=!1){const c=qS(t.urlParams),d=t.url+c,h=Object.assign({},t.headers);return XM(h,e),YM(h,n),JM(h,i),ZM(h,r),new QM(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tL(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function nL(...t){const e=tL();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(mv())return new Blob(t);throw new rt(nt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function rL(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sL(t){if(typeof atob>"u")throw zM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class im{constructor(e,n){this.data=e,this.contentType=n||null}}function iL(t,e){switch(t){case er.RAW:return new im(HS(e));case er.BASE64:case er.BASE64URL:return new im(GS(t,e));case er.DATA_URL:return new im(aL(e),lL(e))}throw hv()}function HS(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function oL(t){let e;try{e=decodeURIComponent(t)}catch{throw bl(er.DATA_URL,"Malformed data URL.")}return HS(e)}function GS(t,e){switch(t){case er.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw bl(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case er.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw bl(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=sL(e)}catch(s){throw s.message.includes("polyfill")?s:bl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class KS{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw bl(er.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=cL(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function aL(t){const e=new KS(t);return e.base64?GS(er.BASE64,e.rest):oL(e.rest)}function lL(t){return new KS(t).contentType}function cL(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os{constructor(e,n){let r=0,s="";Nw(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(Nw(this.data_)){const r=this.data_,s=rL(r,e,n);return s===null?null:new os(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new os(r,!0)}}static getBlob(...e){if(mv()){const n=e.map(r=>r instanceof os?r.data_:r);return new os(nL.apply(null,n))}else{const n=e.map(o=>fv(o)?iL(er.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new os(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WS(t){let e;try{e=JSON.parse(t)}catch{return null}return KM(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uL(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function dL(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function QS(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hL(t,e){return e}class zt{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||hL}}let yu=null;function fL(t){return!fv(t)||t.length<2?t:QS(t)}function YS(){if(yu)return yu;const t=[];t.push(new zt("bucket")),t.push(new zt("generation")),t.push(new zt("metageneration")),t.push(new zt("name","fullPath",!0));function e(i,o){return fL(o)}const n=new zt("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new zt("size");return s.xform=r,t.push(s),t.push(new zt("timeCreated")),t.push(new zt("updated")),t.push(new zt("md5Hash",null,!0)),t.push(new zt("cacheControl",null,!0)),t.push(new zt("contentDisposition",null,!0)),t.push(new zt("contentEncoding",null,!0)),t.push(new zt("contentLanguage",null,!0)),t.push(new zt("contentType",null,!0)),t.push(new zt("metadata","customMetadata",!0)),yu=t,yu}function mL(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new dn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function pL(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return mL(r,t),r}function JS(t,e,n){const r=WS(e);return r===null?null:pL(t,r,n)}function gL(t,e,n,r){const s=WS(e);if(s===null||!fv(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,m=t.fullPath,p="/b/"+o(h)+"/o/"+o(m),x=Wh(p,n,r),A=qS({alt:"media",token:d});return x+A})[0]}function yL(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class pv{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XS(t){if(!t)throw hv()}function vL(t,e){function n(r,s){const i=JS(t,s,e);return XS(i!==null),i}return n}function _L(t,e){function n(r,s){const i=JS(t,s,e);return XS(i!==null),gL(i,s,t.host,t._protocol)}return n}function ZS(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=PM():s=RM():n.getStatus()===402?s=kM(t.bucket):n.getStatus()===403?s=DM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function eA(t){const e=ZS(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=CM(t.path)),i.serverResponse=s.serverResponse,i}return n}function xL(t,e,n){const r=e.fullServerUrl(),s=Wh(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new pv(s,i,_L(t,n),o);return a.errorHandler=eA(e),a}function wL(t,e){const n=e.fullServerUrl(),r=Wh(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,d){}const a=new pv(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=eA(e),a}function EL(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function IL(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=EL(null,e)),r}function TL(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let w="";for(let P=0;P<2;P++)w=w+Math.random().toString().slice(2);return w}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const d=IL(e,r,s),h=yL(d,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,p=`\r
--`+c+"--",x=os.getBlob(m,r,p);if(x===null)throw FM();const A={name:d.fullPath},C=Wh(i,t.host,t._protocol),k="POST",_=t.maxUploadRetryTime,v=new pv(C,k,vL(t,n),_);return v.urlParams=A,v.headers=o,v.body=x.uploadData(),v.errorHandler=ZS(e),v}class bL{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=mi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=mi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=mi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw qa("cannot .send() more than once");if(ar(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw qa("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw qa("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw qa("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw qa("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class SL extends bL{initXhr(){this.xhr_.responseType="text"}}function gv(){return new SL}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ri{constructor(e,n){this._service=e,n instanceof dn?this._location=n:this._location=dn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ri(e,n)}get root(){const e=new dn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return QS(this._location.path)}get storage(){return this._service}get parent(){const e=uL(this._location.path);if(e===null)return null;const n=new dn(this._location.bucket,e);return new Ri(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw BM(e)}}function AL(t,e,n){t._throwIfRoot("uploadBytes");const r=TL(t.storage,t._location,YS(),new os(e,!0),n);return t.storage.makeRequestWithTokens(r,gv).then(s=>({metadata:s,ref:t}))}function NL(t){t._throwIfRoot("getDownloadURL");const e=xL(t.storage,t._location,YS());return t.storage.makeRequestWithTokens(e,gv).then(n=>{if(n===null)throw UM();return n})}function CL(t){t._throwIfRoot("deleteObject");const e=wL(t.storage,t._location);return t.storage.makeRequestWithTokens(e,gv)}function kL(t,e){const n=dL(t._location.path,e),r=new dn(t._location.bucket,n);return new Ri(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RL(t){return/^[A-Za-z]+:\/\//.test(t)}function PL(t,e){return new Ri(t,e)}function tA(t,e){if(t instanceof yv){const n=t;if(n._bucket==null)throw LM();const r=new Ri(n,n._bucket);return e!=null?tA(r,e):r}else return e!==void 0?kL(t,e):t}function DL(t,e){if(e&&RL(e)){if(t instanceof yv)return PL(t,e);throw Zp("To use ref(service, url), the first argument must be a Storage instance.")}else return tA(t,e)}function kw(t,e){const n=e==null?void 0:e[BS];return n==null?null:dn.makeFromBucketSpec(n,t)}function jL(t,e,n,r={}){t.host=`${e}:${n}`;const s=ar(e);s&&(vh(`https://${t.host}/b`),Yg("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Rk(i,t.app.options.projectId))}class yv{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=zS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=AM,this._maxUploadRetryTime=NM,this._requests=new Set,s!=null?this._bucket=dn.makeFromBucketSpec(s,this._host):this._bucket=kw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=dn.makeFromBucketSpec(this._url,e):this._bucket=kw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Cw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Cw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Qt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ri(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new $M($S());{const o=eL(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Rw="@firebase/storage",Pw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA="storage";function VL(t,e,n){return t=Ae(t),AL(t,e,n)}function OL(t){return t=Ae(t),NL(t)}function Dw(t){return t=Ae(t),CL(t)}function om(t,e){return t=Ae(t),DL(t,e)}function ML(t=Zg(),e){t=Ae(t);const r=mc(t,nA).getImmediate({identifier:e}),s=p1("storage");return s&&LL(r,...s),r}function LL(t,e,n,r={}){jL(t,e,n,r)}function FL(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new yv(n,r,s,e,ji)}function UL(){Cs(new br(nA,FL,"PUBLIC").setMultipleInstances(!0)),In(Rw,Pw,""),In(Rw,Pw,"esm2020")}UL();const rA={apiKey:"AIzaSyBqe7srBIViRiHmZlIQzMywDhiop5q7OXI",authDomain:"colegio-verdy.firebaseapp.com",projectId:"colegio-verdy",storageBucket:"colegio-verdy.firebasestorage.app",messagingSenderId:"602481785882",appId:"1:602481785882:web:0f873bf9968992e5af65a3"},jw=Object.entries(rA).filter(([,t])=>!t).map(([t])=>t),rl=jw.length?`Configurao Firebase incompleta. Defina: ${jw.join(", ")}.`:null;function zL(t){if(!t)return null;try{return Zx(t,{localCache:Oj({tabManager:Uj()})})}catch{return Zx(t,{localCache:Vj()})}}const Rr=rl?null:T1(rA),St=Rr?sM(Rr):null,Y=zL(Rr),sA=Rr?bM(Rr):null,Ha=Rr?ML(Rr):null,BL=["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],$L=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],qL={Administrativos:"bg-primary",Acadmicos:"bg-blue-500",Feriado:"bg-red-400",Recesso:"bg-amber-500"},HL=t=>qL[t]||"bg-slate-500",GL=t=>(t||"").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim(),vv=({embedded:t=!1})=>{const[e,n]=D.useState(new Date),[r,s]=D.useState(null),[i,o]=D.useState([]),[a,c]=D.useState(!0),[d,h]=D.useState(!1);D.useEffect(()=>{if(!Y)return c(!1),()=>{};const P=pt(Fe(Y,"events"),j=>{const L=j.docs.map(E=>{const y=E.data();return{id:E.id,title:y.titulo||"Sem ttulo",date:y.data||"",time:y.diaTodo?"Dia todo":y.horario||"",location:y.local||"Local no informado",type:y.tipo||"Administrativos",color:HL(y.tipo),description:GL(y.descricao||""),diaTodo:!!y.diaTodo}}).sort((E,y)=>{const b=`${E.date||""} ${E.time||""}`,N=`${y.date||""} ${y.time||""}`;return b.localeCompare(N)});o(L),c(!1)},()=>{o([]),c(!1)});return()=>P()},[]);const m=D.useMemo(()=>i.reduce((P,j)=>(j.date&&(P[j.date]||(P[j.date]=[]),P[j.date].push(j)),P),{}),[i]),p=r?m[r]||[]:[],x=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),A=new Date(e.getFullYear(),e.getMonth(),1).getDay(),C=()=>n(new Date(e.getFullYear(),e.getMonth()-1,1)),k=()=>n(new Date(e.getFullYear(),e.getMonth()+1,1)),_=P=>{s(P),h(!0)},v=()=>{const P=[],j=new Date().toISOString().split("T")[0];for(let L=0;L<A;L++)P.push(u.jsx("div",{className:"h-10 lg:h-24 bg-slate-50/50 rounded-xl border border-transparent"},`empty-${L}`));for(let L=1;L<=x;L++){const E=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(L).padStart(2,"0")}`,y=m[E]||[],b=E===j,N=r===E;P.push(u.jsxs("div",{onClick:()=>_(E),className:`relative h-12 lg:h-24 p-1 lg:p-2 rounded-xl border transition-all cursor-pointer flex flex-col items-center lg:items-start ${N?"border-primary ring-2 ring-primary/20 bg-primary/5":"border-slate-100 hover:border-primary/40 bg-white shadow-sm"}`,children:[u.jsx("span",{className:`text-[13px] lg:text-sm font-semibold w-7 h-7 flex items-center justify-center rounded-full ${b?"bg-primary text-white":"text-slate-700"}`,children:L}),u.jsx("div",{className:"flex lg:hidden gap-1 mt-1",children:y.slice(0,3).map(I=>u.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${I.color}`},I.id))}),u.jsxs("div",{className:"hidden lg:flex flex-col gap-1 mt-1 w-full overflow-hidden",children:[y.slice(0,2).map(I=>u.jsxs("div",{className:`text-[10px] text-white font-medium px-1.5 py-0.5 rounded truncate ${I.color}`,children:[I.diaTodo?"Dia todo":I.time," - ",I.title]},I.id)),y.length>2&&u.jsxs("div",{className:"text-[10px] text-slate-500 font-medium px-1",children:["+ ",y.length-2," mais"]})]})]},L))}return P},w=r?r.split("-").reverse().join("/"):"";return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`${t?"w-full":"max-w-7xl mx-auto h-full"}`,children:u.jsxs("div",{className:"flex flex-col bg-white rounded-2xl border border-slate-200 shadow-sm p-4 lg:p-6 h-fit shrink-0",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("h2",{className:"text-xl lg:text-2xl font-bold text-slate-800 flex items-center gap-3",children:[u.jsx(fp,{className:"text-primary hidden sm:block",size:24}),BL[e.getMonth()]," ",e.getFullYear()]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:C,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-600 transition-colors",children:u.jsx(i1,{size:20})}),u.jsx("button",{onClick:k,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-600 transition-colors",children:u.jsx(ph,{size:20})})]})]}),u.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2 lg:mb-4",children:$L.map(P=>u.jsx("div",{className:"text-center text-[11px] lg:text-xs font-bold text-slate-400 uppercase tracking-wider",children:P},P))}),u.jsx("div",{className:"grid grid-cols-7 gap-1 lg:gap-2",children:v()}),a&&u.jsx("div",{className:"text-sm text-slate-500 mt-3",children:"Carregando eventos..."})]})}),d&&u.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[u.jsx("button",{className:"absolute inset-0 bg-slate-900/45",onClick:()=>h(!1),"aria-label":"Fechar modal"}),u.jsxs("div",{className:"relative w-full sm:max-w-2xl max-h-[85vh] bg-white rounded-t-2xl sm:rounded-2xl border border-slate-200 shadow-xl p-4 sm:p-5 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("h3",{className:"text-lg font-bold text-slate-800",children:["Eventos de ",w]}),u.jsx("button",{onClick:()=>h(!1),className:"w-9 h-9 rounded-lg border border-slate-200 text-slate-500 hover:bg-slate-50 inline-flex items-center justify-center",children:u.jsx(Tr,{size:16})})]}),u.jsx("div",{className:"overflow-y-auto max-h-[68vh] flex flex-col gap-3 pr-1",children:p.length===0?u.jsx("div",{className:"text-sm text-slate-500 bg-slate-50 rounded-xl border border-slate-100 p-4",children:"Nenhum evento cadastrado para este dia."}):p.map(P=>u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-3 relative overflow-hidden",children:[u.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${P.color}`}),u.jsxs("div",{className:"pl-2",children:[u.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[u.jsx("h4",{className:"font-semibold text-slate-800",children:P.title}),u.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide text-white ${P.color}`,children:P.type})]}),P.description&&u.jsx("p",{className:"text-sm text-slate-500 mb-2",children:P.description}),u.jsxs("div",{className:"flex flex-col gap-1.5",children:[u.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-600",children:[u.jsx(Qg,{size:14,className:"text-slate-400"})," ",P.time||"Horrio no informado"]}),u.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-600",children:[u.jsx(mk,{size:14,className:"text-slate-400"})," ",P.location]})]})]})]},P.id))})]})]})]})},Vw=()=>u.jsx(vv,{}),Ow=({onOpenTurma:t,turmas:e=[],studentsStatus:n={},carregando:r=!1})=>u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("h2",{className:"text-2xl lg:text-3xl font-bold text-slate-800 mb-4",children:["Minhas Turmas ",e.length>0?`(${e.length})`:""]}),r?u.jsx("p",{className:"text-slate-500",children:"Carregando turmas..."}):e.length>0?u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(s=>{const i=Object.values(n).filter(c=>c.turmaId===s.id),o=i.length,a=i.filter(c=>c.status==="sent"||c.status==="absent").length;return u.jsxs("div",{onClick:()=>t(s),className:"p-4 rounded-lg border-2 border-slate-200 hover:border-primary/50 bg-white cursor-pointer transition-all hover:shadow-md",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"font-semibold text-slate-800",children:s.nome}),u.jsx(ph,{size:18,className:"text-slate-400"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-sm text-slate-600",children:s.periodo}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs",children:[u.jsx("span",{className:"text-slate-600",children:"Cadernetas preenchidas"}),u.jsxs("span",{className:"font-semibold text-primary",children:[a,"/",o]})]}),u.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:u.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${o>0?a/o*100:0}%`}})})]})]})]},s.id)})}):u.jsx("p",{className:"text-slate-500",children:"Nenhuma turma atribuda"})]}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-slate-800 mb-4",children:"Calendrio Escolar"}),u.jsx(vv,{embedded:!0})]})]}),KL=({turma:t,onBack:e,onOpenStudent:n,studentsStatus:r})=>{const[s,i]=D.useState(""),a=Object.values(r).filter(d=>d.turmaId===t.id).filter(d=>d.name.toLowerCase().includes(s.toLowerCase())),c=d=>{switch(d){case"sent":return{icon:ck,color:"text-primary",bg:"bg-primary/10",label:"Enviado"};case"draft":return{icon:Qg,color:"text-accent",bg:"bg-accent/10",label:"Pendente (Rascunho)"};case"absent":return{icon:xd,color:"text-red-500",bg:"bg-red-50",label:"Faltou"};default:return{icon:dk,color:"text-slate-300",bg:"bg-slate-50",label:"No iniciado"}}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto h-full",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-2 lg:mb-6 flex-wrap",children:[u.jsx("button",{onClick:e,className:"w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary hover:border-primary transition-all shadow-sm shrink-0",children:u.jsx(Wg,{size:20})}),u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800 truncate",children:"Dirio de Classe"}),u.jsxs("p",{className:"text-sm font-medium text-primary mt-1",children:[t.nome," (",t.periodo,")"]})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:u.jsx(_k,{size:18,className:"text-slate-400"})}),u.jsx("input",{type:"text",placeholder:"Buscar aluno na turma...",className:"form-control !pl-10 !py-3 bg-white shadow-sm border-transparent",value:s,onChange:d=>i(d.target.value)})]}),u.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden flex-1 flex flex-col",children:[u.jsxs("div",{className:"bg-slate-50 px-6 py-3 border-b border-slate-200 flex justify-between items-center text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[u.jsxs("span",{children:[a.length," Alunos"]}),u.jsx("span",{children:"Status de Envio"})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto divide-y divide-slate-100",children:[a.map(d=>{const h=c(d.status),m=h.icon;return u.jsxs("div",{onClick:()=>n(d.id),className:"flex items-center justify-between p-4 px-6 hover:bg-slate-50 cursor-pointer transition-colors group",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-200 shrink-0 relative",children:u.jsx("img",{src:d.avatar,alt:d.name,className:`w-full h-full rounded-full object-cover ${d.status==="absent"?"grayscale opacity-60":""}`})}),u.jsxs("div",{children:[u.jsx("h4",{className:`font-semibold text-[15px] ${d.status==="absent"?"text-slate-500 line-through":"text-slate-800"}`,children:d.name}),u.jsx("span",{className:"text-xs text-slate-400",children:"Ver dirio"})]})]}),u.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg ${h.bg}`,children:[u.jsx(m,{size:16,className:h.color}),u.jsx("span",{className:`text-xs font-semibold ${h.color}`,children:h.label})]})]},d.id)}),a.length===0&&u.jsxs("div",{className:"p-10 flex flex-col items-center justify-center text-slate-400 text-center",children:[u.jsx(xd,{size:48,className:"mb-4 text-slate-300"}),"Nenhum aluno encontrado correspondente  busca."]})]})]})]})},vu=({options:t,active:e,onChange:n})=>u.jsx("div",{className:"flex bg-slate-100/50 p-0.5 rounded-xl w-full",children:t.map(r=>u.jsx("button",{className:`segment-btn ${e===r?"active":""}`,onClick:()=>n(r),children:r},r))}),Mw={meals:{"Lanche Manh":null,Almoo:null,"Lanche Tarde":null,Jantar:null},rest:{"Sono Manh":null,"Sono Tarde":null},activities:{Manh:null,Tarde:null},evacuation:{Manh:null,Tarde:null},obs:""},WL=({student:t,turma:e,onBack:n,onUpdateStatus:r})=>{const[s,i]=D.useState(Mw),[o,a]=D.useState(!1),[c,d]=D.useState(!1),[h,m]=D.useState(!0),p=()=>new Date().toISOString().split("T")[0];D.useEffect(()=>{(async()=>{try{if(!Y||!t.id){m(!1);return}const _=p(),v=Lt(Fe(Y,"cadernetaEntries"),mt("studentId","==",t.id),mt("date","==",_)),w=await Gp(v);if(!w.empty){const P=w.docs[0].data();i(P.data||Mw),a(P.isAbsent||!1)}m(!1)}catch(_){console.error("Erro ao carregar caderneta:",_),m(!1)}})()},[t.id]);const x=(k,_,v)=>{if(o)return;const w={...s,[k]:{...s[k],[_]:v}};k==="obs"&&(w.obs=v),i(w),t.status!=="sent"&&r("draft")},A=()=>{o?(a(!1),r("pending")):(a(!0),r("absent"))},C=async()=>{try{if(d(!0),!Y){mu.error("Erro de conexo. Tente novamente."),d(!1);return}const k=p(),_={studentId:t.id,studentName:t.name,turmaId:e.id,turmaName:e.nome,date:k,data:s,isAbsent:o,status:o?"absent":"sent",createdAt:Me(),updatedAt:Me()},v=Lt(Fe(Y,"cadernetaEntries"),mt("studentId","==",t.id),mt("date","==",k)),w=await Gp(v);if(w.empty)await Bh(Fe(Y,"cadernetaEntries"),_);else{const P=w.docs[0].id;await Bd(tt(Y,"cadernetaEntries",P),{..._,createdAt:w.docs[0].data().createdAt})}o?mu.success(`Falta de ${t.name} registrada!`):mu.success(`Caderneta de ${t.name} enviada!`),r(o?"absent":"sent"),d(!1),n()}catch(k){console.error("Erro ao salvar caderneta:",k),mu.error("Erro ao salvar. Tente novamente."),d(!1)}};return u.jsxs("div",{className:"flex flex-col gap-0 max-w-4xl mx-auto",children:[u.jsxs("div",{className:`flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-2 lg:mb-6 glass-panel !p-4 transition-colors ${o?"bg-red-50/80 border-red-200":""}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary transition-colors bg-white",children:u.jsx(Wg,{size:20})}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-12 h-12 rounded-full p-0.5 bg-slate-200",children:u.jsx("img",{src:t.avatar,alt:"Avatar",className:`w-full h-full rounded-full object-cover ${o?"grayscale":""}`})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-widest",children:e==null?void 0:e.nome}),u.jsx("div",{className:`font-bold text-lg ${o?"text-red-700 line-through":"text-slate-800"}`,children:t.name})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:A,className:`px-4 py-2.5 rounded-xl font-semibold text-sm transition-all flex items-center gap-1.5 ${o?"bg-red-500 text-white shadow-md":"bg-red-50 text-red-500 hover:bg-red-100"}`,children:[u.jsx(xd,{size:18})," ",o?"Marcado como Falta":"Indicar Falta"]}),u.jsxs("button",{className:`btn-primary px-5 py-2.5 ${c?"opacity-50 pointer-events-none":""}`,onClick:C,disabled:c,children:[u.jsx(xk,{size:18})," ",o?"Confirmar Falta":"Enviar"]})]})]}),u.jsxs("div",{className:`grid grid-cols-1 lg:grid-cols-2 gap-6 transition-opacity duration-300 ${o?"opacity-30 pointer-events-none":"opacity-100"}`,children:[u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(o1,{className:"text-primary",size:20})," Refeies"]}),u.jsx("div",{className:"flex flex-col gap-3",children:Object.keys(s.meals).map(k=>u.jsxs("div",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:k}),u.jsx("div",{className:"w-full lg:w-[320px]",children:u.jsx(vu,{options:["Total","Suficiente","Insuficiente","Recusou"],active:s.meals[k],onChange:_=>x("meals",k,_)})})]},k))})]}),u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(l1,{className:"text-primary",size:20})," Descanso"]}),u.jsx("div",{className:"flex flex-col gap-3",children:Object.keys(s.rest).map(k=>u.jsxs("div",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:k}),u.jsx("div",{className:"w-full lg:w-[180px]",children:u.jsx(vu,{options:["Sim","No"],active:s.rest[k],onChange:_=>x("rest",k,_)})})]},k))})]}),u.jsxs("div",{className:"glass-panel lg:col-span-full flex flex-col lg:flex-row gap-8 lg:gap-12",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(r1,{className:"text-primary",size:20})," Atividades"]}),u.jsx("div",{className:"flex flex-col gap-3",children:["Manh","Tarde"].map(k=>u.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:k}),u.jsx(vu,{options:["Ativa","Parcial","Sem Participao"],active:s.activities[k],onChange:_=>x("activities",k,_)})]},k))})]}),u.jsx("div",{className:"hidden lg:block w-px bg-slate-200"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(s1,{className:"text-primary",size:20})," Evacuao"]}),u.jsx("div",{className:"flex flex-col gap-3",children:["Manh","Tarde"].map(k=>u.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:k}),u.jsx(vu,{options:["Normal","Alterado","No houve"],active:s.evacuation[k],onChange:_=>x("evacuation",k,_)})]},k))})]})]}),u.jsxs("div",{className:"glass-panel lg:col-span-full",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(mp,{className:"text-primary",size:20})," Observaes e Recados"]}),u.jsx("textarea",{className:"form-control min-h-[120px] resize-none",placeholder:`Escreva notas importantes sobre o dia de ${t==null?void 0:t.name.split(" ")[0]}...`,value:s.obs,onChange:k=>x("obs",null,k.target.value)})]})]})]})},Lw=[{id:"1",type:"broadcast",name:"Comunicados Gerais",role:"Escola",lastMessage:"Lembrando que amanh no haver aula na educao infantil.",time:"14:30",unread:0},{id:"2",type:"direct",name:"Me do Joo Pedro",role:"Famlia",lastMessage:"Ele est melhor da gripe, amanh ir.",time:"10:15",unread:2},{id:"3",type:"direct",name:"Pai do Lucas T.",role:"Famlia",lastMessage:"Hoje a av vai buscar o Lucas s 17h, ok?",time:"Ontem",unread:0},{id:"4",type:"direct",name:"Me da Maria Clara",role:"Famlia",lastMessage:"Obrigada pelo cuidado de sempre!",time:"Segunda",unread:0}],Fw=()=>{const[t,e]=D.useState(Lw[1]),[n,r]=D.useState("all"),[s,i]=D.useState("");return Lw.filter(o=>n==="all"?!0:o.type===n),u.jsx("div",{className:"flex h-[calc(100vh-140px)] lg:h-[calc(100vh-160px)] gap-0 lg:gap-6 antialiased -mx-4 lg:mx-0",children:u.jsx("div",{className:"w-full flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:u.jsx(a1,{size:32,className:"text-slate-400"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Mensagens"}),u.jsx("p",{className:"text-slate-500",children:"Esta funcionalidade est em desenvolvimento."}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Em breve voc poder se comunicar diretamente com pais, professore e direo."})]})})})},iA=D.createContext(),Qh=()=>D.useContext(iA),Uw=new Set(["teacher","parent","admin"]),Yi=t=>((t||"").split("@")[0]||"Usuario").replace(/[._-]+/g," ").trim()||"Usuario",QL=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t||""),YL=t=>(t||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim().replace(/\s+/g,".").replace(/[^a-z0-9.]/g,""),JL=t=>`${t}@usuario.verdy.app`,am=t=>/@usuario\.verdy\.app$/i.test(t||""),_u=t=>`https://ui-avatars.com/api/?name=${encodeURIComponent(t||"Usuario")}&background=e2e8f0&color=0f172a`,XL=({children:t})=>{const[e,n]=D.useState(null),[r,s]=D.useState(null),[i,o]=D.useState(null),[a,c]=D.useState(!0);D.useEffect(()=>St?H4(St,async A=>{if(A)try{const C=tt(Y,"users",A.uid),k=await tm(C);if(k.exists()){const _=k.data(),v=_.role,w=typeof _.email=="string"&&_.email.trim()?_.email.trim():null,P=A.email||null,j=w||(am(P||"")?null:P),L=_.nome||Yi(j||P||""),E={uid:A.uid,email:j,authEmail:P,username:_.username||"",role:Uw.has(v)?v:"parent",nome:L,telefone:_.telefone||"",disciplina:_.disciplina||"",avatarUrl:_.avatarUrl||_u(L)};_.avatarUrl||await Bd(C,{avatarUrl:E.avatarUrl,updatedAt:Me()},{merge:!0}),o(E),s(Uw.has(v)?v:"parent")}else{const _=A.email||null,v=am(_||"")?null:_,w=Yi(v||_||""),P={uid:A.uid,email:v,authEmail:_,username:"",role:"parent",nome:w,telefone:"",disciplina:"",avatarUrl:_u(w)};await Bd(C,{...P,createdAt:Me(),updatedAt:Me()}),o(P),s("parent")}}catch(C){console.log("Erro ao buscar role, backend no configurado ok. "+C),o({uid:A.uid,email:am(A.email||"")?null:A.email||null,authEmail:A.email||null,username:"",role:"parent",nome:Yi(A.email||""),telefone:"",disciplina:"",avatarUrl:_u(Yi(A.email||""))}),s("parent")}else o(null),s(null);n(A),c(!1)}):(c(!1),()=>{}),[]);const p={currentUser:e,userRole:r,userProfile:i,login:async(x,A)=>{if(!St)return Promise.reject({code:"auth/configuration-not-found",message:rl});let C=x;if(!x.includes("@")){const k=await tm(tt(Y,"usernames",x.toLowerCase().trim()));if(!k.exists())throw{code:"auth/user-not-found",message:"Usurio no encontrado."};C=k.data().email}return U4(St,C,A)},register:async(x,A)=>{if(!St)return Promise.reject({code:"auth/configuration-not-found",message:rl});if(!Y)return Promise.reject({code:"auth/configuration-not-found",message:rl});const C=typeof x=="object"&&x!==null?x:{nome:Yi(x||""),telefone:"",username:(x||"").split("@")[0]||"",email:x||"",password:A||""},k=typeof C.nome=="string"?C.nome.trim():"",_=typeof C.telefone=="string"?C.telefone.trim():"",v=YL(C.username),w=typeof C.email=="string"?C.email.trim().toLowerCase():"",P=typeof C.password=="string"?C.password:"";if(!k)throw{code:"auth/invalid-display-name",message:"Nome completo  obrigatrio."};if(!v||v.length<3)throw{code:"auth/invalid-username",message:"Usurio invlido. Use ao menos 3 caracteres."};if(!P||P.length<6)throw{code:"auth/weak-password",message:"A senha deve ter pelo menos 6 caracteres."};if(w&&!QL(w))throw{code:"auth/invalid-email",message:"E-mail invlido."};const j=(w||JL(v)).toLowerCase(),L=tt(Y,"usernames",v);if((await tm(L)).exists())throw{code:"auth/username-already-in-use",message:"Este usurio j est em uso."};const y=await F4(St,j,P),b=k||Yi(w||j);try{await Gj(Y,async N=>{if((await N.get(L)).exists())throw new Error("USERNAME_IN_USE");N.set(tt(Y,"users",y.user.uid),{uid:y.user.uid,email:w||null,authEmail:j,username:v,role:"parent",nome:b,telefone:_,avatarUrl:_u(b),createdAt:Me(),updatedAt:Me()}),N.set(L,{email:j,uid:y.user.uid})})}catch(N){if((N==null?void 0:N.message)==="USERNAME_IN_USE"){try{await K4(y.user)}catch(I){console.error("Falha ao remover usurio aps conflito de username:",I)}throw{code:"auth/username-already-in-use",message:"Este usurio j est em uso."}}throw N}return y},logout:()=>St?G4(St):Promise.resolve(),authError:rl};return u.jsx(iA.Provider,{value:p,children:!a&&t})},ZL=()=>{const[t,e]=D.useState(!0),[n,r]=D.useState(""),[s,i]=D.useState(""),[o,a]=D.useState(""),[c,d]=D.useState(""),[h,m]=D.useState(""),[p,x]=D.useState(""),[A,C]=D.useState(""),[k,_]=D.useState(""),[v,w]=D.useState(!1),{login:P,register:j,authError:L}=Qh(),E=async y=>{y.preventDefault();try{if(_(""),w(!0),t)await P(n,s);else{if(s!==o){_("A confirmao da senha no confere.");return}await j({nome:c,telefone:h,username:p,email:A,password:s})}}catch(b){console.error(b),b.code==="auth/user-not-found"||b.code==="auth/invalid-credential"?_("Usurio ou senha invlidos. Verifique seus dados de acesso."):b.code==="auth/email-already-in-use"?_("Este e-mail j est cadastrado no sistema."):b.code==="auth/weak-password"?_("A senha deve ter pelo menos 6 caracteres."):b.code==="auth/invalid-email"?_("Informe um e-mail vlido ou deixe o campo em branco."):b.code==="auth/invalid-username"?_("Usurio invlido. Use ao menos 3 caracteres (letras, nmeros e ponto)."):b.code==="auth/username-already-in-use"?_("Este nome de usurio j est em uso."):b.code==="auth/invalid-display-name"?_("Informe o nome completo."):b.code==="auth/configuration-not-found"?_(b.message||"Firebase no configurado para autenticao."):_("Ocorreu um erro ao comunicar com o servidor!")}finally{w(!1)}};return u.jsx("div",{className:"min-h-screen bg-slate-50 flex flex-col justify-center items-center p-4",children:u.jsxs("div",{className:"w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("img",{src:"/pwa-192x192.png",alt:"Colgio Verdy",className:"w-20 h-20 mx-auto rounded-2xl shadow-lg mb-4 object-cover"}),u.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Colgio Verdy"}),u.jsx("p",{className:"text-slate-500 mt-2",children:t?"Acesse o portal da escola":"Crie seu acesso inicial"})]}),u.jsxs("div",{className:"bg-white rounded-3xl p-8 border border-slate-200 shadow-xl shadow-slate-200/50",children:[L&&u.jsxs("div",{className:"bg-amber-50 text-amber-700 p-4 rounded-xl mb-6 flex items-start gap-3 text-sm",children:[u.jsx(x0,{className:"shrink-0 mt-0.5",size:18}),u.jsx("span",{children:L})]}),k&&u.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-xl mb-6 flex items-start gap-3 text-sm",children:[u.jsx(x0,{className:"shrink-0 mt-0.5",size:18}),u.jsx("span",{children:k})]}),u.jsxs("form",{onSubmit:E,className:"flex flex-col gap-5",children:[t?u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Usurio ou E-mail"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:n,onChange:y=>r(y.target.value),placeholder:"Seu usurio de acesso",className:"w-full form-control !pl-10 !py-3",required:!0,autoComplete:"username"}),u.jsx(Zr,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Senha"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"password",value:s,onChange:y=>i(y.target.value),placeholder:"",className:"w-full form-control !pl-10 !py-3",required:!0,minLength:6,autoComplete:"current-password"}),u.jsx(Uf,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Nome Completo"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:c,onChange:y=>d(y.target.value),placeholder:"Seu nome completo",className:"w-full form-control !pl-10 !py-3",required:!0,autoComplete:"name"}),u.jsx(Zr,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Telefone"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"tel",value:h,onChange:y=>m(y.target.value),placeholder:"(00) 00000-0000",className:"w-full form-control !pl-10 !py-3",required:!0,autoComplete:"tel"}),u.jsx(vk,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Usurio"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"text",value:p,onChange:y=>x(y.target.value),placeholder:"seu.usuario",className:"w-full form-control !pl-10 !py-3",required:!0,autoComplete:"username"}),u.jsx(Zr,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"E-mail (opcional)"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"email",value:A,onChange:y=>C(y.target.value),placeholder:"seu@email.com",className:"w-full form-control !pl-10 !py-3",autoComplete:"email"}),u.jsx(fk,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Senha"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"password",value:s,onChange:y=>i(y.target.value),placeholder:"",className:"w-full form-control !pl-10 !py-3",required:!0,minLength:6,autoComplete:"new-password"}),u.jsx(Uf,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Confirmao de Senha"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"password",value:o,onChange:y=>a(y.target.value),placeholder:"",className:"w-full form-control !pl-10 !py-3",required:!0,minLength:6,autoComplete:"new-password"}),u.jsx(Uf,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]})]}),u.jsxs("button",{type:"submit",disabled:v,className:`btn-primary w-full justify-center !py-3.5 mt-2 text-base ${v?"opacity-70 cursor-not-allowed":""}`,children:[v?"Processando...":t?"Entrar no Sistema":"Criar Cadastro",t?u.jsx(hk,{size:20}):u.jsx(Ek,{size:20})]})]}),u.jsx("div",{className:"mt-8 text-center text-sm text-slate-500 border-t border-slate-100 pt-6",children:u.jsxs("p",{children:[t?"Primeiro acesso? ":"J possui uma conta? ",u.jsx("button",{onClick:()=>{e(!t),_(""),i(""),a("")},className:"font-bold text-primary hover:text-primary-dark transition-colors",type:"button",children:t?"Cadastre-se aqui":"Faa Login"})]})})]})]})})},e3=({value:t})=>t?u.jsx("span",{className:"text-xs font-semibold px-2.5 py-1 rounded-full bg-primary/10 text-primary border border-primary/20",children:t}):u.jsx("span",{className:"text-xs text-slate-400 italic",children:""}),lm=({icon:t,title:e,children:n})=>u.jsxs("div",{className:"glass-panel flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(t,{className:"text-primary",size:20})," ",e]}),n]}),xu=({label:t,value:e})=>u.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[u.jsx("span",{className:"text-sm font-medium text-slate-600",children:t}),u.jsx(e3,{value:e})]}),zw=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(Number);return new Date(e,n-1,r).toLocaleDateString("pt-BR",{weekday:"long",day:"2-digit",month:"2-digit",year:"numeric"})},Bw=t=>t===new Date().toISOString().split("T")[0],t3=({student:t,turmaNome:e,onBack:n})=>{var A,C;const[r,s]=D.useState([]),[i,o]=D.useState(0),[a,c]=D.useState(!0);D.useEffect(()=>{if(!Y||!(t!=null&&t.id)){c(!1);return}(async()=>{try{const _=(await Gp(Lt(Fe(Y,"cadernetaEntries"),mt("studentId","==",t.id),Hb("date","desc")))).docs.map(w=>({id:w.id,...w.data()}));s(_);const v=_.findIndex(w=>Bw(w.date));o(v>=0?v:0)}catch{s([])}finally{c(!1)}})()},[t==null?void 0:t.id]);const d=r[i]??null,h=(d==null?void 0:d.data)??null,m=(d==null?void 0:d.isAbsent)??!1,p=i<r.length-1,x=i>0;return u.jsxs("div",{className:"flex flex-col gap-4 max-w-4xl mx-auto p-4 lg:p-8",children:[u.jsxs("div",{className:"glass-panel !p-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary transition-colors bg-white shrink-0",children:u.jsx(Wg,{size:20})}),u.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-200 overflow-hidden shrink-0 flex items-center justify-center",children:t.fotoUrl?u.jsx("img",{src:t.fotoUrl,alt:t.nome,className:"w-full h-full object-cover"}):u.jsx("span",{className:"text-lg font-bold text-slate-400",children:(C=(A=t.nome)==null?void 0:A.charAt(0))==null?void 0:C.toUpperCase()})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-widest",children:e}),u.jsx("div",{className:"font-bold text-lg text-slate-800",children:t.nome})]})]}),!a&&u.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-xl px-3 py-2",children:[u.jsx("button",{onClick:()=>o(k=>k+1),disabled:!p,className:"w-8 h-8 rounded-lg flex items-center justify-center text-slate-500 hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":"Data anterior",children:u.jsx(i1,{size:18})}),u.jsx("span",{className:"text-sm font-semibold text-slate-700 min-w-[160px] text-center",children:d?Bw(d.date)?"Hoje  "+zw(d.date):zw(d.date):"Nenhuma entrada"}),u.jsx("button",{onClick:()=>o(k=>k-1),disabled:!x,className:"w-8 h-8 rounded-lg flex items-center justify-center text-slate-500 hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":"Prxima data",children:u.jsx(ph,{size:18})})]})]}),a&&u.jsx("div",{className:"flex flex-col gap-4",children:[1,2,3].map(k=>u.jsx("div",{className:"glass-panel animate-pulse h-24"},k))}),!a&&r.length===0&&u.jsxs("div",{className:"glass-panel p-10 text-center",children:[u.jsx(mp,{size:36,className:"mx-auto text-slate-300 mb-3"}),u.jsx("p",{className:"font-semibold text-slate-600",children:"Nenhuma caderneta registrada"}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"As cadernetas aparecero aqui aps serem enviadas pela escola."})]}),!a&&d&&m&&u.jsxs("div",{className:"glass-panel bg-red-50/80 border-red-200 flex items-center gap-4 p-6",children:[u.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 border border-red-200 flex items-center justify-center",children:u.jsx(xd,{size:24,className:"text-red-500"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-bold text-red-700",children:"Falta registrada"}),u.jsxs("p",{className:"text-sm text-red-500 mt-0.5",children:[t.nome," no compareceu neste dia."]})]})]}),!a&&d&&!m&&h&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[u.jsx(lm,{icon:o1,title:"Refeies",children:Object.entries(h.meals??{}).map(([k,_])=>u.jsx(xu,{label:k,value:_},k))}),u.jsx(lm,{icon:l1,title:"Descanso",children:Object.entries(h.rest??{}).map(([k,_])=>u.jsx(xu,{label:k,value:_},k))}),u.jsxs("div",{className:"glass-panel lg:col-span-full flex flex-col lg:flex-row gap-8 lg:gap-12",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(r1,{className:"text-primary",size:20})," Atividades"]}),["Manh","Tarde"].map(k=>{var _;return u.jsx(xu,{label:k,value:(_=h.activities)==null?void 0:_[k]},k)})]}),u.jsx("div",{className:"hidden lg:block w-px bg-slate-200"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(s1,{className:"text-primary",size:20})," Evacuao"]}),["Manh","Tarde"].map(k=>{var _;return u.jsx(xu,{label:k,value:(_=h.evacuation)==null?void 0:_[k]},k)})]})]}),u.jsx(lm,{icon:mp,title:"Observaes e Recados",className:"flex-1",children:h.obs?u.jsx("p",{className:"text-sm text-slate-600 whitespace-pre-wrap leading-relaxed",children:h.obs}):u.jsx("p",{className:"text-sm text-slate-400 italic",children:"Nenhuma observao registrada."})})]})]})},$w={sent:{label:"Enviada hoje",className:"bg-emerald-50 text-emerald-700 border-emerald-200"},absent:{label:"Falta registrada",className:"bg-red-50 text-red-600 border-red-200"},pending:{label:"Aguardando",className:"bg-slate-50 text-slate-500 border-slate-200"}},n3=({student:t,turmaNome:e,cadernetaStatus:n,onClick:r})=>{var i,o;const s=$w[n]??$w.pending;return u.jsxs("button",{onClick:r,className:"w-full bg-white rounded-2xl border border-slate-200 shadow-sm p-4 flex items-center gap-4 hover:border-primary/40 hover:shadow-md transition-all text-left",children:[u.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 border border-slate-200 overflow-hidden shrink-0 flex items-center justify-center",children:t.fotoUrl?u.jsx("img",{src:t.fotoUrl,alt:t.nome,className:"w-full h-full object-cover"}):u.jsx("span",{className:"text-lg font-bold text-slate-400",children:(o=(i=t.nome)==null?void 0:i.charAt(0))==null?void 0:o.toUpperCase()})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-semibold text-slate-800 truncate",children:t.nome}),u.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:e||"Turma no informada"})]}),u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[u.jsx("span",{className:`text-xs font-semibold px-2.5 py-1 rounded-full border ${s.className}`,children:s.label}),u.jsx(ph,{size:16,className:"text-slate-400"})]})]})},r3=()=>{var A;const{currentUser:t,userProfile:e}=Qh(),[n,r]=D.useState([]),[s,i]=D.useState({}),[o,a]=D.useState({}),[c,d]=D.useState(!0),[h,m]=D.useState(null),p=t==null?void 0:t.uid;D.useEffect(()=>{if(!Y||!p){d(!1);return}const C=Lt(Fe(Y,"students"),mt("responsaveisIds","array-contains",p));return pt(C,_=>{const v=_.docs.map(w=>({id:w.id,...w.data()})).filter(w=>w.status==="ativo");r(v),d(!1)},()=>d(!1))},[p]),D.useEffect(()=>{if(!Y||n.length===0){i({});return}const C=[...new Set(n.map(v=>v.turmaId).filter(Boolean))];if(C.length===0)return;const k=Lt(Fe(Y,"classrooms"),mt("__name__","in",C));return pt(k,v=>{const w={};v.docs.forEach(P=>{w[P.id]=P.data().nome||"Turma"}),i(w)},()=>{})},[n]),D.useEffect(()=>{if(!Y||n.length===0){a({});return}const C=new Date().toISOString().split("T")[0],k=n.map(w=>w.id),_=[];for(let w=0;w<k.length;w+=30)_.push(k.slice(w,w+30));const v=_.map(w=>{const P=Lt(Fe(Y,"cadernetaEntries"),mt("studentId","in",w),mt("date","==",C));return pt(P,j=>{a(L=>{const E={...L};return j.docs.forEach(y=>{const b=y.data();E[b.studentId]=b.status||"pending"}),E})},()=>{})});return()=>v.forEach(w=>w())},[n]);const x=((A=e==null?void 0:e.nome)==null?void 0:A.split(" ")[0])||"Responsvel";return h?u.jsx(t3,{student:h,turmaNome:s[h.turmaId],onBack:()=>m(null)}):u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto p-4 lg:p-8",children:[u.jsx("div",{children:u.jsxs("h1",{className:"text-2xl font-bold text-slate-800",children:["Ol, ",x,"!"]})}),u.jsxs("section",{children:[u.jsx("div",{className:"flex items-center gap-2 mb-3",children:u.jsx("h2",{className:"text-base font-semibold text-slate-700",children:"Calendrio Escolar"})}),u.jsx(vv,{embedded:!0})]}),u.jsxs("section",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[u.jsx(fl,{size:18,className:"text-primary"}),u.jsx("h2",{className:"text-base font-semibold text-slate-700",children:"Meus Filhos"})]}),c?u.jsx("div",{className:"flex flex-col gap-3",children:[1,2].map(C=>u.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-4 flex items-center gap-4 animate-pulse",children:[u.jsx("div",{className:"w-14 h-14 rounded-2xl bg-slate-100"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-4 bg-slate-100 rounded w-1/3"}),u.jsx("div",{className:"h-3 bg-slate-100 rounded w-1/4"})]})]},C))}):n.length===0?u.jsxs("div",{className:"bg-white rounded-2xl border border-dashed border-slate-200 p-8 text-center",children:[u.jsx(Qg,{size:36,className:"mx-auto text-slate-300 mb-3"}),u.jsx("p",{className:"font-semibold text-slate-600",children:"Nenhum aluno vinculado"}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Entre em contato com a escola para vincular seu filho  sua conta."})]}):u.jsx("div",{className:"flex flex-col gap-3",children:n.map(C=>u.jsx(n3,{student:C,turmaNome:s[C.turmaId],cadernetaStatus:o[C.id]||"pending",onClick:()=>m(C)},C.id))})]})]})};function s3(){const[t,e]=D.useState(null),[n,r]=D.useState(null),[s,i]=D.useState([]),[o,a]=D.useState(!0);D.useEffect(()=>{if(!Y)return()=>{};const h=[];return h.push(pt(Fe(Y,"students"),m=>{e(m.size)},()=>{e(0)})),h.push(pt(Lt(Fe(Y,"classrooms"),mt("status","==","ativa")),m=>{r(m.size)},()=>{r(0)})),h.push(pt(Lt(Fe(Y,"events"),mt("data",">=",new Date().toISOString().split("T")[0]),Hb("data","asc"),Rj(5)),m=>{const p=m.docs.map(x=>{const A=x.data();return{id:x.id,titulo:A.titulo||"Sem ttulo",tipo:A.tipo||"Administrativos",data:A.data||"",local:A.local||"",diaTodo:!!A.diaTodo,horario:A.horario||"",anexoUrl:A.anexoUrl||"",anexoNome:A.anexoNome||""}});i(p),a(!1)},()=>{i([]),a(!1)})),()=>h.forEach(m=>m())},[]);const c=h=>{if(!h)return{dia:"--",mes:"---"};const[m,p,x]=h.split("-");if(!m||!p||!x)return{dia:"--",mes:"---"};const A=new Date(Number(m),Number(p)-1,Number(x));return{dia:String(A.getDate()).padStart(2,"0"),mes:A.toLocaleDateString("pt-BR",{month:"short"}).replace(".","").toUpperCase()}},d=D.useMemo(()=>[{id:"i1",label:"Total de Alunos",valor:t,icon:$l,color:"text-primary bg-primary/10"},{id:"i2",label:"Turmas Ativas",valor:n,icon:c1,color:"text-primary bg-primary/10"},{id:"i3",label:"Calendrio",valor:s.length,icon:hp,color:"text-primary bg-primary/10"},{id:"i4",label:"Comunicados",valor:"-",icon:gk,color:"text-primary bg-primary/10"}],[t,n,s.length]);return u.jsxs("div",{className:"flex flex-col gap-6 max-w-6xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Dashboard da Administrao"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Viso consolidada da operao escolar."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:d.map(h=>u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60 flex items-center gap-3",children:[u.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center ${h.color}`,children:u.jsx(h.icon,{size:20})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wide",children:h.label}),u.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.valor??""})]})]},h.id))}),u.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(hp,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Prximos eventos"})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[o&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando eventos..."}),!o&&s.map(h=>{const m=c(h.data);return u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/80 p-3 flex items-center gap-3",children:[u.jsxs("div",{className:"w-14 h-14 rounded-lg bg-slate-100 border border-slate-200 flex flex-col items-center justify-center",children:[u.jsx("span",{className:"text-base font-bold text-slate-800 leading-none",children:m.dia}),u.jsx("span",{className:"text-[10px] font-semibold text-slate-500",children:m.mes})]}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"font-semibold text-slate-800 truncate",children:h.titulo}),u.jsx("div",{className:"text-sm text-slate-500",children:h.diaTodo?"Dia todo":h.horario}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:h.tipo}),h.local&&u.jsx("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:h.local}),h.anexoUrl&&u.jsx("a",{href:h.anexoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-primary hover:underline mt-0.5 inline-block truncate",children:h.anexoNome||"Ver anexo"})]})]},h.id)}),!o&&s.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhum evento cadastrado."})]})]}),u.jsx("div",{className:"glass-panel p-5 border border-slate-200/60",children:u.jsx("div",{className:"flex flex-col gap-3",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:u.jsx(a1,{size:32,className:"text-slate-400"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Mensagens"}),u.jsx("p",{className:"text-slate-500",children:"Esta funcionalidade est em desenvolvimento."}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Em breve voc poder se comunicar diretamente com pais, professore e direo."})]})})})]})]})}const i3=["Administrativos","Acadmicos","Feriado","Recesso"],cm=5,um={titulo:"",tipo:"Administrativos",data:"",local:"",descricao:"",diaTodo:!1,horario:"",anexoUrl:"",anexoNome:"",anexoMimeType:"",anexoPath:""};function o3(){const[t,e]=D.useState([]),[n,r]=D.useState(!0),[s,i]=D.useState(!1),[o,a]=D.useState(null),[c,d]=D.useState(um),[h,m]=D.useState(!1),[p,x]=D.useState(null),[A,C]=D.useState(1),k=D.useRef(null);D.useEffect(()=>{if(!Y)return()=>{};const I=pt(Fe(Y,"events"),R=>{const S=R.docs.map(ie=>{const le=ie.data();return{id:ie.id,titulo:le.titulo||"Sem ttulo",tipo:le.tipo||"Administrativos",data:le.data||"",local:le.local||"",descricao:le.descricao||"",diaTodo:!!le.diaTodo,horario:le.horario||"",anexoUrl:le.anexoUrl||"",anexoNome:le.anexoNome||"",anexoMimeType:le.anexoMimeType||"",anexoPath:le.anexoPath||""}}).sort((ie,le)=>{const W=`${ie.data||""} ${ie.horario||""}`;return`${le.data||""} ${le.horario||""}`.localeCompare(W)});e(S),r(!1)},()=>{e([]),r(!1)});return()=>I()},[]);const _=I=>{if(!I)return{dia:"--",mes:"---"};const[R,S,ie]=I.split("-");if(!R||!S||!ie)return{dia:"--",mes:"---"};const le=new Date(Number(R),Number(S)-1,Number(ie));return{dia:String(le.getDate()).padStart(2,"0"),mes:le.toLocaleDateString("pt-BR",{month:"short"}).replace(".","").toUpperCase()}},v=()=>{a(null),d(um),x(null),i(!0)},w=I=>{a(I.id),d({titulo:I.titulo||"",tipo:I.tipo||"Administrativos",data:I.data||"",local:I.local||"",descricao:I.descricao||"",diaTodo:!!I.diaTodo,horario:I.horario||"",anexoUrl:I.anexoUrl||"",anexoNome:I.anexoNome||"",anexoMimeType:I.anexoMimeType||"",anexoPath:I.anexoPath||""}),x(null),i(!0)},P=()=>{a(null),d(um),x(null),i(!1)};D.useEffect(()=>{!s||!k.current||(k.current.innerHTML=c.descricao||"")},[s,o]);const j=I=>{document.execCommand(I,!1),k.current&&d(R=>({...R,descricao:k.current.innerHTML}))},L=D.useMemo(()=>Math.max(1,Math.ceil(t.length/cm)),[t.length]),E=Math.min(A,L),y=D.useMemo(()=>t.slice((E-1)*cm,E*cm),[t,E]),b=async I=>{I.preventDefault();const R=c.titulo.trim(),S=c.tipo,ie=c.data,le=c.local.trim(),W=(c.descricao||"").trim(),we=!!c.diaTodo,$=c.horario;if(!(!R||!S||!ie||!we&&!$||!Y))try{m(!0);let F=c.anexoUrl||"",K=c.anexoNome||"",J=c.anexoMimeType||"",Q=c.anexoPath||"";if(p&&Ha){const ue=p.name.replace(/\s+/g,"_"),Ne=`events/${Date.now()}-${ue}`,_e=om(Ha,Ne);if(await VL(_e,p),F=await OL(_e),K=p.name,J=p.type||"",c.anexoPath)try{await Dw(om(Ha,c.anexoPath))}catch{}Q=Ne}const me={titulo:R,tipo:S,data:ie,local:le,descricao:W,diaTodo:we,horario:we?"":$,anexoUrl:F,anexoNome:K,anexoMimeType:J,anexoPath:Q,updatedAt:Me()};o?await un(tt(Y,"events",o),me):await Bh(Fe(Y,"events"),{...me,createdAt:Me()}),C(1),P()}finally{m(!1)}},N=async I=>{if(!Y)return;const R=t.find(S=>S.id===I);if(await Kj(tt(Y,"events",I)),R!=null&&R.anexoPath&&Ha)try{await Dw(om(Ha,R.anexoPath))}catch{}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-6xl mx-auto",children:[u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Calendrio Escolar"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Gerencie os eventos e compromissos da escola."})]}),u.jsxs("button",{onClick:s?P:v,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center gap-1",children:[s?u.jsx(Tr,{size:14}):u.jsx(dc,{size:14}),s?"Cancelar":"Novo evento"]})]}),s&&u.jsxs("form",{onSubmit:b,className:"rounded-xl border border-slate-200 p-3 bg-white/80 grid grid-cols-1 md:grid-cols-6 gap-2 items-end",children:[u.jsxs("label",{className:"md:col-span-2 text-sm text-slate-600 flex flex-col gap-1",children:["Ttulo",u.jsx("input",{value:c.titulo,onChange:I=>d(R=>({...R,titulo:I.target.value})),className:"form-control !py-2.5",placeholder:"Ttulo do evento",required:!0})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Tipo",u.jsx("select",{value:c.tipo,onChange:I=>d(R=>({...R,tipo:I.target.value})),className:"form-control !py-2.5",required:!0,children:i3.map(I=>u.jsx("option",{value:I,children:I},I))})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Data",u.jsx("input",{type:"date",value:c.data,onChange:I=>d(R=>({...R,data:I.target.value})),className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Local",u.jsx("input",{value:c.local,onChange:I=>d(R=>({...R,local:I.target.value})),className:"form-control !py-2.5",placeholder:"Ex.: Auditrio"})]}),u.jsxs("div",{className:"text-sm text-slate-600 flex flex-col gap-1",children:[u.jsx("span",{children:"Perodo"}),u.jsx("div",{className:"h-[42px] flex items-center",children:u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:c.diaTodo,onChange:I=>d(R=>({...R,diaTodo:I.target.checked,horario:I.target.checked?"":R.horario}))}),"Dia todo"]})})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Horrio",u.jsx("input",{type:"time",value:c.horario,onChange:I=>d(R=>({...R,horario:I.target.value})),className:"form-control !py-2.5",required:!c.diaTodo,disabled:c.diaTodo})]}),u.jsxs("label",{className:"md:col-span-2 text-sm text-slate-600 flex flex-col gap-1",children:["Anexo (PDF ou imagem)",u.jsx("input",{type:"file",accept:"application/pdf,image/*",onChange:I=>{var R;return x(((R=I.target.files)==null?void 0:R[0])||null)},className:"form-control !py-2.5"}),!p&&c.anexoUrl&&u.jsxs("a",{href:c.anexoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-primary hover:underline truncate",children:["Anexo atual: ",c.anexoNome||"Visualizar arquivo"]})]}),u.jsxs("div",{className:"md:col-span-6 flex flex-col gap-2 text-sm text-slate-600",children:[u.jsx("span",{children:"Descrio"}),u.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 w-fit",children:[u.jsx("button",{type:"button",onMouseDown:I=>I.preventDefault(),onClick:()=>j("bold"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 font-semibold",children:"B"}),u.jsx("button",{type:"button",onMouseDown:I=>I.preventDefault(),onClick:()=>j("italic"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 italic",children:"I"}),u.jsx("button",{type:"button",onMouseDown:I=>I.preventDefault(),onClick:()=>j("underline"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 underline",children:"U"}),u.jsx("button",{type:"button",onMouseDown:I=>I.preventDefault(),onClick:()=>j("insertUnorderedList"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100",children:""})]}),u.jsx("div",{ref:k,contentEditable:!0,suppressContentEditableWarning:!0,onInput:I=>{const R=I.currentTarget.innerHTML;d(S=>({...S,descricao:R}))},className:"min-h-[120px] rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),u.jsx("div",{className:"md:col-span-6 flex justify-end",children:u.jsx("button",{type:"submit",disabled:h,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-60",children:o?"Salvar edio":"Salvar evento"})})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(hp,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Eventos"})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[n&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando eventos..."}),!n&&y.map(I=>{const R=_(I.data);return u.jsxs("div",{className:"mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 border-l-8 border-l-slate-500",children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap p-2",children:[u.jsxs("button",{onClick:()=>w(I),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>N(I.id),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-red-600 bg-red-50 border border-red-200 hover:bg-red-100 transition-colors flex flex-col items-center gap-1",children:[u.jsx(I0,{}),"Excluir"]})]}),u.jsx("div",{className:"md:grow min-w-0 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsxs("div",{className:"w-14 h-14 rounded-full bg-slate-200 border border-slate-500 flex flex-col items-center justify-center shrink-0",children:[u.jsx("span",{className:"text-base font-bold text-slate-500 leading-none",children:R.dia}),u.jsx("span",{className:"text-[10px] font-semibold text-slate-500",children:R.mes})]}),u.jsxs("div",{className:"min-w-0 md:grow",children:[u.jsxs("div",{className:"font-semibold text-slate-800 truncate",children:[I.titulo,u.jsxs("span",{className:`inline-flex items-center ${I.anexoUrl?"":"hidden"}`,children:["",u.jsx(yk,{size:14})]})]}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:I.tipo}),u.jsx("div",{className:"md:hidden text-xs text-slate-500",children:I.diaTodo?"Dia todo":I.horario}),u.jsx("div",{className:"md:hidden text-xs text-slate-500 mt-0.5 truncate",children:I.local})]}),u.jsxs("div",{className:"hidden md:block md:w-32",children:[u.jsx("div",{className:"text-sm text-slate-500",children:I.diaTodo?"Dia todo":I.horario}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:I.local})]})]})})]}),u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>w(I),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{size:14})}),u.jsx("button",{onClick:()=>N(I.id),className:"h-8 px-2 rounded-e-lg text-xs font-medium text-red-600 border border-primary border-l-0 inline-flex justify-center items-center gap-1",children:u.jsx(I0,{size:14})})]})]},I.id)}),!n&&t.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhum evento cadastrado."}),!n&&t.length>0&&u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",E," de ",L]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:E===1,onClick:()=>C(I=>Math.max(1,I-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:E===L,onClick:()=>C(I=>Math.min(L,I+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})]})}const dm=5,hm={nome:"",turmaId:"",fotoUrl:""},Ga={responsavelId:"",parentesco:"",podeBuscar:!0,contatoEmergencia:!1};function a3(t){return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=e2e8f0&color=0f172a`}async function l3(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function c3(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function qw(){const[t,e]=D.useState([]),[n,r]=D.useState([]),[s,i]=D.useState([]),[o,a]=D.useState(!1),[c,d]=D.useState(null),[h,m]=D.useState(hm),[p,x]=D.useState(""),[A,C]=D.useState("todos"),[k,_]=D.useState("todas"),[v,w]=D.useState(!1),[P,j]=D.useState(1),[L,E]=D.useState(!1),[y,b]=D.useState(!0),[N,I]=D.useState(!1),[R,S]=D.useState({tipo:"",mensagem:""}),[ie,le]=D.useState(!1),[W,we]=D.useState(null),[$,F]=D.useState(""),[K,J]=D.useState(Ga);D.useEffect(()=>Y?pt(Fe(Y,"students"),Z=>{const ne=Z.docs.map(pe=>{const Ce=pe.data();return{id:pe.id,nome:Ce.nome||"Sem nome",turmaId:Ce.turmaId||"",status:Ce.status||"ativo",fotoUrl:Ce.fotoUrl||"",responsaveis:Array.isArray(Ce.responsaveis)?Ce.responsaveis:[]}}).sort((pe,Ce)=>pe.nome.localeCompare(Ce.nome,"pt-BR"));e(ne),b(!1);const he=Z.docs.filter(pe=>{const Ce=pe.data();return Array.isArray(Ce.responsaveis)&&Ce.responsaveis.length>0&&!Array.isArray(Ce.responsaveisIds)});if(he.length>0){const pe=Wj(Y);he.forEach(Ce=>{const Sn=Ce.data().responsaveis.map(Kt=>Kt.responsavelId).filter(Boolean);pe.update(tt(Y,"students",Ce.id),{responsaveisIds:Sn})}),pe.commit().catch(()=>{})}},Z=>{b(!1),S({tipo:"erro",mensagem:(Z==null?void 0:Z.message)||"No foi possvel carregar os alunos do banco."})}):(b(!1),S({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{}),[]),D.useEffect(()=>{if(!Y)return()=>{};const U=Lt(Fe(Y,"users"),mt("role","==","parent"));return pt(U,ne=>{const he=ne.docs.map(pe=>{const Ce=pe.data();return{id:pe.id,nome:Ce.nome||"Sem nome",email:Ce.email||"",telefone:Ce.telefone||"",avatarUrl:Ce.avatarUrl||"",status:Ce.status||"ativo"}}).sort((pe,Ce)=>pe.nome.localeCompare(Ce.nome,"pt-BR"));i(he)})},[]),D.useEffect(()=>Y?pt(Fe(Y,"classrooms"),Z=>{const ne=Z.docs.map(he=>{const pe=he.data();return{id:he.id,nome:pe.nome||"Sem nome",periodo:pe.periodo||"",status:pe.status||"ativa"}}).sort((he,pe)=>he.nome.localeCompare(pe.nome,"pt-BR"));r(ne)}):()=>{},[]);const Q=D.useMemo(()=>t.filter(U=>{const Z=U.nome.toLowerCase().includes(p.toLowerCase()),ne=A==="todos"?!0:U.status===A,he=k==="todas"?!0:U.turmaId===k;return Z&&ne&&he}),[t,p,A,k]),me=Math.max(1,Math.ceil(Q.length/dm)),ue=Math.min(P,me),Ne=Q.slice((ue-1)*dm,ue*dm),_e=U=>{var Z;return((Z=n.find(ne=>ne.id===U))==null?void 0:Z.nome)||"Sem turma"},ke=()=>{d(null),m(hm),a(!0)},Ve=U=>{d(U.id),m({nome:U.nome,turmaId:U.turmaId||"",fotoUrl:U.fotoUrl||""}),a(!0)},kt=()=>{a(!1),d(null),m(hm)},zn=async U=>{var ne;const Z=(ne=U.target.files)==null?void 0:ne[0];if(Z)try{const he=await l3(Z),pe=await c3(he);m(Ce=>({...Ce,fotoUrl:pe}))}catch(he){S({tipo:"erro",mensagem:(he==null?void 0:he.message)||"No foi possvel carregar a foto."})}finally{U.target.value=""}},Mi=async U=>{U.preventDefault(),S({tipo:"",mensagem:""}),E(!0);const Z=h.nome.trim(),ne=h.turmaId;if(!Z||!ne){E(!1);return}const he=h.fotoUrl.trim()||a3(Z);try{if(!Y)throw new Error("Banco de dados no configurado.");c?(await un(tt(Y,"students",c),{nome:Z,turmaId:ne,fotoUrl:he,updatedAt:Me()}),S({tipo:"sucesso",mensagem:"Dados do aluno atualizados com sucesso."})):(await Bh(Fe(Y,"students"),{nome:Z,turmaId:ne,fotoUrl:he,status:"ativo",createdAt:Me(),updatedAt:Me()}),S({tipo:"sucesso",mensagem:"Aluno cadastrado com sucesso."})),j(1),kt()}catch(pe){S({tipo:"erro",mensagem:(pe==null?void 0:pe.message)||"No foi possvel salvar o aluno."})}finally{E(!1)}},Mr=U=>{(async()=>{if(!Y)throw new Error("Banco de dados no configurado.");const ne=t.find(he=>he.id===U);ne&&await un(tt(Y,"students",U),{status:ne.status==="ativo"?"inativo":"ativo",updatedAt:Me()})})().catch(ne=>{S({tipo:"erro",mensagem:(ne==null?void 0:ne.message)||"No foi possvel atualizar o status do aluno."})})},Bn=U=>{we(U),le(!0),F(""),J(Ga)},Li=()=>{le(!1),we(null),F(""),J(Ga)},vt=W?t.find(U=>U.id===W.id)||W:null,$n=(vt==null?void 0:vt.responsaveis)||[],$s=D.useMemo(()=>{const U=$.trim().toLowerCase();return s.filter(Z=>Z.status==="ativo").filter(Z=>!U||Z.nome.toLowerCase().includes(U))},[s,$]),Fi=async U=>{if(U.preventDefault(),!Y||!vt)return;const Z=s.find(he=>he.id===K.responsavelId),ne=K.parentesco.trim();if(!(!Z||!ne))try{I(!0),S({tipo:"",mensagem:""});const he=Array.isArray(vt.responsaveis)?vt.responsaveis:[],pe={responsavelId:Z.id,nome:Z.nome,email:Z.email||"",telefone:Z.telefone||"",avatarUrl:Z.avatarUrl||"",parentesco:ne,podeBuscar:!!K.podeBuscar,contatoEmergencia:!!K.contatoEmergencia},Ce=he.findIndex(Kt=>Kt.responsavelId===Z.id);let Sn=[];Ce>=0?Sn=he.map((Kt,Yh)=>Yh===Ce?pe:Kt):Sn=[...he,pe],pe.contatoEmergencia&&(Sn=Sn.map(Kt=>({...Kt,contatoEmergencia:Kt.responsavelId===pe.responsavelId}))),await un(tt(Y,"students",vt.id),{responsaveis:Sn,responsaveisIds:Sn.map(Kt=>Kt.responsavelId),updatedAt:Me()}),J(Ga),S({tipo:"sucesso",mensagem:"Vnculo de responsvel salvo com sucesso."})}catch(he){S({tipo:"erro",mensagem:(he==null?void 0:he.message)||"No foi possvel salvar o vnculo do responsvel."})}finally{I(!1)}},B=U=>{J({responsavelId:U.responsavelId||"",parentesco:U.parentesco||"",podeBuscar:!!U.podeBuscar,contatoEmergencia:!!U.contatoEmergencia})},ce=async U=>{if(!(!Y||!vt))try{I(!0),S({tipo:"",mensagem:""});const ne=(Array.isArray(vt.responsaveis)?vt.responsaveis:[]).filter(he=>he.responsavelId!==U);await un(tt(Y,"students",vt.id),{responsaveis:ne,responsaveisIds:ne.map(he=>he.responsavelId),updatedAt:Me()}),K.responsavelId===U&&J(Ga),S({tipo:"sucesso",mensagem:"Vnculo removido com sucesso."})}catch(Z){S({tipo:"erro",mensagem:(Z==null?void 0:Z.message)||"No foi possvel remover o vnculo do responsvel."})}finally{I(!1)}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Alunos"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro, edio e status dos alunos."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Alunos"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>w(U=>!U),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${v?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(gh,{size:16})}),u.jsx("button",{onClick:o?kt:ke,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar aluno",children:o?u.jsx(Tr,{size:16}):u.jsx(dc,{size:16})}),u.jsx("button",{onClick:o?kt:ke,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:o?"Cancelar":"Adicionar aluno"})]})]}),o&&u.jsxs("form",{onSubmit:Mi,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload da foto",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32 rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:h.fotoUrl?u.jsx("img",{src:h.fotoUrl,alt:"Avatar do aluno",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem foto"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:zn,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:h.nome,onChange:U=>m(Z=>({...Z,nome:U.target.value})),placeholder:"Nome do aluno",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Turma",u.jsxs("select",{value:h.turmaId,onChange:U=>m(Z=>({...Z,turmaId:U.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione a turma"}),n.map(U=>u.jsx("option",{value:U.id,children:U.nome},U.id))]})]})]})})]}),u.jsx("button",{type:"submit",disabled:L,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:c?"Salvar edio":"Salvar aluno"})]}),R.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${R.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:R.mensagem}),u.jsxs("div",{className:`${v?"flex":"hidden"} flex-col gap-3 mb-4 md:flex md:flex-row`,children:[u.jsx("input",{value:p,onChange:U=>{x(U.target.value),j(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:A,onChange:U=>{C(U.target.value),j(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]}),u.jsxs("select",{value:k,onChange:U=>{_(U.target.value),j(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todas",children:"Todas as turmas"}),n.map(U=>u.jsx("option",{value:U.id,children:U.nome},U.id))]})]}),y&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando alunos..."}),!y&&Ne.map(U=>u.jsx("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${U.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:(()=>{const Z=(U.responsaveis||[]).filter(ne=>ne.contatoEmergencia);return u.jsxs("div",{children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>Ve(U),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>Bn(U),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-primary bg-primary/15 border border-primary/30 hover:bg-primary/35 transition-colors flex flex-col items-center gap-1",children:[u.jsx($l,{}),"Resp."]}),u.jsxs("button",{onClick:()=>Mr(U.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${U.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[U.status==="ativo"?u.jsx(Ns,{}):u.jsx(As,{}),U.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:U.fotoUrl?u.jsx("img",{src:U.fotoUrl,alt:U.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:U.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:_e(U.turmaId)})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:Z.map(ne=>u.jsxs("div",{children:[u.jsx("div",{className:"font-bold",children:ne.nome||"Responsvel"}),u.jsxs("div",{children:[ne.parentesco||"Parentesco no informado"," - ",ne.telefone||"Sem telefone"]})]}))})})]}),u.jsxs("div",{className:"grid grid-cols-3 md:hidden p-1",children:[u.jsx("button",{onClick:()=>Ve(U),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>Bn(U),className:"h-8 px-2 text-xs font-medium text-primary border border-primary inline-flex justify-center items-center gap-1",children:u.jsx($l,{})}),u.jsx("button",{onClick:()=>Mr(U.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${U.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:U.status==="ativo"?u.jsx(Ns,{}):u.jsx(As,{})})]})]},U.id)})()},U.id)),ie&&vt&&u.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-2xl rounded-xl border border-slate-200 bg-white shadow-xl p-4 md:p-5",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h4",{className:"text-base font-bold text-slate-800",children:["Responsveis de ",vt.nome]}),u.jsx("button",{onClick:Li,className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),u.jsxs("form",{onSubmit:Fi,className:"rounded-lg border border-slate-200 p-3 mb-3 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Responsvel",u.jsxs("select",{value:K.responsavelId,onChange:U=>J(Z=>({...Z,responsavelId:U.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione"}),$s.map(U=>u.jsx("option",{value:U.id,children:U.nome},U.id))]})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Parentesco",u.jsx("input",{value:K.parentesco,onChange:U=>J(Z=>({...Z,parentesco:U.target.value})),placeholder:"Ex.: Me, Pai, Av, Tio",className:"form-control !py-2.5",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:K.podeBuscar,onChange:U=>J(Z=>({...Z,podeBuscar:U.target.checked}))}),"Pode buscar o aluno"]}),u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:K.contatoEmergencia,onChange:U=>J(Z=>({...Z,contatoEmergencia:U.target.checked}))}),"Contato de emergncia"]})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",disabled:N,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-60",children:N?"Salvando...":"Salvar vnculo"})})]}),u.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:["Vnculos atuais (",$n.length,")"]}),u.jsxs("div",{className:"flex flex-col gap-2 max-h-60 overflow-y-auto",children:[$n.map(U=>u.jsxs("div",{className:`rounded-lg border px-3 py-2 ${U.contatoEmergencia?"bg-amber-50 border-amber-500":""}`,children:[u.jsxs("div",{className:"flex items-center justify-start gap-2",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 py-2",children:[u.jsxs("button",{onClick:()=>B(U),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>ce(U.responsavelId),className:"w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 bg-red-50 text-red-600 hover:bg-red-100 border border-red-700",children:[u.jsx(wk,{}),"Excluir"]})]}),u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:u.jsx("img",{src:U.avatarUrl,alt:U.nome,className:"w-full h-full object-cover"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:U.nome||"Responsvel"}),u.jsxs("div",{className:"text-sm text-slate-500 truncate",children:[U.parentesco||"Sem parentesco","  ",U.podeBuscar?"Pode buscar":"No pode buscar",U.contatoEmergencia?"  Emergncia":""]})]})]})]}),u.jsx("div",{className:"w-full md:hidden",children:u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>B(U),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>ce(U.responsavelId),className:"h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1",children:u.jsx(Tr,{})})]})})]},U.responsavelId)),$n.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum responsvel vinculado."})]})]})]})}),!y&&Ne.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum aluno encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",ue," de ",me]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{disabled:ue===1,onClick:()=>j(U=>Math.max(1,U-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Anterior"}),u.jsx("button",{disabled:ue===me,onClick:()=>j(U=>Math.min(me,U+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Prxima"})]})]})]})]})}const fm=5,mm={nome:"",disciplina:"",email:"",telefone:"",avatarUrl:""};async function u3(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function d3(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function h3(){const[t,e]=D.useState([]),[n,r]=D.useState(!1),[s,i]=D.useState(null),[o,a]=D.useState(mm),[c,d]=D.useState(""),[h,m]=D.useState("todos"),[p,x]=D.useState("todas"),[A,C]=D.useState(!1),[k,_]=D.useState(1),[v,w]=D.useState(!1),[P,j]=D.useState(!0),[L,E]=D.useState({tipo:"",mensagem:""});D.useEffect(()=>{if(!Y)return j(!1),E({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{};const F=Lt(Fe(Y,"users"),mt("role","==","teacher"));return pt(F,J=>{const Q=J.docs.map(me=>{const ue=me.data();return{id:me.id,nome:ue.nome||"Sem nome",disciplina:ue.disciplina||"",email:ue.email||"",telefone:ue.telefone||"",avatarUrl:ue.avatarUrl||"",status:ue.status||"ativo"}}).sort((me,ue)=>me.nome.localeCompare(ue.nome,"pt-BR"));e(Q),j(!1)},J=>{j(!1),E({tipo:"erro",mensagem:(J==null?void 0:J.message)||"No foi possvel carregar os professores do banco."})})},[]);const y=D.useMemo(()=>[...new Set(t.map(F=>F.disciplina).filter(Boolean))].sort(),[t]),b=D.useMemo(()=>t.filter(F=>{const K=F.nome.toLowerCase().includes(c.toLowerCase()),J=h==="todos"?!0:F.status===h,Q=p==="todas"?!0:F.disciplina===p;return K&&J&&Q}),[t,c,h,p]),N=Math.max(1,Math.ceil(b.length/fm)),I=Math.min(k,N),R=b.slice((I-1)*fm,I*fm),S=()=>{i(null),a(mm),r(!0)},ie=F=>{i(F.id),a({nome:F.nome,disciplina:F.disciplina,email:F.email||"",telefone:F.telefone||"",avatarUrl:F.avatarUrl||""}),r(!0)},le=()=>{i(null),a(mm),r(!1)},W=F=>{F.preventDefault(),(async()=>{var _e;E({tipo:"",mensagem:""}),w(!0);const J=o.nome.trim(),Q=o.disciplina.trim(),me=o.email.trim().toLowerCase(),ue=o.telefone.trim(),Ne=o.avatarUrl.trim();if(!J||!me){w(!1);return}try{if(s){if(!Y)throw new Error("Banco de dados no configurado.");await un(tt(Y,"users",s),{nome:J,disciplina:Q||null,telefone:ue||null,avatarUrl:Ne||null,updatedAt:Me()}),E({tipo:"sucesso",mensagem:"Dados do professor atualizados com sucesso."})}else{if(!Rr||!St)throw new Error("Firebase no configurado para cadastro de professor.");const Ve=await US(sA,"createTeacherAccount")({nome:J,email:me,disciplina:Q,telefone:ue,avatarUrl:Ne}),kt=((_e=Ve==null?void 0:Ve.data)==null?void 0:_e.email)||me;await SS(St,kt),E({tipo:"sucesso",mensagem:"Professor cadastrado e link para criao de senha enviado por e-mail."})}_(1),le()}catch(ke){const Ve=(ke==null?void 0:ke.message)||"No foi possvel salvar o professor.";E({tipo:"erro",mensagem:Ve})}finally{w(!1)}})()},we=F=>{(async()=>{if(!Y)throw new Error("Banco de dados no configurado.");const J=t.find(Q=>Q.id===F);J&&await un(tt(Y,"users",F),{status:J.status==="ativo"?"inativo":"ativo",updatedAt:Me()})})().catch(J=>{E({tipo:"erro",mensagem:(J==null?void 0:J.message)||"No foi possvel atualizar o status do professor."})})},$=async F=>{var J;const K=(J=F.target.files)==null?void 0:J[0];if(K)try{const Q=await u3(K),me=await d3(Q);a(ue=>({...ue,avatarUrl:me}))}catch(Q){E({tipo:"erro",mensagem:(Q==null?void 0:Q.message)||"No foi possvel carregar o avatar."})}finally{F.target.value=""}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Professores"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro, edio e status do quadro docente."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Professores"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>C(F=>!F),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${A?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(gh,{size:16})}),u.jsx("button",{onClick:n?le:S,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar professor",children:n?u.jsx(Tr,{size:16}):u.jsx(dc,{size:16})}),u.jsx("button",{onClick:n?le:S,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:n?"Cancelar":"Adicionar professor"})]})]}),n&&u.jsxs("form",{onSubmit:W,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload de avatar",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32  rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar do professor",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem avatar"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:$,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:o.nome,onChange:F=>a(K=>({...K,nome:F.target.value})),placeholder:"Nome completo",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2 text-sm text-slate-600",children:["E-mail",u.jsx("input",{type:"email",value:o.email,onChange:F=>a(K=>({...K,email:F.target.value})),placeholder:"E-mail",className:"form-control !py-2.5",required:!0,disabled:!!s})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Disciplina",u.jsx("input",{value:o.disciplina,onChange:F=>a(K=>({...K,disciplina:F.target.value})),placeholder:"Disciplina (opcional)",className:"form-control !py-2.5"})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Telefone",u.jsx("input",{value:o.telefone,onChange:F=>a(K=>({...K,telefone:F.target.value})),placeholder:"Telefone (opcional)",className:"form-control !py-2.5"})]})]})})]}),u.jsx("button",{type:"submit",disabled:v,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:s?"Salvar edio":"Salvar professor"})]}),L.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${L.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:L.mensagem}),u.jsxs("div",{className:`${A?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:c,onChange:F=>{d(F.target.value),_(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:h,onChange:F=>{m(F.target.value),_(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]}),u.jsxs("select",{value:p,onChange:F=>{x(F.target.value),_(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todas",children:"Todas as disciplinas"}),y.map(F=>u.jsx("option",{value:F,children:F},F))]})]}),P&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando professores..."}),!P&&R.map(F=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${F.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>ie(F),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>we(F.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${F.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[F.status==="ativo"?u.jsx(Ns,{}):u.jsx(As,{}),F.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:F.avatarUrl?u.jsx("img",{src:F.avatarUrl,alt:F.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{className:"",children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:F.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:F.disciplina||"Sem disciplina"}),u.jsx("div",{className:"md:hidden text-sm text-slate-500 truncate",children:F.email})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:F.email})})]}),u.jsx("div",{children:u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>ie(F),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>we(F.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${F.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:F.status==="ativo"?u.jsx(Ns,{}):u.jsx(As,{})})]})})]},F.id)),!P&&R.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum professor encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",I," de ",N]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:I===1,onClick:()=>_(F=>Math.max(1,F-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:I===N,onClick:()=>_(F=>Math.min(N,F+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}const pm=5,gm={nome:"",email:"",telefone:"",avatarUrl:""};async function f3(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function m3(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function p3(){const[t,e]=D.useState([]),[n,r]=D.useState(!1),[s,i]=D.useState(null),[o,a]=D.useState(gm),[c,d]=D.useState(""),[h,m]=D.useState("todos"),[p,x]=D.useState(!1),[A,C]=D.useState(1),[k,_]=D.useState(!1),[v,w]=D.useState(!0),[P,j]=D.useState({tipo:"",mensagem:""});D.useEffect(()=>{if(!Y)return w(!1),j({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{};const W=Lt(Fe(Y,"users"),mt("role","==","parent"));return pt(W,$=>{const F=$.docs.map(K=>{const J=K.data();return{id:K.id,nome:J.nome||"Sem nome",email:J.email||"",telefone:J.telefone||"",avatarUrl:J.avatarUrl||"",status:J.status||"ativo"}}).sort((K,J)=>K.nome.localeCompare(J.nome,"pt-BR"));e(F),w(!1)},$=>{w(!1),j({tipo:"erro",mensagem:($==null?void 0:$.message)||"No foi possvel carregar os responsveis do banco."})})},[]);const L=D.useMemo(()=>t.filter(W=>{const we=W.nome.toLowerCase().includes(c.toLowerCase()),$=h==="todos"?!0:W.status===h;return we&&$}),[t,c,h]),E=Math.max(1,Math.ceil(L.length/pm)),y=Math.min(A,E),b=L.slice((y-1)*pm,y*pm),N=()=>{i(null),a(gm),r(!0)},I=W=>{i(W.id),a({nome:W.nome,email:W.email||"",telefone:W.telefone||"",avatarUrl:W.avatarUrl||""}),r(!0)},R=()=>{i(null),a(gm),r(!1)},S=W=>{W.preventDefault(),(async()=>{var Q;j({tipo:"",mensagem:""}),_(!0);const $=o.nome.trim(),F=o.email.trim().toLowerCase(),K=o.telefone.trim(),J=o.avatarUrl.trim();if(!$||!F){_(!1);return}try{if(s){if(!Y)throw new Error("Banco de dados no configurado.");await un(tt(Y,"users",s),{nome:$,telefone:K||null,avatarUrl:J||null,updatedAt:Me()}),j({tipo:"sucesso",mensagem:"Dados do responsvel atualizados com sucesso."})}else{if(!Rr||!St)throw new Error("Firebase no configurado para cadastro de responsvel.");const ue=await US(sA,"createParentAccount")({nome:$,email:F,telefone:K,avatarUrl:J}),Ne=((Q=ue==null?void 0:ue.data)==null?void 0:Q.email)||F;await SS(St,Ne),j({tipo:"sucesso",mensagem:"Responsvel cadastrado e link para criao de senha enviado por e-mail."})}C(1),R()}catch(me){const ue=(me==null?void 0:me.message)||"No foi possvel salvar o responsvel.";j({tipo:"erro",mensagem:ue})}finally{_(!1)}})()},ie=W=>{(async()=>{if(!Y)throw new Error("Banco de dados no configurado.");const $=t.find(F=>F.id===W);$&&await un(tt(Y,"users",W),{status:$.status==="ativo"?"inativo":"ativo",updatedAt:Me()})})().catch($=>{j({tipo:"erro",mensagem:($==null?void 0:$.message)||"No foi possvel atualizar o status do responsvel."})})},le=async W=>{var $;const we=($=W.target.files)==null?void 0:$[0];if(we)try{const F=await f3(we),K=await m3(F);a(J=>({...J,avatarUrl:K}))}catch(F){j({tipo:"erro",mensagem:(F==null?void 0:F.message)||"No foi possvel carregar o avatar."})}finally{W.target.value=""}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Responsveis"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro e acompanhamento dos responsveis dos alunos."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Responsveis"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>x(W=>!W),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${p?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(gh,{size:16})}),u.jsx("button",{onClick:n?R:N,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar responsvel",children:n?u.jsx(Tr,{size:16}):u.jsx(dc,{size:16})}),u.jsx("button",{onClick:n?R:N,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:n?"Cancelar":"Adicionar responsvel"})]})]}),n&&u.jsxs("form",{onSubmit:S,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload de avatar",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32 rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar do responsvel",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem avatar"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:le,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:o.nome,onChange:W=>a(we=>({...we,nome:W.target.value})),placeholder:"Nome completo",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2 text-sm text-slate-600",children:["E-mail",u.jsx("input",{type:"email",value:o.email,onChange:W=>a(we=>({...we,email:W.target.value})),placeholder:"E-mail",className:"form-control !py-2.5",required:!0,disabled:!!s})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Telefone",u.jsx("input",{value:o.telefone,onChange:W=>a(we=>({...we,telefone:W.target.value})),placeholder:"Telefone (opcional)",className:"form-control !py-2.5"})]})]})})]}),u.jsx("button",{type:"submit",disabled:k,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:s?"Salvar edio":"Salvar responsvel"})]}),P.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${P.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:P.mensagem}),u.jsxs("div",{className:`${p?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:c,onChange:W=>{d(W.target.value),C(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:h,onChange:W=>{m(W.target.value),C(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]})]}),v&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando responsveis..."}),!v&&b.map(W=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${W.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>I(W),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>ie(W.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${W.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[W.status==="ativo"?u.jsx(Ns,{}):u.jsx(As,{}),W.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:W.avatarUrl?u.jsx("img",{src:W.avatarUrl,alt:W.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:W.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:W.email}),u.jsx("div",{className:"md:hidden text-sm text-slate-500 truncate",children:W.telefone||"Sem telefone"})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:W.telefone||"Sem telefone"})})]}),u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>I(W),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>ie(W.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${W.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:W.status==="ativo"?u.jsx(Ns,{}):u.jsx(As,{})})]})]},W.id)),!v&&b.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum responsvel encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",y," de ",E]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:y===1,onClick:()=>C(W=>Math.max(1,W-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:y===E,onClick:()=>C(W=>Math.min(E,W+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}const ym=5,vm={nome:"",periodo:"Integral",professorId:""};function g3(){const[t,e]=D.useState([]),[n,r]=D.useState([]),[s,i]=D.useState([]),[o,a]=D.useState(!1),[c,d]=D.useState(null),[h,m]=D.useState(vm),[p,x]=D.useState(""),[A,C]=D.useState("todos"),[k,_]=D.useState("todos"),[v,w]=D.useState(!1),[P,j]=D.useState(1),[L,E]=D.useState(!1),[y,b]=D.useState(!1),[N,I]=D.useState(!0),[R,S]=D.useState(!0),[ie,le]=D.useState({tipo:"",mensagem:""}),[W,we]=D.useState(null),[$,F]=D.useState(!1),[K,J]=D.useState("");D.useEffect(()=>Y?pt(Fe(Y,"classrooms"),ce=>{const U=ce.docs.map(Z=>{const ne=Z.data();return{id:Z.id,nome:ne.nome||"Sem nome",periodo:ne.periodo||"",professorId:ne.professorId||"",professorNome:ne.professorNome||"",status:ne.status||"ativa"}}).sort((Z,ne)=>Z.nome.localeCompare(ne.nome,"pt-BR"));e(U),I(!1)},ce=>{I(!1),le({tipo:"erro",mensagem:(ce==null?void 0:ce.message)||"No foi possvel carregar as turmas do banco."})}):(I(!1),le({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{}),[]),D.useEffect(()=>{if(!Y)return()=>{};const B=Lt(Fe(Y,"users"),mt("role","==","teacher"));return pt(B,U=>{const Z=U.docs.map(ne=>{const he=ne.data();return{id:ne.id,nome:he.nome||"Sem nome",status:he.status||"ativo"}}).sort((ne,he)=>ne.nome.localeCompare(he.nome,"pt-BR"));i(Z)})},[]),D.useEffect(()=>Y?pt(Lt(Fe(Y,"students")),ce=>{const U=ce.docs.map(Z=>{const ne=Z.data();return{id:Z.id,nome:ne.nome||"Sem nome",turmaId:ne.turmaId||"",status:ne.status||"ativo",fotoUrl:ne.fotoUrl||""}}).sort((Z,ne)=>Z.nome.localeCompare(ne.nome,"pt-BR"));r(U),S(!1)},()=>{S(!1)}):(S(!1),()=>{}),[]);const Q=D.useMemo(()=>[...new Set(t.map(B=>B.periodo).filter(Boolean))],[t]),me=D.useMemo(()=>{const B=["Matutino","Vespertino","Integral"];return[...new Set([...B,...Q])]},[Q]),ue=D.useMemo(()=>t.filter(B=>{const ce=B.nome.toLowerCase().includes(p.toLowerCase()),U=A==="todos"?!0:B.status===A,Z=k==="todos"?!0:B.periodo===k;return ce&&U&&Z}),[t,p,A,k]),Ne=Math.max(1,Math.ceil(ue.length/ym)),_e=Math.min(P,Ne),ke=ue.slice((_e-1)*ym,_e*ym),Ve=t.find(B=>B.id===W)||null,kt=D.useMemo(()=>W?n.filter(B=>B.turmaId===W):[],[n,W]),zn=D.useMemo(()=>{if(!W)return[];const B=K.trim().toLowerCase();return B?n.filter(ce=>ce.nome.toLowerCase().includes(B)).slice(0,20):[]},[n,W,K]),Mi=()=>{d(null),m(vm),a(!0)},Mr=B=>{d(B.id),m({nome:B.nome,periodo:B.periodo||"",professorId:B.professorId||""}),a(!0)},Bn=()=>{d(null),m(vm),a(!1)},Li=B=>{B.preventDefault(),(async()=>{le({tipo:"",mensagem:""}),E(!0);const U=h.nome.trim(),Z=h.periodo.trim(),ne=h.professorId,he=s.find(pe=>pe.id===ne);if(!U||!Z||!ne||!he){E(!1);return}try{if(!Y)throw new Error("Banco de dados no configurado.");c?(await un(tt(Y,"classrooms",c),{nome:U,periodo:Z,professorId:ne,professorNome:he.nome,updatedAt:Me()}),le({tipo:"sucesso",mensagem:"Dados da turma atualizados com sucesso."})):(await Bh(Fe(Y,"classrooms"),{nome:U,periodo:Z,professorId:ne,professorNome:he.nome,status:"ativa",createdAt:Me(),updatedAt:Me()}),le({tipo:"sucesso",mensagem:"Turma cadastrada com sucesso."})),j(1),Bn()}catch(pe){le({tipo:"erro",mensagem:(pe==null?void 0:pe.message)||"No foi possvel salvar a turma."})}finally{E(!1)}})()},vt=B=>{(async()=>{if(!Y)throw new Error("Banco de dados no configurado.");const U=t.find(Z=>Z.id===B);U&&await un(tt(Y,"classrooms",B),{status:U.status==="ativa"?"inativa":"ativa",updatedAt:Me()})})().catch(U=>{le({tipo:"erro",mensagem:(U==null?void 0:U.message)||"No foi possvel atualizar o status da turma."})})},$n=B=>{we(ce=>ce===B?null:B),F(!1),J("")},$s=async B=>{try{if(!Y||!W)throw new Error("Selecione uma turma para vincular alunos.");b(!0),le({tipo:"",mensagem:""}),await un(tt(Y,"students",B.id),{turmaId:W,updatedAt:Me()}),le({tipo:"sucesso",mensagem:B.turmaId&&B.turmaId!==W?"Aluno transferido para a turma com sucesso.":"Aluno vinculado  turma com sucesso."})}catch(ce){le({tipo:"erro",mensagem:(ce==null?void 0:ce.message)||"No foi possvel vincular o aluno."})}finally{b(!1)}},Fi=async B=>{try{if(!Y)throw new Error("Dados no disponveis para remover aluno.");b(!0),le({tipo:"",mensagem:""}),await un(tt(Y,"students",B),{turmaId:null,updatedAt:Me()}),le({tipo:"sucesso",mensagem:"Aluno removido da turma com sucesso."})}catch(ce){le({tipo:"erro",mensagem:(ce==null?void 0:ce.message)||"No foi possvel remover o aluno da turma."})}finally{b(!1)}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Turmas"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Organizao das turmas e perodos da escola."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Turmas"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>w(B=>!B),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${v?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(gh,{size:16})}),u.jsx("button",{onClick:o?Bn:Mi,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar turma",children:o?u.jsx(Tr,{size:16}):u.jsx(dc,{size:16})}),u.jsx("button",{onClick:o?Bn:Mi,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:o?"Cancelar":"Adicionar turma"})]})]}),o&&u.jsxs("form",{onSubmit:Li,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome da turma",u.jsx("input",{value:h.nome,onChange:B=>m(ce=>({...ce,nome:B.target.value})),placeholder:"Nome da turma",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Perodo",u.jsx("select",{value:h.periodo,onChange:B=>m(ce=>({...ce,periodo:B.target.value})),className:"form-control !py-2.5",children:me.map(B=>u.jsx("option",{value:B,children:B},B))})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Professor responsvel",u.jsxs("select",{value:h.professorId,onChange:B=>m(ce=>({...ce,professorId:B.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione"}),s.filter(B=>B.status==="ativo"||B.id===h.professorId).map(B=>u.jsx("option",{value:B.id,children:B.nome},B.id))]})]})]}),u.jsx("button",{type:"submit",disabled:L,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:c?"Salvar edio":"Salvar turma"})]}),ie.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${ie.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:ie.mensagem}),u.jsxs("div",{className:`${v?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:p,onChange:B=>{x(B.target.value),j(1)},placeholder:"Buscar por turma",className:"form-control !py-2.5"}),u.jsxs("select",{value:A,onChange:B=>{C(B.target.value),j(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativa",children:"Ativa"}),u.jsx("option",{value:"inativa",children:"Inativa"})]}),u.jsxs("select",{value:k,onChange:B=>{_(B.target.value),j(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os perodos"}),Q.map(B=>u.jsx("option",{value:B,children:B},B))]})]}),Ve&&u.jsxs("div",{className:"mt-5 rounded-xl border border-slate-200 bg-white/80 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h4",{className:"text-base font-bold text-slate-800",children:["Gerenciar alunos da turma: ",Ve.nome]}),u.jsx("button",{onClick:()=>we(null),className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),R?u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando alunos..."}):u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx("div",{className:"flex items-center justify-end",children:u.jsx("button",{onClick:()=>F(!0),className:"h-9 w-full md:w-auto px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors",children:"Buscar e vincular aluno"})}),u.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:["Alunos da turma: ",kt.length]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:[kt.map(B=>{var ce,U;return u.jsxs("div",{className:"flex items-center justify-between bg-slate-100 gap-3 rounded-lg border shadown-md border-slate-300 px-3 py-2",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-9 h-9 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:B.fotoUrl?u.jsx("img",{src:B.fotoUrl,alt:B.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-500 font-semibold",children:((U=(ce=B.nome)==null?void 0:ce.charAt(0))==null?void 0:U.toUpperCase())||"?"})}),u.jsx("span",{className:"text-sm text-slate-700 truncate",children:B.nome})]}),u.jsx("button",{disabled:y,onClick:()=>Fi(B.id),className:"h-7 px-2 rounded-md text-xs font-medium text-red-600 bg-red-50 hover:bg-red-100 disabled:opacity-50",children:"Remover"})]},B.id)}),kt.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum aluno vinculado."})]})]}),u.jsx("div",{className:"text-xs text-slate-500",children:"Use Buscar e vincular aluno para localizar por nome e incluir na turma."})]})]}),$&&Ve&&u.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-2xl rounded-xl border border-slate-200 bg-white shadow-xl p-4 md:p-5",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-base font-bold text-slate-800",children:Ve.nome}),u.jsx("button",{onClick:()=>{F(!1),J("")},className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),u.jsx("input",{value:K,onChange:B=>J(B.target.value),placeholder:"Digite o nome do aluno",className:"form-control !py-2.5 mb-3"}),!K.trim()&&u.jsx("div",{className:"text-sm text-slate-500 py-4",children:"Digite um nome para buscar alunos."}),K.trim()&&u.jsxs("div",{className:"flex flex-col gap-2 max-h-96 overflow-y-auto",children:[zn.map(B=>{var Z,ne;const ce=B.turmaId===W,U=B.turmaId&&!ce;return u.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-lg border border-slate-200 px-3 py-2",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:B.fotoUrl?u.jsx("img",{src:B.fotoUrl,alt:B.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-500 font-semibold",children:((ne=(Z=B.nome)==null?void 0:Z.charAt(0))==null?void 0:ne.toUpperCase())||"?"})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-slate-700 truncate",children:B.nome}),ce&&u.jsx("div",{className:"text-xs text-emerald-700",children:"J est nesta turma"}),U&&u.jsx("div",{className:"text-xs text-amber-700",children:"Est em outra turma"})]})]}),u.jsx("button",{disabled:y||ce,onClick:()=>$s(B),className:"h-8 px-2 rounded-lg text-xs font-medium text-emerald-700 bg-emerald-50 hover:bg-emerald-100 disabled:opacity-50",children:ce?"Vinculado":U?"Transferir":"Vincular"})]},B.id)}),zn.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum aluno encontrado."})]})]})}),N&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando turmas..."}),!N&&ke.map(B=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${B.status==="ativa"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>Mr(B),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>$n(B.id),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-primary bg-primary/15 border border-primary/30 hover:bg-primary/35 transition-colors flex flex-col items-center gap-1",children:[u.jsx(fl,{}),"Alunos"]}),u.jsxs("button",{onClick:()=>vt(B.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${B.status==="ativa"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[B.status==="ativa"?u.jsx(Ns,{}):u.jsx(As,{}),B.status==="ativa"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2",children:[u.jsxs("div",{className:"font-medium text-slate-800 truncate",children:[B.nome," - ",B.periodo||"Sem perodo"]}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:B.professorNome||"No definido"})]})})]}),u.jsxs("div",{className:"grid grid-cols-3 md:hidden p-1",children:[u.jsx("button",{onClick:()=>Mr(B),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>$n(B.id),className:"h-8 px-2 text-xs font-medium text-slate-700 border border-primary justify-center inline-flex items-center gap-1",children:u.jsx($l,{})}),u.jsx("button",{onClick:()=>vt(B.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${B.status==="ativa"?"text-red-600":"text-emerald-700"}`,children:B.status==="ativa"?u.jsx(Ns,{}):u.jsx(As,{})})]})]},B.id)),!N&&ke.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhuma turma encontrada."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",_e," de ",Ne]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:_e===1,onClick:()=>j(B=>Math.max(1,B-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:_e===Ne,onClick:()=>j(B=>Math.min(Ne,B+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}async function y3(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}function v3(){const{currentUser:t,userProfile:e}=Qh(),[n,r]=D.useState(""),[s,i]=D.useState(""),[o,a]=D.useState(""),[c,d]=D.useState(""),[h,m]=D.useState(""),[p,x]=D.useState(""),[A,C]=D.useState(!1),[k,_]=D.useState(!1),[v,w]=D.useState(""),[P,j]=D.useState(""),[L,E]=D.useState(""),[y,b]=D.useState("");D.useEffect(()=>{r((e==null?void 0:e.nome)||""),i((e==null?void 0:e.telefone)||""),a((e==null?void 0:e.avatarUrl)||"")},[e]);const N=async S=>{var le;const ie=(le=S.target.files)==null?void 0:le[0];if(ie)try{const W=await y3(ie);a(W)}catch(W){j((W==null?void 0:W.message)||"No foi possvel carregar a imagem.")}finally{S.target.value=""}},I=async S=>{if(S.preventDefault(),!(!t||!Y)){w(""),j(""),C(!0);try{await Bd(tt(Y,"users",t.uid),{nome:n.trim(),telefone:s.trim(),avatarUrl:o||null,updatedAt:Me()},{merge:!0}),w("Perfil atualizado com sucesso.")}catch(ie){j((ie==null?void 0:ie.message)||"No foi possvel atualizar o perfil.")}finally{C(!1)}}},R=async S=>{if(S.preventDefault(),!(!(t!=null&&t.email)||!(St!=null&&St.currentUser))){if(E(""),b(""),!c.trim()){b("Informe sua senha atual.");return}if(h.length<6){b("A nova senha deve ter pelo menos 6 caracteres.");return}if(h!==p){b("A confirmao da senha no confere.");return}_(!0);try{const ie=Oi.credential(t.email,c);await L4(St.currentUser,ie),await z4(St.currentUser,h),d(""),m(""),x(""),E("Senha atualizada com sucesso.")}catch(ie){(ie==null?void 0:ie.code)==="auth/wrong-password"||(ie==null?void 0:ie.code)==="auth/invalid-credential"?b("Senha atual invlida."):b((ie==null?void 0:ie.message)||"No foi possvel alterar a senha.")}finally{_(!1)}}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Meu Perfil"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Atualize suas informaes e sua senha de acesso."})]}),u.jsxs("form",{onSubmit:I,className:"glass-panel p-5 border border-slate-200/60 flex flex-col gap-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Dados pessoais"}),P&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:P}),v&&u.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:v}),u.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[u.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:o?u.jsx("img",{src:o,alt:"Avatar do usurio",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-400 text-sm",children:"Sem avatar"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Avatar"}),u.jsx("input",{type:"file",accept:"image/*",onChange:N,className:"form-control !py-2 mt-1"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Nome",u.jsx("input",{value:n,onChange:S=>r(S.target.value),placeholder:"Nome",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["E-mail",u.jsx("input",{value:(e==null?void 0:e.email)||(t==null?void 0:t.email)||"",disabled:!0,className:"form-control !py-2.5 bg-slate-100 text-slate-500"})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600 md:col-span-2",children:["Telefone",u.jsx("input",{value:s,onChange:S=>i(S.target.value),placeholder:"Telefone",className:"form-control !py-2.5"})]})]}),u.jsx("button",{type:"submit",disabled:A,className:"h-10 px-4 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:"Salvar perfil"})]}),u.jsxs("form",{onSubmit:R,className:"glass-panel p-5 border border-slate-200/60 flex flex-col gap-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Alterar senha"}),y&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:y}),L&&u.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:L}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Senha atual",u.jsx("input",{type:"password",value:c,onChange:S=>d(S.target.value),placeholder:"Senha atual",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Nova senha",u.jsx("input",{type:"password",value:h,onChange:S=>m(S.target.value),placeholder:"Nova senha",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Confirmar nova senha",u.jsx("input",{type:"password",value:p,onChange:S=>x(S.target.value),placeholder:"Confirmar nova senha",className:"form-control !py-2.5",required:!0})]})]}),u.jsx("button",{type:"submit",disabled:k,className:"h-10 px-4 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:"Alterar senha"})]})]})}function _3(){const{currentUser:t,userRole:e,userProfile:n,logout:r}=Qh(),[s,i]=D.useState("caderneta"),[o,a]=D.useState("dashboard"),[c,d]=D.useState(null),[h,m]=D.useState(null),[p,x]=D.useState(null),[A,C]=D.useState([]),[k,_]=D.useState(!0),[v,w]=D.useState(!1),[P,j]=D.useState(!1),[L,E]=D.useState(()=>navigator.onLine?"online":"offline"),y=D.useRef(null);if(D.useEffect(()=>{e==="admin"&&!s.startsWith("admin-")&&s!=="perfil"&&i("admin-dashboard"),e==="parent"&&!["parent-inicio","calendario","comunicacao","perfil"].includes(s)&&i("parent-inicio")},[e,s]),D.useEffect(()=>{if(!Y||e!=="teacher"||!(t!=null&&t.uid))return e!=="teacher"&&(C([]),x({})),_(!1),()=>{};_(!0);const Q=Lt(Fe(Y,"classrooms"),mt("professorId","==",t.uid)),me=pt(Q,ue=>{const Ne=ue.docs.map(_e=>{const ke=_e.data();return{id:_e.id,nome:ke.nome||"Sem nome",periodo:ke.periodo||""}}).sort((_e,ke)=>_e.nome.localeCompare(ke.nome,"pt-BR"));C(Ne)},()=>{C([])});return()=>{me()}},[e,t==null?void 0:t.uid]),D.useEffect(()=>{if(!Y||e!=="teacher"||A.length===0)return x({}),_(!1),()=>{};const Q=A.map(Ne=>Ne.id),me=Lt(Fe(Y,"students"),mt("turmaId","in",Q)),ue=pt(me,Ne=>{const _e={};Ne.docs.forEach(ke=>{const Ve=ke.data();_e[ke.id]={id:ke.id,turmaId:Ve.turmaId||"",name:Ve.nome||"Sem nome",status:"pending",avatar:Ve.fotoUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(Ve.nome||"Aluno")}&background=e2e8f0&color=0f172a`}}),x(_e),_(!1)},Ne=>{x({}),_(!1)});return()=>{ue()}},[e,A,Y]),D.useEffect(()=>{if(!Y||e!=="teacher"||A.length===0)return()=>{};const Q=A.map(_e=>_e.id),me=new Date().toISOString().split("T")[0],ue=Lt(Fe(Y,"cadernetaEntries"),mt("turmaId","in",Q),mt("date","==",me)),Ne=pt(ue,_e=>{x(ke=>{const Ve={...ke};return Object.keys(Ve).forEach(kt=>{Ve[kt].status="pending"}),_e.docs.forEach(kt=>{const zn=kt.data();Ve[zn.studentId]&&(Ve[zn.studentId].status=zn.status||"sent")}),Ve})});return()=>{Ne()}},[e,A,Y]),D.useEffect(()=>{const Q=()=>{E("syncing"),y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{E("online")},1500)},me=()=>{y.current&&clearTimeout(y.current),E("offline")};return window.addEventListener("online",Q),window.addEventListener("offline",me),()=>{window.removeEventListener("online",Q),window.removeEventListener("offline",me),y.current&&clearTimeout(y.current)}},[]),!t)return u.jsx(ZL,{});const b=Q=>{d(Q),a("diario")},N=Q=>{m(Q),a("aluno")},I=(Q,me)=>{x(ue=>({...ue,[Q]:{...ue[Q],status:me}}))},R=()=>o==="dashboard"?u.jsx(Ow,{onOpenTurma:b,turmas:A,studentsStatus:p,carregando:k}):o==="diario"&&c?u.jsx(KL,{turma:c,studentsStatus:p,onBack:()=>a("dashboard"),onOpenStudent:N}):o==="aluno"&&h?u.jsx(WL,{student:p[h],turma:c,onBack:()=>a("diario"),onUpdateStatus:Q=>I(h,Q)}):u.jsx(Ow,{onOpenTurma:b,turmas:A,studentsStatus:p,carregando:k}),S=()=>{if(s==="perfil")return u.jsx(v3,{});if(e==="admin")return s==="admin-dashboard"?u.jsx(s3,{}):s==="admin-calendar"?u.jsx(o3,{}):s==="admin-professores"?u.jsx(h3,{}):s==="admin-responsaveis"?u.jsx(p3,{}):s==="admin-alunos"?u.jsx(qw,{}):s==="admin-turmas"?u.jsx(g3,{}):u.jsx(qw,{});if(e==="parent")return s==="calendario"?u.jsx(Vw,{}):s==="comunicacao"?u.jsx(Fw,{}):u.jsx(r3,{});switch(s){case"caderneta":return R();case"calendario":return u.jsx(Vw,{});case"comunicacao":return u.jsx(Fw,{});default:return R()}},ie=Q=>{i(Q),w(!1),j(!1),Q==="caderneta"&&a("dashboard")},le=()=>{i("perfil"),w(!1),j(!1)},W=()=>e==="admin"?"Viso Geral":e==="parent"?"Incio":"Dashboard",we=e==="admin"?[{id:"admin-dashboard",label:"Dashboard",icon:fp},{id:"admin-calendar",label:"Calendrio",icon:fp},{id:"admin-professores",label:"Professores",icon:Zr},{id:"admin-turmas",label:"Turmas",icon:c1},{id:"admin-responsaveis",label:"Responsveis",icon:$l},{id:"admin-alunos",label:"Alunos",icon:fl}]:e==="parent"?[{id:"parent-inicio",label:W(),icon:fl},{id:"comunicacao",label:"Mensagens",icon:E0}]:[{id:"caderneta",label:W(),icon:fl},{id:"comunicacao",label:"Mensagens",icon:E0}],$=(n==null?void 0:n.nome)||(t==null?void 0:t.displayName)||"Usurio",F=(n==null?void 0:n.email)||(t==null?void 0:t.email)||"",K=(n==null?void 0:n.avatarUrl)||"",J=L==="offline"?{label:"Offline",className:"bg-red-50 text-red-600 border-red-200",dotClassName:"bg-red-500"}:L==="syncing"?{label:"Sincronizando...",className:"bg-amber-50 text-amber-700 border-amber-200",dotClassName:"bg-amber-500"}:{label:"Online",className:"bg-emerald-50 text-emerald-700 border-emerald-200",dotClassName:"bg-emerald-500"};return u.jsxs("div",{className:"flex h-screen overflow-hidden bg-bg-app",children:[u.jsx(OV,{position:"top-right"}),v&&u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>w(!1)}),u.jsxs("div",{className:"lg:hidden fixed top-0 w-full h-16 bg-white border-b border-slate-200 flex items-center justify-between px-4 z-50",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>j(Q=>!Q),className:"w-9 h-9 rounded-lg border border-slate-200 bg-white text-slate-600 inline-flex items-center justify-center","aria-label":P?"Fechar menu":"Abrir menu",children:P?u.jsx(Tr,{size:18}):u.jsx(pk,{size:18})}),u.jsx("img",{src:"/pwa-192x192.png",alt:"Verdy",className:"w-8 h-8 rounded-lg object-cover shadow-sm"}),u.jsx("span",{className:"font-bold text-slate-800 tracking-tight",children:"Verdy"})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:`hidden sm:inline-flex items-center gap-1.5 px-2 py-1 rounded-full border text-[11px] font-medium ${J.className}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${J.dotClassName}`}),J.label]}),u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:()=>w(Q=>!Q),className:"w-9 h-9 rounded-full bg-slate-100 border border-slate-200 overflow-hidden flex items-center justify-center text-slate-500",children:K?u.jsx("img",{src:K,alt:$,className:"w-full h-full object-cover"}):u.jsx(Zr,{size:18})}),v&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-56 rounded-xl border border-slate-200 bg-white shadow-lg p-2 z-20",children:[u.jsxs("div",{className:"px-3 py-2 border-b border-slate-100 mb-1",children:[u.jsx("div",{className:"text-xs font-semibold text-slate-800 truncate",children:$}),u.jsx("div",{className:"text-[11px] text-slate-500 truncate",children:F||"Conta ativa"})]}),u.jsxs("button",{onClick:()=>{w(!1),le()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-700 hover:bg-slate-50",children:[u.jsx(Zr,{size:16}),"Meu perfil"]}),u.jsxs("button",{onClick:()=>{w(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50",children:[u.jsx(w0,{size:16}),"Sair do sistema"]})]})]})]})]}),P&&u.jsxs("div",{className:"lg:hidden fixed inset-0 z-40",children:[u.jsx("button",{onClick:()=>j(!1),className:"absolute inset-0 bg-slate-900/40","aria-label":"Fechar menu"}),u.jsxs("aside",{className:"absolute left-0 top-0 h-full w-full bg-white border-r border-slate-200 p-5 flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("img",{src:"/pwa-192x192.png",alt:"Verdy",className:"w-8 h-8 rounded-lg object-cover shadow-sm"}),u.jsx("span",{className:"font-bold text-slate-800 tracking-tight",children:"Verdy"})]}),u.jsx("button",{onClick:()=>j(!1),className:"w-8 h-8 rounded-lg border border-slate-200 text-slate-600 inline-flex items-center justify-center","aria-label":"Fechar menu",children:u.jsx(Tr,{size:16})})]}),u.jsx("nav",{className:"flex flex-col gap-2",children:we.map(Q=>u.jsxs("button",{onClick:()=>ie(Q.id),className:`flex items-center gap-3 w-full text-left px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${s===Q.id?"bg-primary text-white":"text-slate-600 hover:bg-slate-50"}`,children:[u.jsx(Q.icon,{size:18}),Q.label]},Q.id))})]})]}),u.jsxs("aside",{className:"hidden lg:flex w-[280px] bg-white border-r border-slate-200 flex-col p-6 z-10 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-10 mt-2",children:[u.jsx("img",{src:"/pwa-192x192.png",alt:"Colgio Verdy",className:"w-10 h-10 rounded-xl object-cover shadow-md"}),u.jsx("h2",{className:"font-bold text-2xl text-slate-800 tracking-tight",children:"Colgio Verdy"})]}),u.jsx("nav",{className:"flex flex-col gap-2 flex-1 mt-4",children:we.map(Q=>u.jsxs("button",{onClick:()=>ie(Q.id),className:`flex items-center gap-3 w-full text-left px-4 py-3.5 rounded-xl font-medium text-[15px] transition-all ${s===Q.id?"bg-primary text-white shadow-md":"text-slate-500 hover:bg-slate-50 hover:text-primary"}`,children:[u.jsx(Q.icon,{size:20}),Q.label]},Q.id))})]}),u.jsxs("main",{className:"flex-1 flex flex-col pt-16 lg:pt-0 overflow-hidden relative",children:[u.jsx("header",{className:"hidden lg:flex h-20 items-center justify-between px-8 bg-white border-b border-slate-200 shrink-0",children:u.jsxs("div",{className:"flex ml-auto items-center gap-6",children:[u.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-xs font-medium ${J.className}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${J.dotClassName}`}),J.label]}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>w(Q=>!Q),className:"flex items-center gap-3 select-none hover:bg-slate-50 rounded-xl px-2 py-1.5 transition-colors",children:[u.jsx("div",{className:"w-11 h-11 rounded-full bg-slate-100 border-2 border-white shadow-sm overflow-hidden flex items-center justify-center text-slate-500",children:K?u.jsx("img",{src:K,alt:$,className:"w-full h-full object-cover"}):u.jsx(Zr,{size:20})}),u.jsxs("div",{className:"flex flex-col text-left",children:[u.jsx("span",{className:"font-semibold text-sm text-slate-800 uppercase",children:$}),u.jsx("span",{className:"text-xs text-slate-500 truncate max-w-[180px]",children:F||"Conta ativa"})]}),u.jsx(uk,{size:16,className:`text-slate-400 transition-transform ${v?"rotate-180":""}`})]}),v&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-56 rounded-xl border border-slate-200 bg-white shadow-lg p-2 z-20",children:[u.jsxs("button",{onClick:()=>{w(!1),le()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-700 hover:bg-slate-50",children:[u.jsx(Zr,{size:16}),"Meu perfil"]}),u.jsxs("button",{onClick:()=>{w(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50",children:[u.jsx(w0,{size:16}),"Sair do sistema"]})]})]})]})}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 lg:p-8 pb-8",children:S()})]})]})}function x3(){return u.jsx(XL,{children:u.jsx(_3,{})})}ok({immediate:!0,onNeedRefresh(){window.location.reload()},onOfflineReady(){}});_m.createRoot(document.getElementById("root")).render(u.jsx(HA.StrictMode,{children:u.jsx(x3,{})}));
