(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function $b(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ow={exports:{}},Rd={},aw={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kl=Symbol.for("react.element"),qb=Symbol.for("react.portal"),Hb=Symbol.for("react.fragment"),Gb=Symbol.for("react.strict_mode"),Kb=Symbol.for("react.profiler"),Wb=Symbol.for("react.provider"),Qb=Symbol.for("react.context"),Yb=Symbol.for("react.forward_ref"),Jb=Symbol.for("react.suspense"),Xb=Symbol.for("react.memo"),Zb=Symbol.for("react.lazy"),bv=Symbol.iterator;function eA(t){return t===null||typeof t!="object"?null:(t=bv&&t[bv]||t["@@iterator"],typeof t=="function"?t:null)}var lw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cw=Object.assign,uw={};function Wo(t,e,n){this.props=t,this.context=e,this.refs=uw,this.updater=n||lw}Wo.prototype.isReactComponent={};Wo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function dw(){}dw.prototype=Wo.prototype;function Np(t,e,n){this.props=t,this.context=e,this.refs=uw,this.updater=n||lw}var Cp=Np.prototype=new dw;Cp.constructor=Np;cw(Cp,Wo.prototype);Cp.isPureReactComponent=!0;var Av=Array.isArray,hw=Object.prototype.hasOwnProperty,kp={current:null},fw={key:!0,ref:!0,__self:!0,__source:!0};function mw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)hw.call(e,r)&&!fw.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Kl,type:t,key:i,ref:o,props:s,_owner:kp.current}}function tA(t,e){return{$$typeof:Kl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Rp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Kl}function nA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Nv=/\/+/g;function Bh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?nA(""+t.key):e.toString(36)}function tu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Kl:case qb:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Bh(o,0):r,Av(s)?(n="",t!=null&&(n=t.replace(Nv,"$&/")+"/"),tu(s,e,n,"",function(d){return d})):s!=null&&(Rp(s)&&(s=tA(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Nv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Av(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+Bh(i,a);o+=tu(i,e,n,c,s)}else if(c=eA(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+Bh(i,a++),o+=tu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function bc(t,e,n){if(t==null)return t;var r=[],s=0;return tu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function rA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ut={current:null},nu={transition:null},sA={ReactCurrentDispatcher:Ut,ReactCurrentBatchConfig:nu,ReactCurrentOwner:kp};function pw(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:bc,forEach:function(t,e,n){bc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return bc(t,function(){e++}),e},toArray:function(t){return bc(t,function(e){return e})||[]},only:function(t){if(!Rp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};_e.Component=Wo;_e.Fragment=Hb;_e.Profiler=Kb;_e.PureComponent=Np;_e.StrictMode=Gb;_e.Suspense=Jb;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sA;_e.act=pw;_e.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=cw({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=kp.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)hw.call(e,c)&&!fw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:Kl,type:t.type,key:s,ref:i,props:r,_owner:o}};_e.createContext=function(t){return t={$$typeof:Qb,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Wb,_context:t},t.Consumer=t};_e.createElement=mw;_e.createFactory=function(t){var e=mw.bind(null,t);return e.type=t,e};_e.createRef=function(){return{current:null}};_e.forwardRef=function(t){return{$$typeof:Yb,render:t}};_e.isValidElement=Rp;_e.lazy=function(t){return{$$typeof:Zb,_payload:{_status:-1,_result:t},_init:rA}};_e.memo=function(t,e){return{$$typeof:Xb,type:t,compare:e===void 0?null:e}};_e.startTransition=function(t){var e=nu.transition;nu.transition={};try{t()}finally{nu.transition=e}};_e.unstable_act=pw;_e.useCallback=function(t,e){return Ut.current.useCallback(t,e)};_e.useContext=function(t){return Ut.current.useContext(t)};_e.useDebugValue=function(){};_e.useDeferredValue=function(t){return Ut.current.useDeferredValue(t)};_e.useEffect=function(t,e){return Ut.current.useEffect(t,e)};_e.useId=function(){return Ut.current.useId()};_e.useImperativeHandle=function(t,e,n){return Ut.current.useImperativeHandle(t,e,n)};_e.useInsertionEffect=function(t,e){return Ut.current.useInsertionEffect(t,e)};_e.useLayoutEffect=function(t,e){return Ut.current.useLayoutEffect(t,e)};_e.useMemo=function(t,e){return Ut.current.useMemo(t,e)};_e.useReducer=function(t,e,n){return Ut.current.useReducer(t,e,n)};_e.useRef=function(t){return Ut.current.useRef(t)};_e.useState=function(t){return Ut.current.useState(t)};_e.useSyncExternalStore=function(t,e,n){return Ut.current.useSyncExternalStore(t,e,n)};_e.useTransition=function(){return Ut.current.useTransition()};_e.version="18.3.1";aw.exports=_e;var V=aw.exports;const iA=$b(V);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oA=V,aA=Symbol.for("react.element"),lA=Symbol.for("react.fragment"),cA=Object.prototype.hasOwnProperty,uA=oA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dA={key:!0,ref:!0,__self:!0,__source:!0};function gw(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)cA.call(e,r)&&!dA.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:aA,type:t,key:i,ref:o,props:s,_owner:uA.current}}Rd.Fragment=lA;Rd.jsx=gw;Rd.jsxs=gw;ow.exports=Rd;var u=ow.exports,Wf={},yw={exports:{}},un={},vw={exports:{}},_w={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,O){var K=$.length;$.push(O);e:for(;0<K;){var Q=K-1>>>1,ue=$[Q];if(0<s(ue,O))$[Q]=O,$[K]=ue,K=Q;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var O=$[0],K=$.pop();if(K!==O){$[0]=K;e:for(var Q=0,ue=$.length,Z=ue>>>1;Q<Z;){var le=2*(Q+1)-1,Ae=$[le],Ie=le+1,De=$[Ie];if(0>s(Ae,K))Ie<ue&&0>s(De,Ae)?($[Q]=De,$[Ie]=K,Q=Ie):($[Q]=Ae,$[le]=K,Q=le);else if(Ie<ue&&0>s(De,K))$[Q]=De,$[Ie]=K,Q=Ie;else break e}}return O}function s($,O){var K=$.sortIndex-O.sortIndex;return K!==0?K:$.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,m=null,g=3,x=!1,T=!1,k=!1,D=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A($){for(var O=n(d);O!==null;){if(O.callback===null)r(d);else if(O.startTime<=$)r(d),O.sortIndex=O.expirationTime,e(c,O);else break;O=n(d)}}function P($){if(k=!1,A($),!T)if(n(c)!==null)T=!0,G(M);else{var O=n(d);O!==null&&Ee(P,O.startTime-$)}}function M($,O){T=!1,k&&(k=!1,b(y),y=-1),x=!0;var K=g;try{for(A(O),m=n(c);m!==null&&(!(m.expirationTime>O)||$&&!_());){var Q=m.callback;if(typeof Q=="function"){m.callback=null,g=m.priorityLevel;var ue=Q(m.expirationTime<=O);O=t.unstable_now(),typeof ue=="function"?m.callback=ue:m===n(c)&&r(c),A(O)}else r(c);m=n(c)}if(m!==null)var Z=!0;else{var le=n(d);le!==null&&Ee(P,le.startTime-O),Z=!1}return Z}finally{m=null,g=K,x=!1}}var B=!1,w=null,y=-1,S=5,N=-1;function _(){return!(t.unstable_now()-N<S)}function C(){if(w!==null){var $=t.unstable_now();N=$;var O=!0;try{O=w(!0,$)}finally{O?I():(B=!1,w=null)}}else B=!1}var I;if(typeof E=="function")I=function(){E(C)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ae=se.port2;se.port1.onmessage=C,I=function(){ae.postMessage(null)}}else I=function(){D(C,0)};function G($){w=$,B||(B=!0,I())}function Ee($,O){y=D(function(){$(t.unstable_now())},O)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){T||x||(T=!0,G(M))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function($){switch(g){case 1:case 2:case 3:var O=3;break;default:O=g}var K=g;g=O;try{return $()}finally{g=K}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,O){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var K=g;g=$;try{return O()}finally{g=K}},t.unstable_scheduleCallback=function($,O,K){var Q=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?Q+K:Q):K=Q,$){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=K+ue,$={id:h++,callback:O,priorityLevel:$,startTime:K,expirationTime:ue,sortIndex:-1},K>Q?($.sortIndex=K,e(d,$),n(c)===null&&$===n(d)&&(k?(b(y),y=-1):k=!0,Ee(P,K-Q))):($.sortIndex=ue,e(c,$),T||x||(T=!0,G(M))),$},t.unstable_shouldYield=_,t.unstable_wrapCallback=function($){var O=g;return function(){var K=g;g=O;try{return $.apply(this,arguments)}finally{g=K}}}})(_w);vw.exports=_w;var hA=vw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fA=V,ln=hA;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xw=new Set,yl={};function wi(t,e){yo(t,e),yo(t+"Capture",e)}function yo(t,e){for(yl[t]=e,t=0;t<e.length;t++)xw.add(e[t])}var dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qf=Object.prototype.hasOwnProperty,mA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cv={},kv={};function pA(t){return Qf.call(kv,t)?!0:Qf.call(Cv,t)?!1:mA.test(t)?kv[t]=!0:(Cv[t]=!0,!1)}function gA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yA(t,e,n,r){if(e===null||typeof e>"u"||gA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function zt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var It={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){It[t]=new zt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];It[e]=new zt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){It[t]=new zt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){It[t]=new zt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){It[t]=new zt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){It[t]=new zt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){It[t]=new zt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){It[t]=new zt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){It[t]=new zt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Pp=/[\-:]([a-z])/g;function Dp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Pp,Dp);It[e]=new zt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Pp,Dp);It[e]=new zt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Pp,Dp);It[e]=new zt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){It[t]=new zt(t,1,!1,t.toLowerCase(),null,!1,!1)});It.xlinkHref=new zt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){It[t]=new zt(t,1,!1,t.toLowerCase(),null,!0,!0)});function jp(t,e,n,r){var s=It.hasOwnProperty(e)?It[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yA(e,n,s,r)&&(n=null),r||s===null?pA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var wr=fA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ac=Symbol.for("react.element"),Hi=Symbol.for("react.portal"),Gi=Symbol.for("react.fragment"),Vp=Symbol.for("react.strict_mode"),Yf=Symbol.for("react.profiler"),ww=Symbol.for("react.provider"),Ew=Symbol.for("react.context"),Mp=Symbol.for("react.forward_ref"),Jf=Symbol.for("react.suspense"),Xf=Symbol.for("react.suspense_list"),Op=Symbol.for("react.memo"),Lr=Symbol.for("react.lazy"),Iw=Symbol.for("react.offscreen"),Rv=Symbol.iterator;function _a(t){return t===null||typeof t!="object"?null:(t=Rv&&t[Rv]||t["@@iterator"],typeof t=="function"?t:null)}var We=Object.assign,$h;function Oa(t){if($h===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);$h=e&&e[1]||""}return`
`+$h+t}var qh=!1;function Hh(t,e){if(!t||qh)return"";qh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{qh=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oa(t):""}function vA(t){switch(t.tag){case 5:return Oa(t.type);case 16:return Oa("Lazy");case 13:return Oa("Suspense");case 19:return Oa("SuspenseList");case 0:case 2:case 15:return t=Hh(t.type,!1),t;case 11:return t=Hh(t.type.render,!1),t;case 1:return t=Hh(t.type,!0),t;default:return""}}function Zf(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Gi:return"Fragment";case Hi:return"Portal";case Yf:return"Profiler";case Vp:return"StrictMode";case Jf:return"Suspense";case Xf:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ew:return(t.displayName||"Context")+".Consumer";case ww:return(t._context.displayName||"Context")+".Provider";case Mp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Op:return e=t.displayName||null,e!==null?e:Zf(t.type)||"Memo";case Lr:e=t._payload,t=t._init;try{return Zf(t(e))}catch{}}return null}function _A(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zf(e);case 8:return e===Vp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function us(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Tw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xA(t){var e=Tw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Nc(t){t._valueTracker||(t._valueTracker=xA(t))}function Sw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Tw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function ku(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function em(t,e){var n=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Pv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=us(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function bw(t,e){e=e.checked,e!=null&&jp(t,"checked",e,!1)}function tm(t,e){bw(t,e);var n=us(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?nm(t,e.type,n):e.hasOwnProperty("defaultValue")&&nm(t,e.type,us(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Dv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function nm(t,e,n){(e!=="number"||ku(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var La=Array.isArray;function so(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+us(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function rm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function jv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if(La(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:us(n)}}function Aw(t,e){var n=us(e.value),r=us(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Vv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Nw(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Nw(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Cc,Cw=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Cc=Cc||document.createElement("div"),Cc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Cc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Qa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wA=["Webkit","ms","Moz","O"];Object.keys(Qa).forEach(function(t){wA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Qa[e]=Qa[t]})});function kw(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Qa.hasOwnProperty(t)&&Qa[t]?(""+e).trim():e+"px"}function Rw(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=kw(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var EA=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function im(t,e){if(e){if(EA[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function om(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var am=null;function Lp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var lm=null,io=null,oo=null;function Mv(t){if(t=Yl(t)){if(typeof lm!="function")throw Error(H(280));var e=t.stateNode;e&&(e=Md(e),lm(t.stateNode,t.type,e))}}function Pw(t){io?oo?oo.push(t):oo=[t]:io=t}function Dw(){if(io){var t=io,e=oo;if(oo=io=null,Mv(t),e)for(t=0;t<e.length;t++)Mv(e[t])}}function jw(t,e){return t(e)}function Vw(){}var Gh=!1;function Mw(t,e,n){if(Gh)return t(e,n);Gh=!0;try{return jw(t,e,n)}finally{Gh=!1,(io!==null||oo!==null)&&(Vw(),Dw())}}function _l(t,e){var n=t.stateNode;if(n===null)return null;var r=Md(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var cm=!1;if(dr)try{var xa={};Object.defineProperty(xa,"passive",{get:function(){cm=!0}}),window.addEventListener("test",xa,xa),window.removeEventListener("test",xa,xa)}catch{cm=!1}function IA(t,e,n,r,s,i,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var Ya=!1,Ru=null,Pu=!1,um=null,TA={onError:function(t){Ya=!0,Ru=t}};function SA(t,e,n,r,s,i,o,a,c){Ya=!1,Ru=null,IA.apply(TA,arguments)}function bA(t,e,n,r,s,i,o,a,c){if(SA.apply(this,arguments),Ya){if(Ya){var d=Ru;Ya=!1,Ru=null}else throw Error(H(198));Pu||(Pu=!0,um=d)}}function Ei(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ow(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Ov(t){if(Ei(t)!==t)throw Error(H(188))}function AA(t){var e=t.alternate;if(!e){if(e=Ei(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Ov(s),t;if(i===r)return Ov(s),e;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function Lw(t){return t=AA(t),t!==null?Fw(t):null}function Fw(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Fw(t);if(e!==null)return e;t=t.sibling}return null}var Uw=ln.unstable_scheduleCallback,Lv=ln.unstable_cancelCallback,NA=ln.unstable_shouldYield,CA=ln.unstable_requestPaint,tt=ln.unstable_now,kA=ln.unstable_getCurrentPriorityLevel,Fp=ln.unstable_ImmediatePriority,zw=ln.unstable_UserBlockingPriority,Du=ln.unstable_NormalPriority,RA=ln.unstable_LowPriority,Bw=ln.unstable_IdlePriority,Pd=null,Kn=null;function PA(t){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(Pd,t,void 0,(t.current.flags&128)===128)}catch{}}var An=Math.clz32?Math.clz32:VA,DA=Math.log,jA=Math.LN2;function VA(t){return t>>>=0,t===0?32:31-(DA(t)/jA|0)|0}var kc=64,Rc=4194304;function Fa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ju(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Fa(a):(i&=o,i!==0&&(r=Fa(i)))}else o=n&~s,o!==0?r=Fa(o):i!==0&&(r=Fa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-An(e),s=1<<n,r|=t[n],e&=~s;return r}function MA(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function OA(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-An(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=MA(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function dm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $w(){var t=kc;return kc<<=1,!(kc&4194240)&&(kc=64),t}function Kh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Wl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-An(e),t[e]=n}function LA(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-An(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Up(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-An(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ke=0;function qw(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Hw,zp,Gw,Kw,Ww,hm=!1,Pc=[],Jr=null,Xr=null,Zr=null,xl=new Map,wl=new Map,Ur=[],FA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fv(t,e){switch(t){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":Xr=null;break;case"mouseover":case"mouseout":Zr=null;break;case"pointerover":case"pointerout":xl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":wl.delete(e.pointerId)}}function wa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Yl(e),e!==null&&zp(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function UA(t,e,n,r,s){switch(e){case"focusin":return Jr=wa(Jr,t,e,n,r,s),!0;case"dragenter":return Xr=wa(Xr,t,e,n,r,s),!0;case"mouseover":return Zr=wa(Zr,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return xl.set(i,wa(xl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,wl.set(i,wa(wl.get(i)||null,t,e,n,r,s)),!0}return!1}function Qw(t){var e=Gs(t.target);if(e!==null){var n=Ei(e);if(n!==null){if(e=n.tag,e===13){if(e=Ow(n),e!==null){t.blockedOn=e,Ww(t.priority,function(){Gw(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ru(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=fm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);am=r,n.target.dispatchEvent(r),am=null}else return e=Yl(n),e!==null&&zp(e),t.blockedOn=n,!1;e.shift()}return!0}function Uv(t,e,n){ru(t)&&n.delete(e)}function zA(){hm=!1,Jr!==null&&ru(Jr)&&(Jr=null),Xr!==null&&ru(Xr)&&(Xr=null),Zr!==null&&ru(Zr)&&(Zr=null),xl.forEach(Uv),wl.forEach(Uv)}function Ea(t,e){t.blockedOn===e&&(t.blockedOn=null,hm||(hm=!0,ln.unstable_scheduleCallback(ln.unstable_NormalPriority,zA)))}function El(t){function e(s){return Ea(s,t)}if(0<Pc.length){Ea(Pc[0],t);for(var n=1;n<Pc.length;n++){var r=Pc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Jr!==null&&Ea(Jr,t),Xr!==null&&Ea(Xr,t),Zr!==null&&Ea(Zr,t),xl.forEach(e),wl.forEach(e),n=0;n<Ur.length;n++)r=Ur[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ur.length&&(n=Ur[0],n.blockedOn===null);)Qw(n),n.blockedOn===null&&Ur.shift()}var ao=wr.ReactCurrentBatchConfig,Vu=!0;function BA(t,e,n,r){var s=ke,i=ao.transition;ao.transition=null;try{ke=1,Bp(t,e,n,r)}finally{ke=s,ao.transition=i}}function $A(t,e,n,r){var s=ke,i=ao.transition;ao.transition=null;try{ke=4,Bp(t,e,n,r)}finally{ke=s,ao.transition=i}}function Bp(t,e,n,r){if(Vu){var s=fm(t,e,n,r);if(s===null)rf(t,e,r,Mu,n),Fv(t,r);else if(UA(s,t,e,n,r))r.stopPropagation();else if(Fv(t,r),e&4&&-1<FA.indexOf(t)){for(;s!==null;){var i=Yl(s);if(i!==null&&Hw(i),i=fm(t,e,n,r),i===null&&rf(t,e,r,Mu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else rf(t,e,r,null,n)}}var Mu=null;function fm(t,e,n,r){if(Mu=null,t=Lp(r),t=Gs(t),t!==null)if(e=Ei(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ow(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Mu=t,null}function Yw(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kA()){case Fp:return 1;case zw:return 4;case Du:case RA:return 16;case Bw:return 536870912;default:return 16}default:return 16}}var Wr=null,$p=null,su=null;function Jw(){if(su)return su;var t,e=$p,n=e.length,r,s="value"in Wr?Wr.value:Wr.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return su=s.slice(t,1<r?1-r:void 0)}function iu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Dc(){return!0}function zv(){return!1}function dn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Dc:zv,this.isPropagationStopped=zv,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Dc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Dc)},persist:function(){},isPersistent:Dc}),e}var Qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qp=dn(Qo),Ql=We({},Qo,{view:0,detail:0}),qA=dn(Ql),Wh,Qh,Ia,Dd=We({},Ql,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ia&&(Ia&&t.type==="mousemove"?(Wh=t.screenX-Ia.screenX,Qh=t.screenY-Ia.screenY):Qh=Wh=0,Ia=t),Wh)},movementY:function(t){return"movementY"in t?t.movementY:Qh}}),Bv=dn(Dd),HA=We({},Dd,{dataTransfer:0}),GA=dn(HA),KA=We({},Ql,{relatedTarget:0}),Yh=dn(KA),WA=We({},Qo,{animationName:0,elapsedTime:0,pseudoElement:0}),QA=dn(WA),YA=We({},Qo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),JA=dn(YA),XA=We({},Qo,{data:0}),$v=dn(XA),ZA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=tN[t])?!!e[t]:!1}function Hp(){return nN}var rN=We({},Ql,{key:function(t){if(t.key){var e=ZA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=iu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hp,charCode:function(t){return t.type==="keypress"?iu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?iu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sN=dn(rN),iN=We({},Dd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),qv=dn(iN),oN=We({},Ql,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hp}),aN=dn(oN),lN=We({},Qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),cN=dn(lN),uN=We({},Dd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dN=dn(uN),hN=[9,13,27,32],Gp=dr&&"CompositionEvent"in window,Ja=null;dr&&"documentMode"in document&&(Ja=document.documentMode);var fN=dr&&"TextEvent"in window&&!Ja,Xw=dr&&(!Gp||Ja&&8<Ja&&11>=Ja),Hv=" ",Gv=!1;function Zw(t,e){switch(t){case"keyup":return hN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function eE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ki=!1;function mN(t,e){switch(t){case"compositionend":return eE(e);case"keypress":return e.which!==32?null:(Gv=!0,Hv);case"textInput":return t=e.data,t===Hv&&Gv?null:t;default:return null}}function pN(t,e){if(Ki)return t==="compositionend"||!Gp&&Zw(t,e)?(t=Jw(),su=$p=Wr=null,Ki=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Xw&&e.locale!=="ko"?null:e.data;default:return null}}var gN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gN[t.type]:e==="textarea"}function tE(t,e,n,r){Pw(r),e=Ou(e,"onChange"),0<e.length&&(n=new qp("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Xa=null,Il=null;function yN(t){hE(t,0)}function jd(t){var e=Yi(t);if(Sw(e))return t}function vN(t,e){if(t==="change")return e}var nE=!1;if(dr){var Jh;if(dr){var Xh="oninput"in document;if(!Xh){var Wv=document.createElement("div");Wv.setAttribute("oninput","return;"),Xh=typeof Wv.oninput=="function"}Jh=Xh}else Jh=!1;nE=Jh&&(!document.documentMode||9<document.documentMode)}function Qv(){Xa&&(Xa.detachEvent("onpropertychange",rE),Il=Xa=null)}function rE(t){if(t.propertyName==="value"&&jd(Il)){var e=[];tE(e,Il,t,Lp(t)),Mw(yN,e)}}function _N(t,e,n){t==="focusin"?(Qv(),Xa=e,Il=n,Xa.attachEvent("onpropertychange",rE)):t==="focusout"&&Qv()}function xN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jd(Il)}function wN(t,e){if(t==="click")return jd(e)}function EN(t,e){if(t==="input"||t==="change")return jd(e)}function IN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Rn=typeof Object.is=="function"?Object.is:IN;function Tl(t,e){if(Rn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Qf.call(e,s)||!Rn(t[s],e[s]))return!1}return!0}function Yv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jv(t,e){var n=Yv(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Yv(n)}}function sE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?sE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iE(){for(var t=window,e=ku();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=ku(t.document)}return e}function Kp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function TN(t){var e=iE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&sE(n.ownerDocument.documentElement,n)){if(r!==null&&Kp(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Jv(n,i);var o=Jv(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var SN=dr&&"documentMode"in document&&11>=document.documentMode,Wi=null,mm=null,Za=null,pm=!1;function Xv(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;pm||Wi==null||Wi!==ku(r)||(r=Wi,"selectionStart"in r&&Kp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Za&&Tl(Za,r)||(Za=r,r=Ou(mm,"onSelect"),0<r.length&&(e=new qp("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Wi)))}function jc(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Qi={animationend:jc("Animation","AnimationEnd"),animationiteration:jc("Animation","AnimationIteration"),animationstart:jc("Animation","AnimationStart"),transitionend:jc("Transition","TransitionEnd")},Zh={},oE={};dr&&(oE=document.createElement("div").style,"AnimationEvent"in window||(delete Qi.animationend.animation,delete Qi.animationiteration.animation,delete Qi.animationstart.animation),"TransitionEvent"in window||delete Qi.transitionend.transition);function Vd(t){if(Zh[t])return Zh[t];if(!Qi[t])return t;var e=Qi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in oE)return Zh[t]=e[n];return t}var aE=Vd("animationend"),lE=Vd("animationiteration"),cE=Vd("animationstart"),uE=Vd("transitionend"),dE=new Map,Zv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ws(t,e){dE.set(t,e),wi(e,[t])}for(var ef=0;ef<Zv.length;ef++){var tf=Zv[ef],bN=tf.toLowerCase(),AN=tf[0].toUpperCase()+tf.slice(1);ws(bN,"on"+AN)}ws(aE,"onAnimationEnd");ws(lE,"onAnimationIteration");ws(cE,"onAnimationStart");ws("dblclick","onDoubleClick");ws("focusin","onFocus");ws("focusout","onBlur");ws(uE,"onTransitionEnd");yo("onMouseEnter",["mouseout","mouseover"]);yo("onMouseLeave",["mouseout","mouseover"]);yo("onPointerEnter",["pointerout","pointerover"]);yo("onPointerLeave",["pointerout","pointerover"]);wi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));wi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));wi("onBeforeInput",["compositionend","keypress","textInput","paste"]);wi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));wi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));wi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NN=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ua));function e_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,bA(r,e,void 0,t),t.currentTarget=null}function hE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;e_(s,a,d),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;e_(s,a,d),i=c}}}if(Pu)throw t=um,Pu=!1,um=null,t}function Fe(t,e){var n=e[xm];n===void 0&&(n=e[xm]=new Set);var r=t+"__bubble";n.has(r)||(fE(e,t,2,!1),n.add(r))}function nf(t,e,n){var r=0;e&&(r|=4),fE(n,t,r,e)}var Vc="_reactListening"+Math.random().toString(36).slice(2);function Sl(t){if(!t[Vc]){t[Vc]=!0,xw.forEach(function(n){n!=="selectionchange"&&(NN.has(n)||nf(n,!1,t),nf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vc]||(e[Vc]=!0,nf("selectionchange",!1,e))}}function fE(t,e,n,r){switch(Yw(e)){case 1:var s=BA;break;case 4:s=$A;break;default:s=Bp}n=s.bind(null,e,n,t),s=void 0,!cm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function rf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Gs(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}Mw(function(){var d=i,h=Lp(n),m=[];e:{var g=dE.get(t);if(g!==void 0){var x=qp,T=t;switch(t){case"keypress":if(iu(n)===0)break e;case"keydown":case"keyup":x=sN;break;case"focusin":T="focus",x=Yh;break;case"focusout":T="blur",x=Yh;break;case"beforeblur":case"afterblur":x=Yh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Bv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=GA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=aN;break;case aE:case lE:case cE:x=QA;break;case uE:x=cN;break;case"scroll":x=qA;break;case"wheel":x=dN;break;case"copy":case"cut":case"paste":x=JA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=qv}var k=(e&4)!==0,D=!k&&t==="scroll",b=k?g!==null?g+"Capture":null:g;k=[];for(var E=d,A;E!==null;){A=E;var P=A.stateNode;if(A.tag===5&&P!==null&&(A=P,b!==null&&(P=_l(E,b),P!=null&&k.push(bl(E,P,A)))),D)break;E=E.return}0<k.length&&(g=new x(g,T,null,n,h),m.push({event:g,listeners:k}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",g&&n!==am&&(T=n.relatedTarget||n.fromElement)&&(Gs(T)||T[hr]))break e;if((x||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,x?(T=n.relatedTarget||n.toElement,x=d,T=T?Gs(T):null,T!==null&&(D=Ei(T),T!==D||T.tag!==5&&T.tag!==6)&&(T=null)):(x=null,T=d),x!==T)){if(k=Bv,P="onMouseLeave",b="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(k=qv,P="onPointerLeave",b="onPointerEnter",E="pointer"),D=x==null?g:Yi(x),A=T==null?g:Yi(T),g=new k(P,E+"leave",x,n,h),g.target=D,g.relatedTarget=A,P=null,Gs(h)===d&&(k=new k(b,E+"enter",T,n,h),k.target=A,k.relatedTarget=D,P=k),D=P,x&&T)t:{for(k=x,b=T,E=0,A=k;A;A=Di(A))E++;for(A=0,P=b;P;P=Di(P))A++;for(;0<E-A;)k=Di(k),E--;for(;0<A-E;)b=Di(b),A--;for(;E--;){if(k===b||b!==null&&k===b.alternate)break t;k=Di(k),b=Di(b)}k=null}else k=null;x!==null&&t_(m,g,x,k,!1),T!==null&&D!==null&&t_(m,D,T,k,!0)}}e:{if(g=d?Yi(d):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var M=vN;else if(Kv(g))if(nE)M=EN;else{M=xN;var B=_N}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(M=wN);if(M&&(M=M(t,d))){tE(m,M,n,h);break e}B&&B(t,g,d),t==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&nm(g,"number",g.value)}switch(B=d?Yi(d):window,t){case"focusin":(Kv(B)||B.contentEditable==="true")&&(Wi=B,mm=d,Za=null);break;case"focusout":Za=mm=Wi=null;break;case"mousedown":pm=!0;break;case"contextmenu":case"mouseup":case"dragend":pm=!1,Xv(m,n,h);break;case"selectionchange":if(SN)break;case"keydown":case"keyup":Xv(m,n,h)}var w;if(Gp)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Ki?Zw(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(Xw&&n.locale!=="ko"&&(Ki||y!=="onCompositionStart"?y==="onCompositionEnd"&&Ki&&(w=Jw()):(Wr=h,$p="value"in Wr?Wr.value:Wr.textContent,Ki=!0)),B=Ou(d,y),0<B.length&&(y=new $v(y,t,null,n,h),m.push({event:y,listeners:B}),w?y.data=w:(w=eE(n),w!==null&&(y.data=w)))),(w=fN?mN(t,n):pN(t,n))&&(d=Ou(d,"onBeforeInput"),0<d.length&&(h=new $v("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=w))}hE(m,e)})}function bl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ou(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=_l(t,n),i!=null&&r.unshift(bl(t,i,s)),i=_l(t,e),i!=null&&r.push(bl(t,i,s))),t=t.return}return r}function Di(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function t_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=_l(n,i),c!=null&&o.unshift(bl(n,c,a))):s||(c=_l(n,i),c!=null&&o.push(bl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var CN=/\r\n?/g,kN=/\u0000|\uFFFD/g;function n_(t){return(typeof t=="string"?t:""+t).replace(CN,`
`).replace(kN,"")}function Mc(t,e,n){if(e=n_(e),n_(t)!==e&&n)throw Error(H(425))}function Lu(){}var gm=null,ym=null;function vm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var _m=typeof setTimeout=="function"?setTimeout:void 0,RN=typeof clearTimeout=="function"?clearTimeout:void 0,r_=typeof Promise=="function"?Promise:void 0,PN=typeof queueMicrotask=="function"?queueMicrotask:typeof r_<"u"?function(t){return r_.resolve(null).then(t).catch(DN)}:_m;function DN(t){setTimeout(function(){throw t})}function sf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),El(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);El(e)}function es(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function s_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Yo=Math.random().toString(36).slice(2),$n="__reactFiber$"+Yo,Al="__reactProps$"+Yo,hr="__reactContainer$"+Yo,xm="__reactEvents$"+Yo,jN="__reactListeners$"+Yo,VN="__reactHandles$"+Yo;function Gs(t){var e=t[$n];if(e)return e;for(var n=t.parentNode;n;){if(e=n[hr]||n[$n]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=s_(t);t!==null;){if(n=t[$n])return n;t=s_(t)}return e}t=n,n=t.parentNode}return null}function Yl(t){return t=t[$n]||t[hr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function Md(t){return t[Al]||null}var wm=[],Ji=-1;function Es(t){return{current:t}}function Ue(t){0>Ji||(t.current=wm[Ji],wm[Ji]=null,Ji--)}function Me(t,e){Ji++,wm[Ji]=t.current,t.current=e}var ds={},Dt=Es(ds),Qt=Es(!1),ri=ds;function vo(t,e){var n=t.type.contextTypes;if(!n)return ds;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Yt(t){return t=t.childContextTypes,t!=null}function Fu(){Ue(Qt),Ue(Dt)}function i_(t,e,n){if(Dt.current!==ds)throw Error(H(168));Me(Dt,e),Me(Qt,n)}function mE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,_A(t)||"Unknown",s));return We({},n,r)}function Uu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ds,ri=Dt.current,Me(Dt,t),Me(Qt,Qt.current),!0}function o_(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=mE(t,e,ri),r.__reactInternalMemoizedMergedChildContext=t,Ue(Qt),Ue(Dt),Me(Dt,t)):Ue(Qt),Me(Qt,n)}var nr=null,Od=!1,of=!1;function pE(t){nr===null?nr=[t]:nr.push(t)}function MN(t){Od=!0,pE(t)}function Is(){if(!of&&nr!==null){of=!0;var t=0,e=ke;try{var n=nr;for(ke=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}nr=null,Od=!1}catch(s){throw nr!==null&&(nr=nr.slice(t+1)),Uw(Fp,Is),s}finally{ke=e,of=!1}}return null}var Xi=[],Zi=0,zu=null,Bu=0,hn=[],fn=0,si=null,rr=1,sr="";function Ms(t,e){Xi[Zi++]=Bu,Xi[Zi++]=zu,zu=t,Bu=e}function gE(t,e,n){hn[fn++]=rr,hn[fn++]=sr,hn[fn++]=si,si=t;var r=rr;t=sr;var s=32-An(r)-1;r&=~(1<<s),n+=1;var i=32-An(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,rr=1<<32-An(e)+s|n<<s|r,sr=i+t}else rr=1<<i|n<<s|r,sr=t}function Wp(t){t.return!==null&&(Ms(t,1),gE(t,1,0))}function Qp(t){for(;t===zu;)zu=Xi[--Zi],Xi[Zi]=null,Bu=Xi[--Zi],Xi[Zi]=null;for(;t===si;)si=hn[--fn],hn[fn]=null,sr=hn[--fn],hn[fn]=null,rr=hn[--fn],hn[fn]=null}var on=null,nn=null,Be=!1,Sn=null;function yE(t,e){var n=pn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function a_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,on=t,nn=es(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,on=t,nn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=si!==null?{id:rr,overflow:sr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=pn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,on=t,nn=null,!0):!1;default:return!1}}function Em(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Im(t){if(Be){var e=nn;if(e){var n=e;if(!a_(t,e)){if(Em(t))throw Error(H(418));e=es(n.nextSibling);var r=on;e&&a_(t,e)?yE(r,n):(t.flags=t.flags&-4097|2,Be=!1,on=t)}}else{if(Em(t))throw Error(H(418));t.flags=t.flags&-4097|2,Be=!1,on=t}}}function l_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;on=t}function Oc(t){if(t!==on)return!1;if(!Be)return l_(t),Be=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!vm(t.type,t.memoizedProps)),e&&(e=nn)){if(Em(t))throw vE(),Error(H(418));for(;e;)yE(t,e),e=es(e.nextSibling)}if(l_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){nn=es(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}nn=null}}else nn=on?es(t.stateNode.nextSibling):null;return!0}function vE(){for(var t=nn;t;)t=es(t.nextSibling)}function _o(){nn=on=null,Be=!1}function Yp(t){Sn===null?Sn=[t]:Sn.push(t)}var ON=wr.ReactCurrentBatchConfig;function Ta(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function Lc(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function c_(t){var e=t._init;return e(t._payload)}function _E(t){function e(b,E){if(t){var A=b.deletions;A===null?(b.deletions=[E],b.flags|=16):A.push(E)}}function n(b,E){if(!t)return null;for(;E!==null;)e(b,E),E=E.sibling;return null}function r(b,E){for(b=new Map;E!==null;)E.key!==null?b.set(E.key,E):b.set(E.index,E),E=E.sibling;return b}function s(b,E){return b=ss(b,E),b.index=0,b.sibling=null,b}function i(b,E,A){return b.index=A,t?(A=b.alternate,A!==null?(A=A.index,A<E?(b.flags|=2,E):A):(b.flags|=2,E)):(b.flags|=1048576,E)}function o(b){return t&&b.alternate===null&&(b.flags|=2),b}function a(b,E,A,P){return E===null||E.tag!==6?(E=ff(A,b.mode,P),E.return=b,E):(E=s(E,A),E.return=b,E)}function c(b,E,A,P){var M=A.type;return M===Gi?h(b,E,A.props.children,P,A.key):E!==null&&(E.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Lr&&c_(M)===E.type)?(P=s(E,A.props),P.ref=Ta(b,E,A),P.return=b,P):(P=hu(A.type,A.key,A.props,null,b.mode,P),P.ref=Ta(b,E,A),P.return=b,P)}function d(b,E,A,P){return E===null||E.tag!==4||E.stateNode.containerInfo!==A.containerInfo||E.stateNode.implementation!==A.implementation?(E=mf(A,b.mode,P),E.return=b,E):(E=s(E,A.children||[]),E.return=b,E)}function h(b,E,A,P,M){return E===null||E.tag!==7?(E=Js(A,b.mode,P,M),E.return=b,E):(E=s(E,A),E.return=b,E)}function m(b,E,A){if(typeof E=="string"&&E!==""||typeof E=="number")return E=ff(""+E,b.mode,A),E.return=b,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ac:return A=hu(E.type,E.key,E.props,null,b.mode,A),A.ref=Ta(b,null,E),A.return=b,A;case Hi:return E=mf(E,b.mode,A),E.return=b,E;case Lr:var P=E._init;return m(b,P(E._payload),A)}if(La(E)||_a(E))return E=Js(E,b.mode,A,null),E.return=b,E;Lc(b,E)}return null}function g(b,E,A,P){var M=E!==null?E.key:null;if(typeof A=="string"&&A!==""||typeof A=="number")return M!==null?null:a(b,E,""+A,P);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Ac:return A.key===M?c(b,E,A,P):null;case Hi:return A.key===M?d(b,E,A,P):null;case Lr:return M=A._init,g(b,E,M(A._payload),P)}if(La(A)||_a(A))return M!==null?null:h(b,E,A,P,null);Lc(b,A)}return null}function x(b,E,A,P,M){if(typeof P=="string"&&P!==""||typeof P=="number")return b=b.get(A)||null,a(E,b,""+P,M);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Ac:return b=b.get(P.key===null?A:P.key)||null,c(E,b,P,M);case Hi:return b=b.get(P.key===null?A:P.key)||null,d(E,b,P,M);case Lr:var B=P._init;return x(b,E,A,B(P._payload),M)}if(La(P)||_a(P))return b=b.get(A)||null,h(E,b,P,M,null);Lc(E,P)}return null}function T(b,E,A,P){for(var M=null,B=null,w=E,y=E=0,S=null;w!==null&&y<A.length;y++){w.index>y?(S=w,w=null):S=w.sibling;var N=g(b,w,A[y],P);if(N===null){w===null&&(w=S);break}t&&w&&N.alternate===null&&e(b,w),E=i(N,E,y),B===null?M=N:B.sibling=N,B=N,w=S}if(y===A.length)return n(b,w),Be&&Ms(b,y),M;if(w===null){for(;y<A.length;y++)w=m(b,A[y],P),w!==null&&(E=i(w,E,y),B===null?M=w:B.sibling=w,B=w);return Be&&Ms(b,y),M}for(w=r(b,w);y<A.length;y++)S=x(w,b,y,A[y],P),S!==null&&(t&&S.alternate!==null&&w.delete(S.key===null?y:S.key),E=i(S,E,y),B===null?M=S:B.sibling=S,B=S);return t&&w.forEach(function(_){return e(b,_)}),Be&&Ms(b,y),M}function k(b,E,A,P){var M=_a(A);if(typeof M!="function")throw Error(H(150));if(A=M.call(A),A==null)throw Error(H(151));for(var B=M=null,w=E,y=E=0,S=null,N=A.next();w!==null&&!N.done;y++,N=A.next()){w.index>y?(S=w,w=null):S=w.sibling;var _=g(b,w,N.value,P);if(_===null){w===null&&(w=S);break}t&&w&&_.alternate===null&&e(b,w),E=i(_,E,y),B===null?M=_:B.sibling=_,B=_,w=S}if(N.done)return n(b,w),Be&&Ms(b,y),M;if(w===null){for(;!N.done;y++,N=A.next())N=m(b,N.value,P),N!==null&&(E=i(N,E,y),B===null?M=N:B.sibling=N,B=N);return Be&&Ms(b,y),M}for(w=r(b,w);!N.done;y++,N=A.next())N=x(w,b,y,N.value,P),N!==null&&(t&&N.alternate!==null&&w.delete(N.key===null?y:N.key),E=i(N,E,y),B===null?M=N:B.sibling=N,B=N);return t&&w.forEach(function(C){return e(b,C)}),Be&&Ms(b,y),M}function D(b,E,A,P){if(typeof A=="object"&&A!==null&&A.type===Gi&&A.key===null&&(A=A.props.children),typeof A=="object"&&A!==null){switch(A.$$typeof){case Ac:e:{for(var M=A.key,B=E;B!==null;){if(B.key===M){if(M=A.type,M===Gi){if(B.tag===7){n(b,B.sibling),E=s(B,A.props.children),E.return=b,b=E;break e}}else if(B.elementType===M||typeof M=="object"&&M!==null&&M.$$typeof===Lr&&c_(M)===B.type){n(b,B.sibling),E=s(B,A.props),E.ref=Ta(b,B,A),E.return=b,b=E;break e}n(b,B);break}else e(b,B);B=B.sibling}A.type===Gi?(E=Js(A.props.children,b.mode,P,A.key),E.return=b,b=E):(P=hu(A.type,A.key,A.props,null,b.mode,P),P.ref=Ta(b,E,A),P.return=b,b=P)}return o(b);case Hi:e:{for(B=A.key;E!==null;){if(E.key===B)if(E.tag===4&&E.stateNode.containerInfo===A.containerInfo&&E.stateNode.implementation===A.implementation){n(b,E.sibling),E=s(E,A.children||[]),E.return=b,b=E;break e}else{n(b,E);break}else e(b,E);E=E.sibling}E=mf(A,b.mode,P),E.return=b,b=E}return o(b);case Lr:return B=A._init,D(b,E,B(A._payload),P)}if(La(A))return T(b,E,A,P);if(_a(A))return k(b,E,A,P);Lc(b,A)}return typeof A=="string"&&A!==""||typeof A=="number"?(A=""+A,E!==null&&E.tag===6?(n(b,E.sibling),E=s(E,A),E.return=b,b=E):(n(b,E),E=ff(A,b.mode,P),E.return=b,b=E),o(b)):n(b,E)}return D}var xo=_E(!0),xE=_E(!1),$u=Es(null),qu=null,eo=null,Jp=null;function Xp(){Jp=eo=qu=null}function Zp(t){var e=$u.current;Ue($u),t._currentValue=e}function Tm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function lo(t,e){qu=t,Jp=eo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(qt=!0),t.firstContext=null)}function _n(t){var e=t._currentValue;if(Jp!==t)if(t={context:t,memoizedValue:e,next:null},eo===null){if(qu===null)throw Error(H(308));eo=t,qu.dependencies={lanes:0,firstContext:t}}else eo=eo.next=t;return e}var Ks=null;function eg(t){Ks===null?Ks=[t]:Ks.push(t)}function wE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,eg(e)):(n.next=s.next,s.next=n),e.interleaved=n,fr(t,r)}function fr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Fr=!1;function tg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function EE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function lr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ts(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Se&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,fr(t,n)}return s=r.interleaved,s===null?(e.next=e,eg(r)):(e.next=s.next,s.next=e),r.interleaved=e,fr(t,n)}function ou(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Up(t,n)}}function u_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hu(t,e,n,r){var s=t.updateQueue;Fr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,h=d=c=null,a=i;do{var g=a.lane,x=a.eventTime;if((r&g)===g){h!==null&&(h=h.next={eventTime:x,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,k=a;switch(g=e,x=n,k.tag){case 1:if(T=k.payload,typeof T=="function"){m=T.call(x,m,g);break e}m=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=k.payload,g=typeof T=="function"?T.call(x,m,g):T,g==null)break e;m=We({},m,g);break e;case 2:Fr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[a]:g.push(a))}else x={eventTime:x,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=x,c=m):h=h.next=x,o|=g;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;g=a,a=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(h===null&&(c=m),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);oi|=o,t.lanes=o,t.memoizedState=m}}function d_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var Jl={},Wn=Es(Jl),Nl=Es(Jl),Cl=Es(Jl);function Ws(t){if(t===Jl)throw Error(H(174));return t}function ng(t,e){switch(Me(Cl,e),Me(Nl,t),Me(Wn,Jl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:sm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=sm(e,t)}Ue(Wn),Me(Wn,e)}function wo(){Ue(Wn),Ue(Nl),Ue(Cl)}function IE(t){Ws(Cl.current);var e=Ws(Wn.current),n=sm(e,t.type);e!==n&&(Me(Nl,t),Me(Wn,n))}function rg(t){Nl.current===t&&(Ue(Wn),Ue(Nl))}var He=Es(0);function Gu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var af=[];function sg(){for(var t=0;t<af.length;t++)af[t]._workInProgressVersionPrimary=null;af.length=0}var au=wr.ReactCurrentDispatcher,lf=wr.ReactCurrentBatchConfig,ii=0,Ke=null,lt=null,gt=null,Ku=!1,el=!1,kl=0,LN=0;function Tt(){throw Error(H(321))}function ig(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Rn(t[n],e[n]))return!1;return!0}function og(t,e,n,r,s,i){if(ii=i,Ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,au.current=t===null||t.memoizedState===null?BN:$N,t=n(r,s),el){i=0;do{if(el=!1,kl=0,25<=i)throw Error(H(301));i+=1,gt=lt=null,e.updateQueue=null,au.current=qN,t=n(r,s)}while(el)}if(au.current=Wu,e=lt!==null&&lt.next!==null,ii=0,gt=lt=Ke=null,Ku=!1,e)throw Error(H(300));return t}function ag(){var t=kl!==0;return kl=0,t}function Un(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gt===null?Ke.memoizedState=gt=t:gt=gt.next=t,gt}function xn(){if(lt===null){var t=Ke.alternate;t=t!==null?t.memoizedState:null}else t=lt.next;var e=gt===null?Ke.memoizedState:gt.next;if(e!==null)gt=e,lt=t;else{if(t===null)throw Error(H(310));lt=t,t={memoizedState:lt.memoizedState,baseState:lt.baseState,baseQueue:lt.baseQueue,queue:lt.queue,next:null},gt===null?Ke.memoizedState=gt=t:gt=gt.next=t}return gt}function Rl(t,e){return typeof e=="function"?e(t):e}function cf(t){var e=xn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=lt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,d=i;do{var h=d.lane;if((ii&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=m,o=r):c=c.next=m,Ke.lanes|=h,oi|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=a,Rn(r,e.memoizedState)||(qt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ke.lanes|=i,oi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function uf(t){var e=xn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Rn(i,e.memoizedState)||(qt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function TE(){}function SE(t,e){var n=Ke,r=xn(),s=e(),i=!Rn(r.memoizedState,s);if(i&&(r.memoizedState=s,qt=!0),r=r.queue,lg(NE.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||gt!==null&&gt.memoizedState.tag&1){if(n.flags|=2048,Pl(9,AE.bind(null,n,r,s,e),void 0,null),yt===null)throw Error(H(349));ii&30||bE(n,e,s)}return s}function bE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function AE(t,e,n,r){e.value=n,e.getSnapshot=r,CE(e)&&kE(t)}function NE(t,e,n){return n(function(){CE(e)&&kE(t)})}function CE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Rn(t,n)}catch{return!0}}function kE(t){var e=fr(t,1);e!==null&&Nn(e,t,1,-1)}function h_(t){var e=Un();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Rl,lastRenderedState:t},e.queue=t,t=t.dispatch=zN.bind(null,Ke,t),[e.memoizedState,t]}function Pl(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RE(){return xn().memoizedState}function lu(t,e,n,r){var s=Un();Ke.flags|=t,s.memoizedState=Pl(1|e,n,void 0,r===void 0?null:r)}function Ld(t,e,n,r){var s=xn();r=r===void 0?null:r;var i=void 0;if(lt!==null){var o=lt.memoizedState;if(i=o.destroy,r!==null&&ig(r,o.deps)){s.memoizedState=Pl(e,n,i,r);return}}Ke.flags|=t,s.memoizedState=Pl(1|e,n,i,r)}function f_(t,e){return lu(8390656,8,t,e)}function lg(t,e){return Ld(2048,8,t,e)}function PE(t,e){return Ld(4,2,t,e)}function DE(t,e){return Ld(4,4,t,e)}function jE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function VE(t,e,n){return n=n!=null?n.concat([t]):null,Ld(4,4,jE.bind(null,e,t),n)}function cg(){}function ME(t,e){var n=xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ig(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function OE(t,e){var n=xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ig(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function LE(t,e,n){return ii&21?(Rn(n,e)||(n=$w(),Ke.lanes|=n,oi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,qt=!0),t.memoizedState=n)}function FN(t,e){var n=ke;ke=n!==0&&4>n?n:4,t(!0);var r=lf.transition;lf.transition={};try{t(!1),e()}finally{ke=n,lf.transition=r}}function FE(){return xn().memoizedState}function UN(t,e,n){var r=rs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},UE(t))zE(e,n);else if(n=wE(t,e,n,r),n!==null){var s=Lt();Nn(n,t,r,s),BE(n,e,r)}}function zN(t,e,n){var r=rs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(UE(t))zE(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Rn(a,o)){var c=e.interleaved;c===null?(s.next=s,eg(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=wE(t,e,s,r),n!==null&&(s=Lt(),Nn(n,t,r,s),BE(n,e,r))}}function UE(t){var e=t.alternate;return t===Ke||e!==null&&e===Ke}function zE(t,e){el=Ku=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function BE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Up(t,n)}}var Wu={readContext:_n,useCallback:Tt,useContext:Tt,useEffect:Tt,useImperativeHandle:Tt,useInsertionEffect:Tt,useLayoutEffect:Tt,useMemo:Tt,useReducer:Tt,useRef:Tt,useState:Tt,useDebugValue:Tt,useDeferredValue:Tt,useTransition:Tt,useMutableSource:Tt,useSyncExternalStore:Tt,useId:Tt,unstable_isNewReconciler:!1},BN={readContext:_n,useCallback:function(t,e){return Un().memoizedState=[t,e===void 0?null:e],t},useContext:_n,useEffect:f_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,lu(4194308,4,jE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return lu(4194308,4,t,e)},useInsertionEffect:function(t,e){return lu(4,2,t,e)},useMemo:function(t,e){var n=Un();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Un();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=UN.bind(null,Ke,t),[r.memoizedState,t]},useRef:function(t){var e=Un();return t={current:t},e.memoizedState=t},useState:h_,useDebugValue:cg,useDeferredValue:function(t){return Un().memoizedState=t},useTransition:function(){var t=h_(!1),e=t[0];return t=FN.bind(null,t[1]),Un().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ke,s=Un();if(Be){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),yt===null)throw Error(H(349));ii&30||bE(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,f_(NE.bind(null,r,i,t),[t]),r.flags|=2048,Pl(9,AE.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Un(),e=yt.identifierPrefix;if(Be){var n=sr,r=rr;n=(r&~(1<<32-An(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=kl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=LN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},$N={readContext:_n,useCallback:ME,useContext:_n,useEffect:lg,useImperativeHandle:VE,useInsertionEffect:PE,useLayoutEffect:DE,useMemo:OE,useReducer:cf,useRef:RE,useState:function(){return cf(Rl)},useDebugValue:cg,useDeferredValue:function(t){var e=xn();return LE(e,lt.memoizedState,t)},useTransition:function(){var t=cf(Rl)[0],e=xn().memoizedState;return[t,e]},useMutableSource:TE,useSyncExternalStore:SE,useId:FE,unstable_isNewReconciler:!1},qN={readContext:_n,useCallback:ME,useContext:_n,useEffect:lg,useImperativeHandle:VE,useInsertionEffect:PE,useLayoutEffect:DE,useMemo:OE,useReducer:uf,useRef:RE,useState:function(){return uf(Rl)},useDebugValue:cg,useDeferredValue:function(t){var e=xn();return lt===null?e.memoizedState=t:LE(e,lt.memoizedState,t)},useTransition:function(){var t=uf(Rl)[0],e=xn().memoizedState;return[t,e]},useMutableSource:TE,useSyncExternalStore:SE,useId:FE,unstable_isNewReconciler:!1};function En(t,e){if(t&&t.defaultProps){e=We({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Sm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:We({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Fd={isMounted:function(t){return(t=t._reactInternals)?Ei(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Lt(),s=rs(t),i=lr(r,s);i.payload=e,n!=null&&(i.callback=n),e=ts(t,i,s),e!==null&&(Nn(e,t,s,r),ou(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Lt(),s=rs(t),i=lr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ts(t,i,s),e!==null&&(Nn(e,t,s,r),ou(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Lt(),r=rs(t),s=lr(n,r);s.tag=2,e!=null&&(s.callback=e),e=ts(t,s,r),e!==null&&(Nn(e,t,r,n),ou(e,t,r))}};function m_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Tl(n,r)||!Tl(s,i):!0}function $E(t,e,n){var r=!1,s=ds,i=e.contextType;return typeof i=="object"&&i!==null?i=_n(i):(s=Yt(e)?ri:Dt.current,r=e.contextTypes,i=(r=r!=null)?vo(t,s):ds),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Fd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function p_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Fd.enqueueReplaceState(e,e.state,null)}function bm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},tg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=_n(i):(i=Yt(e)?ri:Dt.current,s.context=vo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Sm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Fd.enqueueReplaceState(s,s.state,null),Hu(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Eo(t,e){try{var n="",r=e;do n+=vA(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function df(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Am(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var HN=typeof WeakMap=="function"?WeakMap:Map;function qE(t,e,n){n=lr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Yu||(Yu=!0,Om=r),Am(t,e)},n}function HE(t,e,n){n=lr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Am(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Am(t,e),typeof r!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function g_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new HN;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=iC.bind(null,t,e,n),e.then(t,t))}function y_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function v_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=lr(-1,1),e.tag=2,ts(n,e,1))),n.lanes|=1),t)}var GN=wr.ReactCurrentOwner,qt=!1;function Ot(t,e,n,r){e.child=t===null?xE(e,null,n,r):xo(e,t.child,n,r)}function __(t,e,n,r,s){n=n.render;var i=e.ref;return lo(e,s),r=og(t,e,n,r,i,s),n=ag(),t!==null&&!qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,mr(t,e,s)):(Be&&n&&Wp(e),e.flags|=1,Ot(t,e,r,s),e.child)}function x_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!yg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,GE(t,e,i,r,s)):(t=hu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Tl,n(o,r)&&t.ref===e.ref)return mr(t,e,s)}return e.flags|=1,t=ss(i,r),t.ref=e.ref,t.return=e,e.child=t}function GE(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Tl(i,r)&&t.ref===e.ref)if(qt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(qt=!0);else return e.lanes=t.lanes,mr(t,e,s)}return Nm(t,e,n,r,s)}function KE(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Me(no,en),en|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Me(no,en),en|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Me(no,en),en|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Me(no,en),en|=r;return Ot(t,e,s,n),e.child}function WE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Nm(t,e,n,r,s){var i=Yt(n)?ri:Dt.current;return i=vo(e,i),lo(e,s),n=og(t,e,n,r,i,s),r=ag(),t!==null&&!qt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,mr(t,e,s)):(Be&&r&&Wp(e),e.flags|=1,Ot(t,e,n,s),e.child)}function w_(t,e,n,r,s){if(Yt(n)){var i=!0;Uu(e)}else i=!1;if(lo(e,s),e.stateNode===null)cu(t,e),$E(e,n,r),bm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=_n(d):(d=Yt(n)?ri:Dt.current,d=vo(e,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==d)&&p_(e,o,r,d),Fr=!1;var g=e.memoizedState;o.state=g,Hu(e,r,o,s),c=e.memoizedState,a!==r||g!==c||Qt.current||Fr?(typeof h=="function"&&(Sm(e,n,h,r),c=e.memoizedState),(a=Fr||m_(e,n,a,r,g,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,EE(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:En(e.type,a),o.props=d,m=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=_n(c):(c=Yt(n)?ri:Dt.current,c=vo(e,c));var x=n.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==c)&&p_(e,o,r,c),Fr=!1,g=e.memoizedState,o.state=g,Hu(e,r,o,s);var T=e.memoizedState;a!==m||g!==T||Qt.current||Fr?(typeof x=="function"&&(Sm(e,n,x,r),T=e.memoizedState),(d=Fr||m_(e,n,d,r,g,T,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Cm(t,e,n,r,i,s)}function Cm(t,e,n,r,s,i){WE(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&o_(e,n,!1),mr(t,e,i);r=e.stateNode,GN.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=xo(e,t.child,null,i),e.child=xo(e,null,a,i)):Ot(t,e,a,i),e.memoizedState=r.state,s&&o_(e,n,!0),e.child}function QE(t){var e=t.stateNode;e.pendingContext?i_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&i_(t,e.context,!1),ng(t,e.containerInfo)}function E_(t,e,n,r,s){return _o(),Yp(s),e.flags|=256,Ot(t,e,n,r),e.child}var km={dehydrated:null,treeContext:null,retryLane:0};function Rm(t){return{baseLanes:t,cachePool:null,transitions:null}}function YE(t,e,n){var r=e.pendingProps,s=He.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Me(He,s&1),t===null)return Im(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Bd(o,r,0,null),t=Js(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Rm(n),e.memoizedState=km,t):ug(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return KN(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ss(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ss(a,i):(i=Js(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Rm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=km,r}return i=t.child,t=i.sibling,r=ss(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function ug(t,e){return e=Bd({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Fc(t,e,n,r){return r!==null&&Yp(r),xo(e,t.child,null,n),t=ug(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function KN(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=df(Error(H(422))),Fc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Bd({mode:"visible",children:r.children},s,0,null),i=Js(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&xo(e,t.child,null,o),e.child.memoizedState=Rm(o),e.memoizedState=km,i);if(!(e.mode&1))return Fc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(H(419)),r=df(i,r,void 0),Fc(t,e,o,r)}if(a=(o&t.childLanes)!==0,qt||a){if(r=yt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,fr(t,s),Nn(r,t,s,-1))}return gg(),r=df(Error(H(421))),Fc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=oC.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,nn=es(s.nextSibling),on=e,Be=!0,Sn=null,t!==null&&(hn[fn++]=rr,hn[fn++]=sr,hn[fn++]=si,rr=t.id,sr=t.overflow,si=e),e=ug(e,r.children),e.flags|=4096,e)}function I_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Tm(t.return,e,n)}function hf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function JE(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Ot(t,e,r.children,n),r=He.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&I_(t,n,e);else if(t.tag===19)I_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Me(He,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Gu(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),hf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Gu(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}hf(e,!0,n,null,i);break;case"together":hf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function cu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function mr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),oi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=ss(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ss(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function WN(t,e,n){switch(e.tag){case 3:QE(e),_o();break;case 5:IE(e);break;case 1:Yt(e.type)&&Uu(e);break;case 4:ng(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Me($u,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Me(He,He.current&1),e.flags|=128,null):n&e.child.childLanes?YE(t,e,n):(Me(He,He.current&1),t=mr(t,e,n),t!==null?t.sibling:null);Me(He,He.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return JE(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Me(He,He.current),r)break;return null;case 22:case 23:return e.lanes=0,KE(t,e,n)}return mr(t,e,n)}var XE,Pm,ZE,e1;XE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Pm=function(){};ZE=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ws(Wn.current);var i=null;switch(n){case"input":s=em(t,s),r=em(t,r),i=[];break;case"select":s=We({},s,{value:void 0}),r=We({},r,{value:void 0}),i=[];break;case"textarea":s=rm(t,s),r=rm(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Lu)}im(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(yl.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(yl.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Fe("scroll",t),i||a===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};e1=function(t,e,n,r){n!==r&&(e.flags|=4)};function Sa(t,e){if(!Be)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function St(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function QN(t,e,n){var r=e.pendingProps;switch(Qp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(e),null;case 1:return Yt(e.type)&&Fu(),St(e),null;case 3:return r=e.stateNode,wo(),Ue(Qt),Ue(Dt),sg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Oc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Sn!==null&&(Um(Sn),Sn=null))),Pm(t,e),St(e),null;case 5:rg(e);var s=Ws(Cl.current);if(n=e.type,t!==null&&e.stateNode!=null)ZE(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return St(e),null}if(t=Ws(Wn.current),Oc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[$n]=e,r[Al]=i,t=(e.mode&1)!==0,n){case"dialog":Fe("cancel",r),Fe("close",r);break;case"iframe":case"object":case"embed":Fe("load",r);break;case"video":case"audio":for(s=0;s<Ua.length;s++)Fe(Ua[s],r);break;case"source":Fe("error",r);break;case"img":case"image":case"link":Fe("error",r),Fe("load",r);break;case"details":Fe("toggle",r);break;case"input":Pv(r,i),Fe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Fe("invalid",r);break;case"textarea":jv(r,i),Fe("invalid",r)}im(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Mc(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Mc(r.textContent,a,t),s=["children",""+a]):yl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Fe("scroll",r)}switch(n){case"input":Nc(r),Dv(r,i,!0);break;case"textarea":Nc(r),Vv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Lu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Nw(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[$n]=e,t[Al]=r,XE(t,e,!1,!1),e.stateNode=t;e:{switch(o=om(n,r),n){case"dialog":Fe("cancel",t),Fe("close",t),s=r;break;case"iframe":case"object":case"embed":Fe("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ua.length;s++)Fe(Ua[s],t);s=r;break;case"source":Fe("error",t),s=r;break;case"img":case"image":case"link":Fe("error",t),Fe("load",t),s=r;break;case"details":Fe("toggle",t),s=r;break;case"input":Pv(t,r),s=em(t,r),Fe("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=We({},r,{value:void 0}),Fe("invalid",t);break;case"textarea":jv(t,r),s=rm(t,r),Fe("invalid",t);break;default:s=r}im(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?Rw(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Cw(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&vl(t,c):typeof c=="number"&&vl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(yl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Fe("scroll",t):c!=null&&jp(t,i,c,o))}switch(n){case"input":Nc(t),Dv(t,r,!1);break;case"textarea":Nc(t),Vv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+us(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?so(t,!!r.multiple,i,!1):r.defaultValue!=null&&so(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Lu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return St(e),null;case 6:if(t&&e.stateNode!=null)e1(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=Ws(Cl.current),Ws(Wn.current),Oc(e)){if(r=e.stateNode,n=e.memoizedProps,r[$n]=e,(i=r.nodeValue!==n)&&(t=on,t!==null))switch(t.tag){case 3:Mc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Mc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[$n]=e,e.stateNode=r}return St(e),null;case 13:if(Ue(He),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Be&&nn!==null&&e.mode&1&&!(e.flags&128))vE(),_o(),e.flags|=98560,i=!1;else if(i=Oc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[$n]=e}else _o(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;St(e),i=!1}else Sn!==null&&(Um(Sn),Sn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||He.current&1?ct===0&&(ct=3):gg())),e.updateQueue!==null&&(e.flags|=4),St(e),null);case 4:return wo(),Pm(t,e),t===null&&Sl(e.stateNode.containerInfo),St(e),null;case 10:return Zp(e.type._context),St(e),null;case 17:return Yt(e.type)&&Fu(),St(e),null;case 19:if(Ue(He),i=e.memoizedState,i===null)return St(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Sa(i,!1);else{if(ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Gu(t),o!==null){for(e.flags|=128,Sa(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Me(He,He.current&1|2),e.child}t=t.sibling}i.tail!==null&&tt()>Io&&(e.flags|=128,r=!0,Sa(i,!1),e.lanes=4194304)}else{if(!r)if(t=Gu(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Sa(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Be)return St(e),null}else 2*tt()-i.renderingStartTime>Io&&n!==1073741824&&(e.flags|=128,r=!0,Sa(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=tt(),e.sibling=null,n=He.current,Me(He,r?n&1|2:n&1),e):(St(e),null);case 22:case 23:return pg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?en&1073741824&&(St(e),e.subtreeFlags&6&&(e.flags|=8192)):St(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function YN(t,e){switch(Qp(e),e.tag){case 1:return Yt(e.type)&&Fu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return wo(),Ue(Qt),Ue(Dt),sg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return rg(e),null;case 13:if(Ue(He),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));_o()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ue(He),null;case 4:return wo(),null;case 10:return Zp(e.type._context),null;case 22:case 23:return pg(),null;case 24:return null;default:return null}}var Uc=!1,Ct=!1,JN=typeof WeakSet=="function"?WeakSet:Set,ee=null;function to(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ye(t,e,r)}else n.current=null}function Dm(t,e,n){try{n()}catch(r){Ye(t,e,r)}}var T_=!1;function XN(t,e){if(gm=Vu,t=iE(),Kp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,d=0,h=0,m=t,g=null;t:for(;;){for(var x;m!==n||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)g=m,m=x;for(;;){if(m===t)break t;if(g===n&&++d===s&&(a=o),g===i&&++h===r&&(c=o),(x=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=x}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ym={focusedElem:t,selectionRange:n},Vu=!1,ee=e;ee!==null;)if(e=ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ee=t;else for(;ee!==null;){e=ee;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var k=T.memoizedProps,D=T.memoizedState,b=e.stateNode,E=b.getSnapshotBeforeUpdate(e.elementType===e.type?k:En(e.type,k),D);b.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var A=e.stateNode.containerInfo;A.nodeType===1?A.textContent="":A.nodeType===9&&A.documentElement&&A.removeChild(A.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(P){Ye(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,ee=t;break}ee=e.return}return T=T_,T_=!1,T}function tl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Dm(e,n,i)}s=s.next}while(s!==r)}}function Ud(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function jm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function t1(t){var e=t.alternate;e!==null&&(t.alternate=null,t1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[$n],delete e[Al],delete e[xm],delete e[jN],delete e[VN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function n1(t){return t.tag===5||t.tag===3||t.tag===4}function S_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||n1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Vm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Lu));else if(r!==4&&(t=t.child,t!==null))for(Vm(t,e,n),t=t.sibling;t!==null;)Vm(t,e,n),t=t.sibling}function Mm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Mm(t,e,n),t=t.sibling;t!==null;)Mm(t,e,n),t=t.sibling}var vt=null,In=!1;function Dr(t,e,n){for(n=n.child;n!==null;)r1(t,e,n),n=n.sibling}function r1(t,e,n){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(Pd,n)}catch{}switch(n.tag){case 5:Ct||to(n,e);case 6:var r=vt,s=In;vt=null,Dr(t,e,n),vt=r,In=s,vt!==null&&(In?(t=vt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vt.removeChild(n.stateNode));break;case 18:vt!==null&&(In?(t=vt,n=n.stateNode,t.nodeType===8?sf(t.parentNode,n):t.nodeType===1&&sf(t,n),El(t)):sf(vt,n.stateNode));break;case 4:r=vt,s=In,vt=n.stateNode.containerInfo,In=!0,Dr(t,e,n),vt=r,In=s;break;case 0:case 11:case 14:case 15:if(!Ct&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Dm(n,e,o),s=s.next}while(s!==r)}Dr(t,e,n);break;case 1:if(!Ct&&(to(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ye(n,e,a)}Dr(t,e,n);break;case 21:Dr(t,e,n);break;case 22:n.mode&1?(Ct=(r=Ct)||n.memoizedState!==null,Dr(t,e,n),Ct=r):Dr(t,e,n);break;default:Dr(t,e,n)}}function b_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new JN),e.forEach(function(r){var s=aC.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function wn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:vt=a.stateNode,In=!1;break e;case 3:vt=a.stateNode.containerInfo,In=!0;break e;case 4:vt=a.stateNode.containerInfo,In=!0;break e}a=a.return}if(vt===null)throw Error(H(160));r1(i,o,s),vt=null,In=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Ye(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)s1(e,t),e=e.sibling}function s1(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(wn(e,t),Fn(t),r&4){try{tl(3,t,t.return),Ud(3,t)}catch(k){Ye(t,t.return,k)}try{tl(5,t,t.return)}catch(k){Ye(t,t.return,k)}}break;case 1:wn(e,t),Fn(t),r&512&&n!==null&&to(n,n.return);break;case 5:if(wn(e,t),Fn(t),r&512&&n!==null&&to(n,n.return),t.flags&32){var s=t.stateNode;try{vl(s,"")}catch(k){Ye(t,t.return,k)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&bw(s,i),om(a,o);var d=om(a,i);for(o=0;o<c.length;o+=2){var h=c[o],m=c[o+1];h==="style"?Rw(s,m):h==="dangerouslySetInnerHTML"?Cw(s,m):h==="children"?vl(s,m):jp(s,h,m,d)}switch(a){case"input":tm(s,i);break;case"textarea":Aw(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?so(s,!!i.multiple,x,!1):g!==!!i.multiple&&(i.defaultValue!=null?so(s,!!i.multiple,i.defaultValue,!0):so(s,!!i.multiple,i.multiple?[]:"",!1))}s[Al]=i}catch(k){Ye(t,t.return,k)}}break;case 6:if(wn(e,t),Fn(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(k){Ye(t,t.return,k)}}break;case 3:if(wn(e,t),Fn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{El(e.containerInfo)}catch(k){Ye(t,t.return,k)}break;case 4:wn(e,t),Fn(t);break;case 13:wn(e,t),Fn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(fg=tt())),r&4&&b_(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Ct=(d=Ct)||h,wn(e,t),Ct=d):wn(e,t),Fn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ee=t,h=t.child;h!==null;){for(m=ee=h;ee!==null;){switch(g=ee,x=g.child,g.tag){case 0:case 11:case 14:case 15:tl(4,g,g.return);break;case 1:to(g,g.return);var T=g.stateNode;if(typeof T.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(k){Ye(r,n,k)}}break;case 5:to(g,g.return);break;case 22:if(g.memoizedState!==null){N_(m);continue}}x!==null?(x.return=g,ee=x):N_(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=kw("display",o))}catch(k){Ye(t,t.return,k)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(k){Ye(t,t.return,k)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:wn(e,t),Fn(t),r&4&&b_(t);break;case 21:break;default:wn(e,t),Fn(t)}}function Fn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(n1(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(vl(s,""),r.flags&=-33);var i=S_(t);Mm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=S_(t);Vm(t,a,o);break;default:throw Error(H(161))}}catch(c){Ye(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ZN(t,e,n){ee=t,i1(t)}function i1(t,e,n){for(var r=(t.mode&1)!==0;ee!==null;){var s=ee,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Uc;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Ct;a=Uc;var d=Ct;if(Uc=o,(Ct=c)&&!d)for(ee=s;ee!==null;)o=ee,c=o.child,o.tag===22&&o.memoizedState!==null?C_(s):c!==null?(c.return=o,ee=c):C_(s);for(;i!==null;)ee=i,i1(i),i=i.sibling;ee=s,Uc=a,Ct=d}A_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ee=i):A_(t)}}function A_(t){for(;ee!==null;){var e=ee;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ct||Ud(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ct)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:En(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&d_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}d_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&El(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Ct||e.flags&512&&jm(e)}catch(g){Ye(e,e.return,g)}}if(e===t){ee=null;break}if(n=e.sibling,n!==null){n.return=e.return,ee=n;break}ee=e.return}}function N_(t){for(;ee!==null;){var e=ee;if(e===t){ee=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ee=n;break}ee=e.return}}function C_(t){for(;ee!==null;){var e=ee;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ud(4,e)}catch(c){Ye(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Ye(e,s,c)}}var i=e.return;try{jm(e)}catch(c){Ye(e,i,c)}break;case 5:var o=e.return;try{jm(e)}catch(c){Ye(e,o,c)}}}catch(c){Ye(e,e.return,c)}if(e===t){ee=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ee=a;break}ee=e.return}}var eC=Math.ceil,Qu=wr.ReactCurrentDispatcher,dg=wr.ReactCurrentOwner,yn=wr.ReactCurrentBatchConfig,Se=0,yt=null,it=null,Et=0,en=0,no=Es(0),ct=0,Dl=null,oi=0,zd=0,hg=0,nl=null,Bt=null,fg=0,Io=1/0,tr=null,Yu=!1,Om=null,ns=null,zc=!1,Qr=null,Ju=0,rl=0,Lm=null,uu=-1,du=0;function Lt(){return Se&6?tt():uu!==-1?uu:uu=tt()}function rs(t){return t.mode&1?Se&2&&Et!==0?Et&-Et:ON.transition!==null?(du===0&&(du=$w()),du):(t=ke,t!==0||(t=window.event,t=t===void 0?16:Yw(t.type)),t):1}function Nn(t,e,n,r){if(50<rl)throw rl=0,Lm=null,Error(H(185));Wl(t,n,r),(!(Se&2)||t!==yt)&&(t===yt&&(!(Se&2)&&(zd|=n),ct===4&&zr(t,Et)),Jt(t,r),n===1&&Se===0&&!(e.mode&1)&&(Io=tt()+500,Od&&Is()))}function Jt(t,e){var n=t.callbackNode;OA(t,e);var r=ju(t,t===yt?Et:0);if(r===0)n!==null&&Lv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Lv(n),e===1)t.tag===0?MN(k_.bind(null,t)):pE(k_.bind(null,t)),PN(function(){!(Se&6)&&Is()}),n=null;else{switch(qw(r)){case 1:n=Fp;break;case 4:n=zw;break;case 16:n=Du;break;case 536870912:n=Bw;break;default:n=Du}n=f1(n,o1.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function o1(t,e){if(uu=-1,du=0,Se&6)throw Error(H(327));var n=t.callbackNode;if(co()&&t.callbackNode!==n)return null;var r=ju(t,t===yt?Et:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Xu(t,r);else{e=r;var s=Se;Se|=2;var i=l1();(yt!==t||Et!==e)&&(tr=null,Io=tt()+500,Ys(t,e));do try{rC();break}catch(a){a1(t,a)}while(!0);Xp(),Qu.current=i,Se=s,it!==null?e=0:(yt=null,Et=0,e=ct)}if(e!==0){if(e===2&&(s=dm(t),s!==0&&(r=s,e=Fm(t,s))),e===1)throw n=Dl,Ys(t,0),zr(t,r),Jt(t,tt()),n;if(e===6)zr(t,r);else{if(s=t.current.alternate,!(r&30)&&!tC(s)&&(e=Xu(t,r),e===2&&(i=dm(t),i!==0&&(r=i,e=Fm(t,i))),e===1))throw n=Dl,Ys(t,0),zr(t,r),Jt(t,tt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:Os(t,Bt,tr);break;case 3:if(zr(t,r),(r&130023424)===r&&(e=fg+500-tt(),10<e)){if(ju(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Lt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=_m(Os.bind(null,t,Bt,tr),e);break}Os(t,Bt,tr);break;case 4:if(zr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-An(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*eC(r/1960))-r,10<r){t.timeoutHandle=_m(Os.bind(null,t,Bt,tr),r);break}Os(t,Bt,tr);break;case 5:Os(t,Bt,tr);break;default:throw Error(H(329))}}}return Jt(t,tt()),t.callbackNode===n?o1.bind(null,t):null}function Fm(t,e){var n=nl;return t.current.memoizedState.isDehydrated&&(Ys(t,e).flags|=256),t=Xu(t,e),t!==2&&(e=Bt,Bt=n,e!==null&&Um(e)),t}function Um(t){Bt===null?Bt=t:Bt.push.apply(Bt,t)}function tC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Rn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zr(t,e){for(e&=~hg,e&=~zd,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-An(e),r=1<<n;t[n]=-1,e&=~r}}function k_(t){if(Se&6)throw Error(H(327));co();var e=ju(t,0);if(!(e&1))return Jt(t,tt()),null;var n=Xu(t,e);if(t.tag!==0&&n===2){var r=dm(t);r!==0&&(e=r,n=Fm(t,r))}if(n===1)throw n=Dl,Ys(t,0),zr(t,e),Jt(t,tt()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Os(t,Bt,tr),Jt(t,tt()),null}function mg(t,e){var n=Se;Se|=1;try{return t(e)}finally{Se=n,Se===0&&(Io=tt()+500,Od&&Is())}}function ai(t){Qr!==null&&Qr.tag===0&&!(Se&6)&&co();var e=Se;Se|=1;var n=yn.transition,r=ke;try{if(yn.transition=null,ke=1,t)return t()}finally{ke=r,yn.transition=n,Se=e,!(Se&6)&&Is()}}function pg(){en=no.current,Ue(no)}function Ys(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,RN(n)),it!==null)for(n=it.return;n!==null;){var r=n;switch(Qp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Fu();break;case 3:wo(),Ue(Qt),Ue(Dt),sg();break;case 5:rg(r);break;case 4:wo();break;case 13:Ue(He);break;case 19:Ue(He);break;case 10:Zp(r.type._context);break;case 22:case 23:pg()}n=n.return}if(yt=t,it=t=ss(t.current,null),Et=en=e,ct=0,Dl=null,hg=zd=oi=0,Bt=nl=null,Ks!==null){for(e=0;e<Ks.length;e++)if(n=Ks[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Ks=null}return t}function a1(t,e){do{var n=it;try{if(Xp(),au.current=Wu,Ku){for(var r=Ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ku=!1}if(ii=0,gt=lt=Ke=null,el=!1,kl=0,dg.current=null,n===null||n.return===null){ct=1,Dl=e,it=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=Et,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=y_(o);if(x!==null){x.flags&=-257,v_(x,o,a,i,e),x.mode&1&&g_(i,d,e),e=x,c=d;var T=e.updateQueue;if(T===null){var k=new Set;k.add(c),e.updateQueue=k}else T.add(c);break e}else{if(!(e&1)){g_(i,d,e),gg();break e}c=Error(H(426))}}else if(Be&&a.mode&1){var D=y_(o);if(D!==null){!(D.flags&65536)&&(D.flags|=256),v_(D,o,a,i,e),Yp(Eo(c,a));break e}}i=c=Eo(c,a),ct!==4&&(ct=2),nl===null?nl=[i]:nl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var b=qE(i,c,e);u_(i,b);break e;case 1:a=c;var E=i.type,A=i.stateNode;if(!(i.flags&128)&&(typeof E.getDerivedStateFromError=="function"||A!==null&&typeof A.componentDidCatch=="function"&&(ns===null||!ns.has(A)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=HE(i,a,e);u_(i,P);break e}}i=i.return}while(i!==null)}u1(n)}catch(M){e=M,it===n&&n!==null&&(it=n=n.return);continue}break}while(!0)}function l1(){var t=Qu.current;return Qu.current=Wu,t===null?Wu:t}function gg(){(ct===0||ct===3||ct===2)&&(ct=4),yt===null||!(oi&268435455)&&!(zd&268435455)||zr(yt,Et)}function Xu(t,e){var n=Se;Se|=2;var r=l1();(yt!==t||Et!==e)&&(tr=null,Ys(t,e));do try{nC();break}catch(s){a1(t,s)}while(!0);if(Xp(),Se=n,Qu.current=r,it!==null)throw Error(H(261));return yt=null,Et=0,ct}function nC(){for(;it!==null;)c1(it)}function rC(){for(;it!==null&&!NA();)c1(it)}function c1(t){var e=h1(t.alternate,t,en);t.memoizedProps=t.pendingProps,e===null?u1(t):it=e,dg.current=null}function u1(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=YN(n,e),n!==null){n.flags&=32767,it=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ct=6,it=null;return}}else if(n=QN(n,e,en),n!==null){it=n;return}if(e=e.sibling,e!==null){it=e;return}it=e=t}while(e!==null);ct===0&&(ct=5)}function Os(t,e,n){var r=ke,s=yn.transition;try{yn.transition=null,ke=1,sC(t,e,n,r)}finally{yn.transition=s,ke=r}return null}function sC(t,e,n,r){do co();while(Qr!==null);if(Se&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(LA(t,i),t===yt&&(it=yt=null,Et=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zc||(zc=!0,f1(Du,function(){return co(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=yn.transition,yn.transition=null;var o=ke;ke=1;var a=Se;Se|=4,dg.current=null,XN(t,n),s1(n,t),TN(ym),Vu=!!gm,ym=gm=null,t.current=n,ZN(n),CA(),Se=a,ke=o,yn.transition=i}else t.current=n;if(zc&&(zc=!1,Qr=t,Ju=s),i=t.pendingLanes,i===0&&(ns=null),PA(n.stateNode),Jt(t,tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Yu)throw Yu=!1,t=Om,Om=null,t;return Ju&1&&t.tag!==0&&co(),i=t.pendingLanes,i&1?t===Lm?rl++:(rl=0,Lm=t):rl=0,Is(),null}function co(){if(Qr!==null){var t=qw(Ju),e=yn.transition,n=ke;try{if(yn.transition=null,ke=16>t?16:t,Qr===null)var r=!1;else{if(t=Qr,Qr=null,Ju=0,Se&6)throw Error(H(331));var s=Se;for(Se|=4,ee=t.current;ee!==null;){var i=ee,o=i.child;if(ee.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(ee=d;ee!==null;){var h=ee;switch(h.tag){case 0:case 11:case 15:tl(8,h,i)}var m=h.child;if(m!==null)m.return=h,ee=m;else for(;ee!==null;){h=ee;var g=h.sibling,x=h.return;if(t1(h),h===d){ee=null;break}if(g!==null){g.return=x,ee=g;break}ee=x}}}var T=i.alternate;if(T!==null){var k=T.child;if(k!==null){T.child=null;do{var D=k.sibling;k.sibling=null,k=D}while(k!==null)}}ee=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ee=o;else e:for(;ee!==null;){if(i=ee,i.flags&2048)switch(i.tag){case 0:case 11:case 15:tl(9,i,i.return)}var b=i.sibling;if(b!==null){b.return=i.return,ee=b;break e}ee=i.return}}var E=t.current;for(ee=E;ee!==null;){o=ee;var A=o.child;if(o.subtreeFlags&2064&&A!==null)A.return=o,ee=A;else e:for(o=E;ee!==null;){if(a=ee,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ud(9,a)}}catch(M){Ye(a,a.return,M)}if(a===o){ee=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,ee=P;break e}ee=a.return}}if(Se=s,Is(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(Pd,t)}catch{}r=!0}return r}finally{ke=n,yn.transition=e}}return!1}function R_(t,e,n){e=Eo(n,e),e=qE(t,e,1),t=ts(t,e,1),e=Lt(),t!==null&&(Wl(t,1,e),Jt(t,e))}function Ye(t,e,n){if(t.tag===3)R_(t,t,n);else for(;e!==null;){if(e.tag===3){R_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ns===null||!ns.has(r))){t=Eo(n,t),t=HE(e,t,1),e=ts(e,t,1),t=Lt(),e!==null&&(Wl(e,1,t),Jt(e,t));break}}e=e.return}}function iC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Lt(),t.pingedLanes|=t.suspendedLanes&n,yt===t&&(Et&n)===n&&(ct===4||ct===3&&(Et&130023424)===Et&&500>tt()-fg?Ys(t,0):hg|=n),Jt(t,e)}function d1(t,e){e===0&&(t.mode&1?(e=Rc,Rc<<=1,!(Rc&130023424)&&(Rc=4194304)):e=1);var n=Lt();t=fr(t,e),t!==null&&(Wl(t,e,n),Jt(t,n))}function oC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),d1(t,n)}function aC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),d1(t,n)}var h1;h1=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Qt.current)qt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return qt=!1,WN(t,e,n);qt=!!(t.flags&131072)}else qt=!1,Be&&e.flags&1048576&&gE(e,Bu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;cu(t,e),t=e.pendingProps;var s=vo(e,Dt.current);lo(e,n),s=og(null,e,r,t,s,n);var i=ag();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yt(r)?(i=!0,Uu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,tg(e),s.updater=Fd,e.stateNode=s,s._reactInternals=e,bm(e,r,t,n),e=Cm(null,e,r,!0,i,n)):(e.tag=0,Be&&i&&Wp(e),Ot(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(cu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=cC(r),t=En(r,t),s){case 0:e=Nm(null,e,r,t,n);break e;case 1:e=w_(null,e,r,t,n);break e;case 11:e=__(null,e,r,t,n);break e;case 14:e=x_(null,e,r,En(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:En(r,s),Nm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:En(r,s),w_(t,e,r,s,n);case 3:e:{if(QE(e),t===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,EE(t,e),Hu(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Eo(Error(H(423)),e),e=E_(t,e,r,n,s);break e}else if(r!==s){s=Eo(Error(H(424)),e),e=E_(t,e,r,n,s);break e}else for(nn=es(e.stateNode.containerInfo.firstChild),on=e,Be=!0,Sn=null,n=xE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(_o(),r===s){e=mr(t,e,n);break e}Ot(t,e,r,n)}e=e.child}return e;case 5:return IE(e),t===null&&Im(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,vm(r,s)?o=null:i!==null&&vm(r,i)&&(e.flags|=32),WE(t,e),Ot(t,e,o,n),e.child;case 6:return t===null&&Im(e),null;case 13:return YE(t,e,n);case 4:return ng(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=xo(e,null,r,n):Ot(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:En(r,s),__(t,e,r,s,n);case 7:return Ot(t,e,e.pendingProps,n),e.child;case 8:return Ot(t,e,e.pendingProps.children,n),e.child;case 12:return Ot(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Me($u,r._currentValue),r._currentValue=o,i!==null)if(Rn(i.value,o)){if(i.children===s.children&&!Qt.current){e=mr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=lr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Tm(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Tm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ot(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,lo(e,n),s=_n(s),r=r(s),e.flags|=1,Ot(t,e,r,n),e.child;case 14:return r=e.type,s=En(r,e.pendingProps),s=En(r.type,s),x_(t,e,r,s,n);case 15:return GE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:En(r,s),cu(t,e),e.tag=1,Yt(r)?(t=!0,Uu(e)):t=!1,lo(e,n),$E(e,r,s),bm(e,r,s,n),Cm(null,e,r,!0,t,n);case 19:return JE(t,e,n);case 22:return KE(t,e,n)}throw Error(H(156,e.tag))};function f1(t,e){return Uw(t,e)}function lC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pn(t,e,n,r){return new lC(t,e,n,r)}function yg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cC(t){if(typeof t=="function")return yg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Mp)return 11;if(t===Op)return 14}return 2}function ss(t,e){var n=t.alternate;return n===null?(n=pn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function hu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")yg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Gi:return Js(n.children,s,i,e);case Vp:o=8,s|=8;break;case Yf:return t=pn(12,n,e,s|2),t.elementType=Yf,t.lanes=i,t;case Jf:return t=pn(13,n,e,s),t.elementType=Jf,t.lanes=i,t;case Xf:return t=pn(19,n,e,s),t.elementType=Xf,t.lanes=i,t;case Iw:return Bd(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case ww:o=10;break e;case Ew:o=9;break e;case Mp:o=11;break e;case Op:o=14;break e;case Lr:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=pn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Js(t,e,n,r){return t=pn(7,t,r,e),t.lanes=n,t}function Bd(t,e,n,r){return t=pn(22,t,r,e),t.elementType=Iw,t.lanes=n,t.stateNode={isHidden:!1},t}function ff(t,e,n){return t=pn(6,t,null,e),t.lanes=n,t}function mf(t,e,n){return e=pn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function uC(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kh(0),this.expirationTimes=Kh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function vg(t,e,n,r,s,i,o,a,c){return t=new uC(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=pn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},tg(i),t}function dC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Hi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function m1(t){if(!t)return ds;t=t._reactInternals;e:{if(Ei(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Yt(n))return mE(t,n,e)}return e}function p1(t,e,n,r,s,i,o,a,c){return t=vg(n,r,!0,t,s,i,o,a,c),t.context=m1(null),n=t.current,r=Lt(),s=rs(n),i=lr(r,s),i.callback=e??null,ts(n,i,s),t.current.lanes=s,Wl(t,s,r),Jt(t,r),t}function $d(t,e,n,r){var s=e.current,i=Lt(),o=rs(s);return n=m1(n),e.context===null?e.context=n:e.pendingContext=n,e=lr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ts(s,e,o),t!==null&&(Nn(t,s,o,i),ou(t,s,o)),o}function Zu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function P_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function _g(t,e){P_(t,e),(t=t.alternate)&&P_(t,e)}function hC(){return null}var g1=typeof reportError=="function"?reportError:function(t){console.error(t)};function xg(t){this._internalRoot=t}qd.prototype.render=xg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));$d(t,e,null,null)};qd.prototype.unmount=xg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ai(function(){$d(null,t,null,null)}),e[hr]=null}};function qd(t){this._internalRoot=t}qd.prototype.unstable_scheduleHydration=function(t){if(t){var e=Kw();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ur.length&&e!==0&&e<Ur[n].priority;n++);Ur.splice(n,0,t),n===0&&Qw(t)}};function wg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function D_(){}function fC(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=Zu(o);i.call(d)}}var o=p1(e,r,t,0,null,!1,!1,"",D_);return t._reactRootContainer=o,t[hr]=o.current,Sl(t.nodeType===8?t.parentNode:t),ai(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=Zu(c);a.call(d)}}var c=vg(t,0,!1,null,null,!1,!1,"",D_);return t._reactRootContainer=c,t[hr]=c.current,Sl(t.nodeType===8?t.parentNode:t),ai(function(){$d(e,c,n,r)}),c}function Gd(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=Zu(o);a.call(c)}}$d(e,o,t,s)}else o=fC(n,e,t,s,r);return Zu(o)}Hw=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Fa(e.pendingLanes);n!==0&&(Up(e,n|1),Jt(e,tt()),!(Se&6)&&(Io=tt()+500,Is()))}break;case 13:ai(function(){var r=fr(t,1);if(r!==null){var s=Lt();Nn(r,t,1,s)}}),_g(t,1)}};zp=function(t){if(t.tag===13){var e=fr(t,134217728);if(e!==null){var n=Lt();Nn(e,t,134217728,n)}_g(t,134217728)}};Gw=function(t){if(t.tag===13){var e=rs(t),n=fr(t,e);if(n!==null){var r=Lt();Nn(n,t,e,r)}_g(t,e)}};Kw=function(){return ke};Ww=function(t,e){var n=ke;try{return ke=t,e()}finally{ke=n}};lm=function(t,e,n){switch(e){case"input":if(tm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Md(r);if(!s)throw Error(H(90));Sw(r),tm(r,s)}}}break;case"textarea":Aw(t,n);break;case"select":e=n.value,e!=null&&so(t,!!n.multiple,e,!1)}};jw=mg;Vw=ai;var mC={usingClientEntryPoint:!1,Events:[Yl,Yi,Md,Pw,Dw,mg]},ba={findFiberByHostInstance:Gs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pC={bundleType:ba.bundleType,version:ba.version,rendererPackageName:ba.rendererPackageName,rendererConfig:ba.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:wr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Lw(t),t===null?null:t.stateNode},findFiberByHostInstance:ba.findFiberByHostInstance||hC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bc.isDisabled&&Bc.supportsFiber)try{Pd=Bc.inject(pC),Kn=Bc}catch{}}un.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mC;un.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wg(e))throw Error(H(200));return dC(t,e,null,n)};un.createRoot=function(t,e){if(!wg(t))throw Error(H(299));var n=!1,r="",s=g1;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=vg(t,1,!1,null,null,n,!1,r,s),t[hr]=e.current,Sl(t.nodeType===8?t.parentNode:t),new xg(e)};un.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=Lw(e),t=t===null?null:t.stateNode,t};un.flushSync=function(t){return ai(t)};un.hydrate=function(t,e,n){if(!Hd(e))throw Error(H(200));return Gd(null,t,e,!0,n)};un.hydrateRoot=function(t,e,n){if(!wg(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=g1;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=p1(e,null,t,1,n??null,s,!1,i,o),t[hr]=e.current,Sl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new qd(e)};un.render=function(t,e,n){if(!Hd(e))throw Error(H(200));return Gd(null,t,e,!1,n)};un.unmountComponentAtNode=function(t){if(!Hd(t))throw Error(H(40));return t._reactRootContainer?(ai(function(){Gd(null,null,t,!1,function(){t._reactRootContainer=null,t[hr]=null})}),!0):!1};un.unstable_batchedUpdates=mg;un.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hd(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return Gd(t,e,n,!1,r)};un.version="18.3.1-next-f1338f8080-20240426";function y1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(y1)}catch(t){console.error(t)}}y1(),yw.exports=un;var gC=yw.exports,j_=gC;Wf.createRoot=j_.createRoot,Wf.hydrateRoot=j_.hydrateRoot;const yC="modulepreload",vC=function(t){return"/"+t},V_={},_C=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=vC(c),c in V_)return;V_[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":yC,d||(m.as="script"),m.crossOrigin="",m.href=c,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((g,x)=>{m.addEventListener("load",g),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function xC(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,c;const d=async(m=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(a=await _C(async()=>{const{Workbox:m}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/sw.js",{scope:"/",type:"classic"})).catch(m=>{o==null||o(m)}),!a)return;a.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),a.addEventListener("installed",m=>{m.isUpdate||r==null||r()}),a.register({immediate:e}).then(m=>{i?i("/sw.js",m):s==null||s(m)}).catch(m=>{o==null||o(m)})}}return c=h(),d}var wC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const EC=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pe=(t,e)=>{const n=V.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:a,...c},d)=>V.createElement("svg",{ref:d,...wC,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${EC(t)}`,...c},[...e.map(([h,m])=>V.createElement(h,m)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n},IC=pe("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),M_=pe("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),v1=pe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),O_=pe("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),ed=pe("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),zm=pe("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),sl=pe("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),TC=pe("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]),SC=pe("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),bC=pe("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),AC=pe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),NC=pe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),_1=pe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),CC=pe("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Eg=pe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),kC=pe("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),RC=pe("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),Kd=pe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),PC=pe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),DC=pe("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),L_=pe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),jC=pe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),VC=pe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),pf=pe("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),MC=pe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),OC=pe("MessageSquareDashed",[["path",{d:"M3 6V5c0-1.1.9-2 2-2h2",key:"9usibi"}],["path",{d:"M11 3h3",key:"1c3ji7"}],["path",{d:"M18 3h1c1.1 0 2 .9 2 2",key:"19esxn"}],["path",{d:"M21 9v2",key:"p14lih"}],["path",{d:"M21 15c0 1.1-.9 2-2 2h-1",key:"1fo1j8"}],["path",{d:"M14 17h-3",key:"1w4p2m"}],["path",{d:"m7 17-4 4v-5",key:"ph9x1h"}],["path",{d:"M3 12v-2",key:"856n1q"}]]),x1=pe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),LC=pe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),FC=pe("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),w1=pe("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),UC=pe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),zC=pe("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),gn=pe("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),li=pe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),E1=pe("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),Bm=pe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),I1=pe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),hs=pe("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),fs=pe("ShieldMinus",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M8 11h8",key:"vwpz6n"}]]),F_=pe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),BC=pe("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),$C=pe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),$m=pe("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),zs=pe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),To=pe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),ms=pe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),qC=()=>{};var U_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T1=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},HC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},S1={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|a>>4;let g=(a&15)<<2|d>>6,x=d&63;c||(x=64,o||(g=64)),r.push(n[h],n[m],n[g],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(T1(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||m==null)throw new GC;const g=i<<2|a>>4;if(r.push(g),d!==64){const x=a<<4&240|d>>2;if(r.push(x),m!==64){const T=d<<6&192|m;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class GC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KC=function(t){const e=T1(t);return S1.encodeByteArray(e,!0)},td=function(t){return KC(t).replace(/\./g,"")},b1=function(t){try{return S1.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WC=()=>A1().__FIREBASE_DEFAULTS__,QC=()=>{if(typeof process>"u"||typeof U_>"u")return;const t=U_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},YC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&b1(t[1]);return e&&JSON.parse(e)},Wd=()=>{try{return qC()||WC()||QC()||YC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},N1=t=>{var e,n;return(n=(e=Wd())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},C1=t=>{const e=N1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},k1=()=>{var t;return(t=Wd())==null?void 0:t.config},R1=t=>{var e;return(e=Wd())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zn(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Qd(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[td(JSON.stringify(n)),td(JSON.stringify(o)),""].join(".")}const il={};function ZC(){const t={prod:[],emulator:[]};for(const e of Object.keys(il))il[e]?t.emulator.push(e):t.prod.push(e);return t}function ek(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let z_=!1;function Ig(t,e){if(typeof window>"u"||typeof document>"u"||!Zn(window.location.host)||il[t]===e||il[t]||z_)return;il[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=ZC().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,x){g.setAttribute("width","24"),g.setAttribute("id",x),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{z_=!0,o()},g}function h(g,x){g.setAttribute("id",x),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=ek(r),x=n("text"),T=document.getElementById(x)||document.createElement("span"),k=n("learnmore"),D=document.getElementById(k)||document.createElement("a"),b=n("preprendIcon"),E=document.getElementById(b)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const A=g.element;a(A),h(D,k);const P=d();c(E,b),A.append(E,T,D,P),document.body.appendChild(A)}i?(T.innerText="Preview backend disconnected.",E.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(E.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,T.innerText="Preview backend running in this workspace."),T.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(dt())}function P1(){var e;const t=(e=Wd())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function sk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ik(){const t=dt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function D1(){return!P1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function j1(){return!P1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function V1(){try{return typeof indexedDB=="object"}catch{return!1}}function ok(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ak="FirebaseError";class Dn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=ak,Object.setPrototypeOf(this,Dn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Xl.prototype.create)}}class Xl{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?lk(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Dn(s,a,r)}}function lk(t,e){return t.replace(ck,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const ck=/\{\$([^}]+)}/g;function uk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ci(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(B_(i)&&B_(o)){if(!ci(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function B_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function za(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ba(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function dk(t,e){const n=new hk(t,e);return n.subscribe.bind(n)}class hk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");fk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=gf),s.error===void 0&&(s.error=gf),s.complete===void 0&&(s.complete=gf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function gf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pe(t){return t&&t._delegate?t._delegate:t}class pr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ls="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new JC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gk(e))try{this.getOrInitializeService({instanceIdentifier:Ls})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ls){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ls){return this.instances.has(e)}getOptions(e=Ls){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ls){return this.component?this.component.multipleInstances?e:Ls:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pk(t){return t===Ls?void 0:t}function gk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new mk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(xe||(xe={}));const vk={debug:xe.DEBUG,verbose:xe.VERBOSE,info:xe.INFO,warn:xe.WARN,error:xe.ERROR,silent:xe.SILENT},_k=xe.INFO,xk={[xe.DEBUG]:"log",[xe.VERBOSE]:"log",[xe.INFO]:"info",[xe.WARN]:"warn",[xe.ERROR]:"error"},wk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=xk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Tg{constructor(e){this.name=e,this._logLevel=_k,this._logHandler=wk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,xe.DEBUG,...e),this._logHandler(this,xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,xe.VERBOSE,...e),this._logHandler(this,xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,xe.INFO,...e),this._logHandler(this,xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,xe.WARN,...e),this._logHandler(this,xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,xe.ERROR,...e),this._logHandler(this,xe.ERROR,...e)}}const Ek=(t,e)=>e.some(n=>t instanceof n);let $_,q_;function Ik(){return $_||($_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Tk(){return q_||(q_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const M1=new WeakMap,qm=new WeakMap,O1=new WeakMap,yf=new WeakMap,Sg=new WeakMap;function Sk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(is(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&M1.set(n,t)}).catch(()=>{}),Sg.set(e,t),e}function bk(t){if(qm.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});qm.set(t,e)}let Hm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qm.get(t);if(e==="objectStoreNames")return t.objectStoreNames||O1.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return is(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ak(t){Hm=t(Hm)}function Nk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(vf(this),e,...n);return O1.set(r,e.sort?e.sort():[e]),is(r)}:Tk().includes(t)?function(...e){return t.apply(vf(this),e),is(M1.get(this))}:function(...e){return is(t.apply(vf(this),e))}}function Ck(t){return typeof t=="function"?Nk(t):(t instanceof IDBTransaction&&bk(t),Ek(t,Ik())?new Proxy(t,Hm):t)}function is(t){if(t instanceof IDBRequest)return Sk(t);if(yf.has(t))return yf.get(t);const e=Ck(t);return e!==t&&(yf.set(t,e),Sg.set(e,t)),e}const vf=t=>Sg.get(t);function kk(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=is(o);return r&&o.addEventListener("upgradeneeded",c=>{r(is(o.result),c.oldVersion,c.newVersion,is(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const Rk=["get","getKey","getAll","getAllKeys","count"],Pk=["put","add","delete","clear"],_f=new Map;function H_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_f.get(e))return _f.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Pk.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Rk.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&c.done]))[0]};return _f.set(e,i),i}Ak(t=>({...t,get:(e,n,r)=>H_(e,n)||t.get(e,n,r),has:(e,n)=>!!H_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(jk(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function jk(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Gm="@firebase/app",G_="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gr=new Tg("@firebase/app"),Vk="@firebase/app-compat",Mk="@firebase/analytics-compat",Ok="@firebase/analytics",Lk="@firebase/app-check-compat",Fk="@firebase/app-check",Uk="@firebase/auth",zk="@firebase/auth-compat",Bk="@firebase/database",$k="@firebase/data-connect",qk="@firebase/database-compat",Hk="@firebase/functions",Gk="@firebase/functions-compat",Kk="@firebase/installations",Wk="@firebase/installations-compat",Qk="@firebase/messaging",Yk="@firebase/messaging-compat",Jk="@firebase/performance",Xk="@firebase/performance-compat",Zk="@firebase/remote-config",eR="@firebase/remote-config-compat",tR="@firebase/storage",nR="@firebase/storage-compat",rR="@firebase/firestore",sR="@firebase/ai",iR="@firebase/firestore-compat",oR="firebase",aR="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Km="[DEFAULT]",lR={[Gm]:"fire-core",[Vk]:"fire-core-compat",[Ok]:"fire-analytics",[Mk]:"fire-analytics-compat",[Fk]:"fire-app-check",[Lk]:"fire-app-check-compat",[Uk]:"fire-auth",[zk]:"fire-auth-compat",[Bk]:"fire-rtdb",[$k]:"fire-data-connect",[qk]:"fire-rtdb-compat",[Hk]:"fire-fn",[Gk]:"fire-fn-compat",[Kk]:"fire-iid",[Wk]:"fire-iid-compat",[Qk]:"fire-fcm",[Yk]:"fire-fcm-compat",[Jk]:"fire-perf",[Xk]:"fire-perf-compat",[Zk]:"fire-rc",[eR]:"fire-rc-compat",[tR]:"fire-gcs",[nR]:"fire-gcs-compat",[rR]:"fire-fst",[iR]:"fire-fst-compat",[sR]:"fire-vertex","fire-js":"fire-js",[oR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nd=new Map,cR=new Map,Wm=new Map;function K_(t,e){try{t.container.addComponent(e)}catch(n){gr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ps(t){const e=t.name;if(Wm.has(e))return gr.debug(`There were multiple attempts to register component ${e}.`),!1;Wm.set(e,t);for(const n of nd.values())K_(n,t);for(const n of cR.values())K_(n,t);return!0}function ec(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function $t(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},os=new Xl("app","Firebase",uR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new pr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw os.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=aR;function L1(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:Km,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw os.create("bad-app-name",{appName:String(s)});if(n||(n=k1()),!n)throw os.create("no-options");const i=nd.get(s);if(i){if(ci(n,i.options)&&ci(r,i.config))return i;throw os.create("duplicate-app",{appName:s})}const o=new yk(s);for(const c of Wm.values())o.addComponent(c);const a=new dR(n,r,o);return nd.set(s,a),a}function bg(t=Km){const e=nd.get(t);if(!e&&t===Km&&k1())return L1();if(!e)throw os.create("no-app",{appName:t});return e}function vn(t,e,n){let r=lR[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gr.warn(o.join(" "));return}ps(new pr(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR="firebase-heartbeat-database",fR=1,jl="firebase-heartbeat-store";let xf=null;function F1(){return xf||(xf=kk(hR,fR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jl)}catch(n){console.warn(n)}}}}).catch(t=>{throw os.create("idb-open",{originalErrorMessage:t.message})})),xf}async function mR(t){try{const n=(await F1()).transaction(jl),r=await n.objectStore(jl).get(U1(t));return await n.done,r}catch(e){if(e instanceof Dn)gr.warn(e.message);else{const n=os.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gr.warn(n.message)}}}async function W_(t,e){try{const r=(await F1()).transaction(jl,"readwrite");await r.objectStore(jl).put(e,U1(t)),await r.done}catch(n){if(n instanceof Dn)gr.warn(n.message);else{const r=os.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});gr.warn(r.message)}}}function U1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR=1024,gR=30;class yR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new _R(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Q_();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>gR){const o=xR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){gr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Q_(),{heartbeatsToSend:r,unsentEntries:s}=vR(this._heartbeatsCache.heartbeats),i=td(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return gr.warn(n),""}}}function Q_(){return new Date().toISOString().substring(0,10)}function vR(t,e=pR){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Y_(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Y_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class _R{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return V1()?ok().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await mR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return W_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return W_(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Y_(t){return td(JSON.stringify({version:2,heartbeats:t})).length}function xR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wR(t){ps(new pr("platform-logger",e=>new Dk(e),"PRIVATE")),ps(new pr("heartbeat",e=>new yR(e),"PRIVATE")),vn(Gm,G_,t),vn(Gm,G_,"esm2020"),vn("fire-js","")}wR("");var J_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var as,z1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,y){function S(){}S.prototype=y.prototype,w.F=y.prototype,w.prototype=new S,w.prototype.constructor=w,w.D=function(N,_,C){for(var I=Array(arguments.length-2),se=2;se<arguments.length;se++)I[se-2]=arguments[se];return y.prototype[_].apply(N,I)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(w,y,S){S||(S=0);const N=Array(16);if(typeof y=="string")for(var _=0;_<16;++_)N[_]=y.charCodeAt(S++)|y.charCodeAt(S++)<<8|y.charCodeAt(S++)<<16|y.charCodeAt(S++)<<24;else for(_=0;_<16;++_)N[_]=y[S++]|y[S++]<<8|y[S++]<<16|y[S++]<<24;y=w.g[0],S=w.g[1],_=w.g[2];let C=w.g[3],I;I=y+(C^S&(_^C))+N[0]+3614090360&4294967295,y=S+(I<<7&4294967295|I>>>25),I=C+(_^y&(S^_))+N[1]+3905402710&4294967295,C=y+(I<<12&4294967295|I>>>20),I=_+(S^C&(y^S))+N[2]+606105819&4294967295,_=C+(I<<17&4294967295|I>>>15),I=S+(y^_&(C^y))+N[3]+3250441966&4294967295,S=_+(I<<22&4294967295|I>>>10),I=y+(C^S&(_^C))+N[4]+4118548399&4294967295,y=S+(I<<7&4294967295|I>>>25),I=C+(_^y&(S^_))+N[5]+1200080426&4294967295,C=y+(I<<12&4294967295|I>>>20),I=_+(S^C&(y^S))+N[6]+2821735955&4294967295,_=C+(I<<17&4294967295|I>>>15),I=S+(y^_&(C^y))+N[7]+4249261313&4294967295,S=_+(I<<22&4294967295|I>>>10),I=y+(C^S&(_^C))+N[8]+1770035416&4294967295,y=S+(I<<7&4294967295|I>>>25),I=C+(_^y&(S^_))+N[9]+2336552879&4294967295,C=y+(I<<12&4294967295|I>>>20),I=_+(S^C&(y^S))+N[10]+4294925233&4294967295,_=C+(I<<17&4294967295|I>>>15),I=S+(y^_&(C^y))+N[11]+2304563134&4294967295,S=_+(I<<22&4294967295|I>>>10),I=y+(C^S&(_^C))+N[12]+1804603682&4294967295,y=S+(I<<7&4294967295|I>>>25),I=C+(_^y&(S^_))+N[13]+4254626195&4294967295,C=y+(I<<12&4294967295|I>>>20),I=_+(S^C&(y^S))+N[14]+2792965006&4294967295,_=C+(I<<17&4294967295|I>>>15),I=S+(y^_&(C^y))+N[15]+1236535329&4294967295,S=_+(I<<22&4294967295|I>>>10),I=y+(_^C&(S^_))+N[1]+4129170786&4294967295,y=S+(I<<5&4294967295|I>>>27),I=C+(S^_&(y^S))+N[6]+3225465664&4294967295,C=y+(I<<9&4294967295|I>>>23),I=_+(y^S&(C^y))+N[11]+643717713&4294967295,_=C+(I<<14&4294967295|I>>>18),I=S+(C^y&(_^C))+N[0]+3921069994&4294967295,S=_+(I<<20&4294967295|I>>>12),I=y+(_^C&(S^_))+N[5]+3593408605&4294967295,y=S+(I<<5&4294967295|I>>>27),I=C+(S^_&(y^S))+N[10]+38016083&4294967295,C=y+(I<<9&4294967295|I>>>23),I=_+(y^S&(C^y))+N[15]+3634488961&4294967295,_=C+(I<<14&4294967295|I>>>18),I=S+(C^y&(_^C))+N[4]+3889429448&4294967295,S=_+(I<<20&4294967295|I>>>12),I=y+(_^C&(S^_))+N[9]+568446438&4294967295,y=S+(I<<5&4294967295|I>>>27),I=C+(S^_&(y^S))+N[14]+3275163606&4294967295,C=y+(I<<9&4294967295|I>>>23),I=_+(y^S&(C^y))+N[3]+4107603335&4294967295,_=C+(I<<14&4294967295|I>>>18),I=S+(C^y&(_^C))+N[8]+1163531501&4294967295,S=_+(I<<20&4294967295|I>>>12),I=y+(_^C&(S^_))+N[13]+2850285829&4294967295,y=S+(I<<5&4294967295|I>>>27),I=C+(S^_&(y^S))+N[2]+4243563512&4294967295,C=y+(I<<9&4294967295|I>>>23),I=_+(y^S&(C^y))+N[7]+1735328473&4294967295,_=C+(I<<14&4294967295|I>>>18),I=S+(C^y&(_^C))+N[12]+2368359562&4294967295,S=_+(I<<20&4294967295|I>>>12),I=y+(S^_^C)+N[5]+4294588738&4294967295,y=S+(I<<4&4294967295|I>>>28),I=C+(y^S^_)+N[8]+2272392833&4294967295,C=y+(I<<11&4294967295|I>>>21),I=_+(C^y^S)+N[11]+1839030562&4294967295,_=C+(I<<16&4294967295|I>>>16),I=S+(_^C^y)+N[14]+4259657740&4294967295,S=_+(I<<23&4294967295|I>>>9),I=y+(S^_^C)+N[1]+2763975236&4294967295,y=S+(I<<4&4294967295|I>>>28),I=C+(y^S^_)+N[4]+1272893353&4294967295,C=y+(I<<11&4294967295|I>>>21),I=_+(C^y^S)+N[7]+4139469664&4294967295,_=C+(I<<16&4294967295|I>>>16),I=S+(_^C^y)+N[10]+3200236656&4294967295,S=_+(I<<23&4294967295|I>>>9),I=y+(S^_^C)+N[13]+681279174&4294967295,y=S+(I<<4&4294967295|I>>>28),I=C+(y^S^_)+N[0]+3936430074&4294967295,C=y+(I<<11&4294967295|I>>>21),I=_+(C^y^S)+N[3]+3572445317&4294967295,_=C+(I<<16&4294967295|I>>>16),I=S+(_^C^y)+N[6]+76029189&4294967295,S=_+(I<<23&4294967295|I>>>9),I=y+(S^_^C)+N[9]+3654602809&4294967295,y=S+(I<<4&4294967295|I>>>28),I=C+(y^S^_)+N[12]+3873151461&4294967295,C=y+(I<<11&4294967295|I>>>21),I=_+(C^y^S)+N[15]+530742520&4294967295,_=C+(I<<16&4294967295|I>>>16),I=S+(_^C^y)+N[2]+3299628645&4294967295,S=_+(I<<23&4294967295|I>>>9),I=y+(_^(S|~C))+N[0]+4096336452&4294967295,y=S+(I<<6&4294967295|I>>>26),I=C+(S^(y|~_))+N[7]+1126891415&4294967295,C=y+(I<<10&4294967295|I>>>22),I=_+(y^(C|~S))+N[14]+2878612391&4294967295,_=C+(I<<15&4294967295|I>>>17),I=S+(C^(_|~y))+N[5]+4237533241&4294967295,S=_+(I<<21&4294967295|I>>>11),I=y+(_^(S|~C))+N[12]+1700485571&4294967295,y=S+(I<<6&4294967295|I>>>26),I=C+(S^(y|~_))+N[3]+2399980690&4294967295,C=y+(I<<10&4294967295|I>>>22),I=_+(y^(C|~S))+N[10]+4293915773&4294967295,_=C+(I<<15&4294967295|I>>>17),I=S+(C^(_|~y))+N[1]+2240044497&4294967295,S=_+(I<<21&4294967295|I>>>11),I=y+(_^(S|~C))+N[8]+1873313359&4294967295,y=S+(I<<6&4294967295|I>>>26),I=C+(S^(y|~_))+N[15]+4264355552&4294967295,C=y+(I<<10&4294967295|I>>>22),I=_+(y^(C|~S))+N[6]+2734768916&4294967295,_=C+(I<<15&4294967295|I>>>17),I=S+(C^(_|~y))+N[13]+1309151649&4294967295,S=_+(I<<21&4294967295|I>>>11),I=y+(_^(S|~C))+N[4]+4149444226&4294967295,y=S+(I<<6&4294967295|I>>>26),I=C+(S^(y|~_))+N[11]+3174756917&4294967295,C=y+(I<<10&4294967295|I>>>22),I=_+(y^(C|~S))+N[2]+718787259&4294967295,_=C+(I<<15&4294967295|I>>>17),I=S+(C^(_|~y))+N[9]+3951481745&4294967295,w.g[0]=w.g[0]+y&4294967295,w.g[1]=w.g[1]+(_+(I<<21&4294967295|I>>>11))&4294967295,w.g[2]=w.g[2]+_&4294967295,w.g[3]=w.g[3]+C&4294967295}r.prototype.v=function(w,y){y===void 0&&(y=w.length);const S=y-this.blockSize,N=this.C;let _=this.h,C=0;for(;C<y;){if(_==0)for(;C<=S;)s(this,w,C),C+=this.blockSize;if(typeof w=="string"){for(;C<y;)if(N[_++]=w.charCodeAt(C++),_==this.blockSize){s(this,N),_=0;break}}else for(;C<y;)if(N[_++]=w[C++],_==this.blockSize){s(this,N),_=0;break}}this.h=_,this.o+=y},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var y=1;y<w.length-8;++y)w[y]=0;y=this.o*8;for(var S=w.length-8;S<w.length;++S)w[S]=y&255,y/=256;for(this.v(w),w=Array(16),y=0,S=0;S<4;++S)for(let N=0;N<32;N+=8)w[y++]=this.g[S]>>>N&255;return w};function i(w,y){var S=a;return Object.prototype.hasOwnProperty.call(S,w)?S[w]:S[w]=y(w)}function o(w,y){this.h=y;const S=[];let N=!0;for(let _=w.length-1;_>=0;_--){const C=w[_]|0;N&&C==y||(S[_]=C,N=!1)}this.g=S}var a={};function c(w){return-128<=w&&w<128?i(w,function(y){return new o([y|0],y<0?-1:0)}):new o([w|0],w<0?-1:0)}function d(w){if(isNaN(w)||!isFinite(w))return m;if(w<0)return D(d(-w));const y=[];let S=1;for(let N=0;w>=S;N++)y[N]=w/S|0,S*=4294967296;return new o(y,0)}function h(w,y){if(w.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(w.charAt(0)=="-")return D(h(w.substring(1),y));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=d(Math.pow(y,8));let N=m;for(let C=0;C<w.length;C+=8){var _=Math.min(8,w.length-C);const I=parseInt(w.substring(C,C+_),y);_<8?(_=d(Math.pow(y,_)),N=N.j(_).add(d(I))):(N=N.j(S),N=N.add(d(I)))}return N}var m=c(0),g=c(1),x=c(16777216);t=o.prototype,t.m=function(){if(k(this))return-D(this).m();let w=0,y=1;for(let S=0;S<this.g.length;S++){const N=this.i(S);w+=(N>=0?N:4294967296+N)*y,y*=4294967296}return w},t.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(T(this))return"0";if(k(this))return"-"+D(this).toString(w);const y=d(Math.pow(w,6));var S=this;let N="";for(;;){const _=P(S,y).g;S=b(S,_.j(y));let C=((S.g.length>0?S.g[0]:S.h)>>>0).toString(w);if(S=_,T(S))return C+N;for(;C.length<6;)C="0"+C;N=C+N}},t.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function T(w){if(w.h!=0)return!1;for(let y=0;y<w.g.length;y++)if(w.g[y]!=0)return!1;return!0}function k(w){return w.h==-1}t.l=function(w){return w=b(this,w),k(w)?-1:T(w)?0:1};function D(w){const y=w.g.length,S=[];for(let N=0;N<y;N++)S[N]=~w.g[N];return new o(S,~w.h).add(g)}t.abs=function(){return k(this)?D(this):this},t.add=function(w){const y=Math.max(this.g.length,w.g.length),S=[];let N=0;for(let _=0;_<=y;_++){let C=N+(this.i(_)&65535)+(w.i(_)&65535),I=(C>>>16)+(this.i(_)>>>16)+(w.i(_)>>>16);N=I>>>16,C&=65535,I&=65535,S[_]=I<<16|C}return new o(S,S[S.length-1]&-2147483648?-1:0)};function b(w,y){return w.add(D(y))}t.j=function(w){if(T(this)||T(w))return m;if(k(this))return k(w)?D(this).j(D(w)):D(D(this).j(w));if(k(w))return D(this.j(D(w)));if(this.l(x)<0&&w.l(x)<0)return d(this.m()*w.m());const y=this.g.length+w.g.length,S=[];for(var N=0;N<2*y;N++)S[N]=0;for(N=0;N<this.g.length;N++)for(let _=0;_<w.g.length;_++){const C=this.i(N)>>>16,I=this.i(N)&65535,se=w.i(_)>>>16,ae=w.i(_)&65535;S[2*N+2*_]+=I*ae,E(S,2*N+2*_),S[2*N+2*_+1]+=C*ae,E(S,2*N+2*_+1),S[2*N+2*_+1]+=I*se,E(S,2*N+2*_+1),S[2*N+2*_+2]+=C*se,E(S,2*N+2*_+2)}for(w=0;w<y;w++)S[w]=S[2*w+1]<<16|S[2*w];for(w=y;w<2*y;w++)S[w]=0;return new o(S,0)};function E(w,y){for(;(w[y]&65535)!=w[y];)w[y+1]+=w[y]>>>16,w[y]&=65535,y++}function A(w,y){this.g=w,this.h=y}function P(w,y){if(T(y))throw Error("division by zero");if(T(w))return new A(m,m);if(k(w))return y=P(D(w),y),new A(D(y.g),D(y.h));if(k(y))return y=P(w,D(y)),new A(D(y.g),y.h);if(w.g.length>30){if(k(w)||k(y))throw Error("slowDivide_ only works with positive integers.");for(var S=g,N=y;N.l(w)<=0;)S=M(S),N=M(N);var _=B(S,1),C=B(N,1);for(N=B(N,2),S=B(S,2);!T(N);){var I=C.add(N);I.l(w)<=0&&(_=_.add(S),C=I),N=B(N,1),S=B(S,1)}return y=b(w,_.j(y)),new A(_,y)}for(_=m;w.l(y)>=0;){for(S=Math.max(1,Math.floor(w.m()/y.m())),N=Math.ceil(Math.log(S)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),C=d(S),I=C.j(y);k(I)||I.l(w)>0;)S-=N,C=d(S),I=C.j(y);T(C)&&(C=g),_=_.add(C),w=b(w,I)}return new A(_,w)}t.B=function(w){return P(this,w).h},t.and=function(w){const y=Math.max(this.g.length,w.g.length),S=[];for(let N=0;N<y;N++)S[N]=this.i(N)&w.i(N);return new o(S,this.h&w.h)},t.or=function(w){const y=Math.max(this.g.length,w.g.length),S=[];for(let N=0;N<y;N++)S[N]=this.i(N)|w.i(N);return new o(S,this.h|w.h)},t.xor=function(w){const y=Math.max(this.g.length,w.g.length),S=[];for(let N=0;N<y;N++)S[N]=this.i(N)^w.i(N);return new o(S,this.h^w.h)};function M(w){const y=w.g.length+1,S=[];for(let N=0;N<y;N++)S[N]=w.i(N)<<1|w.i(N-1)>>>31;return new o(S,w.h)}function B(w,y){const S=y>>5;y%=32;const N=w.g.length-S,_=[];for(let C=0;C<N;C++)_[C]=y>0?w.i(C+S)>>>y|w.i(C+S+1)<<32-y:w.i(C+S);return new o(_,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,z1=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,as=o}).apply(typeof J_<"u"?J_:typeof self<"u"?self:typeof window<"u"?window:{});var $c=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var B1,$a,$1,fu,Qm,q1,H1,G1;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof $c=="object"&&$c];for(var f=0;f<l.length;++f){var p=l[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(l,f){if(f)e:{var p=r;l=l.split(".");for(var v=0;v<l.length-1;v++){var j=l[v];if(!(j in p))break e;p=p[j]}l=l[l.length-1],v=p[l],f=f(v),f!=v&&f!=null&&e(p,l,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(f){var p=[],v;for(v in f)Object.prototype.hasOwnProperty.call(f,v)&&p.push([v,f[v]]);return p}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function c(l,f,p){return l.call.apply(l.bind,arguments)}function d(l,f,p){return d=c,d.apply(null,arguments)}function h(l,f){var p=Array.prototype.slice.call(arguments,1);return function(){var v=p.slice();return v.push.apply(v,arguments),l.apply(this,v)}}function m(l,f){function p(){}p.prototype=f.prototype,l.Z=f.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(v,j,L){for(var Y=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)Y[ye-2]=arguments[ye];return f.prototype[j].apply(v,Y)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function x(l){const f=l.length;if(f>0){const p=Array(f);for(let v=0;v<f;v++)p[v]=l[v];return p}return[]}function T(l,f){for(let v=1;v<arguments.length;v++){const j=arguments[v];var p=typeof j;if(p=p!="object"?p:j?Array.isArray(j)?"array":p:"null",p=="array"||p=="object"&&typeof j.length=="number"){p=l.length||0;const L=j.length||0;l.length=p+L;for(let Y=0;Y<L;Y++)l[p+Y]=j[Y]}else l.push(j)}}class k{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function D(l){o.setTimeout(()=>{throw l},0)}function b(){var l=w;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class E{constructor(){this.h=this.g=null}add(f,p){const v=A.get();v.set(f,p),this.h?this.h.next=v:this.g=v,this.h=v}}var A=new k(()=>new P,l=>l.reset());class P{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let M,B=!1,w=new E,y=()=>{const l=Promise.resolve(void 0);M=()=>{l.then(S)}};function S(){for(var l;l=b();){try{l.h.call(l.g)}catch(p){D(p)}var f=A;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}B=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}_.prototype.h=function(){this.defaultPrevented=!0};var C=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};o.addEventListener("test",p,f),o.removeEventListener("test",p,f)}catch{}return l}();function I(l){return/^[\s\xa0]*$/.test(l)}function se(l,f){_.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}m(se,_),se.prototype.init=function(l,f){const p=this.type=l.type,v=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(p=="mouseover"?f=l.fromElement:p=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,v?(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ae="closure_listenable_"+(Math.random()*1e6|0),G=0;function Ee(l,f,p,v,j){this.listener=l,this.proxy=null,this.src=f,this.type=p,this.capture=!!v,this.ha=j,this.key=++G,this.da=this.fa=!1}function $(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function O(l,f,p){for(const v in l)f.call(p,l[v],v,l)}function K(l,f){for(const p in l)f.call(void 0,l[p],p,l)}function Q(l){const f={};for(const p in l)f[p]=l[p];return f}const ue="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(l,f){let p,v;for(let j=1;j<arguments.length;j++){v=arguments[j];for(p in v)l[p]=v[p];for(let L=0;L<ue.length;L++)p=ue[L],Object.prototype.hasOwnProperty.call(v,p)&&(l[p]=v[p])}}function le(l){this.src=l,this.g={},this.h=0}le.prototype.add=function(l,f,p,v,j){const L=l.toString();l=this.g[L],l||(l=this.g[L]=[],this.h++);const Y=Ie(l,f,v,j);return Y>-1?(f=l[Y],p||(f.fa=!1)):(f=new Ee(f,this.src,L,!!v,j),f.fa=p,l.push(f)),f};function Ae(l,f){const p=f.type;if(p in l.g){var v=l.g[p],j=Array.prototype.indexOf.call(v,f,void 0),L;(L=j>=0)&&Array.prototype.splice.call(v,j,1),L&&($(f),l.g[p].length==0&&(delete l.g[p],l.h--))}}function Ie(l,f,p,v){for(let j=0;j<l.length;++j){const L=l[j];if(!L.da&&L.listener==f&&L.capture==!!p&&L.ha==v)return j}return-1}var De="closure_lm_"+(Math.random()*1e6|0),Ve={};function qe(l,f,p,v,j){if(Array.isArray(f)){for(let L=0;L<f.length;L++)qe(l,f[L],p,v,j);return null}return p=Ci(p),l&&l[ae]?l.J(f,p,a(v)?!!v.capture:!1,j):bi(l,f,p,!1,v,j)}function bi(l,f,p,v,j,L){if(!f)throw Error("Invalid event type");const Y=a(j)?!!j.capture:!!j;let ye=Vn(l);if(ye||(l[De]=ye=new le(l)),p=ye.add(f,p,v,Y,L),p.proxy)return p;if(v=Ai(),p.proxy=v,v.src=l,v.listener=p,l.addEventListener)C||(j=Y),j===void 0&&(j=!1),l.addEventListener(f.toString(),v,j);else if(l.attachEvent)l.attachEvent(Ni(f.toString()),v);else if(l.addListener&&l.removeListener)l.addListener(v);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Ai(){function l(p){return f.call(l.src,l.listener,p)}const f=ft;return l}function Sr(l,f,p,v,j){if(Array.isArray(f))for(var L=0;L<f.length;L++)Sr(l,f[L],p,v,j);else v=a(v)?!!v.capture:!!v,p=Ci(p),l&&l[ae]?(l=l.i,L=String(f).toString(),L in l.g&&(f=l.g[L],p=Ie(f,p,v,j),p>-1&&($(f[p]),Array.prototype.splice.call(f,p,1),f.length==0&&(delete l.g[L],l.h--)))):l&&(l=Vn(l))&&(f=l.g[f.toString()],l=-1,f&&(l=Ie(f,p,v,j)),(p=l>-1?f[l]:null)&&jn(p))}function jn(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[ae])Ae(f.i,l);else{var p=l.type,v=l.proxy;f.removeEventListener?f.removeEventListener(p,v,l.capture):f.detachEvent?f.detachEvent(Ni(p),v):f.addListener&&f.removeListener&&f.removeListener(v),(p=Vn(f))?(Ae(p,l),p.h==0&&(p.src=null,f[De]=null)):$(l)}}}function Ni(l){return l in Ve?Ve[l]:Ve[l]="on"+l}function ft(l,f){if(l.da)l=!0;else{f=new se(f,this);const p=l.listener,v=l.ha||l.src;l.fa&&jn(l),l=p.call(v,f)}return l}function Vn(l){return l=l[De],l instanceof le?l:null}var Cs="__closure_events_fn_"+(Math.random()*1e9>>>0);function Ci(l){return typeof l=="function"?l:(l[Cs]||(l[Cs]=function(f){return l.handleEvent(f)}),l[Cs])}function U(){N.call(this),this.i=new le(this),this.M=this,this.G=null}m(U,N),U.prototype[ae]=!0,U.prototype.removeEventListener=function(l,f,p,v){Sr(this,l,f,p,v)};function ce(l,f){var p,v=l.G;if(v)for(p=[];v;v=v.G)p.push(v);if(l=l.M,v=f.type||f,typeof f=="string")f=new _(f,l);else if(f instanceof _)f.target=f.target||l;else{var j=f;f=new _(v,l),Z(f,j)}j=!0;let L,Y;if(p)for(Y=p.length-1;Y>=0;Y--)L=f.g=p[Y],j=F(L,v,!0,f)&&j;if(L=f.g=l,j=F(L,v,!0,f)&&j,j=F(L,v,!1,f)&&j,p)for(Y=0;Y<p.length;Y++)L=f.g=p[Y],j=F(L,v,!1,f)&&j}U.prototype.N=function(){if(U.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const p=l.g[f];for(let v=0;v<p.length;v++)$(p[v]);delete l.g[f],l.h--}}this.G=null},U.prototype.J=function(l,f,p,v){return this.i.add(String(l),f,!1,p,v)},U.prototype.K=function(l,f,p,v){return this.i.add(String(l),f,!0,p,v)};function F(l,f,p,v){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let j=!0;for(let L=0;L<f.length;++L){const Y=f[L];if(Y&&!Y.da&&Y.capture==p){const ye=Y.listener,at=Y.ha||Y.src;Y.fa&&Ae(l.i,Y),j=ye.call(at,v)!==!1&&j}}return j&&!v.defaultPrevented}function J(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(l,f||0)}function ne(l){l.g=J(()=>{l.g=null,l.i&&(l.i=!1,ne(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class fe extends N{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:ne(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ge(l){N.call(this),this.h=l,this.g={}}m(ge,N);var jt=[];function br(l){O(l.g,function(f,p){this.g.hasOwnProperty(p)&&jn(f)},l),l.g={}}ge.prototype.N=function(){ge.Z.N.call(this),br(this)},ge.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Mn=o.JSON.stringify,Sh=o.JSON.parse,xb=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function Vy(){}function My(){}var sa={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function bh(){_.call(this,"d")}m(bh,_);function Ah(){_.call(this,"c")}m(Ah,_);var ks={},Oy=null;function pc(){return Oy=Oy||new U}ks.Ia="serverreachability";function Ly(l){_.call(this,ks.Ia,l)}m(Ly,_);function ia(l){const f=pc();ce(f,new Ly(f))}ks.STAT_EVENT="statevent";function Fy(l,f){_.call(this,ks.STAT_EVENT,l),this.stat=f}m(Fy,_);function Vt(l){const f=pc();ce(f,new Fy(f,l))}ks.Ja="timingevent";function Uy(l,f){_.call(this,ks.Ja,l),this.size=f}m(Uy,_);function oa(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},f)}function aa(){this.g=!0}aa.prototype.ua=function(){this.g=!1};function wb(l,f,p,v,j,L){l.info(function(){if(l.g)if(L){var Y="",ye=L.split("&");for(let je=0;je<ye.length;je++){var at=ye[je].split("=");if(at.length>1){const mt=at[0];at=at[1];const Ln=mt.split("_");Y=Ln.length>=2&&Ln[1]=="type"?Y+(mt+"="+at+"&"):Y+(mt+"=redacted&")}}}else Y=null;else Y=L;return"XMLHTTP REQ ("+v+") [attempt "+j+"]: "+f+`
`+p+`
`+Y})}function Eb(l,f,p,v,j,L,Y){l.info(function(){return"XMLHTTP RESP ("+v+") [ attempt "+j+"]: "+f+`
`+p+`
`+L+" "+Y})}function ki(l,f,p,v){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+Tb(l,p)+(v?" "+v:"")})}function Ib(l,f){l.info(function(){return"TIMEOUT: "+f})}aa.prototype.info=function(){};function Tb(l,f){if(!l.g)return f;if(!f)return null;try{const L=JSON.parse(f);if(L){for(l=0;l<L.length;l++)if(Array.isArray(L[l])){var p=L[l];if(!(p.length<2)){var v=p[1];if(Array.isArray(v)&&!(v.length<1)){var j=v[0];if(j!="noop"&&j!="stop"&&j!="close")for(let Y=1;Y<v.length;Y++)v[Y]=""}}}}return Mn(L)}catch{return f}}var gc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},zy={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},By;function Nh(){}m(Nh,Vy),Nh.prototype.g=function(){return new XMLHttpRequest},By=new Nh;function la(l){return encodeURIComponent(String(l))}function Sb(l){var f=1;l=l.split(":");const p=[];for(;f>0&&l.length;)p.push(l.shift()),f--;return l.length&&p.push(l.join(":")),p}function Ar(l,f,p,v){this.j=l,this.i=f,this.l=p,this.S=v||1,this.V=new ge(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new $y}function $y(){this.i=null,this.g="",this.h=!1}var qy={},Ch={};function kh(l,f,p){l.M=1,l.A=vc(On(f)),l.u=p,l.R=!0,Hy(l,null)}function Hy(l,f){l.F=Date.now(),yc(l),l.B=On(l.A);var p=l.B,v=l.S;Array.isArray(v)||(v=[String(v)]),sv(p.i,"t",v),l.C=0,p=l.j.L,l.h=new $y,l.g=Ev(l.j,p?f:null,!l.u),l.P>0&&(l.O=new fe(d(l.Y,l,l.g),l.P)),f=l.V,p=l.g,v=l.ba;var j="readystatechange";Array.isArray(j)||(j&&(jt[0]=j.toString()),j=jt);for(let L=0;L<j.length;L++){const Y=qe(p,j[L],v||f.handleEvent,!1,f.h||f);if(!Y)break;f.g[Y.key]=Y}f=l.J?Q(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),ia(),wb(l.i,l.v,l.B,l.l,l.S,l.u)}Ar.prototype.ba=function(l){l=l.target;const f=this.O;f&&kr(l)==3?f.j():this.Y(l)},Ar.prototype.Y=function(l){try{if(l==this.g)e:{const ye=kr(this.g),at=this.g.ya(),je=this.g.ca();if(!(ye<3)&&(ye!=3||this.g&&(this.h.h||this.g.la()||dv(this.g)))){this.K||ye!=4||at==7||(at==8||je<=0?ia(3):ia(2)),Rh(this);var f=this.g.ca();this.X=f;var p=bb(this);if(this.o=f==200,Eb(this.i,this.v,this.B,this.l,this.S,ye,f),this.o){if(this.U&&!this.L){t:{if(this.g){var v,j=this.g;if((v=j.g?j.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(v)){var L=v;break t}}L=null}if(l=L)ki(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Ph(this,l);else{this.o=!1,this.m=3,Vt(12),Rs(this),ca(this);break e}}if(this.R){l=!0;let mt;for(;!this.K&&this.C<p.length;)if(mt=Ab(this,p),mt==Ch){ye==4&&(this.m=4,Vt(14),l=!1),ki(this.i,this.l,null,"[Incomplete Response]");break}else if(mt==qy){this.m=4,Vt(15),ki(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else ki(this.i,this.l,mt,null),Ph(this,mt);if(Gy(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ye!=4||p.length!=0||this.h.h||(this.m=1,Vt(16),l=!1),this.o=this.o&&l,!l)ki(this.i,this.l,p,"[Invalid Chunked Response]"),Rs(this),ca(this);else if(p.length>0&&!this.W){this.W=!0;var Y=this.j;Y.g==this&&Y.aa&&!Y.P&&(Y.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),Uh(Y),Y.P=!0,Vt(11))}}else ki(this.i,this.l,p,null),Ph(this,p);ye==4&&Rs(this),this.o&&!this.K&&(ye==4?vv(this.j,this):(this.o=!1,yc(this)))}else zb(this.g),f==400&&p.indexOf("Unknown SID")>0?(this.m=3,Vt(12)):(this.m=0,Vt(13)),Rs(this),ca(this)}}}catch{}finally{}};function bb(l){if(!Gy(l))return l.g.la();const f=dv(l.g);if(f==="")return"";let p="";const v=f.length,j=kr(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Rs(l),ca(l),"";l.h.i=new o.TextDecoder}for(let L=0;L<v;L++)l.h.h=!0,p+=l.h.i.decode(f[L],{stream:!(j&&L==v-1)});return f.length=0,l.h.g+=p,l.C=0,l.h.g}function Gy(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function Ab(l,f){var p=l.C,v=f.indexOf(`
`,p);return v==-1?Ch:(p=Number(f.substring(p,v)),isNaN(p)?qy:(v+=1,v+p>f.length?Ch:(f=f.slice(v,v+p),l.C=v+p,f)))}Ar.prototype.cancel=function(){this.K=!0,Rs(this)};function yc(l){l.T=Date.now()+l.H,Ky(l,l.H)}function Ky(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=oa(d(l.aa,l),f)}function Rh(l){l.D&&(o.clearTimeout(l.D),l.D=null)}Ar.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(Ib(this.i,this.B),this.M!=2&&(ia(),Vt(17)),Rs(this),this.m=2,ca(this)):Ky(this,this.T-l)};function ca(l){l.j.I==0||l.K||vv(l.j,l)}function Rs(l){Rh(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,br(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function Ph(l,f){try{var p=l.j;if(p.I!=0&&(p.g==l||Dh(p.h,l))){if(!l.L&&Dh(p.h,l)&&p.I==3){try{var v=p.Ba.g.parse(f)}catch{v=null}if(Array.isArray(v)&&v.length==3){var j=v;if(j[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)Ic(p),wc(p);else break e;Fh(p),Vt(18)}}else p.xa=j[1],0<p.xa-p.K&&j[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=oa(d(p.Va,p),6e3));Yy(p.h)<=1&&p.ta&&(p.ta=void 0)}else Ds(p,11)}else if((l.L||p.g==l)&&Ic(p),!I(f))for(j=p.Ba.g.parse(f),f=0;f<j.length;f++){let je=j[f];const mt=je[0];if(!(mt<=p.K))if(p.K=mt,je=je[1],p.I==2)if(je[0]=="c"){p.M=je[1],p.ba=je[2];const Ln=je[3];Ln!=null&&(p.ka=Ln,p.j.info("VER="+p.ka));const js=je[4];js!=null&&(p.za=js,p.j.info("SVER="+p.za));const Rr=je[5];Rr!=null&&typeof Rr=="number"&&Rr>0&&(v=1.5*Rr,p.O=v,p.j.info("backChannelRequestTimeoutMs_="+v)),v=p;const Pr=l.g;if(Pr){const Sc=Pr.g?Pr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Sc){var L=v.h;L.g||Sc.indexOf("spdy")==-1&&Sc.indexOf("quic")==-1&&Sc.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(jh(L,L.h),L.h=null))}if(v.G){const zh=Pr.g?Pr.g.getResponseHeader("X-HTTP-Session-Id"):null;zh&&(v.wa=zh,Le(v.J,v.G,zh))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),v=p;var Y=l;if(v.na=wv(v,v.L?v.ba:null,v.W),Y.L){Jy(v.h,Y);var ye=Y,at=v.O;at&&(ye.H=at),ye.D&&(Rh(ye),yc(ye)),v.g=Y}else gv(v);p.i.length>0&&Ec(p)}else je[0]!="stop"&&je[0]!="close"||Ds(p,7);else p.I==3&&(je[0]=="stop"||je[0]=="close"?je[0]=="stop"?Ds(p,7):Lh(p):je[0]!="noop"&&p.l&&p.l.qa(je),p.A=0)}}ia(4)}catch{}}var Nb=class{constructor(l,f){this.g=l,this.map=f}};function Wy(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Qy(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Yy(l){return l.h?1:l.g?l.g.size:0}function Dh(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function jh(l,f){l.g?l.g.add(f):l.h=f}function Jy(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Wy.prototype.cancel=function(){if(this.i=Xy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Xy(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const p of l.g.values())f=f.concat(p.G);return f}return x(l.i)}var Zy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cb(l,f){if(l){l=l.split("&");for(let p=0;p<l.length;p++){const v=l[p].indexOf("=");let j,L=null;v>=0?(j=l[p].substring(0,v),L=l[p].substring(v+1)):j=l[p],f(j,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function Nr(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof Nr?(this.l=l.l,ua(this,l.j),this.o=l.o,this.g=l.g,da(this,l.u),this.h=l.h,Vh(this,iv(l.i)),this.m=l.m):l&&(f=String(l).match(Zy))?(this.l=!1,ua(this,f[1]||"",!0),this.o=ha(f[2]||""),this.g=ha(f[3]||"",!0),da(this,f[4]),this.h=ha(f[5]||"",!0),Vh(this,f[6]||"",!0),this.m=ha(f[7]||"")):(this.l=!1,this.i=new ma(null,this.l))}Nr.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(fa(f,ev,!0),":");var p=this.g;return(p||f=="file")&&(l.push("//"),(f=this.o)&&l.push(fa(f,ev,!0),"@"),l.push(la(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(fa(p,p.charAt(0)=="/"?Pb:Rb,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",fa(p,jb)),l.join("")},Nr.prototype.resolve=function(l){const f=On(this);let p=!!l.j;p?ua(f,l.j):p=!!l.o,p?f.o=l.o:p=!!l.g,p?f.g=l.g:p=l.u!=null;var v=l.h;if(p)da(f,l.u);else if(p=!!l.h){if(v.charAt(0)!="/")if(this.g&&!this.h)v="/"+v;else{var j=f.h.lastIndexOf("/");j!=-1&&(v=f.h.slice(0,j+1)+v)}if(j=v,j==".."||j==".")v="";else if(j.indexOf("./")!=-1||j.indexOf("/.")!=-1){v=j.lastIndexOf("/",0)==0,j=j.split("/");const L=[];for(let Y=0;Y<j.length;){const ye=j[Y++];ye=="."?v&&Y==j.length&&L.push(""):ye==".."?((L.length>1||L.length==1&&L[0]!="")&&L.pop(),v&&Y==j.length&&L.push("")):(L.push(ye),v=!0)}v=L.join("/")}else v=j}return p?f.h=v:p=l.i.toString()!=="",p?Vh(f,iv(l.i)):p=!!l.m,p&&(f.m=l.m),f};function On(l){return new Nr(l)}function ua(l,f,p){l.j=p?ha(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function da(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function Vh(l,f,p){f instanceof ma?(l.i=f,Vb(l.i,l.l)):(p||(f=fa(f,Db)),l.i=new ma(f,l.l))}function Le(l,f,p){l.i.set(f,p)}function vc(l){return Le(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function ha(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function fa(l,f,p){return typeof l=="string"?(l=encodeURI(l).replace(f,kb),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function kb(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var ev=/[#\/\?@]/g,Rb=/[#\?:]/g,Pb=/[#\?]/g,Db=/[#\?@]/g,jb=/#/g;function ma(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Ps(l){l.g||(l.g=new Map,l.h=0,l.i&&Cb(l.i,function(f,p){l.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}t=ma.prototype,t.add=function(l,f){Ps(this),this.i=null,l=Ri(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(f),this.h+=1,this};function tv(l,f){Ps(l),f=Ri(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function nv(l,f){return Ps(l),f=Ri(l,f),l.g.has(f)}t.forEach=function(l,f){Ps(this),this.g.forEach(function(p,v){p.forEach(function(j){l.call(f,j,v,this)},this)},this)};function rv(l,f){Ps(l);let p=[];if(typeof f=="string")nv(l,f)&&(p=p.concat(l.g.get(Ri(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)p=p.concat(l[f]);return p}t.set=function(l,f){return Ps(this),this.i=null,l=Ri(this,l),nv(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=rv(this,l),l.length>0?String(l[0]):f):f};function sv(l,f,p){tv(l,f),p.length>0&&(l.i=null,l.g.set(Ri(l,f),x(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let v=0;v<f.length;v++){var p=f[v];const j=la(p);p=rv(this,p);for(let L=0;L<p.length;L++){let Y=j;p[L]!==""&&(Y+="="+la(p[L])),l.push(Y)}}return this.i=l.join("&")};function iv(l){const f=new ma;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function Ri(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function Vb(l,f){f&&!l.j&&(Ps(l),l.i=null,l.g.forEach(function(p,v){const j=v.toLowerCase();v!=j&&(tv(this,v),sv(this,j,p))},l)),l.j=f}function Mb(l,f){const p=new aa;if(o.Image){const v=new Image;v.onload=h(Cr,p,"TestLoadImage: loaded",!0,f,v),v.onerror=h(Cr,p,"TestLoadImage: error",!1,f,v),v.onabort=h(Cr,p,"TestLoadImage: abort",!1,f,v),v.ontimeout=h(Cr,p,"TestLoadImage: timeout",!1,f,v),o.setTimeout(function(){v.ontimeout&&v.ontimeout()},1e4),v.src=l}else f(!1)}function Ob(l,f){const p=new aa,v=new AbortController,j=setTimeout(()=>{v.abort(),Cr(p,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:v.signal}).then(L=>{clearTimeout(j),L.ok?Cr(p,"TestPingServer: ok",!0,f):Cr(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(j),Cr(p,"TestPingServer: error",!1,f)})}function Cr(l,f,p,v,j){try{j&&(j.onload=null,j.onerror=null,j.onabort=null,j.ontimeout=null),v(p)}catch{}}function Lb(){this.g=new xb}function Mh(l){this.i=l.Sb||null,this.h=l.ab||!1}m(Mh,Vy),Mh.prototype.g=function(){return new _c(this.i,this.h)};function _c(l,f){U.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(_c,U),t=_c.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,ga(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,pa(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ga(this)),this.g&&(this.readyState=3,ga(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;ov(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function ov(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?pa(this):ga(this),this.readyState==3&&ov(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,pa(this))},t.Na=function(l){this.g&&(this.response=l,pa(this))},t.ga=function(){this.g&&pa(this)};function pa(l){l.readyState=4,l.l=null,l.j=null,l.B=null,ga(l)}t.setRequestHeader=function(l,f){this.A.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=f.next();return l.join(`\r
`)};function ga(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(_c.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function av(l){let f="";return O(l,function(p,v){f+=v,f+=":",f+=p,f+=`\r
`}),f}function Oh(l,f,p){e:{for(v in p){var v=!1;break e}v=!0}v||(p=av(p),typeof l=="string"?p!=null&&la(p):Le(l,f,p))}function Qe(l){U.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Qe,U);var Fb=/^https?$/i,Ub=["POST","PUT"];t=Qe.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,f,p,v){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():By.g(),this.g.onreadystatechange=g(d(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(L){lv(this,L);return}if(l=p||"",p=new Map(this.headers),v)if(Object.getPrototypeOf(v)===Object.prototype)for(var j in v)p.set(j,v[j]);else if(typeof v.keys=="function"&&typeof v.get=="function")for(const L of v.keys())p.set(L,v.get(L));else throw Error("Unknown input type for opt_headers: "+String(v));v=Array.from(p.keys()).find(L=>L.toLowerCase()=="content-type"),j=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(Ub,f,void 0)>=0)||v||j||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[L,Y]of p)this.g.setRequestHeader(L,Y);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(L){lv(this,L)}};function lv(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,cv(l),xc(l)}function cv(l){l.A||(l.A=!0,ce(l,"complete"),ce(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,ce(this,"complete"),ce(this,"abort"),xc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xc(this,!0)),Qe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?uv(this):this.Xa())},t.Xa=function(){uv(this)};function uv(l){if(l.h&&typeof i<"u"){if(l.v&&kr(l)==4)setTimeout(l.Ca.bind(l),0);else if(ce(l,"readystatechange"),kr(l)==4){l.h=!1;try{const L=l.ca();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var v;if(v=L===0){let Y=String(l.D).match(Zy)[1]||null;!Y&&o.self&&o.self.location&&(Y=o.self.location.protocol.slice(0,-1)),v=!Fb.test(Y?Y.toLowerCase():"")}p=v}if(p)ce(l,"complete"),ce(l,"success");else{l.o=6;try{var j=kr(l)>2?l.g.statusText:""}catch{j=""}l.l=j+" ["+l.ca()+"]",cv(l)}}finally{xc(l)}}}}function xc(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const p=l.g;l.g=null,f||ce(l,"ready");try{p.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function kr(l){return l.g?l.g.readyState:0}t.ca=function(){try{return kr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Sh(f)}};function dv(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function zb(l){const f={};l=(l.g&&kr(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let v=0;v<l.length;v++){if(I(l[v]))continue;var p=Sb(l[v]);const j=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const L=f[j]||[];f[j]=L,L.push(p)}K(f,function(v){return v.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ya(l,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||f}function hv(l){this.za=0,this.i=[],this.j=new aa,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ya("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ya("baseRetryDelayMs",5e3,l),this.Za=ya("retryDelaySeedMs",1e4,l),this.Ta=ya("forwardChannelMaxRetries",2,l),this.va=ya("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new Wy(l&&l.concurrentRequestLimit),this.Ba=new Lb,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=hv.prototype,t.ka=8,t.I=1,t.connect=function(l,f,p,v){Vt(0),this.W=l,this.H=f||{},p&&v!==void 0&&(this.H.OSID=p,this.H.OAID=v),this.F=this.X,this.J=wv(this,null,this.W),Ec(this)};function Lh(l){if(fv(l),l.I==3){var f=l.V++,p=On(l.J);if(Le(p,"SID",l.M),Le(p,"RID",f),Le(p,"TYPE","terminate"),va(l,p),f=new Ar(l,l.j,f),f.M=2,f.A=vc(On(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=f.A,p=!0),p||(f.g=Ev(f.j,null),f.g.ea(f.A)),f.F=Date.now(),yc(f)}xv(l)}function wc(l){l.g&&(Uh(l),l.g.cancel(),l.g=null)}function fv(l){wc(l),l.v&&(o.clearTimeout(l.v),l.v=null),Ic(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function Ec(l){if(!Qy(l.h)&&!l.m){l.m=!0;var f=l.Ea;M||y(),B||(M(),B=!0),w.add(f,l),l.D=0}}function Bb(l,f){return Yy(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=oa(d(l.Ea,l,f),_v(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const j=new Ar(this,this.j,l);let L=this.o;if(this.U&&(L?(L=Q(L),Z(L,this.U)):L=this.U),this.u!==null||this.R||(j.J=L,L=null),this.S)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var v=this.i[p];if("__data__"in v.map&&(v=v.map.__data__,typeof v=="string")){v=v.length;break t}v=void 0}if(v===void 0)break;if(f+=v,f>4096){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=pv(this,j,f),p=On(this.J),Le(p,"RID",l),Le(p,"CVER",22),this.G&&Le(p,"X-HTTP-Session-Id",this.G),va(this,p),L&&(this.R?f="headers="+la(av(L))+"&"+f:this.u&&Oh(p,this.u,L)),jh(this.h,j),this.Ra&&Le(p,"TYPE","init"),this.S?(Le(p,"$req",f),Le(p,"SID","null"),j.U=!0,kh(j,p,null)):kh(j,p,f),this.I=2}}else this.I==3&&(l?mv(this,l):this.i.length==0||Qy(this.h)||mv(this))};function mv(l,f){var p;f?p=f.l:p=l.V++;const v=On(l.J);Le(v,"SID",l.M),Le(v,"RID",p),Le(v,"AID",l.K),va(l,v),l.u&&l.o&&Oh(v,l.u,l.o),p=new Ar(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),f&&(l.i=f.G.concat(l.i)),f=pv(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),jh(l.h,p),kh(p,v,f)}function va(l,f){l.H&&O(l.H,function(p,v){Le(f,v,p)}),l.l&&O({},function(p,v){Le(f,v,p)})}function pv(l,f,p){p=Math.min(l.i.length,p);const v=l.l?d(l.l.Ka,l.l,l):null;e:{var j=l.i;let ye=-1;for(;;){const at=["count="+p];ye==-1?p>0?(ye=j[0].g,at.push("ofs="+ye)):ye=0:at.push("ofs="+ye);let je=!0;for(let mt=0;mt<p;mt++){var L=j[mt].g;const Ln=j[mt].map;if(L-=ye,L<0)ye=Math.max(0,j[mt].g-100),je=!1;else try{L="req"+L+"_"||"";try{var Y=Ln instanceof Map?Ln:Object.entries(Ln);for(const[js,Rr]of Y){let Pr=Rr;a(Rr)&&(Pr=Mn(Rr)),at.push(L+js+"="+encodeURIComponent(Pr))}}catch(js){throw at.push(L+"type="+encodeURIComponent("_badmap")),js}}catch{v&&v(Ln)}}if(je){Y=at.join("&");break e}}Y=void 0}return l=l.i.splice(0,p),f.G=l,Y}function gv(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;M||y(),B||(M(),B=!0),w.add(f,l),l.A=0}}function Fh(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=oa(d(l.Da,l),_v(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,yv(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=oa(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Vt(10),wc(this),yv(this))};function Uh(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function yv(l){l.g=new Ar(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=On(l.na);Le(f,"RID","rpc"),Le(f,"SID",l.M),Le(f,"AID",l.K),Le(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&Le(f,"TO",l.ia),Le(f,"TYPE","xmlhttp"),va(l,f),l.u&&l.o&&Oh(f,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=vc(On(f)),p.u=null,p.R=!0,Hy(p,l)}t.Va=function(){this.C!=null&&(this.C=null,wc(this),Fh(this),Vt(19))};function Ic(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function vv(l,f){var p=null;if(l.g==f){Ic(l),Uh(l),l.g=null;var v=2}else if(Dh(l.h,f))p=f.G,Jy(l.h,f),v=1;else return;if(l.I!=0){if(f.o)if(v==1){p=f.u?f.u.length:0,f=Date.now()-f.F;var j=l.D;v=pc(),ce(v,new Uy(v,p)),Ec(l)}else gv(l);else if(j=f.m,j==3||j==0&&f.X>0||!(v==1&&Bb(l,f)||v==2&&Fh(l)))switch(p&&p.length>0&&(f=l.h,f.i=f.i.concat(p)),j){case 1:Ds(l,5);break;case 4:Ds(l,10);break;case 3:Ds(l,6);break;default:Ds(l,2)}}}function _v(l,f){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*f}function Ds(l,f){if(l.j.info("Error code "+f),f==2){var p=d(l.bb,l),v=l.Ua;const j=!v;v=new Nr(v||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ua(v,"https"),vc(v),j?Mb(v.toString(),p):Ob(v.toString(),p)}else Vt(2);l.I=0,l.l&&l.l.pa(f),xv(l),fv(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Vt(2)):(this.j.info("Failed to ping google.com"),Vt(1))};function xv(l){if(l.I=0,l.ja=[],l.l){const f=Xy(l.h);(f.length!=0||l.i.length!=0)&&(T(l.ja,f),T(l.ja,l.i),l.h.i.length=0,x(l.i),l.i.length=0),l.l.oa()}}function wv(l,f,p){var v=p instanceof Nr?On(p):new Nr(p);if(v.g!="")f&&(v.g=f+"."+v.g),da(v,v.u);else{var j=o.location;v=j.protocol,f=f?f+"."+j.hostname:j.hostname,j=+j.port;const L=new Nr(null);v&&ua(L,v),f&&(L.g=f),j&&da(L,j),p&&(L.h=p),v=L}return p=l.G,f=l.wa,p&&f&&Le(v,p,f),Le(v,"VER",l.ka),va(l,v),v}function Ev(l,f,p){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new Qe(new Mh({ab:p})):new Qe(l.ma),f.Fa(l.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Iv(){}t=Iv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Tc(){}Tc.prototype.g=function(l,f){return new Zt(l,f)};function Zt(l,f){U.call(this),this.g=new hv(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!I(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!I(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Pi(this)}m(Zt,U),Zt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Zt.prototype.close=function(){Lh(this.g)},Zt.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=Mn(l),l=p);f.i.push(new Nb(f.Ya++,l)),f.I==3&&Ec(f)},Zt.prototype.N=function(){this.g.l=null,delete this.j,Lh(this.g),delete this.g,Zt.Z.N.call(this)};function Tv(l){bh.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const p in f){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}m(Tv,bh);function Sv(){Ah.call(this),this.status=1}m(Sv,Ah);function Pi(l){this.g=l}m(Pi,Iv),Pi.prototype.ra=function(){ce(this.g,"a")},Pi.prototype.qa=function(l){ce(this.g,new Tv(l))},Pi.prototype.pa=function(l){ce(this.g,new Sv)},Pi.prototype.oa=function(){ce(this.g,"b")},Tc.prototype.createWebChannel=Tc.prototype.g,Zt.prototype.send=Zt.prototype.o,Zt.prototype.open=Zt.prototype.m,Zt.prototype.close=Zt.prototype.close,G1=function(){return new Tc},H1=function(){return pc()},q1=ks,Qm={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},gc.NO_ERROR=0,gc.TIMEOUT=8,gc.HTTP_ERROR=6,fu=gc,zy.COMPLETE="complete",$1=zy,My.EventType=sa,sa.OPEN="a",sa.CLOSE="b",sa.ERROR="c",sa.MESSAGE="d",U.prototype.listen=U.prototype.J,$a=My,Qe.prototype.listenOnce=Qe.prototype.K,Qe.prototype.getLastError=Qe.prototype.Ha,Qe.prototype.getLastErrorCode=Qe.prototype.ya,Qe.prototype.getStatus=Qe.prototype.ca,Qe.prototype.getResponseJson=Qe.prototype.La,Qe.prototype.getResponseText=Qe.prototype.la,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Fa,B1=Qe}).apply(typeof $c<"u"?$c:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}At.UNAUTHENTICATED=new At(null),At.GOOGLE_CREDENTIALS=new At("google-credentials-uid"),At.FIRST_PARTY=new At("first-party-uid"),At.MOCK_USER=new At("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jo="12.9.0";function ER(t){Jo=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ui=new Tg("@firebase/firestore");function Ui(){return ui.logLevel}function q(t,...e){if(ui.logLevel<=xe.DEBUG){const n=e.map(Ag);ui.debug(`Firestore (${Jo}): ${t}`,...n)}}function nt(t,...e){if(ui.logLevel<=xe.ERROR){const n=e.map(Ag);ui.error(`Firestore (${Jo}): ${t}`,...n)}}function So(t,...e){if(ui.logLevel<=xe.WARN){const n=e.map(Ag);ui.warn(`Firestore (${Jo}): ${t}`,...n)}}function Ag(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function te(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,K1(t,r,n)}function K1(t,e,n){let r=`FIRESTORE (${Jo}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw nt(r),new Error(r)}function oe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||K1(e,s,r)}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class W extends Dn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class TR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(At.UNAUTHENTICATED))}shutdown(){}}class SR{constructor(e){this.t=e,this.currentUser=At.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){oe(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new cr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new cr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new cr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(oe(typeof r.accessToken=="string",31837,{l:r}),new IR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string",2055,{h:e}),new At(e)}}class bR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=At.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class AR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new bR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(At.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class X_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class NR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,$t(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){oe(this.o===void 0,3512);const r=i=>{i.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new X_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(oe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new X_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=CR(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function me(t,e){return t<e?-1:t>e?1:0}function Ym(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return wf(s)===wf(i)?me(s,i):wf(s)?1:-1}return me(t.length,e.length)}const kR=55296,RR=57343;function wf(t){const e=t.charCodeAt(0);return e>=kR&&e<=RR}function bo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function W1(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z_="__name__";class zn{constructor(e,n,r){n===void 0?n=0:n>e.length&&te(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&te(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return zn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof zn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=zn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return me(e.length,n.length)}static compareSegments(e,n){const r=zn.isNumericId(e),s=zn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?zn.extractNumericId(e).compare(zn.extractNumericId(n)):Ym(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return as.fromString(e.substring(4,e.length-2))}}class be extends zn{construct(e,n,r){return new be(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new W(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new be(n)}static emptyPath(){return new be([])}}const PR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ge extends zn{construct(e,n,r){return new Ge(e,n,r)}static isValidIdentifier(e){return PR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ge.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Z_}static keyField(){return new Ge([Z_])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new W(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new W(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new W(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new W(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ge(n)}static emptyPath(){return new Ge([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.path=e}static fromPath(e){return new X(be.fromString(e))}static fromName(e){return new X(be.fromString(e).popFirst(5))}static empty(){return new X(be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&be.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return be.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new X(new be(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q1(t,e,n){if(!n)throw new W(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function DR(t,e,n,r){if(e===!0&&r===!0)throw new W(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function e0(t){if(!X.isDocumentKey(t))throw new W(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function t0(t){if(X.isDocumentKey(t))throw new W(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Y1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Yd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":te(12329,{type:typeof t})}function Cn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new W(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Yd(t);throw new W(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ot(t,e){const n={typeString:t};return e&&(n.value=e),n}function tc(t,e){if(!Y1(t))throw new W(z.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new W(z.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0=-62135596800,r0=1e6;class Ne{static now(){return Ne.fromMillis(Date.now())}static fromDate(e){return Ne.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*r0);return new Ne(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new W(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new W(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<n0)throw new W(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new W(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/r0}_compareTo(e){return this.seconds===e.seconds?me(this.nanoseconds,e.nanoseconds):me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ne._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(tc(e,Ne._jsonSchema))return new Ne(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-n0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ne._jsonSchemaVersion="firestore/timestamp/1.0",Ne._jsonSchema={type:ot("string",Ne._jsonSchemaVersion),seconds:ot("number"),nanoseconds:ot("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class de{static fromTimestamp(e){return new de(e)}static min(){return new de(new Ne(0,0))}static max(){return new de(new Ne(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=-1;class rd{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function Jm(t){return t.fields.find(e=>e.kind===2)}function Fs(t){return t.fields.filter(e=>e.kind!==2)}rd.UNKNOWN_ID=-1;class mu{constructor(e,n){this.fieldPath=e,this.kind=n}}class Vl{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Vl(0,cn.min())}}function J1(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=de.fromTimestamp(r===1e9?new Ne(n+1,0):new Ne(n,r));return new cn(s,X.empty(),e)}function X1(t){return new cn(t.readTime,t.key,Ao)}class cn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new cn(de.min(),X.empty(),Ao)}static max(){return new cn(de.max(),X.empty(),Ao)}}function Cg(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=X.comparator(t.documentKey,e.documentKey),n!==0?n:me(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class eI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ts(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==Z1)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&te(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new R((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof R?n:R.resolve(n)}catch(n){return R.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):R.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):R.reject(n)}static resolve(e){return new R((n,r)=>{n(e)})}static reject(e){return new R((n,r)=>{r(e)})}static waitFor(e){return new R((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=R.resolve(!1);for(const r of e)n=n.next(s=>s?R.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new R((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new R((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tn="SimpleDb";class Jd{static open(e,n,r,s){try{return new Jd(n,e.transaction(s,r))}catch(i){throw new ol(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new cr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new ol(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=kg(r.target.error);this.S.reject(new ol(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(q(tn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new VR(n)}}class ls{static delete(e){return q(tn,"Removing database:",e),Bs(A1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!V1())return!1;if(ls.F())return!0;const e=dt(),n=ls.M(e),r=0<n&&n<10,s=tI(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,ls.M(dt())===12.2&&nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(q(tn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new ol(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new W(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new W(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ol(e,o))},s.onupgradeneeded=i=>{q(tn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{q(tn,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=n=>this.K(n)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=Jd.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),R.reject(d))).toPromise();return c.catch(()=>{}),await a.D,c}catch(a){const c=a,d=c.name!=="FirebaseError"&&o<3;if(q(tn,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class jR{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Bs(this.U.delete())}}class ol extends W{constructor(e,n){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ss(t){return t.name==="IndexedDbTransactionError"}class VR{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(q(tn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(q(tn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Bs(r)}add(e){return q(tn,"ADD",this.store.name,e,e),Bs(this.store.add(e))}get(e){return Bs(this.store.get(e)).next(n=>(n===void 0&&(n=null),q(tn,"GET",this.store.name,e,n),n))}delete(e){return q(tn,"DELETE",this.store.name,e),Bs(this.store.delete(e))}count(){return q(tn,"COUNT",this.store.name),Bs(this.store.count())}H(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new R((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.J(i,(a,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new R((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){q(tn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const s=this.cursor(r);return this.J(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.J(s,n)}te(e){const n=this.cursor({});return new R((r,s)=>{n.onerror=i=>{const o=kg(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}J(e,n){const r=[];return new R((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new jR(a),d=n(a.primaryKey,a.value,c);if(d instanceof R){const h=d.catch(m=>(c.done(),R.reject(m)));r.push(h)}c.isDone?s():c.G===null?a.continue():a.continue(c.G)}}).next(()=>R.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Bs(t){return new R((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=kg(r.target.error);n(s)}})}let s0=!1;function kg(t){const e=ls.M(dt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new W("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return s0||(s0=!0,setTimeout(()=>{throw r},0)),r}}return t}const al="IndexBackfiller";class MR{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){q(al,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();q(al,`Documents written: ${n}`)}catch(n){Ss(n)?q(al,"Ignoring IndexedDB error during index backfill: ",n):await Ts(n)}await this.re(6e4)})}}class OR{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return R.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return q(al,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(q(al,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=X1(i);Cg(o,r)>0&&(r=o)}),new cn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ht.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs=-1;function Xd(t){return t==null}function Ml(t){return t===0&&1/t==-1/0}function nI(t){return typeof t=="number"&&Number.isInteger(t)&&!Ml(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sd="";function Pt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=i0(e)),e=LR(t.get(n),e);return i0(e)}function LR(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case sd:n+="";break;default:n+=i}}return n}function i0(t){return t+sd+""}function qn(t){const e=t.length;if(oe(e>=2,64408,{path:t}),e===2)return oe(t.charAt(0)===sd&&t.charAt(1)==="",56145,{path:t}),be.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(sd,i);switch((o<0||o>n)&&te(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:te(61167,{path:t})}i=o+2}return new be(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Us="remoteDocuments",nc="owner",ji="owner",Ol="mutationQueues",FR="userId",Tn="mutations",o0="batchId",Qs="userMutationsIndex",a0=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(t,e){return[t,Pt(e)]}function rI(t,e,n){return[t,Pt(e),n]}const UR={},No="documentMutations",id="remoteDocumentsV14",zR=["prefixPath","collectionGroup","readTime","documentId"],gu="documentKeyIndex",BR=["prefixPath","collectionGroup","documentId"],sI="collectionGroupIndex",$R=["collectionGroup","readTime","prefixPath","documentId"],Ll="remoteDocumentGlobal",Xm="remoteDocumentGlobalKey",Co="targets",iI="queryTargetsIndex",qR=["canonicalId","targetId"],ko="targetDocuments",HR=["targetId","path"],Rg="documentTargetsIndex",GR=["path","targetId"],od="targetGlobalKey",Zs="targetGlobal",Fl="collectionParents",KR=["collectionId","parent"],Ro="clientMetadata",WR="clientId",Zd="bundles",QR="bundleId",eh="namedQueries",YR="name",Pg="indexConfiguration",JR="indexId",Zm="collectionGroupIndex",XR="collectionGroup",ll="indexState",ZR=["indexId","uid"],oI="sequenceNumberIndex",e2=["uid","sequenceNumber"],cl="indexEntries",t2=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],aI="documentKeyIndex",n2=["indexId","uid","orderedDocumentKey"],th="documentOverlays",r2=["userId","collectionPath","documentId"],ep="collectionPathOverlayIndex",s2=["userId","collectionPath","largestBatchId"],lI="collectionGroupOverlayIndex",i2=["userId","collectionGroup","largestBatchId"],Dg="globals",o2="name",cI=[Ol,Tn,No,Us,Co,nc,Zs,ko,Ro,Ll,Fl,Zd,eh],a2=[...cI,th],uI=[Ol,Tn,No,id,Co,nc,Zs,ko,Ro,Ll,Fl,Zd,eh,th],dI=uI,jg=[...dI,Pg,ll,cl],l2=jg,hI=[...jg,Dg],c2=hI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp extends eI{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function ht(t,e){const n=ie(t);return ls.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function bs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e,n){this.comparator=e,this.root=n||_t.EMPTY}insert(e,n){return new Oe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(e){return new Oe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new qc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new qc(this.root,e,this.comparator,!1)}getReverseIterator(){return new qc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new qc(this.root,e,this.comparator,!0)}}class qc{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _t{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??_t.RED,this.left=s??_t.EMPTY,this.right=i??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new _t(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return _t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw te(43730,{key:this.key,value:this.value});if(this.right.isRed())throw te(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw te(27949);return e+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw te(57766)}get value(){throw te(16141)}get color(){throw te(16727)}get left(){throw te(29726)}get right(){throw te(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new _t(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.comparator=e,this.data=new Oe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new c0(this.data.getIterator())}getIteratorFrom(e){return new c0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Re(this.comparator);return n.data=e,n}}class c0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Vi(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new Gt([])}unionWith(e){let n=new Re(Ge.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Gt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return bo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new mI("Invalid base64 string: "+i):i}}(e);return new rt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new rt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rt.EMPTY_BYTE_STRING=new rt("");const u2=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yr(t){if(oe(!!t,39018),typeof t=="string"){let e=0;const n=u2.exec(t);if(oe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ze(t.seconds),nanos:ze(t.nanos)}}function ze(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function vr(t){return typeof t=="string"?rt.fromBase64String(t):rt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pI="server_timestamp",gI="__type__",yI="__previous_value__",vI="__local_write_time__";function Vg(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[gI])==null?void 0:r.stringValue)===pI}function nh(t){const e=t.mapValue.fields[yI];return Vg(e)?nh(e):e}function Ul(t){const e=yr(t.mapValue.fields[vI].timestampValue);return new Ne(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,n,r,s,i,o,a,c,d,h,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=m}}const ad="(default)";class di{constructor(e,n){this.projectId=e,this.database=n||ad}static empty(){return new di("","")}get isDefaultDatabase(){return this.database===ad}isEqual(e){return e instanceof di&&e.projectId===this.projectId&&e.database===this.database}}function h2(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new W(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new di(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg="__type__",_I="__max__",Yr={mapValue:{fields:{__type__:{stringValue:_I}}}},Og="__vector__",Po="value",yu={nullValue:"NULL_VALUE"};function gs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Vg(t)?4:xI(t)?9007199254740991:rh(t)?10:11:te(28295,{value:t})}function Xn(t,e){if(t===e)return!0;const n=gs(t);if(n!==gs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ul(t).isEqual(Ul(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=yr(s.timestampValue),a=yr(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return vr(s.bytesValue).isEqual(vr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ze(s.geoPointValue.latitude)===ze(i.geoPointValue.latitude)&&ze(s.geoPointValue.longitude)===ze(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ze(s.integerValue)===ze(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ze(s.doubleValue),a=ze(i.doubleValue);return o===a?Ml(o)===Ml(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return bo(t.arrayValue.values||[],e.arrayValue.values||[],Xn);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(l0(o)!==l0(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Xn(o[c],a[c])))return!1;return!0}(t,e);default:return te(52216,{left:t})}}function zl(t,e){return(t.values||[]).find(n=>Xn(n,e))!==void 0}function ys(t,e){if(t===e)return 0;const n=gs(t),r=gs(e);if(n!==r)return me(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return me(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=ze(i.integerValue||i.doubleValue),c=ze(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return u0(t.timestampValue,e.timestampValue);case 4:return u0(Ul(t),Ul(e));case 5:return Ym(t.stringValue,e.stringValue);case 6:return function(i,o){const a=vr(i),c=vr(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const h=me(a[d],c[d]);if(h!==0)return h}return me(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=me(ze(i.latitude),ze(o.latitude));return a!==0?a:me(ze(i.longitude),ze(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return d0(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,x,T,k;const a=i.fields||{},c=o.fields||{},d=(g=a[Po])==null?void 0:g.arrayValue,h=(x=c[Po])==null?void 0:x.arrayValue,m=me(((T=d==null?void 0:d.values)==null?void 0:T.length)||0,((k=h==null?void 0:h.values)==null?void 0:k.length)||0);return m!==0?m:d0(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Yr.mapValue&&o===Yr.mapValue)return 0;if(i===Yr.mapValue)return 1;if(o===Yr.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let m=0;m<c.length&&m<h.length;++m){const g=Ym(c[m],h[m]);if(g!==0)return g;const x=ys(a[c[m]],d[h[m]]);if(x!==0)return x}return me(c.length,h.length)}(t.mapValue,e.mapValue);default:throw te(23264,{he:n})}}function u0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return me(t,e);const n=yr(t),r=yr(e),s=me(n.seconds,r.seconds);return s!==0?s:me(n.nanos,r.nanos)}function d0(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=ys(n[s],r[s]);if(i)return i}return me(n.length,r.length)}function Do(t){return np(t)}function np(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=yr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return vr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return X.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=np(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${np(n.fields[o])}`;return s+"}"}(t.mapValue):te(61005,{value:t})}function vu(t){switch(gs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=nh(t);return e?16+vu(e):16;case 5:return 2*t.stringValue.length;case 6:return vr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+vu(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return bs(r.fields,(i,o)=>{s+=i.length+vu(o)}),s}(t.mapValue);default:throw te(13486,{value:t})}}function Bl(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function rp(t){return!!t&&"integerValue"in t}function $l(t){return!!t&&"arrayValue"in t}function h0(t){return!!t&&"nullValue"in t}function f0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _u(t){return!!t&&"mapValue"in t}function rh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[Mg])==null?void 0:r.stringValue)===Og}function ul(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return bs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ul(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ul(t.arrayValue.values[n]);return e}return{...t}}function xI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===_I}const wI={mapValue:{fields:{[Mg]:{stringValue:Og},[Po]:{arrayValue:{}}}}};function f2(t){return"nullValue"in t?yu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Bl(di.empty(),X.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?rh(t)?wI:{mapValue:{}}:te(35942,{value:t})}function m2(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Bl(di.empty(),X.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?wI:"mapValue"in t?rh(t)?{mapValue:{}}:Yr:te(61959,{value:t})}function m0(t,e){const n=ys(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function p0(t,e){const n=ys(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.value=e}static empty(){return new kt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!_u(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ul(n)}setAll(e){let n=Ge.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=ul(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());_u(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Xn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];_u(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){bs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new kt(ul(this.value))}}function EI(t){const e=[];return bs(t.fields,(n,r)=>{const s=new Ge([n]);if(_u(r)){const i=EI(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Gt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Je(e,0,de.min(),de.min(),de.min(),kt.empty(),0)}static newFoundDocument(e,n,r,s){return new Je(e,1,n,de.min(),r,s,0)}static newNoDocument(e,n){return new Je(e,2,n,de.min(),de.min(),kt.empty(),0)}static newUnknownDocument(e,n){return new Je(e,3,n,de.min(),de.min(),kt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(de.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=de.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Je&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Je(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e,n){this.position=e,this.inclusive=n}}function g0(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=X.comparator(X.fromName(o.referenceValue),n.key):r=ys(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function y0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Xn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n="asc"){this.field=e,this.dir=n}}function p2(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{}class we extends II{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new g2(e,n,r):n==="array-contains"?new _2(e,r):n==="in"?new CI(e,r):n==="not-in"?new x2(e,r):n==="array-contains-any"?new w2(e,r):new we(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new y2(e,r):new v2(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ys(n,this.value)):n!==null&&gs(this.value)===gs(n)&&this.matchesComparison(ys(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return te(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ce extends II{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Ce(e,n)}matches(e){return Vo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Vo(t){return t.op==="and"}function sp(t){return t.op==="or"}function Lg(t){return TI(t)&&Vo(t)}function TI(t){for(const e of t.filters)if(e instanceof Ce)return!1;return!0}function ip(t){if(t instanceof we)return t.field.canonicalString()+t.op.toString()+Do(t.value);if(Lg(t))return t.filters.map(e=>ip(e)).join(",");{const e=t.filters.map(n=>ip(n)).join(",");return`${t.op}(${e})`}}function SI(t,e){return t instanceof we?function(r,s){return s instanceof we&&r.op===s.op&&r.field.isEqual(s.field)&&Xn(r.value,s.value)}(t,e):t instanceof Ce?function(r,s){return s instanceof Ce&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&SI(o,s.filters[a]),!0):!1}(t,e):void te(19439)}function bI(t,e){const n=t.filters.concat(e);return Ce.create(n,t.op)}function AI(t){return t instanceof we?function(n){return`${n.field.canonicalString()} ${n.op} ${Do(n.value)}`}(t):t instanceof Ce?function(n){return n.op.toString()+" {"+n.getFilters().map(AI).join(" ,")+"}"}(t):"Filter"}class g2 extends we{constructor(e,n,r){super(e,n,r),this.key=X.fromName(r.referenceValue)}matches(e){const n=X.comparator(e.key,this.key);return this.matchesComparison(n)}}class y2 extends we{constructor(e,n){super(e,"in",n),this.keys=NI("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class v2 extends we{constructor(e,n){super(e,"not-in",n),this.keys=NI("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function NI(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>X.fromName(r.referenceValue))}class _2 extends we{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return $l(n)&&zl(n.arrayValue,this.value)}}class CI extends we{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&zl(this.value.arrayValue,n)}}class x2 extends we{constructor(e,n){super(e,"not-in",n)}matches(e){if(zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!zl(this.value.arrayValue,n)}}class w2 extends we{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!$l(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>zl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function op(t,e=null,n=[],r=[],s=null,i=null,o=null){return new E2(t,e,n,r,s,i,o)}function hi(t){const e=ie(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>ip(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Xd(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Do(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Do(r)).join(",")),e.Te=n}return e.Te}function rc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!p2(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!SI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!y0(t.startAt,e.startAt)&&y0(t.endAt,e.endAt)}function cd(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function ud(t,e){return t.filters.filter(n=>n instanceof we&&n.field.isEqual(e))}function v0(t,e,n){let r=yu,s=!0;for(const i of ud(t,e)){let o=yu,a=!0;switch(i.op){case"<":case"<=":o=f2(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=yu}m0({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];m0({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function _0(t,e,n){let r=Yr,s=!0;for(const i of ud(t,e)){let o=Yr,a=!0;switch(i.op){case">=":case">":o=m2(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Yr}p0({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];p0({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function kI(t,e,n,r,s,i,o,a){return new sc(t,e,n,r,s,i,o,a)}function ic(t){return new sc(t)}function x0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function I2(t){return X.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function RI(t){return t.collectionGroup!==null}function dl(t){const e=ie(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Re(Ge.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new ld(i,r))}),n.has(Ge.keyField().canonicalString())||e.Ie.push(new ld(Ge.keyField(),r))}return e.Ie}function an(t){const e=ie(t);return e.Ee||(e.Ee=T2(e,dl(t))),e.Ee}function T2(t,e){if(t.limitType==="F")return op(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new ld(s.field,i)});const n=t.endAt?new jo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new jo(t.startAt.position,t.startAt.inclusive):null;return op(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ap(t,e){const n=t.filters.concat([e]);return new sc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function lp(t,e,n){return new sc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function sh(t,e){return rc(an(t),an(e))&&t.limitType===e.limitType}function PI(t){return`${hi(an(t))}|lt:${t.limitType}`}function zi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>AI(s)).join(", ")}]`),Xd(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Do(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Do(s)).join(",")),`Target(${r})`}(an(t))}; limitType=${t.limitType})`}function oc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):X.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of dl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const d=g0(o,a,c);return o.inclusive?d<=0:d<0}(r.startAt,dl(r),s)||r.endAt&&!function(o,a,c){const d=g0(o,a,c);return o.inclusive?d>=0:d>0}(r.endAt,dl(r),s))}(t,e)}function DI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function jI(t){return(e,n)=>{let r=!1;for(const s of dl(t)){const i=S2(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function S2(t,e,n){const r=t.field.isKeyField()?X.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),d=a.data.field(i);return c!==null&&d!==null?ys(c,d):te(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return te(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){bs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return fI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2=new Oe(X.comparator);function rn(){return b2}const VI=new Oe(X.comparator);function qa(...t){let e=VI;for(const n of t)e=e.insert(n.key,n);return e}function MI(t){let e=VI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Hn(){return hl()}function OI(){return hl()}function hl(){return new Er(t=>t.toString(),(t,e)=>t.isEqual(e))}const A2=new Oe(X.comparator),N2=new Re(X.comparator);function ve(...t){let e=N2;for(const n of t)e=e.add(n);return e}const C2=new Re(me);function Fg(){return C2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ml(e)?"-0":e}}function LI(t){return{integerValue:""+t}}function k2(t,e){return nI(e)?LI(e):Ug(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ih{constructor(){this._=void 0}}function R2(t,e,n){return t instanceof Mo?function(s,i){const o={fields:{[gI]:{stringValue:pI},[vI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Vg(i)&&(i=nh(i)),i&&(o.fields[yI]=i),{mapValue:o}}(n,e):t instanceof Oo?UI(t,e):t instanceof Lo?zI(t,e):function(s,i){const o=FI(s,i),a=w0(o)+w0(s.Ae);return rp(o)&&rp(s.Ae)?LI(a):Ug(s.serializer,a)}(t,e)}function P2(t,e,n){return t instanceof Oo?UI(t,e):t instanceof Lo?zI(t,e):n}function FI(t,e){return t instanceof ql?function(r){return rp(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Mo extends ih{}class Oo extends ih{constructor(e){super(),this.elements=e}}function UI(t,e){const n=BI(e);for(const r of t.elements)n.some(s=>Xn(s,r))||n.push(r);return{arrayValue:{values:n}}}class Lo extends ih{constructor(e){super(),this.elements=e}}function zI(t,e){let n=BI(e);for(const r of t.elements)n=n.filter(s=>!Xn(s,r));return{arrayValue:{values:n}}}class ql extends ih{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function w0(t){return ze(t.integerValue||t.doubleValue)}function BI(t){return $l(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(e,n){this.field=e,this.transform=n}}function D2(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Oo&&s instanceof Oo||r instanceof Lo&&s instanceof Lo?bo(r.elements,s.elements,Xn):r instanceof ql&&s instanceof ql?Xn(r.Ae,s.Ae):r instanceof Mo&&s instanceof Mo}(t.transform,e.transform)}class j2{constructor(e,n){this.version=e,this.transformResults=n}}class Rt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Rt}static exists(e){return new Rt(void 0,e)}static updateTime(e){return new Rt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class oh{}function qI(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ah(t.key,Rt.none()):new Xo(t.key,t.data,Rt.none());{const n=t.data,r=kt.empty();let s=new Re(Ge.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ir(t.key,r,new Gt(s.toArray()),Rt.none())}}function V2(t,e,n){t instanceof Xo?function(s,i,o){const a=s.value.clone(),c=I0(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ir?function(s,i,o){if(!xu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=I0(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(HI(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function fl(t,e,n,r){return t instanceof Xo?function(i,o,a,c){if(!xu(i.precondition,o))return a;const d=i.value.clone(),h=T0(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ir?function(i,o,a,c){if(!xu(i.precondition,o))return a;const d=T0(i.fieldTransforms,c,o),h=o.data;return h.setAll(HI(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,a){return xu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function M2(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=FI(r.transform,s||null);i!=null&&(n===null&&(n=kt.empty()),n.set(r.field,i))}return n||null}function E0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&bo(r,s,(i,o)=>D2(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xo extends oh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ir extends oh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function HI(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function I0(t,e,n){const r=new Map;oe(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,P2(o,a,n[s]))}return r}function T0(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,R2(i,o,e))}return r}class ah extends oh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class GI extends oh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&V2(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=fl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=fl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=OI();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=qI(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(de.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ve())}isEqual(e){return this.batchId===e.batchId&&bo(this.mutations,e.mutations,(n,r)=>E0(n,r))&&bo(this.baseMutations,e.baseMutations,(n,r)=>E0(n,r))}}class Bg{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){oe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return A2}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Bg(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $g{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st,Te;function L2(t){switch(t){case z.OK:return te(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return te(15467,{code:t})}}function KI(t){if(t===void 0)return nt("GRPC error has no .code"),z.UNKNOWN;switch(t){case st.OK:return z.OK;case st.CANCELLED:return z.CANCELLED;case st.UNKNOWN:return z.UNKNOWN;case st.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case st.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case st.INTERNAL:return z.INTERNAL;case st.UNAVAILABLE:return z.UNAVAILABLE;case st.UNAUTHENTICATED:return z.UNAUTHENTICATED;case st.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case st.NOT_FOUND:return z.NOT_FOUND;case st.ALREADY_EXISTS:return z.ALREADY_EXISTS;case st.PERMISSION_DENIED:return z.PERMISSION_DENIED;case st.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case st.ABORTED:return z.ABORTED;case st.OUT_OF_RANGE:return z.OUT_OF_RANGE;case st.UNIMPLEMENTED:return z.UNIMPLEMENTED;case st.DATA_LOSS:return z.DATA_LOSS;default:return te(39323,{code:t})}}(Te=st||(st={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U2=new as([4294967295,4294967295],0);function S0(t){const e=F2().encode(t),n=new z1;return n.update(e),new Uint8Array(n.digest())}function b0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new as([n,r],0),new as([s,i],0)]}class qg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ha(`Invalid padding: ${n}`);if(r<0)throw new Ha(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ha(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ha(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=as.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(as.fromNumber(r)));return s.compare(U2)===1&&(s=new as([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=S0(e),[r,s]=b0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new qg(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=S0(e),[r,s]=b0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ha extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,lc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new ac(de.min(),s,new Oe(me),rn(),ve())}}class lc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new lc(r,n,ve(),ve(),ve())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=s}}class WI{constructor(e,n){this.targetId=e,this.Ce=n}}class QI{constructor(e,n,r=rt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class A0{constructor(){this.ve=0,this.Fe=N0(),this.Me=rt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ve(),n=ve(),r=ve();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:te(38017,{changeType:i})}}),new lc(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=N0()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,oe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class z2{constructor(e){this.Ge=e,this.ze=new Map,this.je=rn(),this.He=Hc(),this.Je=Hc(),this.Ze=new Oe(me)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:te(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(cd(i))if(r===0){const o=new X(i.path);this.et(n,o,Je.newNoDocument(o,de.min()))}else oe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=vr(r).toUint8Array()}catch(c){if(c instanceof mI)return So("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new qg(o,s,i)}catch(c){return So(c instanceof Ha?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&cd(a.target)){const c=new X(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Je.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.Ke())}});let r=ve();this.Je.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new ac(e,n,this.Ze,this.je,r);return this.je=rn(),this.He=Hc(),this.Je=Hc(),this.Ze=new Oe(me),s}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.qe(n,1):s.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new A0,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new Re(me),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new Re(me),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new A0),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function Hc(){return new Oe(X.comparator)}function N0(){return new Oe(X.comparator)}const B2={asc:"ASCENDING",desc:"DESCENDING"},$2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},q2={and:"AND",or:"OR"};class H2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function cp(t,e){return t.useProto3Json||Xd(e)?e:{value:e}}function Fo(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function YI(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function G2(t,e){return Fo(t,e.toTimestamp())}function Ft(t){return oe(!!t,49232),de.fromTimestamp(function(n){const r=yr(n);return new Ne(r.seconds,r.nanos)}(t))}function Hg(t,e){return up(t,e).canonicalString()}function up(t,e){const n=function(s){return new be(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function JI(t){const e=be.fromString(t);return oe(oT(e),10190,{key:e.toString()}),e}function dd(t,e){return Hg(t.databaseId,e.path)}function ei(t,e){const n=JI(e);if(n.get(1)!==t.databaseId.projectId)throw new W(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new W(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new X(eT(n))}function XI(t,e){return Hg(t.databaseId,e)}function ZI(t){const e=JI(t);return e.length===4?be.emptyPath():eT(e)}function dp(t){return new be(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eT(t){return oe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function C0(t,e,n){return{name:dd(t,e),fields:n.value.mapValue.fields}}function K2(t,e,n){const r=ei(t,e.name),s=Ft(e.updateTime),i=e.createTime?Ft(e.createTime):de.min(),o=new kt({mapValue:{fields:e.fields}}),a=Je.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function W2(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:te(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(oe(h===void 0||typeof h=="string",58123),rt.fromBase64String(h||"")):(oe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),rt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?z.UNKNOWN:KI(d.code);return new W(h,d.message||"")}(o);n=new QI(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ei(t,r.document.name),i=Ft(r.document.updateTime),o=r.document.createTime?Ft(r.document.createTime):de.min(),a=new kt({mapValue:{fields:r.document.fields}}),c=Je.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new wu(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ei(t,r.document),i=r.readTime?Ft(r.readTime):de.min(),o=Je.newNoDocument(s,i),a=r.removedTargetIds||[];n=new wu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ei(t,r.document),i=r.removedTargetIds||[];n=new wu([],i,s,null)}else{if(!("filter"in e))return te(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new O2(s,i),a=r.targetId;n=new WI(a,o)}}return n}function hd(t,e){let n;if(e instanceof Xo)n={update:C0(t,e.key,e.value)};else if(e instanceof ah)n={delete:dd(t,e.key)};else if(e instanceof Ir)n={update:C0(t,e.key,e.data),updateMask:eP(e.fieldMask)};else{if(!(e instanceof GI))return te(16599,{dt:e.type});n={verify:dd(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Mo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Oo)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Lo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ql)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw te(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:G2(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:te(27497)}(t,e.precondition)),n}function hp(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Rt.updateTime(Ft(i.updateTime)):i.exists!==void 0?Rt.exists(i.exists):Rt.none()}(e.currentDocument):Rt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)oe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Mo;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];c=new Oo(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];c=new Lo(h)}else"increment"in a?c=new ql(o,a.increment):te(16584,{proto:a});const d=Ge.fromServerFormat(a.fieldPath);return new $I(d,c)}(t,s)):[];if(e.update){e.update.name;const s=ei(t,e.update.name),i=new kt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new Gt(d.map(h=>Ge.fromServerFormat(h)))}(e.updateMask);return new Ir(s,i,o,n,r)}return new Xo(s,i,n,r)}if(e.delete){const s=ei(t,e.delete);return new ah(s,n)}if(e.verify){const s=ei(t,e.verify);return new GI(s,n)}return te(1463,{proto:e})}function Q2(t,e){return t&&t.length>0?(oe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Ft(s.updateTime):Ft(i);return o.isEqual(de.min())&&(o=Ft(i)),new j2(o,s.transformResults||[])}(n,e))):[]}function tT(t,e){return{documents:[XI(t,e.path)]}}function nT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=XI(t,s);const i=function(d){if(d.length!==0)return iT(Ce.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(g){return{field:Bi(g.field),direction:J2(g.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=cp(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function rT(t){let e=ZI(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){oe(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(m){const g=sT(m);return g instanceof Ce&&Lg(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(T){return new ld($i(T.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,Xd(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(m){const g=!!m.before,x=m.values||[];return new jo(x,g)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const g=!m.before,x=m.values||[];return new jo(x,g)}(n.endAt)),kI(e,s,o,i,a,"F",c,d)}function Y2(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return te(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function sT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=$i(n.unaryFilter.field);return we.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=$i(n.unaryFilter.field);return we.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=$i(n.unaryFilter.field);return we.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=$i(n.unaryFilter.field);return we.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return te(61313);default:return te(60726)}}(t):t.fieldFilter!==void 0?function(n){return we.create($i(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return te(58110);default:return te(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Ce.create(n.compositeFilter.filters.map(r=>sT(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return te(1026)}}(n.compositeFilter.op))}(t):te(30097,{filter:t})}function J2(t){return B2[t]}function X2(t){return $2[t]}function Z2(t){return q2[t]}function Bi(t){return{fieldPath:t.canonicalString()}}function $i(t){return Ge.fromServerFormat(t.fieldPath)}function iT(t){return t instanceof we?function(n){if(n.op==="=="){if(f0(n.value))return{unaryFilter:{field:Bi(n.field),op:"IS_NAN"}};if(h0(n.value))return{unaryFilter:{field:Bi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(f0(n.value))return{unaryFilter:{field:Bi(n.field),op:"IS_NOT_NAN"}};if(h0(n.value))return{unaryFilter:{field:Bi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bi(n.field),op:X2(n.op),value:n.value}}}(t):t instanceof Ce?function(n){const r=n.getFilters().map(s=>iT(s));return r.length===1?r[0]:{compositeFilter:{op:Z2(n.op),filters:r}}}(t):te(54877,{filter:t})}function eP(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function oT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function aT(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ir{constructor(e,n,r,s,i=de.min(),o=de.min(),a=rt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new ir(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ir(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e){this.yt=e}}function tP(t,e){let n;if(e.document)n=K2(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=X.fromSegments(e.noDocument.path),s=mi(e.noDocument.readTime);n=Je.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return te(56709);{const r=X.fromSegments(e.unknownDocument.path),s=mi(e.unknownDocument.version);n=Je.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Ne(s[0],s[1]);return de.fromTimestamp(i)}(e.readTime)),n}function k0(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:fd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:dd(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Fo(i,o.version.toTimestamp()),createTime:Fo(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:fi(e.version)};else{if(!e.isUnknownDocument())return te(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:fi(e.version)}}return r}function fd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function fi(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function mi(t){const e=new Ne(t.seconds,t.nanoseconds);return de.fromTimestamp(e)}function $s(t,e){const n=(e.baseMutations||[]).map(i=>hp(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>hp(t.yt,i)),s=Ne.fromMillis(e.localWriteTimeMs);return new zg(e.batchId,s,n,r)}function Ga(t){const e=mi(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?mi(t.lastLimboFreeSnapshotVersion):de.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return oe(o===1,1966,{count:o}),an(ic(ZI(i.documents[0])))}(t.query):function(i){return an(rT(i))}(t.query),new ir(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,rt.fromBase64String(t.resumeToken))}function cT(t,e){const n=fi(e.snapshotVersion),r=fi(e.lastLimboFreeSnapshotVersion);let s;s=cd(e.target)?tT(t.yt,e.target):nT(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:hi(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function uT(t){const e=rT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?lp(e,e.limit,"L"):e}function Ef(t,e){return new $g(e.largestBatchId,hp(t.yt,e.overlayMutation))}function R0(t,e){const n=e.path.lastSegment();return[t,Pt(e.path.popLast()),n]}function P0(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:fi(r.readTime),documentKey:Pt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{getBundleMetadata(e,n){return D0(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:mi(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return D0(e).put(function(s){return{bundleId:s.id,createTime:fi(Ft(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return j0(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:uT(i.bundledQuery),readTime:mi(i.readTime)}}(r)})}saveNamedQuery(e,n){return j0(e).put(function(s){return{name:s.name,readTime:fi(Ft(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function D0(t){return ht(t,Zd)}function j0(t){return ht(t,eh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new lh(e,r)}getOverlay(e,n){return Aa(e).get(R0(this.userId,n)).next(r=>r?Ef(this.serializer,r):null)}getOverlays(e,n){const r=Hn();return R.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new $g(n,o);s.push(this.bt(e,a))}),R.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Pt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Aa(e).X(ep,a))}),R.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Hn(),i=Pt(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Aa(e).H(ep,o).next(a=>{for(const c of a){const d=Ef(this.serializer,c);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Hn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Aa(e).ee({index:lI,range:a},(c,d,h)=>{const m=Ef(this.serializer,d);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):h.done()}).next(()=>i)}bt(e,n){return Aa(e).put(function(s,i,o){const[a,c,d]=R0(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:hd(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Aa(t){return ht(t,th)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{St(e){return ht(e,Dg)}getSessionToken(e){return this.St(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?rt.fromUint8Array(r):rt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.St(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt(ze(e.integerValue));else if("doubleValue"in e){const r=ze(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),Ml(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=yr(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(vr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?xI(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):rh(e)?this.kt(e.mapValue,n):(this.Kt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.qt(e.arrayValue,n),this.Nt(n)):te(19022,{Ut:e})}Ot(e,n){this.Ft(n,25),this.$t(e,n)}$t(e,n){n.xt(e)}Kt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=Po,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt(ze(i)),this.Ot(s,n),this.Ct(r[s],n)}qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),X.fromName(e).path.forEach(r=>{this.Ft(n,60),this.$t(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}qs.Wt=new qs;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mi=255;function sP(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function V0(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=sP(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class iP{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ht(r.value),r=n.next();this.Jt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const s=n.codePointAt(0);this.Ht(240|s>>>18),this.Ht(128|63&s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s)}}this.Jt()}Yt(e){const n=this.en(e),r=V0(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=V0(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(Mi),this.sn(255)}_n(){this.an(Mi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===Mi?(this.sn(Mi),this.sn(0)):this.sn(n)}Ht(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===Mi?(this.an(Mi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class oP{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class aP{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Na{constructor(){this.cn=new iP,this.ascending=new oP(this.cn),this.descending=new aP(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,n,r,s){this.hn=e,this.Pn=n,this.Tn=r,this.In=s}En(){const e=this.In.length,n=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.In,0),n!==e?r.set([0],this.In.length):++r[r.length-1],new Hs(this.hn,this.Pn,this.Tn,r)}Rn(e,n,r){return{indexId:this.hn,uid:e,arrayValue:Eu(this.Tn),directionalValue:Eu(this.In),orderedDocumentKey:Eu(n),documentKey:r.path.toArray()}}An(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function jr(t,e){let n=t.hn-e.hn;return n!==0?n:(n=M0(t.Tn,e.Tn),n!==0?n:(n=M0(t.In,e.In),n!==0?n:X.comparator(t.Pn,e.Pn)))}function M0(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function Eu(t){return j1()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function O0(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class L0{constructor(e){this.Vn=new Re((n,r)=>Ge.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(oe(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const n=Jm(e);if(n!==void 0&&!this.pn(n))return!1;const r=Fs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.pn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){const a=this.Vn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.yn(a,c)||!this.wn(this.dn[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.dn.length||!this.wn(this.dn[o++],a))return!1}return!0}bn(){if(this.fn)return null;let e=new Re(Ge.comparator);const n=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new mu(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new mu(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new mu(r.field,r.dir==="asc"?0:1)));return new rd(rd.UNKNOWN_ID,this.collectionId,n,Vl.empty())}pn(e){for(const n of this.mn)if(this.yn(n,e))return!0;return!1}yn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}wn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dT(t){var n,r;if(oe(t instanceof we||t instanceof Ce,20012),t instanceof we){if(t instanceof CI){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>we.create(t.field,"==",i)))||[];return Ce.create(s,"or")}return t}const e=t.filters.map(s=>dT(s));return Ce.create(e,t.op)}function lP(t){if(t.getFilters().length===0)return[];const e=pp(dT(t));return oe(hT(e),7391),fp(e)||mp(e)?[e]:e.getFilters()}function fp(t){return t instanceof we}function mp(t){return t instanceof Ce&&Lg(t)}function hT(t){return fp(t)||mp(t)||function(n){if(n instanceof Ce&&sp(n)){for(const r of n.getFilters())if(!fp(r)&&!mp(r))return!1;return!0}return!1}(t)}function pp(t){if(oe(t instanceof we||t instanceof Ce,34018),t instanceof we)return t;if(t.filters.length===1)return pp(t.filters[0]);const e=t.filters.map(r=>pp(r));let n=Ce.create(e,t.op);return n=md(n),hT(n)?n:(oe(n instanceof Ce,64498),oe(Vo(n),40251),oe(n.filters.length>1,57927),n.filters.reduce((r,s)=>Gg(r,s)))}function Gg(t,e){let n;return oe(t instanceof we||t instanceof Ce,38388),oe(e instanceof we||e instanceof Ce,25473),n=t instanceof we?e instanceof we?function(s,i){return Ce.create([s,i],"and")}(t,e):F0(t,e):e instanceof we?F0(e,t):function(s,i){if(oe(s.filters.length>0&&i.filters.length>0,48005),Vo(s)&&Vo(i))return bI(s,i.getFilters());const o=sp(s)?s:i,a=sp(s)?i:s,c=o.filters.map(d=>Gg(d,a));return Ce.create(c,"or")}(t,e),md(n)}function F0(t,e){if(Vo(e))return bI(e,t.getFilters());{const n=e.filters.map(r=>Gg(t,r));return Ce.create(n,"or")}}function md(t){if(oe(t instanceof we||t instanceof Ce,11850),t instanceof we)return t;const e=t.getFilters();if(e.length===1)return md(e[0]);if(TI(t))return t;const n=e.map(s=>md(s)),r=[];return n.forEach(s=>{s instanceof we?r.push(s):s instanceof Ce&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:Ce.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(){this.Sn=new Kg}addToCollectionParentIndex(e,n){return this.Sn.add(n),R.resolve()}getCollectionParents(e,n){return R.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return R.resolve()}deleteFieldIndex(e,n){return R.resolve()}deleteAllFieldIndexes(e){return R.resolve()}createTargetIndexes(e,n){return R.resolve()}getDocumentsMatchingTarget(e,n){return R.resolve(null)}getIndexType(e,n){return R.resolve(0)}getFieldIndexes(e,n){return R.resolve([])}getNextCollectionGroupToUpdate(e){return R.resolve(null)}getMinOffset(e,n){return R.resolve(cn.min())}getMinOffsetFromCollectionGroup(e,n){return R.resolve(cn.min())}updateCollectionGroup(e,n,r){return R.resolve()}updateIndexEntries(e,n){return R.resolve()}}class Kg{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Re(be.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Re(be.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U0="IndexedDbIndexManager",Gc=new Uint8Array(0);class uP{constructor(e,n){this.databaseId=n,this.Dn=new Kg,this.Cn=new Er(r=>hi(r),(r,s)=>rc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Dn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Dn.add(n)});const i={collectionId:r,parent:Pt(s)};return z0(e).put(i)}return R.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[W1(n),""],!1,!0);return z0(e).H(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(qn(o.parent))}return r})}addFieldIndex(e,n){const r=Ca(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Li(e);return i.next(a=>{o.put(P0(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Ca(e),s=Li(e),i=Oi(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Ca(e),r=Oi(e),s=Li(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return R.forEach(this.vn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new L0(r).bn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Oi(e);let s=!0;const i=new Map;return R.forEach(this.vn(n),o=>this.Fn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ve();const a=[];return R.forEach(i,(c,d)=>{q(U0,`Using index ${function(A){return`id=${A.indexId}|cg=${A.collectionGroup}|f=${A.fields.map(P=>`${P.fieldPath}:${P.kind}`).join(",")}`}(c)} to execute ${hi(n)}`);const h=function(A,P){const M=Jm(P);if(M===void 0)return null;for(const B of ud(A,M.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(d,c),m=function(A,P){const M=new Map;for(const B of Fs(P))for(const w of ud(A,B.fieldPath))switch(w.op){case"==":case"in":M.set(B.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return M.set(B.fieldPath.canonicalString(),w.value),Array.from(M.values())}return null}(d,c),g=function(A,P){const M=[];let B=!0;for(const w of Fs(P)){const y=w.kind===0?v0(A,w.fieldPath,A.startAt):_0(A,w.fieldPath,A.startAt);M.push(y.value),B&&(B=y.inclusive)}return new jo(M,B)}(d,c),x=function(A,P){const M=[];let B=!0;for(const w of Fs(P)){const y=w.kind===0?_0(A,w.fieldPath,A.endAt):v0(A,w.fieldPath,A.endAt);M.push(y.value),B&&(B=y.inclusive)}return new jo(M,B)}(d,c),T=this.Mn(c,d,g),k=this.Mn(c,d,x),D=this.xn(c,d,m),b=this.On(c.indexId,h,T,g.inclusive,k,x.inclusive,D);return R.forEach(b,E=>r.Z(E,n.limit).next(A=>{A.forEach(P=>{const M=X.fromSegments(P.documentKey);o.has(M)||(o=o.add(M),a.push(M))})}))}).next(()=>a)}return R.resolve(null)})}vn(e){let n=this.Cn.get(e);return n||(e.filters.length===0?n=[e]:n=lP(Ce.create(e.filters,"and")).map(r=>op(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,n),n)}On(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),d=c/(n!=null?n.length:1),h=[];for(let m=0;m<c;++m){const g=n?this.Nn(n[m/d]):Gc,x=this.Bn(e,g,r[m%d],s),T=this.Ln(e,g,i[m%d],o),k=a.map(D=>this.Bn(e,g,D,!0));h.push(...this.createRange(x,T,k))}return h}Bn(e,n,r,s){const i=new Hs(e,X.empty(),n,r);return s?i:i.En()}Ln(e,n,r,s){const i=new Hs(e,X.empty(),n,r);return s?i.En():i}Fn(e,n){const r=new L0(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.gn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.vn(n);return R.forEach(s,i=>this.Fn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let d=new Re(Ge.comparator),h=!1;for(const m of c.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:d=d.add(g.field));for(const m of c.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}kn(e,n){const r=new Na;for(const s of Fs(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.ln(s.kind);qs.Wt.Dt(i,o)}return r.un()}Nn(e){const n=new Na;return qs.Wt.Dt(e,n.ln(0)),n.un()}Kn(e,n){const r=new Na;return qs.Wt.Dt(Bl(this.databaseId,n),r.ln(function(i){const o=Fs(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}xn(e,n,r){if(r===null)return[];let s=[];s.push(new Na);let i=0;for(const o of Fs(e)){const a=r[i++];for(const c of s)if(this.qn(n,o.fieldPath)&&$l(a))s=this.Un(s,o,a);else{const d=c.ln(o.kind);qs.Wt.Dt(a,d)}}return this.$n(s)}Mn(e,n,r){return this.xn(e,n,r.position)}$n(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Un(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new Na;c.seed(a.un()),qs.Wt.Dt(o,c.ln(n.kind)),i.push(c)}return i}qn(e,n){return!!e.filters.find(r=>r instanceof we&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Ca(e),s=Li(e);return(n?r.H(Zm,IDBKeyRange.bound(n,n)):r.H()).next(i=>{const o=[];return R.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(h,m){const g=m?new Vl(m.sequenceNumber,new cn(mi(m.readTime),new X(qn(m.documentKey)),m.largestBatchId)):Vl.empty(),x=h.fields.map(([T,k])=>new mu(Ge.fromServerFormat(T),k));return new rd(h.indexId,h.collectionGroup,x,g)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:me(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Ca(e),i=Li(e);return this.Wn(e).next(o=>s.H(Zm,IDBKeyRange.bound(n,n)).next(a=>R.forEach(a,c=>i.put(P0(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return R.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?R.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),R.forEach(a,c=>this.Qn(e,s,c).next(d=>{const h=this.Gn(i,c);return d.isEqual(h)?R.resolve():this.zn(e,i,c,d,h)}))))})}jn(e,n,r,s){return Oi(e).put(s.Rn(this.uid,this.Kn(r,n.key),n.key))}Hn(e,n,r,s){return Oi(e).delete(s.An(this.uid,this.Kn(r,n.key),n.key))}Qn(e,n,r){const s=Oi(e);let i=new Re(jr);return s.ee({index:aI,range:IDBKeyRange.only([r.indexId,this.uid,Eu(this.Kn(r,n))])},(o,a)=>{i=i.add(new Hs(r.indexId,n,O0(a.arrayValue),O0(a.directionalValue)))}).next(()=>i)}Gn(e,n){let r=new Re(jr);const s=this.kn(n,e);if(s==null)return r;const i=Jm(n);if(i!=null){const o=e.data.field(i.fieldPath);if($l(o))for(const a of o.arrayValue.values||[])r=r.add(new Hs(n.indexId,e.key,this.Nn(a),s))}else r=r.add(new Hs(n.indexId,e.key,Gc,s));return r}zn(e,n,r,s,i){q(U0,"Updating index entries for document '%s'",n.key);const o=[];return function(c,d,h,m,g){const x=c.getIterator(),T=d.getIterator();let k=Vi(x),D=Vi(T);for(;k||D;){let b=!1,E=!1;if(k&&D){const A=h(k,D);A<0?E=!0:A>0&&(b=!0)}else k!=null?E=!0:b=!0;b?(m(D),D=Vi(T)):E?(g(k),k=Vi(x)):(k=Vi(x),D=Vi(T))}}(s,i,jr,a=>{o.push(this.jn(e,n,r,a))},a=>{o.push(this.Hn(e,n,r,a))}),R.waitFor(o)}Wn(e){let n=1;return Li(e).ee({index:oI,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>jr(o,a)).filter((o,a,c)=>!a||jr(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=jr(o,e),c=jr(o,n);if(a===0)s[0]=e.En();else if(a>0&&c<0)s.push(o),s.push(o.En());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Jn(s[o],s[o+1]))return[];const a=s[o].An(this.uid,Gc,X.empty()),c=s[o+1].An(this.uid,Gc,X.empty());i.push(IDBKeyRange.bound(a,c))}return i}Jn(e,n){return jr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(B0)}getMinOffset(e,n){return R.mapArray(this.vn(n),r=>this.Fn(e,r).next(s=>s||te(44426))).next(B0)}}function z0(t){return ht(t,Fl)}function Oi(t){return ht(t,cl)}function Ca(t){return ht(t,Pg)}function Li(t){return ht(t,ll)}function B0(t){oe(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Cg(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new cn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},fT=41943040;class Nt{static withCacheSize(e){return new Nt(e,Nt.DEFAULT_COLLECTION_PERCENTILE,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(t,e,n){const r=t.store(Tn),s=t.store(No),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.ee({range:o},(h,m,g)=>(a++,g.delete()));i.push(c.next(()=>{oe(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const m=rI(e,h.key.path,n.batchId);i.push(s.delete(m)),d.push(h.key)}return R.waitFor(i).next(()=>d)}function pd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw te(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nt.DEFAULT_COLLECTION_PERCENTILE=10,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nt.DEFAULT=new Nt(fT,Nt.DEFAULT_COLLECTION_PERCENTILE,Nt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nt.DISABLED=new Nt(-1,0,0);class ch{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Zn={}}static wt(e,n,r,s){oe(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new ch(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Vr(e).ee({index:Qs,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=qi(e),o=Vr(e);return o.add({}).next(a=>{oe(typeof a=="number",49019);const c=new zg(a,n,r,s),d=function(x,T,k){const D=k.baseMutations.map(E=>hd(x.yt,E)),b=k.mutations.map(E=>hd(x.yt,E));return{userId:T,batchId:k.batchId,localWriteTimeMs:k.localWriteTime.toMillis(),baseMutations:D,mutations:b}}(this.serializer,this.userId,c),h=[];let m=new Re((g,x)=>me(g.canonicalString(),x.canonicalString()));for(const g of s){const x=rI(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),h.push(o.put(d)),h.push(i.put(x,UR))}return m.forEach(g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Zn[a]=c.keys()}),R.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return Vr(e).get(n).next(r=>r?(oe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),$s(this.serializer,r)):null)}Xn(e,n){return this.Zn[n]?R.resolve(this.Zn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Zn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Vr(e).ee({index:Qs,range:s},(o,a,c)=>{a.userId===this.userId&&(oe(a.batchId>=r,47524,{Yn:r}),i=$s(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Xs;return Vr(e).ee({index:Qs,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Xs],[this.userId,Number.POSITIVE_INFINITY]);return Vr(e).H(Qs,n).next(r=>r.map(s=>$s(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=pu(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return qi(e).ee({range:s},(o,a,c)=>{const[d,h,m]=o,g=qn(h);if(d===this.userId&&n.path.isEqual(g))return Vr(e).get(m).next(x=>{if(!x)throw te(61480,{er:o,batchId:m});oe(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:m}),i.push($s(this.serializer,x))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Re(me);const s=[];return n.forEach(i=>{const o=pu(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=qi(e).ee({range:a},(d,h,m)=>{const[g,x,T]=d,k=qn(x);g===this.userId&&i.path.isEqual(k)?r=r.add(T):m.done()});s.push(c)}),R.waitFor(s).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=pu(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Re(me);return qi(e).ee({range:o},(c,d,h)=>{const[m,g,x]=c,T=qn(g);m===this.userId&&r.isPrefixOf(T)?T.length===s&&(a=a.add(x)):h.done()}).next(()=>this.tr(e,a))}tr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Vr(e).get(i).next(o=>{if(o===null)throw te(35274,{batchId:i});oe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push($s(this.serializer,o))}))}),R.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return mT(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.nr(n.batchId)}),R.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return R.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return qi(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=qn(i[1]);s.push(c)}else a.done()}).next(()=>{oe(s.length===0,56720,{rr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return pT(e,this.userId,n)}ir(e){return gT(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Xs,lastStreamToken:""})}}function pT(t,e,n){const r=pu(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return qi(t).ee({range:i,Y:!0},(a,c,d)=>{const[h,m,g]=a;h===e&&m===s&&(o=!0),d.done()}).next(()=>o)}function Vr(t){return ht(t,Tn)}function qi(t){return ht(t,No)}function gT(t){return ht(t,Ol)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new pi(0)}static ar(){return new pi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.ur(e).next(n=>{const r=new pi(n.highestTargetId);return n.highestTargetId=r.next(),this.cr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(n=>de.fromTimestamp(new Ne(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.ur(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.cr(e,s)))}addTargetData(e,n){return this.lr(e,n).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(n,r),this.cr(e,r))))}updateTargetData(e,n){return this.lr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Fi(e).delete(n.targetId)).next(()=>this.ur(e)).next(r=>(oe(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Fi(e).ee((o,a)=>{const c=Ga(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>R.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Fi(e).ee((r,s)=>{const i=Ga(s);n(i)})}ur(e){return q0(e).get(od).next(n=>(oe(n!==null,2888),n))}cr(e,n){return q0(e).put(od,n)}lr(e,n){return Fi(e).put(cT(this.serializer,n))}hr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(n=>n.targetCount)}getTargetData(e,n){const r=hi(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Fi(e).ee({range:s,index:iI},(o,a,c)=>{const d=Ga(a);rc(n,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Br(e);return n.forEach(o=>{const a=Pt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),R.waitFor(s)}removeMatchingKeys(e,n,r){const s=Br(e);return R.forEach(n,i=>{const o=Pt(i.path);return R.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Br(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Br(e);let i=ve();return s.ee({range:r,Y:!0},(o,a,c)=>{const d=qn(o[1]),h=new X(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=Pt(n.path),s=IDBKeyRange.bound([r],[W1(r)],!1,!0);let i=0;return Br(e).ee({index:Rg,Y:!0,range:s},([o,a],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return Fi(e).get(n).next(r=>r?Ga(r):null)}}function Fi(t){return ht(t,Co)}function q0(t){return ht(t,Zs)}function Br(t){return ht(t,ko)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H0="LruGarbageCollector",yT=1048576;function G0([t,e],[n,r]){const s=me(t,n);return s===0?me(e,r):s}class hP{constructor(e){this.Pr=e,this.buffer=new Re(G0),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();G0(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class vT{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){q(H0,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ss(n)?q(H0,"Ignoring IndexedDB error during garbage collection: ",n):await Ts(n)}await this.Ar(3e5)})}}class fP{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return R.resolve(Ht.ce);const r=new hP(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.mr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),R.resolve($0)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$0):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,s,i,o,a,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),Ui()<=xe.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${m} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),R.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function _T(t,e){return new fP(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(e,n){this.db=e,this.garbageCollector=_T(this,n)}dr(e){const n=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}mr(e,n){return this.yr(e,(r,s)=>n(s))}addReference(e,n,r){return Kc(e,r)}removeReference(e,n,r){return Kc(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Kc(e,n)}wr(e,n){return function(s,i){let o=!1;return gT(s).te(a=>pT(s,a,i).next(c=>(c&&(o=!0),R.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.yr(e,(o,a)=>{if(a<=n){const c=this.wr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,de.min()),Br(e).delete(function(m){return[0,Pt(m.path)]}(o))))});s.push(c)}}).next(()=>R.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Kc(e,n)}yr(e,n){const r=Br(e);let s,i=Ht.ce;return r.ee({index:Rg},([o,a],{path:c,sequenceNumber:d})=>{o===0?(i!==Ht.ce&&n(new X(qn(s)),i),i=d,s=c):i=Ht.ce}).next(()=>{i!==Ht.ce&&n(new X(qn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Kc(t,e){return Br(t).put(function(r,s){return{targetId:0,path:Pt(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(){this.changes=new Er(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Je.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?R.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Vs(e).put(r)}removeEntry(e,n,r){return Vs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],fd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.br(e,r)))}getEntry(e,n){let r=Je.newInvalidDocument(n);return Vs(e).ee({index:gu,range:IDBKeyRange.only(ka(n))},(s,i)=>{r=this.Sr(n,i)}).next(()=>r)}Dr(e,n){let r={size:0,document:Je.newInvalidDocument(n)};return Vs(e).ee({index:gu,range:IDBKeyRange.only(ka(n))},(s,i)=>{r={document:this.Sr(n,i),size:pd(i)}}).next(()=>r)}getEntries(e,n){let r=rn();return this.Cr(e,n,(s,i)=>{const o=this.Sr(s,i);r=r.insert(s,o)}).next(()=>r)}vr(e,n){let r=rn(),s=new Oe(X.comparator);return this.Cr(e,n,(i,o)=>{const a=this.Sr(i,o);r=r.insert(i,a),s=s.insert(i,pd(o))}).next(()=>({documents:r,Fr:s}))}Cr(e,n,r){if(n.isEmpty())return R.resolve();let s=new Re(Q0);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(ka(s.first()),ka(s.last())),o=s.getIterator();let a=o.getNext();return Vs(e).ee({index:gu,range:i},(c,d,h)=>{const m=X.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&Q0(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(ka(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),fd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Vs(e).H(IDBKeyRange.bound(a,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=rn();for(const m of d){const g=this.Sr(X.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(oc(n,g)||s.has(g.key))&&(h=h.insert(g.key,g))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=rn();const o=W0(n,r),a=W0(n,cn.max());return Vs(e).ee({index:sI,range:IDBKeyRange.bound(o,a,!0)},(c,d,h)=>{const m=this.Sr(X.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new gP(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return K0(e).get(Xm).next(n=>(oe(!!n,20021),n))}br(e,n){return K0(e).put(Xm,n)}Sr(e,n){if(n){const r=tP(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(de.min())))return r}return Je.newInvalidDocument(e)}}function wT(t){return new pP(t)}class gP extends xT{constructor(e,n){super(),this.Mr=e,this.trackRemovals=n,this.Or=new Er(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Re((i,o)=>me(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Or.get(i);if(n.push(this.Mr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=k0(this.Mr.serializer,o);s=s.add(i.path.popLast());const d=pd(c);r+=d-a.size,n.push(this.Mr.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=k0(this.Mr.serializer,o.convertToNoDocument(de.min()));n.push(this.Mr.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Mr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Mr.updateMetadata(e,r)),R.waitFor(n)}getFromCache(e,n){return this.Mr.Dr(e,n).next(r=>(this.Or.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Mr.vr(e,n).next(({documents:r,Fr:s})=>(s.forEach((i,o)=>{this.Or.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function K0(t){return ht(t,Ll)}function Vs(t){return ht(t,id)}function ka(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function W0(t,e){const n=e.documentKey.path.toArray();return[t,fd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Q0(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=me(n[i],r[i]),s)return s;return s=me(n.length,r.length),s||(s=me(n[n.length-2],r[r.length-2]),s||me(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ET{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&fl(r.mutation,s,Gt.empty(),Ne.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ve()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ve()){const s=Hn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=qa();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Hn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ve()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=rn();const o=hl(),a=function(){return hl()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Ir)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),fl(h.mutation,d,h.mutation.getFieldMask(),Ne.now())):o.set(d.key,Gt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new yP(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=hl();let s=new Oe((o,a)=>o-a),i=ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||Gt.empty();h=a.applyToLocalView(d,h),r.set(c,h);const m=(s.get(a.batchId)||ve()).add(c);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,h=c.value,m=OI();h.forEach(g=>{if(!i.has(g)){const x=qI(n.get(g),r.get(g));x!==null&&m.set(g,x),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return R.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return I2(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):RI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):R.resolve(Hn());let a=Ao,c=i;return o.next(d=>R.forEach(d,(h,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(h)?R.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{c=c.insert(h,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,ve())).next(h=>({batchId:a,changes:MI(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new X(n)).next(r=>{let s=qa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=qa();return this.indexManager.getCollectionParents(e,i).next(a=>R.forEach(a,c=>{const d=function(m,g){return new sc(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Je.newInvalidDocument(h)))});let a=qa();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&fl(h.mutation,d,Gt.empty(),Ne.now()),oc(n,d)&&(a=a.insert(c,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vP{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return R.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Ft(s.createTime)}}(n)),R.resolve()}getNamedQuery(e,n){return R.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(s){return{name:s.name,query:uT(s.bundledQuery),readTime:Ft(s.readTime)}}(n)),R.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _P{constructor(){this.overlays=new Oe(X.comparator),this.Lr=new Map}getOverlay(e,n){return R.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Hn();return R.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),R.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Lr.delete(r)),R.resolve()}getOverlaysForCollection(e,n,r){const s=Hn(),i=n.length+1,o=new X(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return R.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Oe((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Hn(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Hn(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return R.resolve(a)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(r.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new $g(n,r));let i=this.Lr.get(n);i===void 0&&(i=ve(),this.Lr.set(n,i)),this.Lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xP{constructor(){this.sessionToken=rt.EMPTY_BYTE_STRING}getSessionToken(e){return R.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,R.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(){this.kr=new Re(pt.Kr),this.qr=new Re(pt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new pt(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new pt(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new X(new be([])),r=new pt(n,e),s=new pt(n,e+1),i=[];return this.qr.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new X(new be([])),r=new pt(n,e),s=new pt(n,e+1);let i=ve();return this.qr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new pt(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class pt{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return X.comparator(e.key,n.key)||me(e.Hr,n.Hr)}static Ur(e,n){return me(e.Hr,n.Hr)||X.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new Re(pt.Kr)}checkEmpty(e){return R.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new zg(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Jr=this.Jr.add(new pt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return R.resolve(o)}lookupMutationBatch(e,n){return R.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return R.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return R.resolve(this.mutationQueue.length===0?Xs:this.Yn-1)}getAllMutationBatches(e){return R.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new pt(n,0),s=new pt(n,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([r,s],o=>{const a=this.Zr(o.Hr);i.push(a)}),R.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Re(me);return n.forEach(s=>{const i=new pt(s,0),o=new pt(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],a=>{r=r.add(a.Hr)})}),R.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;X.isDocumentKey(i)||(i=i.child(""));const o=new pt(new X(i),0);let a=new Re(me);return this.Jr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(c.Hr)),!0)},o),R.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){oe(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return R.forEach(n.mutations,s=>{const i=new pt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new pt(n,0),s=this.Jr.firstAfterOrEqual(r);return R.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,R.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{constructor(e){this.ti=e,this.docs=function(){return new Oe(X.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return R.resolve(r?r.document.mutableCopy():Je.newInvalidDocument(n))}getEntries(e,n){let r=rn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Je.newInvalidDocument(s))}),R.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=rn();const o=n.path,a=new X(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Cg(X1(h),r)<=0||(s.has(h.key)||oc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return R.resolve(i)}getAllFromCollectionGroup(e,n,r,s){te(9500)}ni(e,n){return R.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new IP(this)}getSize(e){return R.resolve(this.size)}}class IP extends xT{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(r)}),R.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e){this.persistence=e,this.ri=new Er(n=>hi(n),rc),this.lastRemoteSnapshotVersion=de.min(),this.highestTargetId=0,this.ii=0,this.si=new Wg,this.targetCount=0,this.oi=pi._r()}forEachTarget(e,n){return this.ri.forEach((r,s)=>n(s)),R.resolve()}getLastRemoteSnapshotVersion(e){return R.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return R.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),R.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),R.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new pi(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,R.resolve()}updateTargetData(e,n){return this.lr(n),R.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,R.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),R.waitFor(i).next(()=>s)}getTargetCount(e){return R.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return R.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),R.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),R.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),R.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return R.resolve(r)}containsKey(e,n){return R.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qg{constructor(e,n){this._i={},this.overlays={},this.ai=new Ht(0),this.ui=!1,this.ui=!0,this.ci=new xP,this.referenceDelegate=e(this),this.li=new TP(this),this.indexManager=new cP,this.remoteDocumentCache=function(s){return new EP(s)}(r=>this.referenceDelegate.hi(r)),this.serializer=new lT(n),this.Pi=new vP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new _P,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new wP(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const s=new SP(this.ai.next());return this.referenceDelegate.Ti(),r(s).next(i=>this.referenceDelegate.Ii(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return R.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class SP extends eI{constructor(e){super(),this.currentSequenceNumber=e}}class uh{constructor(e){this.persistence=e,this.Ri=new Wg,this.Ai=null}static Vi(e){return new uh(e)}get di(){if(this.Ai)return this.Ai;throw te(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),R.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),R.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),R.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(s=>this.di.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.di.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return R.forEach(this.di,r=>{const s=X.fromPath(r);return this.mi(e,s).next(i=>{i||n.removeEntry(s,de.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return R.or([()=>R.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class gd{constructor(e,n){this.persistence=e,this.fi=new Er(r=>Pt(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=_T(this,n)}static Vi(e,n){return new gd(e,n)}Ti(){}Ii(e){return R.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return R.forEach(this.fi,(r,s)=>this.wr(e,r,s).next(i=>i?R.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,de.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),R.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),R.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),R.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),R.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=vu(e.data.value)),n}wr(e,n,r){return R.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.fi.get(n);return R.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e){this.serializer=e}k(e,n,r,s){const i=new Jd("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(nc)}(e),function(c){c.createObjectStore(Ol,{keyPath:FR}),c.createObjectStore(Tn,{keyPath:o0,autoIncrement:!0}).createIndex(Qs,a0,{unique:!0}),c.createObjectStore(No)}(e),Y0(e),function(c){c.createObjectStore(Us)}(e));let o=R.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(ko),c.deleteObjectStore(Co),c.deleteObjectStore(Zs)}(e),Y0(e)),o=o.next(()=>function(c){const d=c.store(Zs),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:de.min().toTimestamp(),targetCount:0};return d.put(od,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,d){return d.store(Tn).H().next(m=>{c.deleteObjectStore(Tn),c.createObjectStore(Tn,{keyPath:o0,autoIncrement:!0}).createIndex(Qs,a0,{unique:!0});const g=d.store(Tn),x=m.map(T=>g.put(T));return R.waitFor(x)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(Ro,{keyPath:WR})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.gi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Ll)}(e),this.pi(i)))),r<7&&s>=7&&(o=o.next(()=>this.yi(i))),r<8&&s>=8&&(o=o.next(()=>this.wi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.bi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(Zd,{keyPath:QR})})(e),function(c){c.createObjectStore(eh,{keyPath:YR})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore(th,{keyPath:r2});d.createIndex(ep,s2,{unique:!1}),d.createIndex(lI,i2,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore(id,{keyPath:zR});d.createIndex(gu,BR),d.createIndex(sI,$R)}(e)).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(Us))),r<14&&s>=14&&(o=o.next(()=>this.Di(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(Pg,{keyPath:JR,autoIncrement:!0}).createIndex(Zm,XR,{unique:!1}),c.createObjectStore(ll,{keyPath:ZR}).createIndex(oI,e2,{unique:!1}),c.createObjectStore(cl,{keyPath:t2}).createIndex(aI,n2,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(ll).clear()}).next(()=>{n.objectStore(cl).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(Dg,{keyPath:o2})})(e)})),r<18&&s>=18&&j1()&&(o=o.next(()=>{n.objectStore(ll).clear()}).next(()=>{n.objectStore(cl).clear()})),o}pi(e){let n=0;return e.store(Us).ee((r,s)=>{n+=pd(s)}).next(()=>{const r={byteSize:n};return e.store(Ll).put(Xm,r)})}gi(e){const n=e.store(Ol),r=e.store(Tn);return n.H().next(s=>R.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Xs],[i.userId,i.lastAcknowledgedBatchId]);return r.H(Qs,o).next(a=>R.forEach(a,c=>{oe(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const d=$s(this.serializer,c);return mT(e,i.userId,d).next(()=>{})}))}))}yi(e){const n=e.store(ko),r=e.store(Us);return e.store(Zs).get(od).next(s=>{const i=[];return r.ee((o,a)=>{const c=new be(o),d=function(m){return[0,Pt(m)]}(c);i.push(n.get(d).next(h=>h?R.resolve():(m=>n.put({targetId:0,path:Pt(m),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>R.waitFor(i))})}wi(e,n){e.createObjectStore(Fl,{keyPath:KR});const r=n.store(Fl),s=new Kg,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Pt(c)})}};return n.store(Us).ee({Y:!0},(o,a)=>{const c=new be(o);return i(c.popLast())}).next(()=>n.store(No).ee({Y:!0},([o,a,c],d)=>{const h=qn(a);return i(h.popLast())}))}bi(e){const n=e.store(Co);return n.ee((r,s)=>{const i=Ga(s),o=cT(this.serializer,i);return n.put(o)})}Si(e,n){const r=n.store(Us),s=[];return r.ee((i,o)=>{const a=n.store(id),c=function(m){return m.document?new X(be.fromString(m.document.name).popFirst(5)):m.noDocument?X.fromSegments(m.noDocument.path):m.unknownDocument?X.fromSegments(m.unknownDocument.path):te(36783)}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>R.waitFor(s))}Di(e,n){const r=n.store(Tn),s=wT(this.serializer),i=new Qg(uh.Vi,this.serializer.yt);return r.H().next(o=>{const a=new Map;return o.forEach(c=>{let d=a.get(c.userId)??ve();$s(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),R.forEach(a,(c,d)=>{const h=new At(d),m=lh.wt(this.serializer,h),g=i.getIndexManager(h),x=ch.wt(h,this.serializer,g,i.referenceDelegate);return new ET(s,x,m,g).recalculateAndSaveOverlaysForDocumentKeys(new tp(n,Ht.ce),c).next()})})}}function Y0(t){t.createObjectStore(ko,{keyPath:HR}).createIndex(Rg,GR,{unique:!0}),t.createObjectStore(Co,{keyPath:"targetId"}).createIndex(iI,qR,{unique:!0}),t.createObjectStore(Zs)}const Mr="IndexedDbPersistence",If=18e5,Tf=5e3,Sf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",AP="main";class Yg{constructor(e,n,r,s,i,o,a,c,d,h,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Ci=i,this.window=o,this.document=a,this.Fi=d,this.Mi=h,this.xi=m,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=g=>Promise.resolve(),!Yg.v())throw new W(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new mP(this,s),this.Ki=n+AP,this.serializer=new lT(c),this.qi=new ls(this.Ki,this.xi,new bP(this.serializer)),this.ci=new rP,this.li=new dP(this.referenceDelegate,this.serializer),this.remoteDocumentCache=wT(this.serializer),this.Pi=new nP,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,h===!1&&nt(Mr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new W(z.FAILED_PRECONDITION,Sf);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new Ht(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Wc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(n=>{n||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(n=>this.isPrimary&&!n?this.Ji(e).next(()=>!1):!!n&&this.Zi(e).next(()=>!0))).catch(e=>{if(Ss(e))return q(Mr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q(Mr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return Ra(e).get(ji).next(n=>R.resolve(this.Xi(n)))}Yi(e){return Wc(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,If)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=ht(n,Ro);return r.H().next(s=>{const i=this.ns(s,If),o=s.filter(a=>i.indexOf(a)===-1);return R.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ui)for(const n of e)this.Ui.removeItem(this.rs(n.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?R.resolve(!0):Ra(e).get(ji).next(n=>{if(n!==null&&this.ts(n.leaseTimestampMs,Tf)&&!this.ss(n.ownerId)){if(this.Xi(n)&&this.networkEnabled)return!0;if(!this.Xi(n)){if(!n.allowTabSynchronization)throw new W(z.FAILED_PRECONDITION,Sf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Wc(e).H().next(r=>this.ns(r,Tf).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&q(Mr,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[nc,Ro],e=>{const n=new tp(e,Ht.ce);return this.Ji(n).next(()=>this.Yi(n))}),this.qi.close(),this.ls()}ns(e,n){return e.filter(r=>this.ts(r.updateTimeMs,n)&&!this.ss(r.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>Wc(e).H().next(n=>this.ns(n,If).map(r=>r.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,n){return ch.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new uP(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return lh.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,n,r){q(Mr,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?c2:c===17?hI:c===16?l2:c===15?jg:c===14?dI:c===13?uI:c===12?a2:c===11?cI:void te(60245)}(this.xi);let o;return this.qi.runTransaction(e,s,i,a=>(o=new tp(a,this.ai?this.ai.next():Ht.ce),n==="readwrite-primary"?this.ji(o).next(c=>!!c||this.Hi(o)).next(c=>{if(!c)throw nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new W(z.FAILED_PRECONDITION,Z1);return r(o)}).next(c=>this.Zi(o).next(()=>c)):this.Ps(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ps(e){return Ra(e).get(ji).next(n=>{if(n!==null&&this.ts(n.leaseTimestampMs,Tf)&&!this.ss(n.ownerId)&&!this.Xi(n)&&!(this.Mi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new W(z.FAILED_PRECONDITION,Sf)})}Zi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Ra(e).put(ji,n)}static v(){return ls.v()}Ji(e){const n=Ra(e);return n.get(ji).next(r=>this.Xi(r)?(q(Mr,"Releasing primary lease."),n.delete(ji)):R.resolve())}ts(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(nt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const n=/(?:Version|Mobile)\/1[456]/;D1()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var n;try{const r=((n=this.Ui)==null?void 0:n.getItem(this.rs(e)))!==null;return q(Mr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return nt(Mr,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){nt("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ra(t){return ht(t,nc)}function Wc(t){return ht(t,Ro)}function IT(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=s}static Es(e,n){let r=ve(),s=ve();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Jg(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return D1()?8:tI(dt())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.gs(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ps(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new NP;return this.ys(e,n,o).next(a=>{if(i.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>i.result)}ws(e,n,r,s){return r.documentReadCount<this.Vs?(Ui()<=xe.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",zi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),R.resolve()):(Ui()<=xe.DEBUG&&q("QueryEngine","Query:",zi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(Ui()<=xe.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",zi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,an(n))):R.resolve())}gs(e,n){if(x0(n))return R.resolve(null);let r=an(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=lp(n,null,"F"),r=an(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ve(...i);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.bs(n,a);return this.Ss(n,d,o,c.readTime)?this.gs(e,lp(n,null,"F")):this.Ds(e,d,n,c)}))})))}ps(e,n,r,s){return x0(n)||s.isEqual(de.min())?R.resolve(null):this.fs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ss(n,o,r,s)?R.resolve(null):(Ui()<=xe.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),zi(n)),this.Ds(e,o,n,J1(s,Ao)).next(a=>a))})}bs(e,n){let r=new Re(jI(e));return n.forEach((s,i)=>{oc(e,i)&&(r=r.add(i))}),r}Ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ys(e,n,r){return Ui()<=xe.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",zi(n)),this.fs.getDocumentsMatchingQuery(e,n,cn.min(),r)}Ds(e,n,r,s){return this.fs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xg="LocalStore",CP=3e8;class kP{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.vs=new Oe(me),this.Fs=new Er(i=>hi(i),rc),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ET(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function ST(t,e,n,r){return new kP(t,e,n,r)}async function bT(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=ve();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function RP(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,c,d,h){const m=d.batch,g=m.keys();let x=R.resolve();return g.forEach(T=>{x=x.next(()=>h.getEntry(c,T)).next(k=>{const D=d.docVersions.get(T);oe(D!==null,48541),k.version.compareTo(D)<0&&(m.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),h.addEntry(k)))})}),x.next(()=>a.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ve();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function AT(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function PP(t,e){const n=ie(t),r=e.snapshotVersion;let s=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});s=n.vs;const a=[];e.targetChanges.forEach((h,m)=>{const g=s.get(m);if(!g)return;a.push(n.li.removeMatchingKeys(i,h.removedDocuments,m).next(()=>n.li.addMatchingKeys(i,h.addedDocuments,m)));let x=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(rt.EMPTY_BYTE_STRING,de.min()).withLastLimboFreeSnapshotVersion(de.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,r)),s=s.insert(m,x),function(k,D,b){return k.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=CP?!0:b.addedDocuments.size+b.modifiedDocuments.size+b.removedDocuments.size>0}(g,x,h)&&a.push(n.li.updateTargetData(i,x))});let c=rn(),d=ve();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(DP(i,o,e.documentUpdates).next(h=>{c=h.Bs,d=h.Ls})),!r.isEqual(de.min())){const h=n.li.getLastRemoteSnapshotVersion(i).next(m=>n.li.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return R.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.vs=s,i))}function DP(t,e,n){let r=ve(),s=ve();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=rn();return n.forEach((a,c)=>{const d=i.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(de.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):q(Xg,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{Bs:o,Ls:s}})}function jP(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Xs),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function yd(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.li.getTargetData(r,e).next(i=>i?(s=i,R.resolve(s)):n.li.allocateTargetId(r).next(o=>(s=new ir(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.vs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function Uo(t,e,n){const r=ie(t),s=r.vs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ss(o))throw o;q(Xg,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(s.target)}function gp(t,e,n){const r=ie(t);let s=de.min(),i=ve();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const m=ie(c),g=m.Fs.get(h);return g!==void 0?R.resolve(m.vs.get(g)):m.li.getTargetData(d,h)}(r,o,an(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:de.min(),n?i:ve())).next(a=>(kT(r,DI(e),a),{documents:a,ks:i})))}function NT(t,e){const n=ie(t),r=ie(n.li),s=n.vs.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.At(i,e).next(o=>o?o.target:null))}function CT(t,e){const n=ie(t),r=n.Ms.get(e)||de.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.xs.getAllFromCollectionGroup(s,e,J1(r,Ao),Number.MAX_SAFE_INTEGER)).then(s=>(kT(n,e,s),s))}function kT(t,e,n){let r=t.Ms.get(e)||de.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ms.set(e,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT="firestore_clients";function J0(t,e){return`${RT}_${t}_${e}`}const PT="firestore_mutations";function X0(t,e,n){let r=`${PT}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const DT="firestore_targets";function bf(t,e){return`${DT}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn="SharedClientState";class vd{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static $s(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new W(s.error.code,s.error.message))),o?new vd(e,n,s.state,i):(nt(Bn,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ml{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static $s(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new W(r.error.code,r.error.message))),i?new ml(e,r.state,s):(nt(Bn,`Failed to parse target state for ID '${e}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class _d{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static $s(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Fg();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=nI(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new _d(e,i):(nt(Bn,`Failed to parse client data for instance '${e}': ${n}`),null)}}class Zg{constructor(e,n){this.clientId=e,this.onlineState=n}static $s(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Zg(n.clientId,n.onlineState):(nt(Bn,`Failed to parse online state: ${e}`),null)}}class yp{constructor(){this.activeTargetIds=Fg()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Af{constructor(e,n,r,s,i){this.window=e,this.Ci=n,this.persistenceKey=r,this.zs=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new Oe(me),this.started=!1,this.Zs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=J0(this.persistenceKey,this.zs),this.Ys=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Js=this.Js.insert(this.zs,new yp),this.eo=new RegExp(`^${RT}_${o}_([^_]*)$`),this.no=new RegExp(`^${PT}_${o}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${DT}_${o}_(\\d+)$`),this.io=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.so=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const s=this.getItem(J0(this.persistenceKey,r));if(s){const i=_d.$s(r,s);i&&(this.Js=this.Js.insert(i.clientId,i))}}this.oo();const n=this.storage.getItem(this.io);if(n){const r=this._o(n);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let n=!1;return this.Js.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,n,r){this.co(e,n,r),this.lo(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(bf(this.persistenceKey,e));if(s){const i=ml.$s(e,s);i&&(r=i.state)}}return n&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(bf(this.persistenceKey,e))}updateQueryState(e,n,r){this.Po(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.lo(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return q(Bn,"READ",e,n),n}setItem(e,n){q(Bn,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){q(Bn,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const n=e;if(n.storageArea===this.storage){if(q(Bn,"EVENT",n.key,n.newValue),n.key===this.Xs)return void nt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.eo.test(n.key)){if(n.newValue==null){const r=this.Eo(n.key);return this.Ro(r,null)}{const r=this.Ao(n.key,n.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(n.key)){if(n.newValue!==null){const r=this.Vo(n.key,n.newValue);if(r)return this.mo(r)}}else if(this.ro.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(n.key===this.io){if(n.newValue!==null){const r=this._o(n.newValue);if(r)return this.ao(r)}}else if(n.key===this.Ys){const r=function(i){let o=Ht.ce;if(i!=null)try{const a=JSON.parse(i);oe(typeof a=="number",30636,{yo:i}),o=a}catch(a){nt(Bn,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Ht.ce&&this.sequenceNumberHandler(r)}else if(n.key===this.so){const r=this.wo(n.newValue);await Promise.all(r.map(s=>this.syncEngine.bo(s)))}}}else this.Zs.push(n)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,n,r){const s=new vd(this.currentUser,e,n,r),i=X0(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Ws())}lo(e){const n=X0(this.persistenceKey,this.currentUser,e);this.removeItem(n)}To(e){const n={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(n))}Po(e,n,r){const s=bf(this.persistenceKey,e),i=new ml(e,n,r);this.setItem(s,i.Ws())}Io(e){const n=JSON.stringify(Array.from(e));this.setItem(this.so,n)}Eo(e){const n=this.eo.exec(e);return n?n[1]:null}Ao(e,n){const r=this.Eo(e);return _d.$s(r,n)}Vo(e,n){const r=this.no.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return vd.$s(new At(i),s,n)}fo(e,n){const r=this.ro.exec(e),s=Number(r[1]);return ml.$s(s,n)}_o(e){return Zg.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);q(Bn,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,n){const r=n?this.Js.insert(e,n):this.Js.remove(e),s=this.uo(this.Js),i=this.uo(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Co(o,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let n=Fg();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class jT{constructor(){this.vo=new yp,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new yp,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z0="ConnectivityMonitor";class ex{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){q(Z0,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){q(Z0,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qc=null;function vp(){return Qc===null?Qc=function(){return 268435456+Math.round(2147483648*Math.random())}():Qc++,"0x"+Qc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nf="RestConnection",MP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class OP{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.$o=this.databaseId.database===ad?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=vp(),a=this.Qo(e,n.toUriEncodedString());q(Nf,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,s,i);const{host:d}=new URL(a),h=Zn(d);return this.zo(e,a,c,r,h).then(m=>(q(Nf,`Received RPC '${e}' ${o}: `,m),m),m=>{throw So(Nf,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Qo(e,n){const r=MP[e];let s=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LP{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bt="WebChannelConnection",Pa=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(s){setTimeout(()=>{throw s},0)}})};class uo extends OP{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!uo.c_){const e=H1();Pa(e,q1.STAT_EVENT,n=>{n.stat===Qm.PROXY?q(bt,"STAT_EVENT: detected buffering proxy"):n.stat===Qm.NOPROXY&&q(bt,"STAT_EVENT: detected no buffering proxy")}),uo.c_=!0}}zo(e,n,r,s,i){const o=vp();return new Promise((a,c)=>{const d=new B1;d.setWithCredentials(!0),d.listenOnce($1.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case fu.NO_ERROR:const m=d.getResponseJson();q(bt,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case fu.TIMEOUT:q(bt,`RPC '${e}' ${o} timed out`),c(new W(z.DEADLINE_EXCEEDED,"Request time out"));break;case fu.HTTP_ERROR:const g=d.getStatus();if(q(bt,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const T=x==null?void 0:x.error;if(T&&T.status&&T.message){const k=function(b){const E=b.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(E)>=0?E:z.UNKNOWN}(T.status);c(new W(k,T.message))}else c(new W(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new W(z.UNAVAILABLE,"Connection failed."));break;default:te(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{q(bt,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);q(bt,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=vp(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const d=i.join("");q(bt,`Creating RPC '${e}' stream ${s}: ${d}`,a);const h=o.createWebChannel(d,a);this.I_(h);let m=!1,g=!1;const x=new LP({Ho:T=>{g?q(bt,`Not sending because RPC '${e}' stream ${s} is closed:`,T):(m||(q(bt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),q(bt,`RPC '${e}' stream ${s} sending:`,T),h.send(T))},Jo:()=>h.close()});return Pa(h,$a.EventType.OPEN,()=>{g||(q(bt,`RPC '${e}' stream ${s} transport opened.`),x.i_())}),Pa(h,$a.EventType.CLOSE,()=>{g||(g=!0,q(bt,`RPC '${e}' stream ${s} transport closed`),x.o_(),this.E_(h))}),Pa(h,$a.EventType.ERROR,T=>{g||(g=!0,So(bt,`RPC '${e}' stream ${s} transport errored. Name:`,T.name,"Message:",T.message),x.o_(new W(z.UNAVAILABLE,"The operation could not be completed")))}),Pa(h,$a.EventType.MESSAGE,T=>{var k;if(!g){const D=T.data[0];oe(!!D,16349);const b=D,E=(b==null?void 0:b.error)||((k=b[0])==null?void 0:k.error);if(E){q(bt,`RPC '${e}' stream ${s} received error:`,E);const A=E.status;let P=function(w){const y=st[w];if(y!==void 0)return KI(y)}(A),M=E.message;A==="NOT_FOUND"&&M.includes("database")&&M.includes("does not exist")&&M.includes(this.databaseId.database)&&So(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),P===void 0&&(P=z.INTERNAL,M="Unknown error status: "+A+" with message "+E.message),g=!0,x.o_(new W(P,M)),h.close()}else q(bt,`RPC '${e}' stream ${s} received:`,D),x.__(D)}}),uo.u_(),setTimeout(()=>{x.s_()},0),x}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return G1()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FP(t){return new uo(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VT(){return typeof window<"u"?window:null}function Iu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(t){return new H2(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */uo.c_=!1;class MT{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=s,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tx="PersistentStream";class OT{constructor(e,n,r,s,i,o,a,c){this.Ci=e,this.b_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new MT(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(nt(n.toString()),nt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new W(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.H_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return q(tx,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(q(tx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class UP extends OT{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=W2(this.serializer,e),r=function(i){if(!("targetChange"in i))return de.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?de.min():o.readTime?Ft(o.readTime):de.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=dp(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=cd(c)?{documents:tT(i,c)}:{query:nT(i,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=YI(i,o.resumeToken);const d=cp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(de.min())>0){a.readTime=Fo(i,o.snapshotVersion.toTimestamp());const d=cp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=Y2(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=dp(this.serializer),n.removeTarget=e,this.K_(n)}}class zP extends OT{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=Q2(e.writeResults,e.commitTime),r=Ft(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=dp(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>hd(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{}class $P extends BP{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new W(z.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,up(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new W(z.UNKNOWN,i.toString())})}jo(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,up(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new W(z.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function qP(t,e,n,r){return new $P(t,e,n,r)}class HP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nt(n),this.aa=!1):q("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi="RemoteStore";class GP{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Ti(this)&&(q(gi,"Restarting streams for network reachability change."),await async function(c){const d=ie(c);d.Ea.add(4),await cc(d),d.Va.set("Unknown"),d.Ea.delete(4),await hh(d)}(this))})}),this.Va=new HP(r,s)}}async function hh(t){if(Ti(t))for(const e of t.Ra)await e(!0)}async function cc(t){for(const e of t.Ra)await e(!1)}function fh(t,e){const n=ie(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),ny(n)?ty(n):ea(n).O_()&&ey(n,e))}function zo(t,e){const n=ie(t),r=ea(n);n.Ia.delete(e),r.O_()&&LT(n,e),n.Ia.size===0&&(r.O_()?r.L_():Ti(n)&&n.Va.set("Unknown"))}function ey(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(de.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ea(t).Z_(e)}function LT(t,e){t.da.$e(e),ea(t).X_(e)}function ty(t){t.da=new z2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),ea(t).start(),t.Va.ua()}function ny(t){return Ti(t)&&!ea(t).x_()&&t.Ia.size>0}function Ti(t){return ie(t).Ea.size===0}function FT(t){t.da=void 0}async function KP(t){t.Va.set("Online")}async function WP(t){t.Ia.forEach((e,n)=>{ey(t,e)})}async function QP(t,e){FT(t),ny(t)?(t.Va.ha(e),ty(t)):t.Va.set("Unknown")}async function YP(t,e,n){if(t.Va.set("Online"),e instanceof QI&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.da.removeTarget(a))}(t,e)}catch(r){q(gi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await xd(t,r)}else if(e instanceof wu?t.da.Xe(e):e instanceof WI?t.da.st(e):t.da.tt(e),!n.isEqual(de.min()))try{const r=await AT(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.da.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(rt.EMPTY_BYTE_STRING,h.snapshotVersion)),LT(i,c);const m=new ir(h.target,c,d,h.sequenceNumber);ey(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){q(gi,"Failed to raise snapshot:",r),await xd(t,r)}}async function xd(t,e,n){if(!Ss(e))throw e;t.Ea.add(1),await cc(t),t.Va.set("Offline"),n||(n=()=>AT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q(gi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await hh(t)})}function UT(t,e){return e().catch(n=>xd(t,n,e))}async function Zo(t){const e=ie(t),n=vs(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Xs;for(;JP(e);)try{const s=await jP(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,XP(e,s)}catch(s){await xd(e,s)}zT(e)&&BT(e)}function JP(t){return Ti(t)&&t.Ta.length<10}function XP(t,e){t.Ta.push(e);const n=vs(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function zT(t){return Ti(t)&&!vs(t).x_()&&t.Ta.length>0}function BT(t){vs(t).start()}async function ZP(t){vs(t).ra()}async function eD(t){const e=vs(t);for(const n of t.Ta)e.ea(n.mutations)}async function tD(t,e,n){const r=t.Ta.shift(),s=Bg.from(r,e,n);await UT(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await Zo(t)}async function nD(t,e){e&&vs(t).Y_&&await async function(r,s){if(function(o){return L2(o)&&o!==z.ABORTED}(s.code)){const i=r.Ta.shift();vs(r).B_(),await UT(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Zo(r)}}(t,e),zT(t)&&BT(t)}async function nx(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),q(gi,"RemoteStore received new credentials");const r=Ti(n);n.Ea.add(3),await cc(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await hh(n)}async function _p(t,e){const n=ie(t);e?(n.Ea.delete(2),await hh(n)):e||(n.Ea.add(2),await cc(n),n.Va.set("Unknown"))}function ea(t){return t.ma||(t.ma=function(n,r,s){const i=ie(n);return i.sa(),new UP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:KP.bind(null,t),Yo:WP.bind(null,t),t_:QP.bind(null,t),J_:YP.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),ny(t)?ty(t):t.Va.set("Unknown")):(await t.ma.stop(),FT(t))})),t.ma}function vs(t){return t.fa||(t.fa=function(n,r,s){const i=ie(n);return i.sa(),new zP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:ZP.bind(null,t),t_:nD.bind(null,t),ta:eD.bind(null,t),na:tD.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await Zo(t)):(await t.fa.stop(),t.Ta.length>0&&(q(gi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new ry(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new W(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function sy(t,e){if(nt("AsyncQueue",`${e}: ${t}`),Ss(t))return new W(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{static emptySet(e){return new ho(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||X.comparator(n.key,r.key):(n,r)=>X.comparator(n.key,r.key),this.keyedMap=qa(),this.sortedSet=new Oe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ho)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ho;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(){this.ga=new Oe(X.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):te(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Bo{constructor(e,n,r,s,i,o,a,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Bo(e,n,ho.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&sh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rD{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class sD{constructor(){this.queries=sx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ie(n),i=s.queries;s.queries=sx(),i.forEach((o,a)=>{for(const c of a.ba)c.onError(r)})})(this,new W(z.ABORTED,"Firestore shutting down"))}}function sx(){return new Er(t=>PI(t),sh)}async function $T(t,e){const n=ie(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.Da()&&(r=2):(i=new rD,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=sy(o,`Initialization of query '${zi(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.ba.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&iy(n)}async function qT(t,e){const n=ie(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?s=e.Da()?0:1:!i.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function iD(t,e){const n=ie(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.ba)a.Fa(s)&&(r=!0);o.wa=s}}r&&iy(n)}function oD(t,e,n){const r=ie(t),s=r.queries.get(e);if(s)for(const i of s.ba)i.onError(n);r.queries.delete(e)}function iy(t){t.Ca.forEach(e=>{e.next()})}var xp,ix;(ix=xp||(xp={})).Ma="default",ix.Cache="cache";class HT{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Bo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Bo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==xp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GT{constructor(e){this.key=e}}class KT{constructor(e){this.key=e}}class aD{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ve(),this.mutatedKeys=ve(),this.eu=jI(e),this.tu=new ho(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new rx,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,m)=>{const g=s.get(h),x=oc(this.query,m)?m:null,T=!!g&&this.mutatedKeys.has(g.key),k=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let D=!1;g&&x?g.data.isEqual(x.data)?T!==k&&(r.track({type:3,doc:x}),D=!0):this.su(g,x)||(r.track({type:2,doc:x}),D=!0,(c&&this.eu(x,c)>0||d&&this.eu(x,d)<0)&&(a=!0)):!g&&x?(r.track({type:0,doc:x}),D=!0):g&&!x&&(r.track({type:1,doc:g}),D=!0,(c||d)&&(a=!0)),D&&(x?(o=o.add(x),i=k?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,m)=>function(x,T){const k=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return te(20277,{Vt:D})}};return k(x)-k(T)}(h.type,m.type)||this.eu(h.doc,m.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],c=this.Ya.size===0&&this.current&&!s?1:0,d=c!==this.Xa;return this.Xa=c,o.length!==0||d?{snapshot:new Bo(this.query,e.tu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new rx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ve(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new KT(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new GT(r))}),n}cu(e){this.Za=e.ks,this.Ya=ve();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Bo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const ta="SyncEngine";class lD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class cD{constructor(e){this.key=e,this.hu=!1}}class uD{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Er(a=>PI(a),sh),this.Iu=new Map,this.Eu=new Set,this.Ru=new Oe(X.comparator),this.Au=new Map,this.Vu=new Wg,this.du={},this.mu=new Map,this.fu=pi.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function dD(t,e,n=!0){const r=mh(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await WT(r,e,n,!0),s}async function hD(t,e){const n=mh(t);await WT(n,e,!0,!1)}async function WT(t,e,n,r){const s=await yd(t.localStore,an(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await oy(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&fh(t.remoteStore,s),a}async function oy(t,e,n,r,s){t.pu=(m,g,x)=>async function(k,D,b,E){let A=D.view.ru(b);A.Ss&&(A=await gp(k.localStore,D.query,!1).then(({documents:w})=>D.view.ru(w,A)));const P=E&&E.targetChanges.get(D.targetId),M=E&&E.targetMismatches.get(D.targetId)!=null,B=D.view.applyChanges(A,k.isPrimaryClient,P,M);return wp(k,D.targetId,B.au),B.snapshot}(t,m,g,x);const i=await gp(t.localStore,e,!0),o=new aD(e,i.ks),a=o.ru(i.documents),c=lc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,c);wp(t,n,d.au);const h=new lD(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function fD(t,e,n){const r=ie(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!sh(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Uo(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&zo(r.remoteStore,s.targetId),$o(r,s.targetId)}).catch(Ts)):($o(r,s.targetId),await Uo(r.localStore,s.targetId,!0))}async function mD(t,e){const n=ie(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),zo(n.remoteStore,r.targetId))}async function pD(t,e,n){const r=uy(t);try{const s=await function(o,a){const c=ie(o),d=Ne.now(),h=a.reduce((x,T)=>x.add(T.key),ve());let m,g;return c.persistence.runTransaction("Locally write mutations","readwrite",x=>{let T=rn(),k=ve();return c.xs.getEntries(x,h).next(D=>{T=D,T.forEach((b,E)=>{E.isValidDocument()||(k=k.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(x,T)).next(D=>{m=D;const b=[];for(const E of a){const A=M2(E,m.get(E.key).overlayedDocument);A!=null&&b.push(new Ir(E.key,A,EI(A.value.mapValue),Rt.exists(!0)))}return c.mutationQueue.addMutationBatch(x,d,b,a)}).next(D=>{g=D;const b=D.applyToLocalDocumentSet(m,k);return c.documentOverlayCache.saveOverlays(x,D.batchId,b)})}).then(()=>({batchId:g.batchId,changes:MI(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let d=o.du[o.currentUser.toKey()];d||(d=new Oe(me)),d=d.insert(a,c),o.du[o.currentUser.toKey()]=d}(r,s.batchId,n),await As(r,s.changes),await Zo(r.remoteStore)}catch(s){const i=sy(s,"Failed to persist write");n.reject(i)}}async function QT(t,e){const n=ie(t);try{const r=await PP(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?oe(o.hu,14607):s.removedDocuments.size>0&&(oe(o.hu,42227),o.hu=!1))}),await As(n,r,e)}catch(r){await Ts(r)}}function ox(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=ie(o);c.onlineState=a;let d=!1;c.queries.forEach((h,m)=>{for(const g of m.ba)g.va(a)&&(d=!0)}),d&&iy(c)}(r.eventManager,e),s.length&&r.Pu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function gD(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Oe(X.comparator);o=o.insert(i,Je.newNoDocument(i,de.min()));const a=ve().add(i),c=new ac(de.min(),new Map,new Oe(me),o,a);await QT(r,c),r.Ru=r.Ru.remove(i),r.Au.delete(e),cy(r)}else await Uo(r.localStore,e,!1).then(()=>$o(r,e,n)).catch(Ts)}async function yD(t,e){const n=ie(t),r=e.batch.batchId;try{const s=await RP(n.localStore,e);ly(n,r,null),ay(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await As(n,s)}catch(s){await Ts(s)}}async function vD(t,e,n){const r=ie(t);try{const s=await function(o,a){const c=ie(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(m=>(oe(m!==null,37113),h=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);ly(r,e,n),ay(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await As(r,s)}catch(s){await Ts(s)}}function ay(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function ly(t,e,n){const r=ie(t);let s=r.du[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.du[r.currentUser.toKey()]=s}}function $o(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||YT(t,r)})}function YT(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(zo(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),cy(t))}function wp(t,e,n){for(const r of n)r instanceof GT?(t.Vu.addReference(r.key,e),_D(t,r)):r instanceof KT?(q(ta,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||YT(t,r.key)):te(19791,{wu:r})}function _D(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(q(ta,"New document in limbo: "+n),t.Eu.add(r),cy(t))}function cy(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new X(be.fromString(e)),r=t.fu.next();t.Au.set(r,new cD(n)),t.Ru=t.Ru.insert(n,r),fh(t.remoteStore,new ir(an(ic(n.path)),r,"TargetPurposeLimboResolution",Ht.ce))}}async function As(t,e,n){const r=ie(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){s.push(d);const m=Jg.Es(c.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Pu.J_(s),await async function(c,d){const h=ie(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>R.forEach(d,g=>R.forEach(g.Ts,x=>h.persistence.referenceDelegate.addReference(m,g.targetId,x)).next(()=>R.forEach(g.Is,x=>h.persistence.referenceDelegate.removeReference(m,g.targetId,x)))))}catch(m){if(!Ss(m))throw m;q(Xg,"Failed to update sequence numbers: "+m)}for(const m of d){const g=m.targetId;if(!m.fromCache){const x=h.vs.get(g),T=x.snapshotVersion,k=x.withLastLimboFreeSnapshotVersion(T);h.vs=h.vs.insert(g,k)}}}(r.localStore,i))}async function xD(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){q(ta,"User change. New user:",e.toKey());const r=await bT(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(c=>{c.reject(new W(z.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await As(n,r.Ns)}}function wD(t,e){const n=ie(t),r=n.Au.get(e);if(r&&r.hu)return ve().add(r.key);{let s=ve();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function ED(t,e){const n=ie(t),r=await gp(n.localStore,e.query,!0),s=e.view.cu(r);return n.isPrimaryClient&&wp(n,e.targetId,s.au),s}async function ID(t,e){const n=ie(t);return CT(n.localStore,e).then(r=>As(n,r))}async function TD(t,e,n,r){const s=ie(t),i=await function(a,c){const d=ie(a),h=ie(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",m=>h.Xn(m,c).next(g=>g?d.localDocuments.getDocuments(m,g):R.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await Zo(s.remoteStore):n==="acknowledged"||n==="rejected"?(ly(s,e,r||null),ay(s,e),function(a,c){ie(ie(a).mutationQueue).nr(c)}(s.localStore,e)):te(6720,"Unknown batchState",{bu:n}),await As(s,i)):q(ta,"Cannot apply mutation batch with id: "+e)}async function SD(t,e){const n=ie(t);if(mh(n),uy(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await ax(n,r.toArray());n.gu=!0,await _p(n.remoteStore,!0);for(const i of s)fh(n.remoteStore,i)}else if(e===!1&&n.gu!==!1){const r=[];let s=Promise.resolve();n.Iu.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>($o(n,o),Uo(n.localStore,o,!0))),zo(n.remoteStore,o)}),await s,await ax(n,r),function(o){const a=ie(o);a.Au.forEach((c,d)=>{zo(a.remoteStore,d)}),a.Vu.zr(),a.Au=new Map,a.Ru=new Oe(X.comparator)}(n),n.gu=!1,await _p(n.remoteStore,!1)}}async function ax(t,e,n){const r=ie(t),s=[],i=[];for(const o of e){let a;const c=r.Iu.get(o);if(c&&c.length!==0){a=await yd(r.localStore,an(c[0]));for(const d of c){const h=r.Tu.get(d),m=await ED(r,h);m.snapshot&&i.push(m.snapshot)}}else{const d=await NT(r.localStore,o);a=await yd(r.localStore,d),await oy(r,JT(d),o,!1,a.resumeToken)}s.push(a)}return r.Pu.J_(i),s}function JT(t){return kI(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function bD(t){return function(n){return ie(ie(n).persistence).hs()}(ie(t).localStore)}async function AD(t,e,n,r){const s=ie(t);if(s.gu)return void q(ta,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await CT(s.localStore,DI(i[0])),a=ac.createSynthesizedRemoteEventForCurrentChange(e,n==="current",rt.EMPTY_BYTE_STRING);await As(s,o,a);break}case"rejected":await Uo(s.localStore,e,!0),$o(s,e,r);break;default:te(64155,n)}}async function ND(t,e,n){const r=mh(t);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){q(ta,"Adding an already active target "+s);continue}const i=await NT(r.localStore,s),o=await yd(r.localStore,i);await oy(r,JT(i),o.targetId,!1,o.resumeToken),fh(r.remoteStore,o)}for(const s of n)r.Iu.has(s)&&await Uo(r.localStore,s,!1).then(()=>{zo(r.remoteStore,s),$o(r,s)}).catch(Ts)}}function mh(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=QT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gD.bind(null,e),e.Pu.J_=iD.bind(null,e.eventManager),e.Pu.yu=oD.bind(null,e.eventManager),e}function uy(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vD.bind(null,e),e}class Hl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=dh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return ST(this.persistence,new TT,e.initialUser,this.serializer)}Cu(e){return new Qg(uh.Vi,this.serializer)}Du(e){return new jT}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Hl.provider={build:()=>new Hl};class XT extends Hl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){oe(this.persistence.referenceDelegate instanceof gd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new vT(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Nt.withCacheSize(this.cacheSizeBytes):Nt.DEFAULT;return new Qg(r=>gd.Vi(r,n),this.serializer)}}class ZT extends Hl{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await uy(this.xu.syncEngine),await Zo(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return ST(this.persistence,new TT,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new vT(r,e.asyncQueue,n)}Mu(e,n){const r=new OR(n,this.persistence);return new MR(e.asyncQueue,r)}Cu(e){const n=IT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Nt.withCacheSize(this.cacheSizeBytes):Nt.DEFAULT;return new Yg(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,VT(),Iu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new jT}}class CD extends ZT{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof Af&&(this.sharedClientState.syncEngine={So:TD.bind(null,n),Do:AD.bind(null,n),Co:ND.bind(null,n),hs:bD.bind(null,n),bo:ID.bind(null,n)},await this.sharedClientState.start()),await this.persistence.zi(async r=>{await SD(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=VT();if(!Af.v(n))throw new W(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=IT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Af(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class qo{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>ox(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=xD.bind(null,this.syncEngine),await _p(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new sD}()}createDatastore(e){const n=dh(e.databaseInfo.databaseId),r=FP(e.databaseInfo);return qP(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new GP(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>ox(this.syncEngine,n,0),function(){return ex.v()?new ex:new VP}())}createSyncEngine(e,n){return function(s,i,o,a,c,d,h){const m=new uD(s,i,o,a,c,d);return h&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ie(s);q(gi,"RemoteStore shutting down."),i.Ea.add(5),await cc(i),i.Aa.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}qo.provider={build:()=>new qo};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):nt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _s="FirestoreClient";class kD{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=s,this.user=At.UNAUTHENTICATED,this.clientId=Ng.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{q(_s,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(q(_s,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=sy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Cf(t,e){t.asyncQueue.verifyOperationInProgress(),q(_s,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await bT(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function lx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await RD(t);q(_s,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>nx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>nx(e.remoteStore,s)),t._onlineComponents=e}async function RD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q(_s,"Using user provided OfflineComponentProvider");try{await Cf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;So("Error using user provided cache. Falling back to memory cache: "+n),await Cf(t,new Hl)}}else q(_s,"Using default OfflineComponentProvider"),await Cf(t,new XT(void 0));return t._offlineComponents}async function tS(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q(_s,"Using user provided OnlineComponentProvider"),await lx(t,t._uninitializedComponentsProvider._online)):(q(_s,"Using default OnlineComponentProvider"),await lx(t,new qo))),t._onlineComponents}function PD(t){return tS(t).then(e=>e.syncEngine)}async function Ep(t){const e=await tS(t),n=e.eventManager;return n.onListen=dD.bind(null,e.syncEngine),n.onUnlisten=fD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=hD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=mD.bind(null,e.syncEngine),n}function DD(t,e,n,r){const s=new eS(r),i=new HT(e,s,n);return t.asyncQueue.enqueueAndForget(async()=>$T(await Ep(t),i)),()=>{s.Nu(),t.asyncQueue.enqueueAndForget(async()=>qT(await Ep(t),i))}}function jD(t,e,n={}){const r=new cr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new eS({next:g=>{h.Nu(),o.enqueueAndForget(()=>qT(i,m));const x=g.docs.has(a);!x&&g.fromCache?d.reject(new W(z.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&g.fromCache&&c&&c.source==="server"?d.reject(new W(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new HT(ic(a.path),h,{includeMetadataChanges:!0,Ka:!0});return $T(i,m)}(await Ep(t),t.asyncQueue,e,n,r)),r.promise}function VD(t,e){const n=new cr;return t.asyncQueue.enqueueAndForget(async()=>pD(await PD(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nS(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD="ComponentProvider",cx=new Map;function OD(t,e,n,r,s){return new d2(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,nS(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LD="firestore.googleapis.com",ux=!0;class dx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new W(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=LD,this.ssl=ux}else this.host=e.host,this.ssl=e.ssl??ux;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=fT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yT)throw new W(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}DR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=nS(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new W(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new W(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new W(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class dy{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new W(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new W(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new TR;switch(r.type){case"firstParty":return new AR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new W(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=cx.get(n);r&&(q(MD,"Removing Datastore"),cx.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class na{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new na(this.firestore,e,this._query)}}class Xe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xe(this.firestore,e,this._key)}toJSON(){return{type:Xe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(tc(n,Xe._jsonSchema))return new Xe(e,r||null,new X(be.fromString(n.referencePath)))}}Xe._jsonSchemaVersion="firestore/documentReference/1.0",Xe._jsonSchema={type:ot("string",Xe._jsonSchemaVersion),referencePath:ot("string")};class cs extends na{constructor(e,n,r){super(e,n,ic(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xe(this.firestore,null,new X(e))}withConverter(e){return new cs(this.firestore,e,this._path)}}function wt(t,e,...n){if(t=Pe(t),Q1("collection","path",e),t instanceof dy){const r=be.fromString(e,...n);return t0(r),new cs(t,null,r)}{if(!(t instanceof Xe||t instanceof cs))throw new W(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(be.fromString(e,...n));return t0(r),new cs(t.firestore,null,r)}}function ut(t,e,...n){if(t=Pe(t),arguments.length===1&&(e=Ng.newId()),Q1("doc","path",e),t instanceof dy){const r=be.fromString(e,...n);return e0(r),new Xe(t,null,new X(r))}{if(!(t instanceof Xe||t instanceof cs))throw new W(z.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(be.fromString(e,...n));return e0(r),new Xe(t.firestore,t instanceof cs?t.converter:null,new X(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx="AsyncQueue";class fx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new MT(this,"async_queue_retry"),this._c=()=>{const r=Iu();r&&q(hx,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Iu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Iu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new cr;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!Ss(e))throw e;q(hx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,nt("INTERNAL UNHANDLED ERROR: ",mx(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=ry.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&te(47125,{Pc:mx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function mx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class xs extends dy{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new fx,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new fx(e),this._firestoreClient=void 0,await e}}}function px(t,e,n){n||(n=ad);const r=ec(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(ci(i,e))return s;throw new W(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new W(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<yT)throw new W(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&Zn(e.host)&&Qd(e.host),r.initialize({options:e,instanceIdentifier:n})}function hy(t){if(t._terminated)throw new W(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||FD(t),t._firestoreClient}function FD(t){var r,s,i,o;const e=t._freezeSettings(),n=OD(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(s=t._app)==null?void 0:s.options.apiKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new kD(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const d=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mn(rt.fromBase64String(e))}catch(n){throw new W(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new mn(rt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:mn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(tc(e,mn._jsonSchema))return mn.fromBase64String(e.bytes)}}mn._jsonSchemaVersion="firestore/bytes/1.0",mn._jsonSchema={type:ot("string",mn._jsonSchemaVersion),bytes:ot("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new W(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new W(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new W(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return me(this._lat,e._lat)||me(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Qn._jsonSchemaVersion}}static fromJSON(e){if(tc(e,Qn._jsonSchema))return new Qn(e.latitude,e.longitude)}}Qn._jsonSchemaVersion="firestore/geoPoint/1.0",Qn._jsonSchema={type:ot("string",Qn._jsonSchemaVersion),latitude:ot("number"),longitude:ot("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:kn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(tc(e,kn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new kn(e.vectorValues);throw new W(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}kn._jsonSchemaVersion="firestore/vectorValue/1.0",kn._jsonSchema={type:ot("string",kn._jsonSchemaVersion),vectorValues:ot("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UD=/^__.*__$/;class zD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ir(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xo(e,this.data,n,this.fieldTransforms)}}class rS{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ir(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function sS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw te(40011,{dataSource:t})}}class my{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new my({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return wd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(sS(this.dataSource)&&UD.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class BD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||dh(e)}createContext(e,n,r,s=!1){return new my({dataSource:e,methodName:n,targetDoc:r,path:Ge.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gh(t){const e=t._freezeSettings(),n=dh(t._databaseId);return new BD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function iS(t,e,n,r,s,i={}){const o=t.createContext(i.merge||i.mergeFields?2:0,e,n,s);gy("Data must be an object, but it was:",o,r);const a=oS(r,o);let c,d;if(i.merge)c=new Gt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const m of i.mergeFields){const g=Ho(e,m,n);if(!o.contains(g))throw new W(z.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);cS(h,g)||h.push(g)}c=new Gt(h),d=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=o.fieldTransforms;return new zD(new kt(a),c,d)}class yh extends ph{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof yh}}class py extends ph{_toFieldTransform(e){return new $I(e.path,new Mo)}isEqual(e){return e instanceof py}}function $D(t,e,n,r){const s=t.createContext(1,e,n);gy("Data must be an object, but it was:",s,r);const i=[],o=kt.empty();bs(r,(c,d)=>{const h=lS(e,c,n);d=Pe(d);const m=s.childContextForFieldPath(h);if(d instanceof yh)i.push(h);else{const g=uc(d,m);g!=null&&(i.push(h),o.set(h,g))}});const a=new Gt(i);return new rS(o,a,s.fieldTransforms)}function qD(t,e,n,r,s,i){const o=t.createContext(1,e,n),a=[Ho(e,r,n)],c=[s];if(i.length%2!=0)throw new W(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(Ho(e,i[g])),c.push(i[g+1]);const d=[],h=kt.empty();for(let g=a.length-1;g>=0;--g)if(!cS(d,a[g])){const x=a[g];let T=c[g];T=Pe(T);const k=o.childContextForFieldPath(x);if(T instanceof yh)d.push(x);else{const D=uc(T,k);D!=null&&(d.push(x),h.set(x,D))}}const m=new Gt(d);return new rS(h,m,o.fieldTransforms)}function HD(t,e,n,r=!1){return uc(n,t.createContext(r?4:3,e))}function uc(t,e){if(aS(t=Pe(t)))return gy("Unsupported field value:",e,t),oS(t,e);if(t instanceof ph)return function(r,s){if(!sS(s.dataSource))throw s.createError(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=uc(a,s.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Pe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return k2(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ne.fromDate(r);return{timestampValue:Fo(s.serializer,i)}}if(r instanceof Ne){const i=new Ne(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Fo(s.serializer,i)}}if(r instanceof Qn)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof mn)return{bytesValue:YI(s.serializer,r._byteString)};if(r instanceof Xe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Hg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof kn)return function(o,a){const c=o instanceof kn?o.toArray():o;return{mapValue:{fields:{[Mg]:{stringValue:Og},[Po]:{arrayValue:{values:c.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return Ug(a.serializer,h)})}}}}}}(r,s);if(aT(r))return r._toProto(s.serializer);throw s.createError(`Unsupported field value: ${Yd(r)}`)}(t,e)}function oS(t,e){const n={};return fI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):bs(t,(r,s)=>{const i=uc(s,e.childContextForField(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function aS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ne||t instanceof Qn||t instanceof mn||t instanceof Xe||t instanceof ph||t instanceof kn||aT(t))}function gy(t,e,n){if(!aS(n)||!Y1(n)){const r=Yd(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Ho(t,e,n){if((e=Pe(e))instanceof fy)return e._internalPath;if(typeof e=="string")return lS(t,e);throw wd("Field path arguments must be of type string or ",t,!1,void 0,n)}const GD=new RegExp("[~\\*/\\[\\]]");function lS(t,e,n){if(e.search(GD)>=0)throw wd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new fy(...e.split("."))._internalPath}catch{throw wd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function wd(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new W(z.INVALID_ARGUMENT,a+t+c)}function cS(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{convertValue(e,n="none"){switch(gs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ze(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(vr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw te(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return bs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Po].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>ze(o.doubleValue));return new kn(n)}convertGeoPoint(e){return new Qn(ze(e.latitude),ze(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=nh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ul(e));default:return null}}convertTimestamp(e){const n=yr(e);return new Ne(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=be.fromString(e);oe(oT(r),9688,{name:e});const s=new di(r.get(1),r.get(3)),i=new X(r.popFirst(5));return s.isEqual(n)||nt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS extends KD{constructor(e){super(),this.firestore=e}convertBytes(e){return new mn(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xe(this.firestore,null,n)}}function $e(){return new py("serverTimestamp")}const gx="@firebase/firestore",yx="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vx(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dS{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new WD(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(Ho("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class WD extends dS{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QD(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new W(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yy{}class YD extends yy{}function yi(t,e,...n){let r=[];e instanceof yy&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof vy).length,a=i.filter(c=>c instanceof vh).length;if(o>1||o>0&&a>0)throw new W(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class vh extends YD{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new vh(e,n,r)}_apply(e){const n=this._parse(e);return hS(e._query,n),new na(e.firestore,e.converter,ap(e._query,n))}_parse(e){const n=gh(e.firestore);return function(i,o,a,c,d,h,m){let g;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new W(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){xx(m,h);const T=[];for(const k of m)T.push(_x(c,i,k));g={arrayValue:{values:T}}}else g=_x(c,i,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||xx(m,h),g=HD(a,o,m,h==="in"||h==="not-in");return we.create(d,h,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ra(t,e,n){const r=e,s=Ho("where",t);return vh._create(s,r,n)}class vy extends yy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new vy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Ce.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)hS(o,c),o=ap(o,c)}(e._query,n),new na(e.firestore,e.converter,ap(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function _x(t,e,n){if(typeof(n=Pe(n))=="string"){if(n==="")throw new W(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!RI(e)&&n.indexOf("/")!==-1)throw new W(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(be.fromString(n));if(!X.isDocumentKey(r))throw new W(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Bl(t,new X(r))}if(n instanceof Xe)return Bl(t,n._key);throw new W(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yd(n)}.`)}function xx(t,e){if(!Array.isArray(t)||t.length===0)throw new W(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hS(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new W(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new W(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function fS(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class JD{constructor(e){this.kind="memory",this._onlineComponentProvider=qo.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new XT(void 0)}}toJSON(){return{kind:this.kind}}}class XD{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=rj(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function ZD(t){return new JD(t)}function ej(t){return new XD(t)}class tj{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=qo.provider,this._offlineComponentProvider={build:n=>new ZT(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class nj{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=qo.provider,this._offlineComponentProvider={build:n=>new CD(n,e==null?void 0:e.cacheSizeBytes)}}}function rj(t){return new tj(t==null?void 0:t.forceOwnership)}function sj(){return new nj}class Ka{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ti extends dS{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Tu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ho("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new W(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ti._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ti._jsonSchemaVersion="firestore/documentSnapshot/1.0",ti._jsonSchema={type:ot("string",ti._jsonSchemaVersion),bundleSource:ot("string","DocumentSnapshot"),bundleName:ot("string"),bundle:ot("string")};class Tu extends ti{data(e={}){return super.data(e)}}class fo{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Ka(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Tu(this._firestore,this._userDataWriter,r.key,r,new Ka(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new W(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new Tu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ka(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Tu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Ka(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:ij(a.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new W(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=fo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ng.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ij(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return te(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fo._jsonSchemaVersion="firestore/querySnapshot/1.0",fo._jsonSchema={type:ot("string",fo._jsonSchemaVersion),bundleSource:ot("string","QuerySnapshot"),bundleName:ot("string"),bundle:ot("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oj(t){t=Cn(t,Xe);const e=Cn(t.firestore,xs),n=hy(e);return jD(n,t._key).then(r=>mS(e,t,r))}function Su(t,e,n){t=Cn(t,Xe);const r=Cn(t.firestore,xs),s=fS(t.converter,e,n),i=gh(r);return _h(r,[iS(i,"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Rt.none())])}function Kt(t,e,n,...r){t=Cn(t,Xe);const s=Cn(t.firestore,xs),i=gh(s);let o;return o=typeof(e=Pe(e))=="string"||e instanceof fy?qD(i,"updateDoc",t._key,e,n,r):$D(i,"updateDoc",t._key,e),_h(s,[o.toMutation(t._key,Rt.exists(!0))])}function aj(t){return _h(Cn(t.firestore,xs),[new ah(t._key,Rt.none())])}function _y(t,e){const n=Cn(t.firestore,xs),r=ut(t),s=fS(t.converter,e),i=gh(t.firestore);return _h(n,[iS(i,"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Rt.exists(!1))]).then(()=>r)}function Xt(t,...e){var d,h,m;t=Pe(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||vx(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(vx(e[r])){const g=e[r];e[r]=(d=g.next)==null?void 0:d.bind(g),e[r+1]=(h=g.error)==null?void 0:h.bind(g),e[r+2]=(m=g.complete)==null?void 0:m.bind(g)}let i,o,a;if(t instanceof Xe)o=Cn(t.firestore,xs),a=ic(t._key.path),i={next:g=>{e[r]&&e[r](mS(o,t,g))},error:e[r+1],complete:e[r+2]};else{const g=Cn(t,na);o=Cn(g.firestore,xs),a=g._query;const x=new uS(o);i={next:T=>{e[r]&&e[r](new fo(o,x,g,T))},error:e[r+1],complete:e[r+2]},QD(t._query)}const c=hy(o);return DD(c,a,s,i)}function _h(t,e){const n=hy(t);return VD(n,e)}function mS(t,e,n){const r=n.docs.get(e._key),s=new uS(t);return new ti(t,s,e._key,r,new Ka(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){ER(Ii),ps(new pr("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new xs(new SR(r.getProvider("auth-internal")),new NR(o,r.getProvider("app-check-internal")),h2(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),vn(gx,yx,e),vn(gx,yx,"esm2020")})();const wx=["from-emerald-400 to-emerald-600","from-blue-400 to-blue-600","from-indigo-400 to-indigo-600","from-amber-400 to-amber-600"],Ex=({onOpenTurma:t,turmas:e=[],studentsStatus:n={},carregando:r=!1})=>{const s=Object.values(n).reduce((i,o)=>{const a=o.turmaId;return a&&(i[a]||(i[a]=[]),i[a].push(o)),i},{});return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto h-full",children:[u.jsxs("div",{className:"mb-2 lg:mb-6",children:[u.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800",children:"Dashboard do Professor"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Selecione uma turma para preencher as cadernetas de hoje."})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando turmas..."}),!r&&e.map((i,o)=>{const a=s[i.id]||[],c=a.length,d=a.filter(x=>x.status==="sent"||x.status==="absent").length,h=c>0&&d===c,m=c>0?d/c*100:0,g=wx[o%wx.length];return u.jsxs("div",{onClick:()=>t(i),className:"glass-panel cursor-pointer hover:border-primary/30 transition-all hover:shadow-lg group flex flex-col gap-4 relative overflow-hidden",children:[u.jsx("div",{className:`absolute top-0 left-0 w-1.5 h-full bg-gradient-to-b ${g}`}),u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{className:"pl-2",children:[u.jsx("div",{className:"text-xs font-semibold text-primary mb-1 tracking-wide uppercase",children:i.periodo}),u.jsxs("h3",{className:"text-xl font-bold text-slate-800 flex items-center gap-2",children:[u.jsx(To,{size:20,className:"text-slate-400"})," ",i.nome]})]}),u.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center text-slate-400 group-hover:bg-primary group-hover:text-white transition-colors",children:u.jsx(_1,{size:20})})]}),u.jsxs("div",{className:"mt-4 bg-slate-50 rounded-xl p-4 border border-slate-100 flex flex-col gap-2",children:[u.jsxs("div",{className:"flex justify-between items-center text-sm",children:[u.jsxs("span",{className:"text-slate-500 font-medium flex items-center gap-1.5",children:[u.jsx(ed,{size:16})," Dirios Preenchidos"]}),u.jsxs("span",{className:`font-bold ${h?"text-primary":"text-slate-700"}`,children:[d," / ",c]})]}),u.jsx("div",{className:"w-full h-2.5 bg-slate-200 rounded-full overflow-hidden mt-1",children:u.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${h?"bg-primary":"bg-accent"}`,style:{width:`${m}%`}})}),!h&&u.jsxs("div",{className:"text-xs text-slate-500 mt-2 flex items-center gap-1",children:[u.jsx(Eg,{size:14,className:"text-accent"})," Faltam ",Math.max(0,c-d)," cadernetas para enviar hoje."]}),h&&u.jsx("div",{className:"text-xs text-primary-dark font-medium mt-2 flex items-center gap-1",children:" Todas as cadernetas enviadas!"})]})]},i.id)}),!r&&e.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhuma turma vinculada ao seu perfil."})]})]})},lj=({turma:t,onBack:e,onOpenStudent:n,studentsStatus:r})=>{const[s,i]=V.useState(""),a=Object.values(r).filter(d=>d.turmaId===t.id).filter(d=>d.name.toLowerCase().includes(s.toLowerCase())),c=d=>{switch(d){case"sent":return{icon:SC,color:"text-primary",bg:"bg-primary/10",label:"Enviado"};case"draft":return{icon:Eg,color:"text-accent",bg:"bg-accent/10",label:"Pendente (Rascunho)"};case"absent":return{icon:$m,color:"text-red-500",bg:"bg-red-50",label:"Faltou"};default:return{icon:CC,color:"text-slate-300",bg:"bg-slate-50",label:"No iniciado"}}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto h-full",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-2 lg:mb-6 flex-wrap",children:[u.jsx("button",{onClick:e,className:"w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary hover:border-primary transition-all shadow-sm shrink-0",children:u.jsx(v1,{size:20})}),u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800 truncate",children:"Dirio de Classe"}),u.jsxs("p",{className:"text-sm font-medium text-primary mt-1",children:[t.nome," (",t.periodo,")"]})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:u.jsx(Bm,{size:18,className:"text-slate-400"})}),u.jsx("input",{type:"text",placeholder:"Buscar aluno na turma...",className:"form-control !pl-10 !py-3 bg-white shadow-sm border-transparent",value:s,onChange:d=>i(d.target.value)})]}),u.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden flex-1 flex flex-col",children:[u.jsxs("div",{className:"bg-slate-50 px-6 py-3 border-b border-slate-200 flex justify-between items-center text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[u.jsxs("span",{children:[a.length," Alunos"]}),u.jsx("span",{children:"Status de Envio"})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto divide-y divide-slate-100",children:[a.map(d=>{const h=c(d.status),m=h.icon;return u.jsxs("div",{onClick:()=>n(d.id),className:"flex items-center justify-between p-4 px-6 hover:bg-slate-50 cursor-pointer transition-colors group",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-200 shrink-0 relative",children:u.jsx("img",{src:d.avatar,alt:d.name,className:`w-full h-full rounded-full object-cover ${d.status==="absent"?"grayscale opacity-60":""}`})}),u.jsxs("div",{children:[u.jsx("h4",{className:`font-semibold text-[15px] ${d.status==="absent"?"text-slate-500 line-through":"text-slate-800"}`,children:d.name}),u.jsx("span",{className:"text-xs text-slate-400",children:"Ver dirio"})]})]}),u.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg ${h.bg}`,children:[u.jsx(m,{size:16,className:h.color}),u.jsx("span",{className:`text-xs font-semibold ${h.color}`,children:h.label})]})]},d.id)}),a.length===0&&u.jsxs("div",{className:"p-10 flex flex-col items-center justify-center text-slate-400 text-center",children:[u.jsx($m,{size:48,className:"mb-4 text-slate-300"}),"Nenhum aluno encontrado correspondente  busca."]})]})]})]})},Yc=({options:t,active:e,onChange:n})=>u.jsx("div",{className:"flex bg-slate-100/50 p-0.5 rounded-xl w-full",children:t.map(r=>u.jsx("button",{className:`segment-btn ${e===r?"active":""}`,onClick:()=>n(r),children:r},r))}),kf={meals:{"Lanche Manh":null,Almoo:null,"Lanche Tarde":null,Jantar:null},rest:{"Sono Manh":null,"Sono Tarde":null},activities:{Manh:null,Tarde:null},evacuation:{Manh:null,Tarde:null},obs:""},Rf={},cj=({student:t,turma:e,onBack:n,onUpdateStatus:r})=>{const[s,i]=V.useState(kf),[o,a]=V.useState(!1);V.useEffect(()=>{t.status==="absent"?(a(!0),i(Rf[t.id]||kf)):(a(!1),i(Rf[t.id]||kf))},[t.id,t.status]);const c=(m,g,x)=>{if(o)return;const T={...s,[m]:{...s[m],[g]:x}};m==="obs"&&(T.obs=x),i(T),Rf[t.id]=T,t.status!=="sent"&&r("draft")},d=()=>{o?(a(!1),r("pending")):(a(!0),r("absent"))},h=()=>{if(o){alert(`O registro de falta de ${t.name} j consta no sistema.`),n();return}alert(`Caderneta preenchida e enviada para os responsveis de ${t.name}!`),r("sent"),n()};return u.jsxs("div",{className:"flex flex-col gap-0 max-w-4xl mx-auto",children:[u.jsxs("div",{className:`flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-2 lg:mb-6 glass-panel !p-4 transition-colors ${o?"bg-red-50/80 border-red-200":""}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary transition-colors bg-white",children:u.jsx(v1,{size:20})}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-12 h-12 rounded-full p-0.5 bg-slate-200",children:u.jsx("img",{src:t.avatar,alt:"Avatar",className:`w-full h-full rounded-full object-cover ${o?"grayscale":""}`})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-widest",children:e==null?void 0:e.nome}),u.jsx("div",{className:`font-bold text-lg ${o?"text-red-700 line-through":"text-slate-800"}`,children:t.name})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:d,className:`px-4 py-2.5 rounded-xl font-semibold text-sm transition-all flex items-center gap-1.5 ${o?"bg-red-500 text-white shadow-md":"bg-red-50 text-red-500 hover:bg-red-100"}`,children:[u.jsx($m,{size:18})," ",o?"Marcado como Falta":"Indicar Falta"]}),u.jsxs("button",{className:`btn-primary px-5 py-2.5 ${o?"opacity-50 pointer-events-none":""}`,onClick:h,children:[u.jsx(I1,{size:18})," Enviar"]})]})]}),u.jsxs("div",{className:`grid grid-cols-1 lg:grid-cols-2 gap-6 transition-opacity duration-300 ${o?"opacity-30 pointer-events-none":"opacity-100"}`,children:[u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(kC,{className:"text-primary",size:20})," Refeies"]}),u.jsx("div",{className:"flex flex-col gap-3",children:Object.keys(s.meals).map(m=>u.jsxs("div",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:m}),u.jsx("div",{className:"w-full lg:w-[320px]",children:u.jsx(Yc,{options:["Total","Suficiente","Insuficiente","Recusou"],active:s.meals[m],onChange:g=>c("meals",m,g)})})]},m))})]}),u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(LC,{className:"text-primary",size:20})," Descanso"]}),u.jsx("div",{className:"flex flex-col gap-3",children:Object.keys(s.rest).map(m=>u.jsxs("div",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:m}),u.jsx("div",{className:"w-full lg:w-[180px]",children:u.jsx(Yc,{options:["Sim","No"],active:s.rest[m],onChange:g=>c("rest",m,g)})})]},m))})]}),u.jsxs("div",{className:"glass-panel lg:col-span-full flex flex-col lg:flex-row gap-8 lg:gap-12",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(IC,{className:"text-primary",size:20})," Atividades"]}),u.jsx("div",{className:"flex flex-col gap-3",children:["Manh","Tarde"].map(m=>u.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:m}),u.jsx(Yc,{options:["Ativa","Parcial","Sem Participao"],active:s.activities[m],onChange:g=>c("activities",m,g)})]},m))})]}),u.jsx("div",{className:"hidden lg:block w-px bg-slate-200"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(bC,{className:"text-primary",size:20})," Evacuao"]}),u.jsx("div",{className:"flex flex-col gap-3",children:["Manh","Tarde"].map(m=>u.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:m}),u.jsx(Yc,{options:["Normal","Alterado","No houve"],active:s.evacuation[m],onChange:g=>c("evacuation",m,g)})]},m))})]})]}),u.jsxs("div",{className:"glass-panel lg:col-span-full",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(UC,{className:"text-primary",size:20})," Observaes e Recados"]}),u.jsx("textarea",{className:"form-control min-h-[120px] resize-none",placeholder:`Escreva notas importantes sobre o dia de ${t==null?void 0:t.name.split(" ")[0]}...`,value:s.obs,onChange:m=>c("obs",null,m.target.value)})]})]})]})},Ix=[{id:"1",title:"Festa Junina",date:"2024-06-24",time:"14:00 - 18:00",location:"Ptio Principal",type:"Festa",color:"bg-orange-500",participants:"Todas as Turmas",description:"Nossa tradicional festa junina com comidas tpicas e danas."},{id:"2",title:"Reunio de Pais",date:"2024-06-15",time:"19:00 - 21:00",location:"Auditrio",type:"Institucional",color:"bg-primary",participants:"Berrio e Maternal",description:"Apresentao do fechamento de semestre e novas metodologias."},{id:"3",title:"Passeio ao Zoolgico",date:"2024-06-10",time:"08:00 - 12:00",location:"Zoolgico Municipal",type:"Excurso",color:"bg-blue-500",participants:"Ensino Fundamental I",description:"Alunos devem vir com agasalho leve e trazer cantil de gua."},{id:"4",title:"Vacinao (Gripe)",date:"2024-06-05",time:"09:00 - 16:00",location:"Enfermaria",type:"Sade",color:"bg-red-400",participants:"Todas as Turmas",description:"Campanha interna de vacinao. Trazer carteirinha!"}],Tx=()=>{const[t,e]=V.useState(new Date(2024,5,1)),[n,r]=V.useState(null),[s,i]=V.useState("Todos"),o=new Date(t.getFullYear(),t.getMonth()+1,0).getDate(),a=new Date(t.getFullYear(),t.getMonth(),1).getDay(),c=["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],d=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],h=()=>e(new Date(t.getFullYear(),t.getMonth()-1,1)),m=()=>e(new Date(t.getFullYear(),t.getMonth()+1,1)),g=()=>{const T=[],k=new Date().toISOString().split("T")[0];for(let D=0;D<a;D++)T.push(u.jsx("div",{className:"h-10 lg:h-24 bg-slate-50/50 rounded-xl border border-transparent"},`empty-${D}`));for(let D=1;D<=o;D++){const b=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(D).padStart(2,"0")}`,E=Ix.filter(M=>M.date===b),A=b===k,P=n===b;T.push(u.jsxs("div",{onClick:()=>r(P?null:b),className:`relative h-12 lg:h-24 p-1 lg:p-2 rounded-xl border transition-all cursor-pointer flex flex-col items-center lg:items-start
             ${P?"border-primary ring-2 ring-primary/20 bg-primary/5":"border-slate-100 hover:border-primary/40 bg-white shadow-sm"}
           `,children:[u.jsx("span",{className:`text-[13px] lg:text-sm font-semibold w-7 h-7 flex items-center justify-center rounded-full
             ${A?"bg-primary text-white":"text-slate-700"}
           `,children:D}),u.jsx("div",{className:"flex lg:hidden gap-1 mt-1",children:E.slice(0,3).map(M=>u.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${M.color}`},M.id))}),u.jsxs("div",{className:"hidden lg:flex flex-col gap-1 mt-1 w-full overflow-hidden",children:[E.slice(0,2).map(M=>u.jsxs("div",{className:`text-[10px] text-white font-medium px-1.5 py-0.5 rounded truncate ${M.color}`,children:[M.time.split(" ")[0]," - ",M.title]},M.id)),E.length>2&&u.jsxs("div",{className:"text-[10px] text-slate-500 font-medium px-1",children:["+ ",E.length-2," mais"]})]})]},D))}return T},x=Ix.filter(T=>{if(n&&T.date!==n||s!=="Todos"&&T.type!==s)return!1;if(!n){const k=parseInt(T.date.split("-")[1],10)-1,D=parseInt(T.date.split("-")[0],10);if(k!==t.getMonth()||D!==t.getFullYear())return!1}return!0});return u.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 max-w-7xl mx-auto h-full",children:[u.jsxs("div",{className:"flex-[2] flex flex-col bg-white rounded-2xl border border-slate-200 shadow-sm p-4 lg:p-6 h-fit shrink-0",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("h2",{className:"text-xl lg:text-2xl font-bold text-slate-800 flex items-center gap-3",children:[u.jsx(sl,{className:"text-primary hidden sm:block",size:24}),c[t.getMonth()]," ",t.getFullYear()]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:h,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-600 transition-colors",children:u.jsx(NC,{size:20})}),u.jsx("button",{onClick:m,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-600 transition-colors",children:u.jsx(_1,{size:20})})]})]}),u.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2 lg:mb-4",children:d.map(T=>u.jsx("div",{className:"text-center text-[11px] lg:text-xs font-bold text-slate-400 uppercase tracking-wider",children:T},T))}),u.jsx("div",{className:"grid grid-cols-7 gap-1 lg:gap-2",children:g()})]}),u.jsxs("div",{className:"flex-1 flex flex-col gap-4",children:[u.jsxs("div",{className:"flex justify-between items-center px-1",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:n?`Eventos de ${n.split("-").reverse().join("/")}`:"Prximos Eventos"}),u.jsxs("button",{className:"hidden lg:flex items-center gap-2 text-sm font-semibold text-primary hover:text-primary-dark transition-colors bg-primary/10 px-3 py-1.5 rounded-lg",children:[u.jsx(li,{size:16})," Novo Evento"]})]}),u.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide px-1",children:["Todos","Institucional","Festa","Excurso"].map(T=>u.jsx("button",{onClick:()=>i(T),className:`px-4 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-colors border
                  ${s===T?"bg-slate-800 text-white border-transparent shadow-sm":"bg-white text-slate-500 border-slate-200 hover:border-slate-300"}
                `,children:T},T))}),u.jsx("div",{className:"flex-1 overflow-y-auto pr-2 pb-20 lg:pb-0 flex flex-col gap-3",children:x.length===0?u.jsxs("div",{className:"flex flex-col items-center justify-center p-8 text-slate-400 text-center bg-slate-50 rounded-2xl border border-slate-100/50 h-40",children:[u.jsx(sl,{size:40,className:"mb-3 text-slate-300"}),"Nenhum evento programado para esta seleo."]}):x.map(T=>u.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden hover:shadow-md transition-shadow group cursor-pointer relative",children:[u.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1.5 ${T.color}`}),u.jsxs("div",{className:"p-4 pl-5",children:[u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide text-white ${T.color}`,children:T.type}),u.jsx("span",{className:"text-xs font-semibold text-slate-500 bg-slate-100 px-2 py-1 rounded-md",children:T.date.split("-").reverse().join("/")})]}),u.jsx("h4",{className:"font-bold text-slate-800 text-lg mb-1",children:T.title}),u.jsx("p",{className:"text-sm text-slate-500 mb-4 line-clamp-2",children:T.description}),u.jsxs("div",{className:"flex flex-col gap-1.5 mt-auto",children:[u.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-600",children:[u.jsx(Eg,{size:14,className:"text-slate-400"})," ",T.time]}),u.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-600",children:[u.jsx(VC,{size:14,className:"text-slate-400"})," ",T.location]})]})]})]},T.id))}),u.jsx("button",{className:"lg:hidden fixed bottom-20 right-4 w-14 h-14 bg-primary text-white rounded-full shadow-[0_8px_16px_rgba(16,185,129,0.3)] flex items-center justify-center hover:-translate-y-1 transition-transform z-40",children:u.jsx(li,{size:24})})]})]})},Sx=[{id:"1",type:"broadcast",name:"Comunicados Gerais",role:"Escola",lastMessage:"Lembrando que amanh no haver aula na educao infantil.",time:"14:30",unread:0},{id:"2",type:"direct",name:"Me do Joo Pedro",role:"Famlia",lastMessage:"Ele est melhor da gripe, amanh ir.",time:"10:15",unread:2},{id:"3",type:"direct",name:"Pai do Lucas T.",role:"Famlia",lastMessage:"Hoje a av vai buscar o Lucas s 17h, ok?",time:"Ontem",unread:0},{id:"4",type:"direct",name:"Me da Maria Clara",role:"Famlia",lastMessage:"Obrigada pelo cuidado de sempre!",time:"Segunda",unread:0}],uj=[{id:"m1",sender:"them",text:"Bom dia professora, o Joo Pedro acordou com um pouco de tosse.",time:"08:00"},{id:"m2",sender:"me",text:"Bom dia mame! Entendido, vamos observar ele por aqui. Fique tranquila.",time:"08:15"},{id:"m3",sender:"them",text:"Muito obrigada, se tiver febre pode me ligar que eu vou buscar.",time:"08:30"},{id:"m4",sender:"me",text:"Combinado.",time:"08:35"},{id:"m5",sender:"them",text:"Ele est melhor da gripe, amanh ir.",time:"10:15"}],bx=()=>{const[t,e]=V.useState(Sx[1]),[n,r]=V.useState("all"),[s,i]=V.useState(""),o=Sx.filter(a=>n==="all"?!0:a.type===n);return u.jsxs("div",{className:"flex h-[calc(100vh-140px)] lg:h-[calc(100vh-160px)] gap-0 lg:gap-6 antialiased -mx-4 lg:mx-0",children:[u.jsxs("div",{className:`${t?"hidden lg:flex":"flex"} flex-col w-full lg:w-[340px] bg-white lg:rounded-2xl border-r lg:border border-slate-200 overflow-hidden shrink-0 shadow-sm h-full`,children:[u.jsxs("div",{className:"p-4 border-b border-slate-100 bg-slate-50/50",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Mensagens"}),u.jsx("button",{className:"w-9 h-9 flex items-center justify-center bg-primary/10 text-primary rounded-full hover:bg-primary/20 transition-colors",children:u.jsx(zC,{size:18})})]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("input",{type:"text",placeholder:"Pesquisar conversas...",className:"w-full bg-slate-100/80 border-transparent rounded-xl py-2 pl-10 pr-4 text-sm focus:border-primary focus:ring-2 focus:ring-primary/20 outline-none transition-all placeholder-slate-400"}),u.jsx(Bm,{size:16,className:"absolute left-3.5 top-2.5 text-slate-400"})]}),u.jsxs("div",{className:"flex bg-slate-200/50 p-1 rounded-lg",children:[u.jsx("button",{className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-colors ${n==="all"?"bg-white shadow-sm text-slate-800":"text-slate-500 hover:text-slate-700"}`,onClick:()=>r("all"),children:"Todas"}),u.jsx("button",{className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-colors ${n==="broadcast"?"bg-white shadow-sm text-slate-800":"text-slate-500 hover:text-slate-700"}`,onClick:()=>r("broadcast"),children:"Mural"}),u.jsx("button",{className:`flex-1 py-1.5 text-xs font-semibold rounded-md transition-colors ${n==="direct"?"bg-white shadow-sm text-slate-800":"text-slate-500 hover:text-slate-700"}`,onClick:()=>r("direct"),children:"Diretas"})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto w-full",children:o.map(a=>u.jsxs("div",{onClick:()=>e(a),className:`flex items-center gap-3 p-4 cursor-pointer border-b border-slate-50 transition-colors ${(t==null?void 0:t.id)===a.id?"bg-primary/5 relative":"hover:bg-slate-50"}`,children:[(t==null?void 0:t.id)===a.id&&u.jsx("div",{className:"hidden lg:block absolute left-0 top-0 bottom-0 w-1 bg-primary rounded-r-md"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-white ${a.type==="broadcast"?"bg-accent":"bg-slate-300"}`,children:a.type==="broadcast"?u.jsx(pf,{size:20}):u.jsx(zs,{size:20})}),a.unread>0&&u.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full border-2 border-white flex items-center justify-center text-[10px] font-bold text-white shadow-sm",children:a.unread})]}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[u.jsx("h4",{className:"font-bold text-sm text-slate-800 truncate pr-2",children:a.name}),u.jsx("span",{className:`text-[11px] whitespace-nowrap ${a.unread>0?"text-primary font-bold":"text-slate-400"}`,children:a.time})]}),u.jsx("div",{className:"flex justify-between items-center",children:u.jsx("p",{className:`text-xs truncate mr-2 ${a.unread>0?"text-slate-800 font-medium":"text-slate-500"}`,children:a.lastMessage})})]})]},a.id))})]}),u.jsx("div",{className:`${t?"flex":"hidden lg:flex"} flex-1 flex-col bg-white lg:rounded-2xl lg:border border-slate-200 overflow-hidden lg:shadow-sm h-full w-full`,children:t?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"h-[72px] bg-white border-b border-slate-100 px-4 lg:px-6 flex justify-between items-center shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3 lg:gap-4",children:[u.jsx("button",{onClick:()=>e(null),className:"lg:hidden w-8 h-8 flex items-center justify-center text-slate-500 hover:bg-slate-100 rounded-full shrink-0",children:u.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:u.jsx("path",{d:"m15 18-6-6 6-6"})})}),u.jsx("div",{className:`w-10 h-10 rounded-full shrink-0 flex items-center justify-center text-white ${t.type==="broadcast"?"bg-accent":"bg-slate-300"}`,children:t.type==="broadcast"?u.jsx(pf,{size:18}):u.jsx(zs,{size:18})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("h3",{className:"font-bold text-slate-800 text-[15px] truncate",children:t.name}),u.jsx("span",{className:"text-[10px] lg:text-xs text-primary font-medium bg-primary/10 px-2 py-0.5 rounded-md inline-block mt-0.5",children:t.role})]})]}),u.jsxs("div",{className:"flex items-center gap-1 lg:gap-2 shrink-0",children:[u.jsx("button",{className:"w-10 h-10 rounded-full hidden sm:flex items-center justify-center text-slate-400 hover:bg-slate-100 transition-colors",children:u.jsx(Bm,{size:20})}),u.jsx("button",{className:"w-10 h-10 rounded-full flex items-center justify-center text-slate-400 hover:bg-slate-100 transition-colors",children:u.jsx(FC,{size:20})})]})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-4 lg:p-6 bg-[#f4f7f6]/50 flex flex-col gap-4",children:[u.jsx("div",{className:"text-center my-4",children:u.jsx("span",{className:"bg-slate-200/70 text-slate-500 text-[11px] font-bold px-3 py-1 rounded-lg uppercase tracking-wider",children:"Hoje"})}),uj.map(a=>{const c=a.sender==="me";return u.jsx("div",{className:`flex max-w-[85%] lg:max-w-[70%] ${c?"self-end":"self-start"}`,children:u.jsxs("div",{className:`flex flex-col ${c?"items-end":"items-start"}`,children:[u.jsx("div",{className:`px-4 py-2.5 rounded-2xl ${c?"bg-primary text-white rounded-tr-sm":"bg-white border border-slate-100 text-slate-700 shadow-sm rounded-tl-sm"}`,children:u.jsx("p",{className:"text-[15px] leading-relaxed",children:a.text})}),u.jsxs("div",{className:"flex items-center gap-1 mt-1 px-1",children:[u.jsx("span",{className:"text-[11px] text-slate-400 font-medium",children:a.time}),c&&u.jsx(TC,{size:14,className:"text-primary"})]})]})},a.id)})]}),u.jsxs("div",{className:"p-4 bg-white border-t border-slate-100 flex gap-3 items-end",children:[u.jsx("button",{className:"w-12 h-12 flex shrink-0 items-center justify-center text-slate-400 hover:text-primary hover:bg-slate-50 rounded-xl transition-colors",children:u.jsx(w1,{size:22})}),u.jsx("div",{className:"flex-1 bg-slate-100/80 rounded-2xl flex items-center border border-transparent focus-within:border-primary/30 transition-colors px-4",children:u.jsx("input",{type:"text",value:s,onChange:a=>i(a.target.value),onKeyDown:a=>{a.key==="Enter"&&i("")},placeholder:"Digite uma mensagem...",className:"w-full bg-transparent border-none py-3.5 outline-none text-[15px] text-slate-800 placeholder-slate-400"})}),u.jsx("button",{onClick:()=>i(""),disabled:!s.trim(),className:`w-12 h-12 flex shrink-0 items-center justify-center rounded-xl transition-all ${s.trim()?"bg-primary text-white shadow-md hover:bg-primary-dark hover:-translate-y-0.5":"bg-slate-100 text-slate-300"}`,children:u.jsx(I1,{size:20,className:s.trim()?"translate-x-0.5":""})})]})]}):u.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400 p-8",children:[u.jsx(pf,{size:64,className:"mb-6 opacity-20 text-primary"}),u.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Central de Comunicao"}),u.jsx("p",{className:"text-center max-w-sm",children:"Selecione uma conversa  esquerda para trocar mensagens com os responsveis ou envie um novo Comunicado Geral ao mural."})]})})]})};var dj="firebase",hj="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vn(dj,hj,"app");function pS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const fj=pS,gS=new Xl("auth","Firebase",pS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ed=new Tg("@firebase/auth");function mj(t,...e){Ed.logLevel<=xe.WARN&&Ed.warn(`Auth (${Ii}): ${t}`,...e)}function bu(t,...e){Ed.logLevel<=xe.ERROR&&Ed.error(`Auth (${Ii}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(t,...e){throw xy(t,...e)}function Yn(t,...e){return xy(t,...e)}function yS(t,e,n){const r={...fj(),[e]:n};return new Xl("auth","Firebase",r).create(e,{appName:t.name})}function ur(t){return yS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function xy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return gS.create(t,...e)}function he(t,e,...n){if(!t)throw xy(e,...n)}function or(t){const e="INTERNAL ASSERTION FAILED: "+t;throw bu(e),new Error(e)}function _r(t,e){t||or(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ip(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function pj(){return Ax()==="http:"||Ax()==="https:"}function Ax(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(pj()||rk()||"connection"in navigator)?navigator.onLine:!0}function yj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,n){this.shortDelay=e,this.longDelay=n,_r(n>e,"Short delay should be less than long delay!"),this.isMobile=tk()||sk()}get(){return gj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wy(t,e){_r(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;or("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;or("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;or("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],xj=new dc(3e4,6e4);function Tr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function er(t,e,n,r,s={}){return _S(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Zl({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...i};return nk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&Zn(t.emulatorConfig.host)&&(d.credentials="include"),vS.fetch()(await xS(t,t.config.apiHost,n,a),d)})}async function _S(t,e,n){t._canInitEmulator=!1;const r={...vj,...e};try{const s=new Ej(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Jc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Jc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Jc(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw yS(t,h,d);Pn(t,h)}}catch(s){if(s instanceof Dn)throw s;Pn(t,"network-request-failed",{message:String(s)})}}async function hc(t,e,n,r,s={}){const i=await er(t,e,n,r,s);return"mfaPendingCredential"in i&&Pn(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function xS(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?wy(t.config,s):`${t.config.apiScheme}://${s}`;return _j.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function wj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ej{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Yn(this.auth,"network-request-failed")),xj.get())})}}function Jc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Yn(t,e,r);return s.customData._tokenResponse=n,s}function Nx(t){return t!==void 0&&t.enterprise!==void 0}class Ij{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return wj(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Tj(t,e){return er(t,"GET","/v2/recaptchaConfig",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sj(t,e){return er(t,"POST","/v1/accounts:delete",e)}async function Id(t,e){return er(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function bj(t,e=!1){const n=Pe(t),r=await n.getIdToken(e),s=Ey(r);he(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:pl(Pf(s.auth_time)),issuedAtTime:pl(Pf(s.iat)),expirationTime:pl(Pf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Pf(t){return Number(t)*1e3}function Ey(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return bu("JWT malformed, contained fewer than 3 sections"),null;try{const s=b1(n);return s?JSON.parse(s):(bu("Failed to decode base64 JWT payload"),null)}catch(s){return bu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Cx(t){const e=Ey(t);return he(e,"internal-error"),he(typeof e.exp<"u","internal-error"),he(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Go(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Dn&&Aj(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Aj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=pl(this.lastLoginAt),this.creationTime=pl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Td(t){var m;const e=t.auth,n=await t.getIdToken(),r=await Go(t,Id(e,{idToken:n}));he(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?wS(s.providerUserInfo):[],o=kj(t.providerData,i),a=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Tp(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function Cj(t){const e=Pe(t);await Td(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function kj(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function wS(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rj(t,e){const n=await _S(t,{},async()=>{const r=Zl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await xS(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&Zn(t.emulatorConfig.host)&&(c.credentials="include"),vS.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Pj(t,e){return er(t,"POST","/v2/accounts:revokeToken",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){he(e.idToken,"internal-error"),he(typeof e.idToken<"u","internal-error"),he(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Cx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){he(e.length!==0,"internal-error");const n=Cx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(he(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await Rj(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new mo;return r&&(he(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(he(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(he(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new mo,this.toJSON())}_performRefresh(){return or("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(t,e){he(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class bn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new Nj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Tp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Go(this,this.stsTokenManager.getToken(this.auth,e));return he(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return bj(this,e)}reload(){return Cj(this)}_assign(e){this!==e&&(he(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new bn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){he(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Td(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if($t(this.auth.app))return Promise.reject(ur(this.auth));const e=await this.getIdToken();return await Go(this,Sj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:x,providerData:T,stsTokenManager:k}=n;he(m&&k,e,"internal-error");const D=mo.fromJSON(this.name,k);he(typeof m=="string",e,"internal-error"),Or(r,e.name),Or(s,e.name),he(typeof g=="boolean",e,"internal-error"),he(typeof x=="boolean",e,"internal-error"),Or(i,e.name),Or(o,e.name),Or(a,e.name),Or(c,e.name),Or(d,e.name),Or(h,e.name);const b=new bn({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:x,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:D,createdAt:d,lastLoginAt:h});return T&&Array.isArray(T)&&(b.providerData=T.map(E=>({...E}))),c&&(b._redirectEventId=c),b}static async _fromIdTokenResponse(e,n,r=!1){const s=new mo;s.updateFromServerResponse(n);const i=new bn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Td(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];he(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?wS(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new mo;a.updateFromIdToken(r);const c=new bn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Tp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kx=new Map;function ar(t){_r(t instanceof Function,"Expected a class definition");let e=kx.get(t);return e?(_r(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,kx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}ES.type="NONE";const Rx=ES;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(t,e,n){return`firebase:${t}:${e}:${n}`}class po{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Au(this.userKey,s.apiKey,i),this.fullPersistenceKey=Au("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Id(this.auth,{idToken:e}).catch(()=>{});return n?bn._fromGetAccountInfoResponse(this.auth,n,e):null}return bn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new po(ar(Rx),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||ar(Rx);const o=Au(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let m;if(typeof h=="string"){const g=await Id(e,{idToken:h}).catch(()=>{});if(!g)break;m=await bn._fromGetAccountInfoResponse(e,g,h)}else m=bn._fromJSON(e,h);d!==i&&(a=m),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new po(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new po(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Px(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(IS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(NS(e))return"Blackberry";if(CS(e))return"Webos";if(TS(e))return"Safari";if((e.includes("chrome/")||SS(e))&&!e.includes("edge/"))return"Chrome";if(AS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function IS(t=dt()){return/firefox\//i.test(t)}function TS(t=dt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function SS(t=dt()){return/crios\//i.test(t)}function bS(t=dt()){return/iemobile/i.test(t)}function AS(t=dt()){return/android/i.test(t)}function NS(t=dt()){return/blackberry/i.test(t)}function CS(t=dt()){return/webos/i.test(t)}function Iy(t=dt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Dj(t=dt()){var e;return Iy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function jj(){return ik()&&document.documentMode===10}function kS(t=dt()){return Iy(t)||AS(t)||CS(t)||NS(t)||/windows phone/i.test(t)||bS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(t,e=[]){let n;switch(t){case"Browser":n=Px(dt());break;case"Worker":n=`${Px(dt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ii}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mj(t,e={}){return er(t,"GET","/v2/passwordPolicy",Tr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj=6;class Lj{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Oj,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fj{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Dx(this),this.idTokenSubscription=new Dx(this),this.beforeStateQueue=new Vj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ar(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await po.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Id(this,{idToken:e}),r=await bn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if($t(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return he(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Td(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=yj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if($t(this.app))return Promise.reject(ur(this));const n=e?Pe(e):null;return n&&he(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&he(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return $t(this.app)?Promise.reject(ur(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return $t(this.app)?Promise.reject(ur(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ar(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Mj(this),n=new Lj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Xl("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Pj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ar(e)||this._popupRedirectResolver;he(n,this,"argument-error"),this.redirectPersistenceManager=await po.create(this,[ar(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(he(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return he(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=RS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if($t(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&mj(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ns(t){return Pe(t)}class Dx{constructor(e){this.auth=e,this.observer=null,this.addObserver=dk(n=>this.observer=n)}get next(){return he(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Uj(t){xh=t}function PS(t){return xh.loadJS(t)}function zj(){return xh.recaptchaEnterpriseScript}function Bj(){return xh.gapiScript}function $j(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class qj{constructor(){this.enterprise=new Hj}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class Hj{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Gj="recaptcha-enterprise",DS="NO_RECAPTCHA";class Kj{constructor(e){this.type=Gj,this.auth=Ns(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{Tj(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new Ij(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;Nx(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(DS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new qj().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Nx(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=zj();c.length!==0&&(c+=a),PS(c).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function jx(t,e,n,r=!1,s=!1){const i=new Kj(t);let o;if(s)o=DS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Sd(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await jx(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await jx(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wj(t,e){const n=ec(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(ci(i,e??{}))return s;Pn(s,"already-initialized")}return n.initialize({options:e})}function Qj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ar);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Yj(t,e,n){const r=Ns(t);he(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=jS(e),{host:o,port:a}=Jj(e),c=a===null?"":`:${a}`,d={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){he(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),he(ci(d,r.config.emulator)&&ci(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Zn(o)?(Qd(`${i}//${o}${c}`),Ig("Auth",!0)):Xj()}function jS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Jj(t){const e=jS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Vx(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Vx(o)}}}function Vx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Xj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return or("not implemented")}_getIdTokenResponse(e){return or("not implemented")}_linkToIdToken(e,n){return or("not implemented")}_getReauthenticationResolver(e){return or("not implemented")}}async function Zj(t,e){return er(t,"POST","/v1/accounts:update",e)}async function eV(t,e){return er(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tV(t,e){return hc(t,"POST","/v1/accounts:signInWithPassword",Tr(t,e))}async function nV(t,e){return er(t,"POST","/v1/accounts:sendOobCode",Tr(t,e))}async function rV(t,e){return nV(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sV(t,e){return hc(t,"POST","/v1/accounts:signInWithEmailLink",Tr(t,e))}async function iV(t,e){return hc(t,"POST","/v1/accounts:signInWithEmailLink",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl extends Ty{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Gl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Gl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sd(e,n,"signInWithPassword",tV);case"emailLink":return sV(e,{email:this._email,oobCode:this._password});default:Pn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Sd(e,r,"signUpPassword",eV);case"emailLink":return iV(e,{idToken:n,email:this._email,oobCode:this._password});default:Pn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function go(t,e){return hc(t,"POST","/v1/accounts:signInWithIdp",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oV="http://localhost";class vi extends Ty{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new vi(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Pn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new vi(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return go(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,go(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,go(e,n)}buildRequest(){const e={requestUri:oV,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Zl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aV(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function lV(t){const e=za(Ba(t)).link,n=e?za(Ba(e)).deep_link_id:null,r=za(Ba(t)).deep_link_id;return(r?za(Ba(r)).link:null)||r||n||e||t}class Sy{constructor(e){const n=za(Ba(e)),r=n.apiKey??null,s=n.oobCode??null,i=aV(n.mode??null);he(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=lV(e);try{return new Sy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(){this.providerId=Si.PROVIDER_ID}static credential(e,n){return Gl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Sy.parseLink(n);return he(r,"argument-error"),Gl._fromEmailAndCode(e,r.code,r.tenantId)}}Si.PROVIDER_ID="password";Si.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Si.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc extends VS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $r extends fc{constructor(){super("facebook.com")}static credential(e){return vi._fromParams({providerId:$r.PROVIDER_ID,signInMethod:$r.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $r.credentialFromTaggedObject(e)}static credentialFromError(e){return $r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $r.credential(e.oauthAccessToken)}catch{return null}}}$r.FACEBOOK_SIGN_IN_METHOD="facebook.com";$r.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr extends fc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return vi._fromParams({providerId:qr.PROVIDER_ID,signInMethod:qr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return qr.credentialFromTaggedObject(e)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return qr.credential(n,r)}catch{return null}}}qr.GOOGLE_SIGN_IN_METHOD="google.com";qr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr extends fc{constructor(){super("github.com")}static credential(e){return vi._fromParams({providerId:Hr.PROVIDER_ID,signInMethod:Hr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hr.credentialFromTaggedObject(e)}static credentialFromError(e){return Hr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Hr.credential(e.oauthAccessToken)}catch{return null}}}Hr.GITHUB_SIGN_IN_METHOD="github.com";Hr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr extends fc{constructor(){super("twitter.com")}static credential(e,n){return vi._fromParams({providerId:Gr.PROVIDER_ID,signInMethod:Gr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Gr.credentialFromTaggedObject(e)}static credentialFromError(e){return Gr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Gr.credential(n,r)}catch{return null}}}Gr.TWITTER_SIGN_IN_METHOD="twitter.com";Gr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cV(t,e){return hc(t,"POST","/v1/accounts:signUp",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _i{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await bn._fromIdTokenResponse(e,r,s),o=Mx(r);return new _i({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Mx(r);return new _i({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function Mx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bd extends Dn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,bd.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new bd(e,n,r,s)}}function MS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?bd._fromErrorAndOperation(t,i,e,r):i})}async function uV(t,e,n=!1){const r=await Go(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _i._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OS(t,e,n=!1){const{auth:r}=t;if($t(r.app))return Promise.reject(ur(r));const s="reauthenticate";try{const i=await Go(t,MS(r,s,e,t),n);he(i.idToken,r,"internal-error");const o=Ey(i.idToken);he(o,r,"internal-error");const{sub:a}=o;return he(t.uid===a,r,"user-mismatch"),_i._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Pn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LS(t,e,n=!1){if($t(t.app))return Promise.reject(ur(t));const r="signIn",s=await MS(t,r,e),i=await _i._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function dV(t,e){return LS(Ns(t),e)}async function hV(t,e){return OS(Pe(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FS(t){const e=Ns(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function US(t,e,n){const r=Ns(t);await Sd(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",rV)}async function fV(t,e,n){if($t(t.app))return Promise.reject(ur(t));const r=Ns(t),o=await Sd(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cV).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&FS(t),c}),a=await _i._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function mV(t,e,n){return $t(t.app)?Promise.reject(ur(t)):dV(Pe(t),Si.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&FS(t),r})}function pV(t,e){return gV(Pe(t),null,e)}async function gV(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await Go(t,Zj(r,i));await t._updateTokensIfNecessary(o,!0)}function yV(t,e,n,r){return Pe(t).onIdTokenChanged(e,n,r)}function vV(t,e,n){return Pe(t).beforeAuthStateChanged(e,n)}function _V(t,e,n,r){return Pe(t).onAuthStateChanged(e,n,r)}function xV(t){return Pe(t).signOut()}const Ad="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ad,"1"),this.storage.removeItem(Ad),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wV=1e3,EV=10;class BS extends zS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);jj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,EV):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},wV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}BS.type="LOCAL";const IV=BS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S extends zS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}$S.type="SESSION";const qS=$S;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TV(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new wh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),c=await TV(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}wh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SV{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const d=by("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(){return window}function bV(t){Jn().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(){return typeof Jn().WorkerGlobalScope<"u"&&typeof Jn().importScripts=="function"}async function AV(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function NV(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function CV(){return HS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GS="firebaseLocalStorageDb",kV=1,Nd="firebaseLocalStorage",KS="fbase_key";class mc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Eh(t,e){return t.transaction([Nd],e?"readwrite":"readonly").objectStore(Nd)}function RV(){const t=indexedDB.deleteDatabase(GS);return new mc(t).toPromise()}function Sp(){const t=indexedDB.open(GS,kV);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Nd,{keyPath:KS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Nd)?e(r):(r.close(),await RV(),e(await Sp()))})})}async function Ox(t,e,n){const r=Eh(t,!0).put({[KS]:e,value:n});return new mc(r).toPromise()}async function PV(t,e){const n=Eh(t,!1).get(e),r=await new mc(n).toPromise();return r===void 0?null:r.value}function Lx(t,e){const n=Eh(t,!0).delete(e);return new mc(n).toPromise()}const DV=800,jV=3;class WS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Sp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>jV)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return HS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=wh._getInstance(CV()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await AV(),!this.activeServiceWorker)return;this.sender=new SV(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||NV()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Sp();return await Ox(e,Ad,"1"),await Lx(e,Ad),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ox(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>PV(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Lx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Eh(s,!1).getAll();return new mc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DV)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}WS.type="LOCAL";const VV=WS;new dc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MV(t,e){return e?ar(e):(he(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay extends Ty{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return go(e,this._buildIdpRequest())}_linkToIdToken(e,n){return go(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return go(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function OV(t){return LS(t.auth,new Ay(t),t.bypassAuthState)}function LV(t){const{auth:e,user:n}=t;return he(n,e,"internal-error"),OS(n,new Ay(t),t.bypassAuthState)}async function FV(t){const{auth:e,user:n}=t;return he(n,e,"internal-error"),uV(n,new Ay(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OV;case"linkViaPopup":case"linkViaRedirect":return FV;case"reauthViaPopup":case"reauthViaRedirect":return LV;default:Pn(this.auth,"internal-error")}}resolve(e){_r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_r(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UV=new dc(2e3,1e4);class ro extends QS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ro.currentPopupAction&&ro.currentPopupAction.cancel(),ro.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return he(e,this.auth,"internal-error"),e}async onExecution(){_r(this.filter.length===1,"Popup operations only handle one event");const e=by();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Yn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(Yn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ro.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,UV.get())};e()}}ro.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zV="pendingRedirect",Nu=new Map;class BV extends QS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Nu.get(this.auth._key());if(!e){try{const r=await $V(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Nu.set(this.auth._key(),e)}return this.bypassAuthState||Nu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function $V(t,e){const n=GV(e),r=HV(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function qV(t,e){Nu.set(t._key(),e)}function HV(t){return ar(t._redirectPersistence)}function GV(t){return Au(zV,t.config.apiKey,t.name)}async function KV(t,e,n=!1){if($t(t.app))return Promise.reject(ur(t));const r=Ns(t),s=MV(r,e),o=await new BV(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV=10*60*1e3;class QV{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!YV(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!YS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(Yn(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WV&&this.cachedEventUids.clear(),this.cachedEventUids.has(Fx(e))}saveEventToCache(e){this.cachedEventUids.add(Fx(e)),this.lastProcessedEventTime=Date.now()}}function Fx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function YS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function YV(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return YS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JV(t,e={}){return er(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XV=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ZV=/^https?/;async function e4(t){if(t.config.emulator)return;const{authorizedDomains:e}=await JV(t);for(const n of e)try{if(t4(n))return}catch{}Pn(t,"unauthorized-domain")}function t4(t){const e=Ip(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!ZV.test(n))return!1;if(XV.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n4=new dc(3e4,6e4);function Ux(){const t=Jn().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function r4(t){return new Promise((e,n)=>{var s,i,o;function r(){Ux(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ux(),n(Yn(t,"network-request-failed"))},timeout:n4.get()})}if((i=(s=Jn().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=Jn().gapi)!=null&&o.load)r();else{const a=$j("iframefcb");return Jn()[a]=()=>{gapi.load?r():n(Yn(t,"network-request-failed"))},PS(`${Bj()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Cu=null,e})}let Cu=null;function s4(t){return Cu=Cu||r4(t),Cu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=new dc(5e3,15e3),o4="__/auth/iframe",a4="emulator/auth/iframe",l4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},c4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function u4(t){const e=t.config;he(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?wy(e,a4):`https://${t.config.authDomain}/${o4}`,r={apiKey:e.apiKey,appName:t.name,v:Ii},s=c4.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Zl(r).slice(1)}`}async function d4(t){const e=await s4(t),n=Jn().gapi;return he(n,t,"internal-error"),e.open({where:document.body,url:u4(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:l4,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Yn(t,"network-request-failed"),a=Jn().setTimeout(()=>{i(o)},i4.get());function c(){Jn().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},f4=500,m4=600,p4="_blank",g4="http://localhost";class zx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function y4(t,e,n,r=f4,s=m4){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...h4,width:r.toString(),height:s.toString(),top:i,left:o},d=dt().toLowerCase();n&&(a=SS(d)?p4:n),IS(d)&&(e=e||g4,c.scrollbars="yes");const h=Object.entries(c).reduce((g,[x,T])=>`${g}${x}=${T},`,"");if(Dj(d)&&a!=="_self")return v4(e||"",a),new zx(null);const m=window.open(e||"",a,h);he(m,t,"popup-blocked");try{m.focus()}catch{}return new zx(m)}function v4(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4="__/auth/handler",x4="emulator/auth/handler",w4=encodeURIComponent("fac");async function Bx(t,e,n,r,s,i){he(t.config.authDomain,t,"auth-domain-config-required"),he(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ii,eventId:s};if(e instanceof VS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",uk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))o[h]=m}if(e instanceof fc){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),d=c?`#${w4}=${encodeURIComponent(c)}`:"";return`${E4(t)}?${Zl(a).slice(1)}${d}`}function E4({config:t}){return t.emulator?wy(t,x4):`https://${t.authDomain}/${_4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Df="webStorageSupport";class I4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qS,this._completeRedirectFn=KV,this._overrideRedirectResult=qV}async _openPopup(e,n,r,s){var o;_r((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await Bx(e,n,r,Ip(),s);return y4(e,i,by())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await Bx(e,n,r,Ip(),s);return bV(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(_r(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await d4(e),r=new QV(e);return n.register("authEvent",s=>(he(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Df,{type:Df},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Df];i!==void 0&&n(!!i),Pn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=e4(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return kS()||TS()||Iy()}}const T4=I4;var $x="@firebase/auth",qx="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){he(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function A4(t){ps(new pr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;he(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:RS(t)},d=new Fj(r,s,i,c);return Qj(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ps(new pr("auth-internal",e=>{const n=Ns(e.getProvider("auth").getImmediate());return(r=>new S4(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),vn($x,qx,b4(t)),vn($x,qx,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4=5*60,C4=R1("authIdTokenMaxAge")||N4;let Hx=null;const k4=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>C4)return;const s=n==null?void 0:n.token;Hx!==s&&(Hx=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function R4(t=bg()){const e=ec(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Wj(t,{popupRedirectResolver:T4,persistence:[VV,IV,qS]}),r=R1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=k4(i.toString());vV(n,o,()=>o(n.currentUser)),yV(n,a=>o(a))}}const s=N1("auth");return s&&Yj(n,`http://${s}`),n}function P4(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}Uj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Yn("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",P4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});A4("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4="type.googleapis.com/google.protobuf.Int64Value",j4="type.googleapis.com/google.protobuf.UInt64Value";function JS(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Cd(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Cd(e));if(typeof t=="function"||typeof t=="object")return JS(t,e=>Cd(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Ko(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case D4:case j4:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Ko(e)):typeof t=="function"||typeof t=="object"?JS(t,e=>Ko(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ny="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gx={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Wt extends Dn{constructor(e,n,r){super(`${Ny}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,Wt.prototype)}}function V4(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function kd(t,e){let n=V4(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!Gx[o])return new Wt("internal","internal");n=Gx[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=Ko(s))}}catch{}return n==="ok"?null:new Wt(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M4{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,$t(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp="us-central1",O4=/^data: (.*?)(?:\n|$)/;function L4(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new Wt("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class F4{constructor(e,n,r,s,i=bp,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new M4(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=bp}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function U4(t,e,n){const r=Zn(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(Qd(t.emulatorOrigin+"/backends"),Ig("Functions",!0))}function z4(t,e,n){const r=s=>$4(t,e,s,{});return r.stream=(s,i)=>H4(t,e,s,i),r}function XS(t){return t.emulatorOrigin&&Zn(t.emulatorOrigin)?"include":void 0}async function B4(t,e,n,r,s){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:XS(s)})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function ZS(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function $4(t,e,n,r){const s=t._url(e);return q4(t,s,n,r)}async function q4(t,e,n,r){n=Cd(n);const s={data:n},i=await ZS(t,r),o=r.timeout||7e4,a=L4(o),c=await Promise.race([B4(e,s,i,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!c)throw new Wt("cancelled","Firebase Functions instance was deleted.");const d=kd(c.status,c.json);if(d)throw d;if(!c.json)throw new Wt("internal","Response is not valid JSON object.");let h=c.json.data;if(typeof h>"u"&&(h=c.json.result),typeof h>"u")throw new Wt("internal","Response is missing data field.");return{data:Ko(h)}}function H4(t,e,n,r){const s=t._url(e);return G4(t,s,n,r||{})}async function G4(t,e,n,r){var g;n=Cd(n);const s={data:n},i=await ZS(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal,credentials:XS(t)})}catch(x){if(x instanceof Error&&x.name==="AbortError"){const k=new Wt("cancelled","Request was cancelled.");return{data:Promise.reject(k),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(k)}}}}}}const T=kd(0,null);return{data:Promise.reject(T),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(T)}}}}}}let a,c;const d=new Promise((x,T)=>{a=x,c=T});(g=r==null?void 0:r.signal)==null||g.addEventListener("abort",()=>{const x=new Wt("cancelled","Request was cancelled.");c(x)});const h=o.body.getReader(),m=K4(h,a,c,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const x=m.getReader();return{async next(){const{value:T,done:k}=await x.read();return{value:T,done:k}},async return(){return await x.cancel(),{done:!0,value:void 0}}}}},data:d}}function K4(t,e,n,r){const s=(o,a)=>{const c=o.match(O4);if(!c)return;const d=c[1];try{const h=JSON.parse(d);if("result"in h){e(Ko(h.result));return}if("message"in h){a.enqueue(Ko(h.message));return}if("error"in h){const m=kd(0,h);a.error(m),n(m);return}}catch(h){if(h instanceof Wt){a.error(h),n(h);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return c();async function c(){if(r!=null&&r.aborted){const d=new Wt("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const g=new Wt("cancelled","Request was cancelled");o.error(g),n(g),await t.cancel();return}a+=i.decode(d,{stream:!0});const m=a.split(`
`);a=m.pop()||"";for(const g of m)g.trim()&&s(g.trim(),o);return c()}catch(d){const h=d instanceof Wt?d:kd(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const Kx="@firebase/functions",Wx="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4="auth-internal",Q4="app-check-internal",Y4="messaging-internal";function J4(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(W4),o=n.getProvider(Y4),a=n.getProvider(Q4);return new F4(s,i,o,a,r)};ps(new pr(Ny,e,"PUBLIC").setMultipleInstances(!0)),vn(Kx,Wx,t),vn(Kx,Wx,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X4(t=bg(),e=bp){const r=ec(Pe(t),Ny).getImmediate({identifier:e}),s=C1("functions");return s&&Z4(r,...s),r}function Z4(t,e,n){U4(Pe(t),e,n)}function eb(t,e,n){return z4(Pe(t),e)}J4();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="firebasestorage.googleapis.com",nb="storageBucket",eM=2*60*1e3,tM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et extends Dn{constructor(e,n,r=0){super(jf(e),`Firebase Storage: ${n} (${jf(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,et.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return jf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ze;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ze||(Ze={}));function jf(t){return"storage/"+t}function Cy(){const t="An unknown error occurred, please check the error payload for server response.";return new et(Ze.UNKNOWN,t)}function nM(t){return new et(Ze.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function rM(t){return new et(Ze.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function sM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new et(Ze.UNAUTHENTICATED,t)}function iM(){return new et(Ze.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function oM(t){return new et(Ze.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function aM(){return new et(Ze.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function lM(){return new et(Ze.CANCELED,"User canceled the upload/download.")}function cM(t){return new et(Ze.INVALID_URL,"Invalid URL '"+t+"'.")}function uM(t){return new et(Ze.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function dM(){return new et(Ze.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+nb+"' property when initializing the app?")}function hM(){return new et(Ze.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function fM(){return new et(Ze.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function mM(t){return new et(Ze.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ap(t){return new et(Ze.INVALID_ARGUMENT,t)}function rb(){return new et(Ze.APP_DELETED,"The Firebase app was deleted.")}function pM(t){return new et(Ze.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function gl(t,e){return new et(Ze.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Da(t){throw new et(Ze.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=sn.makeFromUrl(e,n)}catch{return new sn(e,"")}if(r.path==="")return r;throw uM(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(P){P.path.charAt(P.path.length-1)==="/"&&(P.path_=P.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(P){P.path_=decodeURIComponent(P.path)}const h="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",x=new RegExp(`^https?://${m}/${h}/b/${s}/o${g}`,"i"),T={bucket:1,path:3},k=n===tb?"(?:storage.googleapis.com|storage.cloud.google.com)":n,D="([^?#]*)",b=new RegExp(`^https?://${k}/${s}/${D}`,"i"),A=[{regex:a,indices:c,postModify:i},{regex:x,indices:T,postModify:d},{regex:b,indices:{bucket:1,path:2},postModify:d}];for(let P=0;P<A.length;P++){const M=A[P],B=M.regex.exec(e);if(B){const w=B[M.indices.bucket];let y=B[M.indices.path];y||(y=""),r=new sn(w,y),M.postModify(r);break}}if(r==null)throw cM(e);return r}}class gM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yM(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let d=!1;function h(...D){d||(d=!0,e.apply(null,D))}function m(D){s=setTimeout(()=>{s=null,t(x,c())},D)}function g(){i&&clearTimeout(i)}function x(D,...b){if(d){g();return}if(D){g(),h.call(null,D,...b);return}if(c()||o){g(),h.call(null,D,...b);return}r<64&&(r*=2);let A;a===1?(a=2,A=0):A=(r+Math.random())*1e3,m(A)}let T=!1;function k(D){T||(T=!0,g(),!d&&(s!==null?(D||(a=2),clearTimeout(s),m(0)):D||(a=1)))}return m(0),i=setTimeout(()=>{o=!0,k(!0)},n),k}function vM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _M(t){return t!==void 0}function xM(t){return typeof t=="object"&&!Array.isArray(t)}function ky(t){return typeof t=="string"||t instanceof String}function Qx(t){return Ry()&&t instanceof Blob}function Ry(){return typeof Blob<"u"}function Yx(t,e,n,r){if(r<e)throw Ap(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Ap(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ih(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function sb(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ni;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ni||(ni={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wM(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(e,n,r,s,i,o,a,c,d,h,m,g=!0,x=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=m,this.retry=g,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((T,k)=>{this.resolve_=T,this.reject_=k,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Xc(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===ni.NO_ERROR,c=i.getStatus();if(!a||wM(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===ni.ABORT;r(!1,new Xc(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new Xc(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());_M(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Cy();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?rb():lM();o(c)}else{const c=aM();o(c)}};this.canceled_?n(!1,new Xc(!1,null,!0)):this.backoffId_=yM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Xc{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function IM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function TM(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function SM(t,e){e&&(t["X-Firebase-GMPID"]=e)}function bM(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function AM(t,e,n,r,s,i,o=!0,a=!1){const c=sb(t.urlParams),d=t.url+c,h=Object.assign({},t.headers);return SM(h,e),IM(h,n),TM(h,i),bM(h,r),new EM(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function CM(...t){const e=NM();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Ry())return new Blob(t);throw new et(Ze.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function kM(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RM(t){if(typeof atob>"u")throw mM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Vf{constructor(e,n){this.data=e,this.contentType=n||null}}function PM(t,e){switch(t){case Gn.RAW:return new Vf(ib(e));case Gn.BASE64:case Gn.BASE64URL:return new Vf(ob(t,e));case Gn.DATA_URL:return new Vf(jM(e),VM(e))}throw Cy()}function ib(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function DM(t){let e;try{e=decodeURIComponent(t)}catch{throw gl(Gn.DATA_URL,"Malformed data URL.")}return ib(e)}function ob(t,e){switch(t){case Gn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw gl(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Gn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw gl(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=RM(e)}catch(s){throw s.message.includes("polyfill")?s:gl(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class ab{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw gl(Gn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=MM(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function jM(t){const e=new ab(t);return e.base64?ob(Gn.BASE64,e.rest):DM(e.rest)}function VM(t){return new ab(t).contentType}function MM(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e,n){let r=0,s="";Qx(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(Qx(this.data_)){const r=this.data_,s=kM(r,e,n);return s===null?null:new Kr(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Kr(r,!0)}}static getBlob(...e){if(Ry()){const n=e.map(r=>r instanceof Kr?r.data_:r);return new Kr(CM.apply(null,n))}else{const n=e.map(o=>ky(o)?PM(Gn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Kr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lb(t){let e;try{e=JSON.parse(t)}catch{return null}return xM(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OM(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function LM(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function cb(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FM(t,e){return e}class Mt{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||FM}}let Zc=null;function UM(t){return!ky(t)||t.length<2?t:cb(t)}function ub(){if(Zc)return Zc;const t=[];t.push(new Mt("bucket")),t.push(new Mt("generation")),t.push(new Mt("metageneration")),t.push(new Mt("name","fullPath",!0));function e(i,o){return UM(o)}const n=new Mt("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Mt("size");return s.xform=r,t.push(s),t.push(new Mt("timeCreated")),t.push(new Mt("updated")),t.push(new Mt("md5Hash",null,!0)),t.push(new Mt("cacheControl",null,!0)),t.push(new Mt("contentDisposition",null,!0)),t.push(new Mt("contentEncoding",null,!0)),t.push(new Mt("contentLanguage",null,!0)),t.push(new Mt("contentType",null,!0)),t.push(new Mt("metadata","customMetadata",!0)),Zc=t,Zc}function zM(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new sn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function BM(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return zM(r,t),r}function db(t,e,n){const r=lb(e);return r===null?null:BM(t,r,n)}function $M(t,e,n,r){const s=lb(e);if(s===null||!ky(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,m=t.fullPath,g="/b/"+o(h)+"/o/"+o(m),x=Ih(g,n,r),T=sb({alt:"media",token:d});return x+T})[0]}function qM(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class Py{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hb(t){if(!t)throw Cy()}function HM(t,e){function n(r,s){const i=db(t,s,e);return hb(i!==null),i}return n}function GM(t,e){function n(r,s){const i=db(t,s,e);return hb(i!==null),$M(i,s,t.host,t._protocol)}return n}function fb(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=iM():s=sM():n.getStatus()===402?s=rM(t.bucket):n.getStatus()===403?s=oM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function mb(t){const e=fb(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=nM(t.path)),i.serverResponse=s.serverResponse,i}return n}function KM(t,e,n){const r=e.fullServerUrl(),s=Ih(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Py(s,i,GM(t,n),o);return a.errorHandler=mb(e),a}function WM(t,e){const n=e.fullServerUrl(),r=Ih(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,d){}const a=new Py(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=mb(e),a}function QM(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function YM(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=QM(null,e)),r}function JM(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let A="";for(let P=0;P<2;P++)A=A+Math.random().toString().slice(2);return A}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const d=YM(e,r,s),h=qM(d,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,g=`\r
--`+c+"--",x=Kr.getBlob(m,r,g);if(x===null)throw hM();const T={name:d.fullPath},k=Ih(i,t.host,t._protocol),D="POST",b=t.maxUploadRetryTime,E=new Py(k,D,HM(t,n),b);return E.urlParams=T,E.headers=o,E.body=x.uploadData(),E.errorHandler=fb(e),E}class XM{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=ni.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=ni.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=ni.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw Da("cannot .send() more than once");if(Zn(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Da("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Da("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Da("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Da("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class ZM extends XM{initXhr(){this.xhr_.responseType="text"}}function Dy(){return new ZM}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(e,n){this._service=e,n instanceof sn?this._location=n:this._location=sn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new xi(e,n)}get root(){const e=new sn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return cb(this._location.path)}get storage(){return this._service}get parent(){const e=OM(this._location.path);if(e===null)return null;const n=new sn(this._location.bucket,e);return new xi(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw pM(e)}}function eO(t,e,n){t._throwIfRoot("uploadBytes");const r=JM(t.storage,t._location,ub(),new Kr(e,!0),n);return t.storage.makeRequestWithTokens(r,Dy).then(s=>({metadata:s,ref:t}))}function tO(t){t._throwIfRoot("getDownloadURL");const e=KM(t.storage,t._location,ub());return t.storage.makeRequestWithTokens(e,Dy).then(n=>{if(n===null)throw fM();return n})}function nO(t){t._throwIfRoot("deleteObject");const e=WM(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Dy)}function rO(t,e){const n=LM(t._location.path,e),r=new sn(t._location.bucket,n);return new xi(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sO(t){return/^[A-Za-z]+:\/\//.test(t)}function iO(t,e){return new xi(t,e)}function pb(t,e){if(t instanceof jy){const n=t;if(n._bucket==null)throw dM();const r=new xi(n,n._bucket);return e!=null?pb(r,e):r}else return e!==void 0?rO(t,e):t}function oO(t,e){if(e&&sO(e)){if(t instanceof jy)return iO(t,e);throw Ap("To use ref(service, url), the first argument must be a Storage instance.")}else return pb(t,e)}function Jx(t,e){const n=e==null?void 0:e[nb];return n==null?null:sn.makeFromBucketSpec(n,t)}function aO(t,e,n,r={}){t.host=`${e}:${n}`;const s=Zn(e);s&&(Qd(`https://${t.host}/b`),Ig("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:XC(i,t.app.options.projectId))}class jy{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=tb,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=eM,this._maxUploadRetryTime=tM,this._requests=new Set,s!=null?this._bucket=sn.makeFromBucketSpec(s,this._host):this._bucket=Jx(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=sn.makeFromBucketSpec(this._url,e):this._bucket=Jx(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Yx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Yx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if($t(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new xi(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new gM(rb());{const o=AM(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const Xx="@firebase/storage",Zx="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gb="storage";function lO(t,e,n){return t=Pe(t),eO(t,e,n)}function cO(t){return t=Pe(t),tO(t)}function ew(t){return t=Pe(t),nO(t)}function Mf(t,e){return t=Pe(t),oO(t,e)}function uO(t=bg(),e){t=Pe(t);const r=ec(t,gb).getImmediate({identifier:e}),s=C1("storage");return s&&dO(r,...s),r}function dO(t,e,n,r={}){aO(t,e,n,r)}function hO(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new jy(n,r,s,e,Ii)}function fO(){ps(new pr(gb,hO,"PUBLIC").setMultipleInstances(!0)),vn(Xx,Zx,""),vn(Xx,Zx,"esm2020")}fO();const yb={apiKey:"AIzaSyBqe7srBIViRiHmZlIQzMywDhiop5q7OXI",authDomain:"colegio-verdy.firebaseapp.com",projectId:"colegio-verdy",storageBucket:"colegio-verdy.firebasestorage.app",messagingSenderId:"602481785882",appId:"1:602481785882:web:0f873bf9968992e5af65a3"},tw=Object.entries(yb).filter(([,t])=>!t).map(([t])=>t),Wa=tw.length?`Configurao Firebase incompleta. Defina: ${tw.join(", ")}.`:null;function mO(t){if(!t)return null;try{return px(t,{localCache:ej({tabManager:sj()})})}catch{return px(t,{localCache:ZD()})}}const xr=Wa?null:L1(yb),xt=xr?R4(xr):null,re=mO(xr),vb=xr?X4(xr):null,ja=xr?uO(xr):null,_b=V.createContext(),Th=()=>V.useContext(_b),nw=new Set(["teacher","parent","admin"]),Va=t=>((t||"").split("@")[0]||"Usuario").replace(/[._-]+/g," ").trim()||"Usuario",eu=t=>`https://ui-avatars.com/api/?name=${encodeURIComponent(t||"Usuario")}&background=e2e8f0&color=0f172a`,pO=({children:t})=>{const[e,n]=V.useState(null),[r,s]=V.useState(null),[i,o]=V.useState(null),[a,c]=V.useState(!0);V.useEffect(()=>xt?_V(xt,async T=>{if(T)try{const k=ut(re,"users",T.uid),D=await oj(k);if(D.exists()){const b=D.data(),E=b.role,A=b.nome||Va(T.email||b.email||""),P={uid:T.uid,email:b.email||T.email||null,role:nw.has(E)?E:"parent",nome:A,telefone:b.telefone||"",disciplina:b.disciplina||"",avatarUrl:b.avatarUrl||eu(A)};b.avatarUrl||await Su(k,{avatarUrl:P.avatarUrl,updatedAt:$e()},{merge:!0}),o(P),s(nw.has(E)?E:"parent")}else{const b=Va(T.email||""),E={uid:T.uid,email:T.email??null,role:"parent",nome:b,telefone:"",disciplina:"",avatarUrl:eu(b)};await Su(k,{...E,createdAt:$e(),updatedAt:$e()}),o(E),s("parent")}}catch(k){console.log("Erro ao buscar role, backend no configurado ok. "+k),o({uid:T.uid,email:T.email||null,role:"parent",nome:Va(T.email||""),telefone:"",disciplina:"",avatarUrl:eu(Va(T.email||""))}),s("parent")}else o(null),s(null);n(T),c(!1)}):(c(!1),()=>{}),[]);const g={currentUser:e,userRole:r,userProfile:i,login:(x,T)=>xt?mV(xt,x,T):Promise.reject({code:"auth/configuration-not-found",message:Wa}),register:async(x,T)=>{if(!xt)return Promise.reject({code:"auth/configuration-not-found",message:Wa});if(!re)return Promise.reject({code:"auth/configuration-not-found",message:Wa});const k=await fV(xt,x,T),D=Va(k.user.email??x);return await Su(ut(re,"users",k.user.uid),{uid:k.user.uid,email:k.user.email??x,role:"parent",nome:D,avatarUrl:eu(D),createdAt:$e(),updatedAt:$e()}),k},logout:()=>xt?xV(xt):Promise.resolve(),authError:Wa};return u.jsx(_b.Provider,{value:g,children:!a&&t})},gO=()=>{const[t,e]=V.useState(!0),[n,r]=V.useState(""),[s,i]=V.useState(""),[o,a]=V.useState(""),[c,d]=V.useState(!1),{login:h,register:m,authError:g}=Th(),x=async T=>{T.preventDefault();try{a(""),d(!0),t?await h(n,s):await m(n,s)}catch(k){console.error(k),k.code==="auth/user-not-found"||k.code==="auth/invalid-credential"?a("E-mail ou senha invlidos. Verifique se voc j tem cadastro."):k.code==="auth/email-already-in-use"?a("Este e-mail j est cadastrado no sistema."):k.code==="auth/weak-password"?a("A senha deve ter pelo menos 6 caracteres."):k.code==="auth/configuration-not-found"?a(k.message||"Firebase no configurado para autenticao."):a("Ocorreu um erro ao comunicar com o servidor!")}finally{d(!1)}};return u.jsx("div",{className:"min-h-screen bg-slate-50 flex flex-col justify-center items-center p-4",children:u.jsxs("div",{className:"w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-primary to-primary-light flex items-center justify-center text-white font-bold text-3xl shadow-[0_4px_10px_rgba(16,185,129,0.3)] mb-4",children:"V"}),u.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Colgio Verdy"}),u.jsx("p",{className:"text-slate-500 mt-2",children:t?"Acesse o portal da escola":"Crie seu acesso inicial"})]}),u.jsxs("div",{className:"bg-white rounded-3xl p-8 border border-slate-200 shadow-xl shadow-slate-200/50",children:[g&&u.jsxs("div",{className:"bg-amber-50 text-amber-700 p-4 rounded-xl mb-6 flex items-start gap-3 text-sm",children:[u.jsx(M_,{className:"shrink-0 mt-0.5",size:18}),u.jsx("span",{children:g})]}),o&&u.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-xl mb-6 flex items-start gap-3 text-sm",children:[u.jsx(M_,{className:"shrink-0 mt-0.5",size:18}),u.jsx("span",{children:o})]}),u.jsxs("form",{onSubmit:x,className:"flex flex-col gap-5",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"E-mail"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"email",value:n,onChange:T=>r(T.target.value),placeholder:"Seu email de acesso",className:"w-full form-control !pl-10 !py-3",required:!0}),u.jsx(jC,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Senha"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"password",value:s,onChange:T=>i(T.target.value),placeholder:"",className:"w-full form-control !pl-10 !py-3",required:!0,minLength:6}),u.jsx(PC,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("button",{type:"submit",disabled:c,className:`btn-primary w-full justify-center !py-3.5 mt-2 text-base ${c?"opacity-70 cursor-not-allowed":""}`,children:[c?"Processando...":t?"Entrar no Sistema":"Criar Cadastro",t?u.jsx(DC,{size:20}):u.jsx($C,{size:20})]})]}),u.jsx("div",{className:"mt-8 text-center text-sm text-slate-500 border-t border-slate-100 pt-6",children:u.jsxs("p",{children:[t?"Primeiro acesso? ":"J possui uma conta? ",u.jsx("button",{onClick:()=>{e(!t),a("")},className:"font-bold text-primary hover:text-primary-dark transition-colors",type:"button",children:t?"Cadastre-se aqui":"Faa Login"})]})})]})]})})},yO=()=>{const{logout:t}=Th();return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto h-full p-4 lg:p-8",children:[u.jsx("div",{className:"flex justify-between items-center mb-6",children:u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Painel do Responsvel"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Acompanhe a rotina dos seus filhos (Em Construo)"})]})}),u.jsxs("div",{className:"glass-panel p-8 text-center flex flex-col items-center justify-center h-64 border-dashed border-2 border-slate-200",children:[u.jsx(RC,{size:48,className:"text-slate-300 mb-4"}),u.jsx("h3",{className:"text-lg font-bold text-slate-700 mb-2",children:"rea em Desenvolvimento"}),u.jsx("p",{className:"text-slate-500 max-w-md",children:"Aqui os pais vero um resumo da ltima caderneta enviada, avisos urgentes da escola e atalhos rpidos."})]})]})},rw=[{id:"m1",titulo:"Comunicado Geral",texto:"Atualizao do calendrio escolar disponvel para famlias.",tempo:"h 10 min"},{id:"m2",titulo:"Coordenao",texto:"Lembrete sobre prazo de envio das avaliaes mensais.",tempo:"h 1 h"},{id:"m3",titulo:"Secretaria",texto:"Documentao de novos alunos em conferncia.",tempo:"h 3 h"}];function vO(){const[t,e]=V.useState(null),[n,r]=V.useState(null),[s,i]=V.useState([]),[o,a]=V.useState(!0);V.useEffect(()=>{if(!re)return()=>{};const h=[];return h.push(Xt(wt(re,"students"),m=>{e(m.size)},()=>{e(0)})),h.push(Xt(yi(wt(re,"classrooms"),ra("status","==","ativa")),m=>{r(m.size)},()=>{r(0)})),h.push(Xt(wt(re,"events"),m=>{const g=m.docs.map(x=>{const T=x.data();return{id:x.id,titulo:T.titulo||"Sem ttulo",tipo:T.tipo||"Administrativos",data:T.data||"",local:T.local||"",diaTodo:!!T.diaTodo,horario:T.horario||"",anexoUrl:T.anexoUrl||"",anexoNome:T.anexoNome||""}}).sort((x,T)=>{const k=`${x.data||""} ${x.horario||""}`,D=`${T.data||""} ${T.horario||""}`;return k.localeCompare(D)});i(g),a(!1)},()=>{i([]),a(!1)})),()=>h.forEach(m=>m())},[]);const c=h=>{if(!h)return{dia:"--",mes:"---"};const[m,g,x]=h.split("-");if(!m||!g||!x)return{dia:"--",mes:"---"};const T=new Date(Number(m),Number(g)-1,Number(x));return{dia:String(T.getDate()).padStart(2,"0"),mes:T.toLocaleDateString("pt-BR",{month:"short"}).replace(".","").toUpperCase()}},d=V.useMemo(()=>[{id:"i1",label:"Total de Alunos",valor:t,icon:To,color:"text-primary bg-primary/10"},{id:"i2",label:"Turmas Ativas",valor:n,icon:E1,color:"text-primary bg-primary/10"},{id:"i3",label:"Calendrio",valor:s.length,icon:zm,color:"text-primary bg-primary/10"},{id:"i4",label:"Comunicados",valor:rw.length,icon:OC,color:"text-primary bg-primary/10"}],[t,n,s.length]);return u.jsxs("div",{className:"flex flex-col gap-6 max-w-6xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Dashboard da Administrao"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Viso consolidada da operao escolar."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:d.map(h=>u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60 flex items-center gap-3",children:[u.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center ${h.color}`,children:u.jsx(h.icon,{size:20})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wide",children:h.label}),u.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.valor??""})]})]},h.id))}),u.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(zm,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Prximos eventos"})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[o&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando eventos..."}),!o&&s.slice(0,6).map(h=>{const m=c(h.data);return u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/80 p-3 flex items-center gap-3",children:[u.jsxs("div",{className:"w-14 h-14 rounded-lg bg-slate-100 border border-slate-200 flex flex-col items-center justify-center",children:[u.jsx("span",{className:"text-base font-bold text-slate-800 leading-none",children:m.dia}),u.jsx("span",{className:"text-[10px] font-semibold text-slate-500",children:m.mes})]}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"font-semibold text-slate-800 truncate",children:h.titulo}),u.jsx("div",{className:"text-sm text-slate-500",children:h.diaTodo?"Dia todo":h.horario}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:h.tipo}),h.local&&u.jsx("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:h.local}),h.anexoUrl&&u.jsx("a",{href:h.anexoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-primary hover:underline mt-0.5 inline-block truncate",children:h.anexoNome||"Ver anexo"})]})]},h.id)}),!o&&s.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhum evento cadastrado."})]})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(x1,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Mensagens Recentes"})]}),u.jsx("div",{className:"flex flex-col gap-3",children:rw.map(h=>u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/80 p-3",children:[u.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[u.jsx("div",{className:"font-semibold text-slate-800",children:h.titulo}),u.jsx("div",{className:"text-xs text-slate-400",children:h.tempo})]}),u.jsx("div",{className:"text-sm text-slate-500",children:h.texto})]},h.id))})]})]})]})}const _O=["Administrativos","Acadmicos","Feriado","Recesso"],Of=5,Lf={titulo:"",tipo:"Administrativos",data:"",local:"",descricao:"",diaTodo:!1,horario:"",anexoUrl:"",anexoNome:"",anexoMimeType:"",anexoPath:""};function xO(){const[t,e]=V.useState([]),[n,r]=V.useState(!0),[s,i]=V.useState(!1),[o,a]=V.useState(null),[c,d]=V.useState(Lf),[h,m]=V.useState(!1),[g,x]=V.useState(null),[T,k]=V.useState(1),D=V.useRef(null);V.useEffect(()=>{if(!re)return()=>{};const _=Xt(wt(re,"events"),C=>{const I=C.docs.map(se=>{const ae=se.data();return{id:se.id,titulo:ae.titulo||"Sem ttulo",tipo:ae.tipo||"Administrativos",data:ae.data||"",local:ae.local||"",descricao:ae.descricao||"",diaTodo:!!ae.diaTodo,horario:ae.horario||"",anexoUrl:ae.anexoUrl||"",anexoNome:ae.anexoNome||"",anexoMimeType:ae.anexoMimeType||"",anexoPath:ae.anexoPath||""}}).sort((se,ae)=>{const G=`${se.data||""} ${se.horario||""}`;return`${ae.data||""} ${ae.horario||""}`.localeCompare(G)});e(I),r(!1)},()=>{e([]),r(!1)});return()=>_()},[]);const b=_=>{if(!_)return{dia:"--",mes:"---"};const[C,I,se]=_.split("-");if(!C||!I||!se)return{dia:"--",mes:"---"};const ae=new Date(Number(C),Number(I)-1,Number(se));return{dia:String(ae.getDate()).padStart(2,"0"),mes:ae.toLocaleDateString("pt-BR",{month:"short"}).replace(".","").toUpperCase()}},E=()=>{a(null),d(Lf),x(null),i(!0)},A=_=>{a(_.id),d({titulo:_.titulo||"",tipo:_.tipo||"Administrativos",data:_.data||"",local:_.local||"",descricao:_.descricao||"",diaTodo:!!_.diaTodo,horario:_.horario||"",anexoUrl:_.anexoUrl||"",anexoNome:_.anexoNome||"",anexoMimeType:_.anexoMimeType||"",anexoPath:_.anexoPath||""}),x(null),i(!0)},P=()=>{a(null),d(Lf),x(null),i(!1)};V.useEffect(()=>{!s||!D.current||(D.current.innerHTML=c.descricao||"")},[s,o]);const M=_=>{document.execCommand(_,!1),D.current&&d(C=>({...C,descricao:D.current.innerHTML}))},B=V.useMemo(()=>Math.max(1,Math.ceil(t.length/Of)),[t.length]),w=Math.min(T,B),y=V.useMemo(()=>t.slice((w-1)*Of,w*Of),[t,w]),S=async _=>{_.preventDefault();const C=c.titulo.trim(),I=c.tipo,se=c.data,ae=c.local.trim(),G=(c.descricao||"").trim(),Ee=!!c.diaTodo,$=c.horario;if(!(!C||!I||!se||!Ee&&!$||!re))try{m(!0);let O=c.anexoUrl||"",K=c.anexoNome||"",Q=c.anexoMimeType||"",ue=c.anexoPath||"";if(g&&ja){const le=g.name.replace(/\s+/g,"_"),Ae=`events/${Date.now()}-${le}`,Ie=Mf(ja,Ae);if(await lO(Ie,g),O=await cO(Ie),K=g.name,Q=g.type||"",c.anexoPath)try{await ew(Mf(ja,c.anexoPath))}catch{}ue=Ae}const Z={titulo:C,tipo:I,data:se,local:ae,descricao:G,diaTodo:Ee,horario:Ee?"":$,anexoUrl:O,anexoNome:K,anexoMimeType:Q,anexoPath:ue,updatedAt:$e()};o?await Kt(ut(re,"events",o),Z):await _y(wt(re,"events"),{...Z,createdAt:$e()}),k(1),P()}finally{m(!1)}},N=async _=>{if(!re)return;const C=t.find(I=>I.id===_);if(await aj(ut(re,"events",_)),C!=null&&C.anexoPath&&ja)try{await ew(Mf(ja,C.anexoPath))}catch{}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-6xl mx-auto",children:[u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Calendrio Escolar"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Gerencie os eventos e compromissos da escola."})]}),u.jsxs("button",{onClick:s?P:E,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center gap-1",children:[s?u.jsx(ms,{size:14}):u.jsx(li,{size:14}),s?"Cancelar":"Novo evento"]})]}),s&&u.jsxs("form",{onSubmit:S,className:"rounded-xl border border-slate-200 p-3 bg-white/80 grid grid-cols-1 md:grid-cols-6 gap-2 items-end",children:[u.jsxs("label",{className:"md:col-span-2 text-sm text-slate-600 flex flex-col gap-1",children:["Ttulo",u.jsx("input",{value:c.titulo,onChange:_=>d(C=>({...C,titulo:_.target.value})),className:"form-control !py-2.5",placeholder:"Ttulo do evento",required:!0})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Tipo",u.jsx("select",{value:c.tipo,onChange:_=>d(C=>({...C,tipo:_.target.value})),className:"form-control !py-2.5",required:!0,children:_O.map(_=>u.jsx("option",{value:_,children:_},_))})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Data",u.jsx("input",{type:"date",value:c.data,onChange:_=>d(C=>({...C,data:_.target.value})),className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Local",u.jsx("input",{value:c.local,onChange:_=>d(C=>({...C,local:_.target.value})),className:"form-control !py-2.5",placeholder:"Ex.: Auditrio"})]}),u.jsxs("div",{className:"text-sm text-slate-600 flex flex-col gap-1",children:[u.jsx("span",{children:"Perodo"}),u.jsx("div",{className:"h-[42px] flex items-center",children:u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:c.diaTodo,onChange:_=>d(C=>({...C,diaTodo:_.target.checked,horario:_.target.checked?"":C.horario}))}),"Dia todo"]})})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Horrio",u.jsx("input",{type:"time",value:c.horario,onChange:_=>d(C=>({...C,horario:_.target.value})),className:"form-control !py-2.5",required:!c.diaTodo,disabled:c.diaTodo})]}),u.jsxs("label",{className:"md:col-span-2 text-sm text-slate-600 flex flex-col gap-1",children:["Anexo (PDF ou imagem)",u.jsx("input",{type:"file",accept:"application/pdf,image/*",onChange:_=>{var C;return x(((C=_.target.files)==null?void 0:C[0])||null)},className:"form-control !py-2.5"}),!g&&c.anexoUrl&&u.jsxs("a",{href:c.anexoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-primary hover:underline truncate",children:["Anexo atual: ",c.anexoNome||"Visualizar arquivo"]})]}),u.jsxs("div",{className:"md:col-span-6 flex flex-col gap-2 text-sm text-slate-600",children:[u.jsx("span",{children:"Descrio"}),u.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 w-fit",children:[u.jsx("button",{type:"button",onMouseDown:_=>_.preventDefault(),onClick:()=>M("bold"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 font-semibold",children:"B"}),u.jsx("button",{type:"button",onMouseDown:_=>_.preventDefault(),onClick:()=>M("italic"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 italic",children:"I"}),u.jsx("button",{type:"button",onMouseDown:_=>_.preventDefault(),onClick:()=>M("underline"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 underline",children:"U"}),u.jsx("button",{type:"button",onMouseDown:_=>_.preventDefault(),onClick:()=>M("insertUnorderedList"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100",children:""})]}),u.jsx("div",{ref:D,contentEditable:!0,suppressContentEditableWarning:!0,onInput:_=>{const C=_.currentTarget.innerHTML;d(I=>({...I,descricao:C}))},className:"min-h-[120px] rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),u.jsx("div",{className:"md:col-span-6 flex justify-end",children:u.jsx("button",{type:"submit",disabled:h,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-60",children:o?"Salvar edio":"Salvar evento"})})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(zm,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Eventos"})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[n&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando eventos..."}),!n&&y.map(_=>{const C=b(_.data);return u.jsxs("div",{className:"mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 border-l-8 border-l-slate-500",children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap p-2",children:[u.jsxs("button",{onClick:()=>A(_),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(gn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>N(_.id),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-red-600 bg-red-50 border border-red-200 hover:bg-red-100 transition-colors flex flex-col items-center gap-1",children:[u.jsx(F_,{}),"Excluir"]})]}),u.jsx("div",{className:"md:grow min-w-0 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsxs("div",{className:"w-14 h-14 rounded-full bg-slate-200 border border-slate-500 flex flex-col items-center justify-center shrink-0",children:[u.jsx("span",{className:"text-base font-bold text-slate-500 leading-none",children:C.dia}),u.jsx("span",{className:"text-[10px] font-semibold text-slate-500",children:C.mes})]}),u.jsxs("div",{className:"min-w-0 md:grow",children:[u.jsxs("div",{className:"font-semibold text-slate-800 truncate",children:[_.titulo,u.jsxs("span",{className:`inline-flex items-center ${_.anexoUrl?"":"hidden"}`,children:["",u.jsx(w1,{size:14})]})]}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:_.tipo}),u.jsx("div",{className:"md:hidden text-xs text-slate-500",children:_.diaTodo?"Dia todo":_.horario}),u.jsx("div",{className:"md:hidden text-xs text-slate-500 mt-0.5 truncate",children:_.local})]}),u.jsxs("div",{className:"hidden md:block md:w-32",children:[u.jsx("div",{className:"text-sm text-slate-500",children:_.diaTodo?"Dia todo":_.horario}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:_.local})]})]})})]}),u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>A(_),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(gn,{size:14})}),u.jsx("button",{onClick:()=>N(_.id),className:"h-8 px-2 rounded-e-lg text-xs font-medium text-red-600 border border-primary border-l-0 inline-flex justify-center items-center gap-1",children:u.jsx(F_,{size:14})})]})]},_.id)}),!n&&t.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhum evento cadastrado."}),!n&&t.length>0&&u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",w," de ",B]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:w===1,onClick:()=>k(_=>Math.max(1,_-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:w===B,onClick:()=>k(_=>Math.min(B,_+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})]})}const Ff=5,Uf={nome:"",turmaId:"",fotoUrl:""},Ma={responsavelId:"",parentesco:"",podeBuscar:!0,contatoEmergencia:!1};function wO(t){return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=e2e8f0&color=0f172a`}async function EO(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function IO(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function sw(){const[t,e]=V.useState([]),[n,r]=V.useState([]),[s,i]=V.useState([]),[o,a]=V.useState(!1),[c,d]=V.useState(null),[h,m]=V.useState(Uf),[g,x]=V.useState(""),[T,k]=V.useState("todos"),[D,b]=V.useState("todas"),[E,A]=V.useState(!1),[P,M]=V.useState(1),[B,w]=V.useState(!1),[y,S]=V.useState(!0),[N,_]=V.useState(!1),[C,I]=V.useState({tipo:"",mensagem:""}),[se,ae]=V.useState(!1),[G,Ee]=V.useState(null),[$,O]=V.useState(""),[K,Q]=V.useState(Ma);V.useEffect(()=>re?Xt(wt(re,"students"),J=>{const ne=J.docs.map(fe=>{const ge=fe.data();return{id:fe.id,nome:ge.nome||"Sem nome",turmaId:ge.turmaId||"",status:ge.status||"ativo",fotoUrl:ge.fotoUrl||"",responsaveis:Array.isArray(ge.responsaveis)?ge.responsaveis:[]}}).sort((fe,ge)=>fe.nome.localeCompare(ge.nome,"pt-BR"));e(ne),S(!1)},J=>{S(!1),I({tipo:"erro",mensagem:(J==null?void 0:J.message)||"No foi possvel carregar os alunos do banco."})}):(S(!1),I({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{}),[]),V.useEffect(()=>{if(!re)return()=>{};const F=yi(wt(re,"users"),ra("role","==","parent"));return Xt(F,ne=>{const fe=ne.docs.map(ge=>{const jt=ge.data();return{id:ge.id,nome:jt.nome||"Sem nome",email:jt.email||"",telefone:jt.telefone||"",avatarUrl:jt.avatarUrl||"",status:jt.status||"ativo"}}).sort((ge,jt)=>ge.nome.localeCompare(jt.nome,"pt-BR"));i(fe)})},[]),V.useEffect(()=>re?Xt(wt(re,"classrooms"),J=>{const ne=J.docs.map(fe=>{const ge=fe.data();return{id:fe.id,nome:ge.nome||"Sem nome",periodo:ge.periodo||"",status:ge.status||"ativa"}}).sort((fe,ge)=>fe.nome.localeCompare(ge.nome,"pt-BR"));r(ne)}):()=>{},[]);const ue=V.useMemo(()=>t.filter(F=>{const J=F.nome.toLowerCase().includes(g.toLowerCase()),ne=T==="todos"?!0:F.status===T,fe=D==="todas"?!0:F.turmaId===D;return J&&ne&&fe}),[t,g,T,D]),Z=Math.max(1,Math.ceil(ue.length/Ff)),le=Math.min(P,Z),Ae=ue.slice((le-1)*Ff,le*Ff),Ie=F=>{var J;return((J=n.find(ne=>ne.id===F))==null?void 0:J.nome)||"Sem turma"},De=()=>{d(null),m(Uf),a(!0)},Ve=F=>{d(F.id),m({nome:F.nome,turmaId:F.turmaId||"",fotoUrl:F.fotoUrl||""}),a(!0)},qe=()=>{a(!1),d(null),m(Uf)},bi=async F=>{var ne;const J=(ne=F.target.files)==null?void 0:ne[0];if(J)try{const fe=await EO(J),ge=await IO(fe);m(jt=>({...jt,fotoUrl:ge}))}catch(fe){I({tipo:"erro",mensagem:(fe==null?void 0:fe.message)||"No foi possvel carregar a foto."})}finally{F.target.value=""}},Ai=async F=>{F.preventDefault(),I({tipo:"",mensagem:""}),w(!0);const J=h.nome.trim(),ne=h.turmaId;if(!J||!ne){w(!1);return}const fe=h.fotoUrl.trim()||wO(J);try{if(!re)throw new Error("Banco de dados no configurado.");c?(await Kt(ut(re,"students",c),{nome:J,turmaId:ne,fotoUrl:fe,updatedAt:$e()}),I({tipo:"sucesso",mensagem:"Dados do aluno atualizados com sucesso."})):(await _y(wt(re,"students"),{nome:J,turmaId:ne,fotoUrl:fe,status:"ativo",createdAt:$e(),updatedAt:$e()}),I({tipo:"sucesso",mensagem:"Aluno cadastrado com sucesso."})),M(1),qe()}catch(ge){I({tipo:"erro",mensagem:(ge==null?void 0:ge.message)||"No foi possvel salvar o aluno."})}finally{w(!1)}},Sr=F=>{(async()=>{if(!re)throw new Error("Banco de dados no configurado.");const ne=t.find(fe=>fe.id===F);ne&&await Kt(ut(re,"students",F),{status:ne.status==="ativo"?"inativo":"ativo",updatedAt:$e()})})().catch(ne=>{I({tipo:"erro",mensagem:(ne==null?void 0:ne.message)||"No foi possvel atualizar o status do aluno."})})},jn=F=>{Ee(F),ae(!0),O(""),Q(Ma)},Ni=()=>{ae(!1),Ee(null),O(""),Q(Ma)},ft=G?t.find(F=>F.id===G.id)||G:null,Vn=(ft==null?void 0:ft.responsaveis)||[],Cs=V.useMemo(()=>{const F=$.trim().toLowerCase();return s.filter(J=>J.status==="ativo").filter(J=>!F||J.nome.toLowerCase().includes(F))},[s,$]),Ci=async F=>{if(F.preventDefault(),!re||!ft)return;const J=s.find(fe=>fe.id===K.responsavelId),ne=K.parentesco.trim();if(!(!J||!ne))try{_(!0),I({tipo:"",mensagem:""});const fe=Array.isArray(ft.responsaveis)?ft.responsaveis:[],ge={responsavelId:J.id,nome:J.nome,email:J.email||"",telefone:J.telefone||"",avatarUrl:J.avatarUrl||"",parentesco:ne,podeBuscar:!!K.podeBuscar,contatoEmergencia:!!K.contatoEmergencia},jt=fe.findIndex(Mn=>Mn.responsavelId===J.id);let br=[];jt>=0?br=fe.map((Mn,Sh)=>Sh===jt?ge:Mn):br=[...fe,ge],ge.contatoEmergencia&&(br=br.map(Mn=>({...Mn,contatoEmergencia:Mn.responsavelId===ge.responsavelId}))),await Kt(ut(re,"students",ft.id),{responsaveis:br,updatedAt:$e()}),Q(Ma),I({tipo:"sucesso",mensagem:"Vnculo de responsvel salvo com sucesso."})}catch(fe){I({tipo:"erro",mensagem:(fe==null?void 0:fe.message)||"No foi possvel salvar o vnculo do responsvel."})}finally{_(!1)}},U=F=>{Q({responsavelId:F.responsavelId||"",parentesco:F.parentesco||"",podeBuscar:!!F.podeBuscar,contatoEmergencia:!!F.contatoEmergencia})},ce=async F=>{if(!(!re||!ft))try{_(!0),I({tipo:"",mensagem:""});const ne=(Array.isArray(ft.responsaveis)?ft.responsaveis:[]).filter(fe=>fe.responsavelId!==F);await Kt(ut(re,"students",ft.id),{responsaveis:ne,updatedAt:$e()}),K.responsavelId===F&&Q(Ma),I({tipo:"sucesso",mensagem:"Vnculo removido com sucesso."})}catch(J){I({tipo:"erro",mensagem:(J==null?void 0:J.message)||"No foi possvel remover o vnculo do responsvel."})}finally{_(!1)}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Alunos"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro, edio e status dos alunos."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Alunos"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>A(F=>!F),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${E?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(Kd,{size:16})}),u.jsx("button",{onClick:o?qe:De,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar aluno",children:o?u.jsx(ms,{size:16}):u.jsx(li,{size:16})}),u.jsx("button",{onClick:o?qe:De,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:o?"Cancelar":"Adicionar aluno"})]})]}),o&&u.jsxs("form",{onSubmit:Ai,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload da foto",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32 rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:h.fotoUrl?u.jsx("img",{src:h.fotoUrl,alt:"Avatar do aluno",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem foto"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:bi,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:h.nome,onChange:F=>m(J=>({...J,nome:F.target.value})),placeholder:"Nome do aluno",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Turma",u.jsxs("select",{value:h.turmaId,onChange:F=>m(J=>({...J,turmaId:F.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione a turma"}),n.map(F=>u.jsx("option",{value:F.id,children:F.nome},F.id))]})]})]})})]}),u.jsx("button",{type:"submit",disabled:B,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:c?"Salvar edio":"Salvar aluno"})]}),C.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${C.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:C.mensagem}),u.jsxs("div",{className:`${E?"flex":"hidden"} flex-col gap-3 mb-4 md:flex md:flex-row`,children:[u.jsx("input",{value:g,onChange:F=>{x(F.target.value),M(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:T,onChange:F=>{k(F.target.value),M(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]}),u.jsxs("select",{value:D,onChange:F=>{b(F.target.value),M(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todas",children:"Todas as turmas"}),n.map(F=>u.jsx("option",{value:F.id,children:F.nome},F.id))]})]}),y&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando alunos..."}),!y&&Ae.map(F=>u.jsx("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${F.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:(()=>{const J=(F.responsaveis||[]).filter(ne=>ne.contatoEmergencia);return u.jsxs("div",{children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>Ve(F),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(gn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>jn(F),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-primary bg-primary/15 border border-primary/30 hover:bg-primary/35 transition-colors flex flex-col items-center gap-1",children:[u.jsx(To,{}),"Resp."]}),u.jsxs("button",{onClick:()=>Sr(F.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${F.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[F.status==="ativo"?u.jsx(fs,{}):u.jsx(hs,{}),F.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:F.fotoUrl?u.jsx("img",{src:F.fotoUrl,alt:F.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:F.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:Ie(F.turmaId)})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:J.map(ne=>u.jsxs("div",{children:[u.jsx("div",{className:"font-bold",children:ne.nome||"Responsvel"}),u.jsxs("div",{children:[ne.parentesco||"Parentesco no informado"," - ",ne.telefone||"Sem telefone"]})]}))})})]}),u.jsxs("div",{className:"grid grid-cols-3 md:hidden p-1",children:[u.jsx("button",{onClick:()=>Ve(F),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(gn,{})}),u.jsx("button",{onClick:()=>jn(F),className:"h-8 px-2 text-xs font-medium text-primary border border-primary inline-flex justify-center items-center gap-1",children:u.jsx(To,{})}),u.jsx("button",{onClick:()=>Sr(F.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${F.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:F.status==="ativo"?u.jsx(fs,{}):u.jsx(hs,{})})]})]},F.id)})()},F.id)),se&&ft&&u.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-2xl rounded-xl border border-slate-200 bg-white shadow-xl p-4 md:p-5",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h4",{className:"text-base font-bold text-slate-800",children:["Responsveis de ",ft.nome]}),u.jsx("button",{onClick:Ni,className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),u.jsxs("form",{onSubmit:Ci,className:"rounded-lg border border-slate-200 p-3 mb-3 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Responsvel",u.jsxs("select",{value:K.responsavelId,onChange:F=>Q(J=>({...J,responsavelId:F.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione"}),Cs.map(F=>u.jsx("option",{value:F.id,children:F.nome},F.id))]})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Parentesco",u.jsx("input",{value:K.parentesco,onChange:F=>Q(J=>({...J,parentesco:F.target.value})),placeholder:"Ex.: Me, Pai, Av, Tio",className:"form-control !py-2.5",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:K.podeBuscar,onChange:F=>Q(J=>({...J,podeBuscar:F.target.checked}))}),"Pode buscar o aluno"]}),u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:K.contatoEmergencia,onChange:F=>Q(J=>({...J,contatoEmergencia:F.target.checked}))}),"Contato de emergncia"]})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",disabled:N,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-60",children:N?"Salvando...":"Salvar vnculo"})})]}),u.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:["Vnculos atuais (",Vn.length,")"]}),u.jsxs("div",{className:"flex flex-col gap-2 max-h-60 overflow-y-auto",children:[Vn.map(F=>u.jsxs("div",{className:`rounded-lg border px-3 py-2 ${F.contatoEmergencia?"bg-amber-50 border-amber-500":""}`,children:[u.jsxs("div",{className:"flex items-center justify-start gap-2",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 py-2",children:[u.jsxs("button",{onClick:()=>U(F),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(gn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>ce(F.responsavelId),className:"w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 bg-red-50 text-red-600 hover:bg-red-100 border border-red-700",children:[u.jsx(BC,{}),"Excluir"]})]}),u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:u.jsx("img",{src:F.avatarUrl,alt:F.nome,className:"w-full h-full object-cover"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:F.nome||"Responsvel"}),u.jsxs("div",{className:"text-sm text-slate-500 truncate",children:[F.parentesco||"Sem parentesco","  ",F.podeBuscar?"Pode buscar":"No pode buscar",F.contatoEmergencia?"  Emergncia":""]})]})]})]}),u.jsx("div",{className:"w-full md:hidden",children:u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>U(F),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(gn,{})}),u.jsx("button",{onClick:()=>ce(F.responsavelId),className:"h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1",children:u.jsx(ms,{})})]})})]},F.responsavelId)),Vn.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum responsvel vinculado."})]})]})]})}),!y&&Ae.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum aluno encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",le," de ",Z]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{disabled:le===1,onClick:()=>M(F=>Math.max(1,F-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Anterior"}),u.jsx("button",{disabled:le===Z,onClick:()=>M(F=>Math.min(Z,F+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Prxima"})]})]})]})]})}const zf=5,Bf={nome:"",disciplina:"",email:"",telefone:"",avatarUrl:""};async function TO(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function SO(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function bO(){const[t,e]=V.useState([]),[n,r]=V.useState(!1),[s,i]=V.useState(null),[o,a]=V.useState(Bf),[c,d]=V.useState(""),[h,m]=V.useState("todos"),[g,x]=V.useState("todas"),[T,k]=V.useState(!1),[D,b]=V.useState(1),[E,A]=V.useState(!1),[P,M]=V.useState(!0),[B,w]=V.useState({tipo:"",mensagem:""});V.useEffect(()=>{if(!re)return M(!1),w({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{};const O=yi(wt(re,"users"),ra("role","==","teacher"));return Xt(O,Q=>{const ue=Q.docs.map(Z=>{const le=Z.data();return{id:Z.id,nome:le.nome||"Sem nome",disciplina:le.disciplina||"",email:le.email||"",telefone:le.telefone||"",avatarUrl:le.avatarUrl||"",status:le.status||"ativo"}}).sort((Z,le)=>Z.nome.localeCompare(le.nome,"pt-BR"));e(ue),M(!1)},Q=>{M(!1),w({tipo:"erro",mensagem:(Q==null?void 0:Q.message)||"No foi possvel carregar os professores do banco."})})},[]);const y=V.useMemo(()=>[...new Set(t.map(O=>O.disciplina).filter(Boolean))].sort(),[t]),S=V.useMemo(()=>t.filter(O=>{const K=O.nome.toLowerCase().includes(c.toLowerCase()),Q=h==="todos"?!0:O.status===h,ue=g==="todas"?!0:O.disciplina===g;return K&&Q&&ue}),[t,c,h,g]),N=Math.max(1,Math.ceil(S.length/zf)),_=Math.min(D,N),C=S.slice((_-1)*zf,_*zf),I=()=>{i(null),a(Bf),r(!0)},se=O=>{i(O.id),a({nome:O.nome,disciplina:O.disciplina,email:O.email||"",telefone:O.telefone||"",avatarUrl:O.avatarUrl||""}),r(!0)},ae=()=>{i(null),a(Bf),r(!1)},G=O=>{O.preventDefault(),(async()=>{var Ie;w({tipo:"",mensagem:""}),A(!0);const Q=o.nome.trim(),ue=o.disciplina.trim(),Z=o.email.trim().toLowerCase(),le=o.telefone.trim(),Ae=o.avatarUrl.trim();if(!Q||!Z){A(!1);return}try{if(s){if(!re)throw new Error("Banco de dados no configurado.");await Kt(ut(re,"users",s),{nome:Q,disciplina:ue||null,telefone:le||null,avatarUrl:Ae||null,updatedAt:$e()}),w({tipo:"sucesso",mensagem:"Dados do professor atualizados com sucesso."})}else{if(!xr||!xt)throw new Error("Firebase no configurado para cadastro de professor.");const Ve=await eb(vb,"createTeacherAccount")({nome:Q,email:Z,disciplina:ue,telefone:le,avatarUrl:Ae}),qe=((Ie=Ve==null?void 0:Ve.data)==null?void 0:Ie.email)||Z;await US(xt,qe),w({tipo:"sucesso",mensagem:"Professor cadastrado e link para criao de senha enviado por e-mail."})}b(1),ae()}catch(De){const Ve=(De==null?void 0:De.message)||"No foi possvel salvar o professor.";w({tipo:"erro",mensagem:Ve})}finally{A(!1)}})()},Ee=O=>{(async()=>{if(!re)throw new Error("Banco de dados no configurado.");const Q=t.find(ue=>ue.id===O);Q&&await Kt(ut(re,"users",O),{status:Q.status==="ativo"?"inativo":"ativo",updatedAt:$e()})})().catch(Q=>{w({tipo:"erro",mensagem:(Q==null?void 0:Q.message)||"No foi possvel atualizar o status do professor."})})},$=async O=>{var Q;const K=(Q=O.target.files)==null?void 0:Q[0];if(K)try{const ue=await TO(K),Z=await SO(ue);a(le=>({...le,avatarUrl:Z}))}catch(ue){w({tipo:"erro",mensagem:(ue==null?void 0:ue.message)||"No foi possvel carregar o avatar."})}finally{O.target.value=""}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Professores"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro, edio e status do quadro docente."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Professores"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>k(O=>!O),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${T?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(Kd,{size:16})}),u.jsx("button",{onClick:n?ae:I,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar professor",children:n?u.jsx(ms,{size:16}):u.jsx(li,{size:16})}),u.jsx("button",{onClick:n?ae:I,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:n?"Cancelar":"Adicionar professor"})]})]}),n&&u.jsxs("form",{onSubmit:G,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload de avatar",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32  rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar do professor",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem avatar"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:$,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:o.nome,onChange:O=>a(K=>({...K,nome:O.target.value})),placeholder:"Nome completo",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2 text-sm text-slate-600",children:["E-mail",u.jsx("input",{type:"email",value:o.email,onChange:O=>a(K=>({...K,email:O.target.value})),placeholder:"E-mail",className:"form-control !py-2.5",required:!0,disabled:!!s})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Disciplina",u.jsx("input",{value:o.disciplina,onChange:O=>a(K=>({...K,disciplina:O.target.value})),placeholder:"Disciplina (opcional)",className:"form-control !py-2.5"})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Telefone",u.jsx("input",{value:o.telefone,onChange:O=>a(K=>({...K,telefone:O.target.value})),placeholder:"Telefone (opcional)",className:"form-control !py-2.5"})]})]})})]}),u.jsx("button",{type:"submit",disabled:E,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:s?"Salvar edio":"Salvar professor"})]}),B.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${B.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:B.mensagem}),u.jsxs("div",{className:`${T?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:c,onChange:O=>{d(O.target.value),b(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:h,onChange:O=>{m(O.target.value),b(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]}),u.jsxs("select",{value:g,onChange:O=>{x(O.target.value),b(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todas",children:"Todas as disciplinas"}),y.map(O=>u.jsx("option",{value:O,children:O},O))]})]}),P&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando professores..."}),!P&&C.map(O=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${O.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>se(O),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(gn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>Ee(O.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${O.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[O.status==="ativo"?u.jsx(fs,{}):u.jsx(hs,{}),O.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:O.avatarUrl?u.jsx("img",{src:O.avatarUrl,alt:O.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{className:"",children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:O.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:O.disciplina||"Sem disciplina"}),u.jsx("div",{className:"md:hidden text-sm text-slate-500 truncate",children:O.email})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:O.email})})]}),u.jsx("div",{children:u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>se(O),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(gn,{})}),u.jsx("button",{onClick:()=>Ee(O.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${O.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:O.status==="ativo"?u.jsx(fs,{}):u.jsx(hs,{})})]})})]},O.id)),!P&&C.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum professor encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",_," de ",N]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:_===1,onClick:()=>b(O=>Math.max(1,O-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:_===N,onClick:()=>b(O=>Math.min(N,O+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}const $f=5,qf={nome:"",email:"",telefone:"",avatarUrl:""};async function AO(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function NO(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function CO(){const[t,e]=V.useState([]),[n,r]=V.useState(!1),[s,i]=V.useState(null),[o,a]=V.useState(qf),[c,d]=V.useState(""),[h,m]=V.useState("todos"),[g,x]=V.useState(!1),[T,k]=V.useState(1),[D,b]=V.useState(!1),[E,A]=V.useState(!0),[P,M]=V.useState({tipo:"",mensagem:""});V.useEffect(()=>{if(!re)return A(!1),M({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{};const G=yi(wt(re,"users"),ra("role","==","parent"));return Xt(G,$=>{const O=$.docs.map(K=>{const Q=K.data();return{id:K.id,nome:Q.nome||"Sem nome",email:Q.email||"",telefone:Q.telefone||"",avatarUrl:Q.avatarUrl||"",status:Q.status||"ativo"}}).sort((K,Q)=>K.nome.localeCompare(Q.nome,"pt-BR"));e(O),A(!1)},$=>{A(!1),M({tipo:"erro",mensagem:($==null?void 0:$.message)||"No foi possvel carregar os responsveis do banco."})})},[]);const B=V.useMemo(()=>t.filter(G=>{const Ee=G.nome.toLowerCase().includes(c.toLowerCase()),$=h==="todos"?!0:G.status===h;return Ee&&$}),[t,c,h]),w=Math.max(1,Math.ceil(B.length/$f)),y=Math.min(T,w),S=B.slice((y-1)*$f,y*$f),N=()=>{i(null),a(qf),r(!0)},_=G=>{i(G.id),a({nome:G.nome,email:G.email||"",telefone:G.telefone||"",avatarUrl:G.avatarUrl||""}),r(!0)},C=()=>{i(null),a(qf),r(!1)},I=G=>{G.preventDefault(),(async()=>{var ue;M({tipo:"",mensagem:""}),b(!0);const $=o.nome.trim(),O=o.email.trim().toLowerCase(),K=o.telefone.trim(),Q=o.avatarUrl.trim();if(!$||!O){b(!1);return}try{if(s){if(!re)throw new Error("Banco de dados no configurado.");await Kt(ut(re,"users",s),{nome:$,telefone:K||null,avatarUrl:Q||null,updatedAt:$e()}),M({tipo:"sucesso",mensagem:"Dados do responsvel atualizados com sucesso."})}else{if(!xr||!xt)throw new Error("Firebase no configurado para cadastro de responsvel.");const le=await eb(vb,"createParentAccount")({nome:$,email:O,telefone:K,avatarUrl:Q}),Ae=((ue=le==null?void 0:le.data)==null?void 0:ue.email)||O;await US(xt,Ae),M({tipo:"sucesso",mensagem:"Responsvel cadastrado e link para criao de senha enviado por e-mail."})}k(1),C()}catch(Z){const le=(Z==null?void 0:Z.message)||"No foi possvel salvar o responsvel.";M({tipo:"erro",mensagem:le})}finally{b(!1)}})()},se=G=>{(async()=>{if(!re)throw new Error("Banco de dados no configurado.");const $=t.find(O=>O.id===G);$&&await Kt(ut(re,"users",G),{status:$.status==="ativo"?"inativo":"ativo",updatedAt:$e()})})().catch($=>{M({tipo:"erro",mensagem:($==null?void 0:$.message)||"No foi possvel atualizar o status do responsvel."})})},ae=async G=>{var $;const Ee=($=G.target.files)==null?void 0:$[0];if(Ee)try{const O=await AO(Ee),K=await NO(O);a(Q=>({...Q,avatarUrl:K}))}catch(O){M({tipo:"erro",mensagem:(O==null?void 0:O.message)||"No foi possvel carregar o avatar."})}finally{G.target.value=""}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Responsveis"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro e acompanhamento dos responsveis dos alunos."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Responsveis"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>x(G=>!G),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${g?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(Kd,{size:16})}),u.jsx("button",{onClick:n?C:N,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar responsvel",children:n?u.jsx(ms,{size:16}):u.jsx(li,{size:16})}),u.jsx("button",{onClick:n?C:N,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:n?"Cancelar":"Adicionar responsvel"})]})]}),n&&u.jsxs("form",{onSubmit:I,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload de avatar",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32 rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar do responsvel",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem avatar"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:ae,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:o.nome,onChange:G=>a(Ee=>({...Ee,nome:G.target.value})),placeholder:"Nome completo",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2 text-sm text-slate-600",children:["E-mail",u.jsx("input",{type:"email",value:o.email,onChange:G=>a(Ee=>({...Ee,email:G.target.value})),placeholder:"E-mail",className:"form-control !py-2.5",required:!0,disabled:!!s})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Telefone",u.jsx("input",{value:o.telefone,onChange:G=>a(Ee=>({...Ee,telefone:G.target.value})),placeholder:"Telefone (opcional)",className:"form-control !py-2.5"})]})]})})]}),u.jsx("button",{type:"submit",disabled:D,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:s?"Salvar edio":"Salvar responsvel"})]}),P.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${P.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:P.mensagem}),u.jsxs("div",{className:`${g?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:c,onChange:G=>{d(G.target.value),k(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:h,onChange:G=>{m(G.target.value),k(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]})]}),E&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando responsveis..."}),!E&&S.map(G=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${G.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>_(G),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(gn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>se(G.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${G.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[G.status==="ativo"?u.jsx(fs,{}):u.jsx(hs,{}),G.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:G.avatarUrl?u.jsx("img",{src:G.avatarUrl,alt:G.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:G.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:G.email}),u.jsx("div",{className:"md:hidden text-sm text-slate-500 truncate",children:G.telefone||"Sem telefone"})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:G.telefone||"Sem telefone"})})]}),u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>_(G),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(gn,{})}),u.jsx("button",{onClick:()=>se(G.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${G.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:G.status==="ativo"?u.jsx(fs,{}):u.jsx(hs,{})})]})]},G.id)),!E&&S.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum responsvel encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",y," de ",w]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:y===1,onClick:()=>k(G=>Math.max(1,G-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:y===w,onClick:()=>k(G=>Math.min(w,G+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}const Hf=5,Gf={nome:"",periodo:"Integral",professorId:""};function kO(){const[t,e]=V.useState([]),[n,r]=V.useState([]),[s,i]=V.useState([]),[o,a]=V.useState(!1),[c,d]=V.useState(null),[h,m]=V.useState(Gf),[g,x]=V.useState(""),[T,k]=V.useState("todos"),[D,b]=V.useState("todos"),[E,A]=V.useState(!1),[P,M]=V.useState(1),[B,w]=V.useState(!1),[y,S]=V.useState(!1),[N,_]=V.useState(!0),[C,I]=V.useState(!0),[se,ae]=V.useState({tipo:"",mensagem:""}),[G,Ee]=V.useState(null),[$,O]=V.useState(!1),[K,Q]=V.useState("");V.useEffect(()=>re?Xt(wt(re,"classrooms"),ce=>{const F=ce.docs.map(J=>{const ne=J.data();return{id:J.id,nome:ne.nome||"Sem nome",periodo:ne.periodo||"",professorId:ne.professorId||"",professorNome:ne.professorNome||"",status:ne.status||"ativa"}}).sort((J,ne)=>J.nome.localeCompare(ne.nome,"pt-BR"));e(F),_(!1)},ce=>{_(!1),ae({tipo:"erro",mensagem:(ce==null?void 0:ce.message)||"No foi possvel carregar as turmas do banco."})}):(_(!1),ae({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{}),[]),V.useEffect(()=>{if(!re)return()=>{};const U=yi(wt(re,"users"),ra("role","==","teacher"));return Xt(U,F=>{const J=F.docs.map(ne=>{const fe=ne.data();return{id:ne.id,nome:fe.nome||"Sem nome",status:fe.status||"ativo"}}).sort((ne,fe)=>ne.nome.localeCompare(fe.nome,"pt-BR"));i(J)})},[]),V.useEffect(()=>re?Xt(yi(wt(re,"students")),ce=>{const F=ce.docs.map(J=>{const ne=J.data();return{id:J.id,nome:ne.nome||"Sem nome",turmaId:ne.turmaId||"",status:ne.status||"ativo",fotoUrl:ne.fotoUrl||""}}).sort((J,ne)=>J.nome.localeCompare(ne.nome,"pt-BR"));r(F),I(!1)},()=>{I(!1)}):(I(!1),()=>{}),[]);const ue=V.useMemo(()=>[...new Set(t.map(U=>U.periodo).filter(Boolean))],[t]),Z=V.useMemo(()=>{const U=["Matutino","Vespertino","Integral"];return[...new Set([...U,...ue])]},[ue]),le=V.useMemo(()=>t.filter(U=>{const ce=U.nome.toLowerCase().includes(g.toLowerCase()),F=T==="todos"?!0:U.status===T,J=D==="todos"?!0:U.periodo===D;return ce&&F&&J}),[t,g,T,D]),Ae=Math.max(1,Math.ceil(le.length/Hf)),Ie=Math.min(P,Ae),De=le.slice((Ie-1)*Hf,Ie*Hf),Ve=t.find(U=>U.id===G)||null,qe=V.useMemo(()=>G?n.filter(U=>U.turmaId===G):[],[n,G]),bi=V.useMemo(()=>{if(!G)return[];const U=K.trim().toLowerCase();return U?n.filter(ce=>ce.nome.toLowerCase().includes(U)).slice(0,20):[]},[n,G,K]),Ai=()=>{d(null),m(Gf),a(!0)},Sr=U=>{d(U.id),m({nome:U.nome,periodo:U.periodo||"",professorId:U.professorId||""}),a(!0)},jn=()=>{d(null),m(Gf),a(!1)},Ni=U=>{U.preventDefault(),(async()=>{ae({tipo:"",mensagem:""}),w(!0);const F=h.nome.trim(),J=h.periodo.trim(),ne=h.professorId,fe=s.find(ge=>ge.id===ne);if(!F||!J||!ne||!fe){w(!1);return}try{if(!re)throw new Error("Banco de dados no configurado.");c?(await Kt(ut(re,"classrooms",c),{nome:F,periodo:J,professorId:ne,professorNome:fe.nome,updatedAt:$e()}),ae({tipo:"sucesso",mensagem:"Dados da turma atualizados com sucesso."})):(await _y(wt(re,"classrooms"),{nome:F,periodo:J,professorId:ne,professorNome:fe.nome,status:"ativa",createdAt:$e(),updatedAt:$e()}),ae({tipo:"sucesso",mensagem:"Turma cadastrada com sucesso."})),M(1),jn()}catch(ge){ae({tipo:"erro",mensagem:(ge==null?void 0:ge.message)||"No foi possvel salvar a turma."})}finally{w(!1)}})()},ft=U=>{(async()=>{if(!re)throw new Error("Banco de dados no configurado.");const F=t.find(J=>J.id===U);F&&await Kt(ut(re,"classrooms",U),{status:F.status==="ativa"?"inativa":"ativa",updatedAt:$e()})})().catch(F=>{ae({tipo:"erro",mensagem:(F==null?void 0:F.message)||"No foi possvel atualizar o status da turma."})})},Vn=U=>{Ee(ce=>ce===U?null:U),O(!1),Q("")},Cs=async U=>{try{if(!re||!G)throw new Error("Selecione uma turma para vincular alunos.");S(!0),ae({tipo:"",mensagem:""}),await Kt(ut(re,"students",U.id),{turmaId:G,updatedAt:$e()}),ae({tipo:"sucesso",mensagem:U.turmaId&&U.turmaId!==G?"Aluno transferido para a turma com sucesso.":"Aluno vinculado  turma com sucesso."})}catch(ce){ae({tipo:"erro",mensagem:(ce==null?void 0:ce.message)||"No foi possvel vincular o aluno."})}finally{S(!1)}},Ci=async U=>{try{if(!re)throw new Error("Dados no disponveis para remover aluno.");S(!0),ae({tipo:"",mensagem:""}),await Kt(ut(re,"students",U),{turmaId:null,updatedAt:$e()}),ae({tipo:"sucesso",mensagem:"Aluno removido da turma com sucesso."})}catch(ce){ae({tipo:"erro",mensagem:(ce==null?void 0:ce.message)||"No foi possvel remover o aluno da turma."})}finally{S(!1)}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Turmas"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Organizao das turmas e perodos da escola."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Turmas"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>A(U=>!U),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${E?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(Kd,{size:16})}),u.jsx("button",{onClick:o?jn:Ai,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar turma",children:o?u.jsx(ms,{size:16}):u.jsx(li,{size:16})}),u.jsx("button",{onClick:o?jn:Ai,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:o?"Cancelar":"Adicionar turma"})]})]}),o&&u.jsxs("form",{onSubmit:Ni,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome da turma",u.jsx("input",{value:h.nome,onChange:U=>m(ce=>({...ce,nome:U.target.value})),placeholder:"Nome da turma",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Perodo",u.jsx("select",{value:h.periodo,onChange:U=>m(ce=>({...ce,periodo:U.target.value})),className:"form-control !py-2.5",children:Z.map(U=>u.jsx("option",{value:U,children:U},U))})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Professor responsvel",u.jsxs("select",{value:h.professorId,onChange:U=>m(ce=>({...ce,professorId:U.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione"}),s.filter(U=>U.status==="ativo"||U.id===h.professorId).map(U=>u.jsx("option",{value:U.id,children:U.nome},U.id))]})]})]}),u.jsx("button",{type:"submit",disabled:B,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:c?"Salvar edio":"Salvar turma"})]}),se.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${se.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:se.mensagem}),u.jsxs("div",{className:`${E?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:g,onChange:U=>{x(U.target.value),M(1)},placeholder:"Buscar por turma",className:"form-control !py-2.5"}),u.jsxs("select",{value:T,onChange:U=>{k(U.target.value),M(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativa",children:"Ativa"}),u.jsx("option",{value:"inativa",children:"Inativa"})]}),u.jsxs("select",{value:D,onChange:U=>{b(U.target.value),M(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os perodos"}),ue.map(U=>u.jsx("option",{value:U,children:U},U))]})]}),Ve&&u.jsxs("div",{className:"mt-5 rounded-xl border border-slate-200 bg-white/80 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h4",{className:"text-base font-bold text-slate-800",children:["Gerenciar alunos da turma: ",Ve.nome]}),u.jsx("button",{onClick:()=>Ee(null),className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),C?u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando alunos..."}):u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx("div",{className:"flex items-center justify-end",children:u.jsx("button",{onClick:()=>O(!0),className:"h-9 w-full md:w-auto px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors",children:"Buscar e vincular aluno"})}),u.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:["Alunos da turma: ",qe.length]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:[qe.map(U=>{var ce,F;return u.jsxs("div",{className:"flex items-center justify-between bg-slate-100 gap-3 rounded-lg border shadown-md border-slate-300 px-3 py-2",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-9 h-9 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:U.fotoUrl?u.jsx("img",{src:U.fotoUrl,alt:U.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-500 font-semibold",children:((F=(ce=U.nome)==null?void 0:ce.charAt(0))==null?void 0:F.toUpperCase())||"?"})}),u.jsx("span",{className:"text-sm text-slate-700 truncate",children:U.nome})]}),u.jsx("button",{disabled:y,onClick:()=>Ci(U.id),className:"h-7 px-2 rounded-md text-xs font-medium text-red-600 bg-red-50 hover:bg-red-100 disabled:opacity-50",children:"Remover"})]},U.id)}),qe.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum aluno vinculado."})]})]}),u.jsx("div",{className:"text-xs text-slate-500",children:"Use Buscar e vincular aluno para localizar por nome e incluir na turma."})]})]}),$&&Ve&&u.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-2xl rounded-xl border border-slate-200 bg-white shadow-xl p-4 md:p-5",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-base font-bold text-slate-800",children:Ve.nome}),u.jsx("button",{onClick:()=>{O(!1),Q("")},className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),u.jsx("input",{value:K,onChange:U=>Q(U.target.value),placeholder:"Digite o nome do aluno",className:"form-control !py-2.5 mb-3"}),!K.trim()&&u.jsx("div",{className:"text-sm text-slate-500 py-4",children:"Digite um nome para buscar alunos."}),K.trim()&&u.jsxs("div",{className:"flex flex-col gap-2 max-h-96 overflow-y-auto",children:[bi.map(U=>{var J,ne;const ce=U.turmaId===G,F=U.turmaId&&!ce;return u.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-lg border border-slate-200 px-3 py-2",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:U.fotoUrl?u.jsx("img",{src:U.fotoUrl,alt:U.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-500 font-semibold",children:((ne=(J=U.nome)==null?void 0:J.charAt(0))==null?void 0:ne.toUpperCase())||"?"})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-slate-700 truncate",children:U.nome}),ce&&u.jsx("div",{className:"text-xs text-emerald-700",children:"J est nesta turma"}),F&&u.jsx("div",{className:"text-xs text-amber-700",children:"Est em outra turma"})]})]}),u.jsx("button",{disabled:y||ce,onClick:()=>Cs(U),className:"h-8 px-2 rounded-lg text-xs font-medium text-emerald-700 bg-emerald-50 hover:bg-emerald-100 disabled:opacity-50",children:ce?"Vinculado":F?"Transferir":"Vincular"})]},U.id)}),bi.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum aluno encontrado."})]})]})}),N&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando turmas..."}),!N&&De.map(U=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${U.status==="ativa"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>Sr(U),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(gn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>Vn(U.id),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-primary bg-primary/15 border border-primary/30 hover:bg-primary/35 transition-colors flex flex-col items-center gap-1",children:[u.jsx(ed,{}),"Alunos"]}),u.jsxs("button",{onClick:()=>ft(U.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${U.status==="ativa"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[U.status==="ativa"?u.jsx(fs,{}):u.jsx(hs,{}),U.status==="ativa"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2",children:[u.jsxs("div",{className:"font-medium text-slate-800 truncate",children:[U.nome," - ",U.periodo||"Sem perodo"]}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:U.professorNome||"No definido"})]})})]}),u.jsxs("div",{className:"grid grid-cols-3 md:hidden p-1",children:[u.jsx("button",{onClick:()=>Sr(U),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(gn,{})}),u.jsx("button",{onClick:()=>Vn(U.id),className:"h-8 px-2 text-xs font-medium text-slate-700 border border-primary justify-center inline-flex items-center gap-1",children:u.jsx(To,{})}),u.jsx("button",{onClick:()=>ft(U.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${U.status==="ativa"?"text-red-600":"text-emerald-700"}`,children:U.status==="ativa"?u.jsx(fs,{}):u.jsx(hs,{})})]})]},U.id)),!N&&De.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhuma turma encontrada."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",Ie," de ",Ae]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:Ie===1,onClick:()=>M(U=>Math.max(1,U-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:Ie===Ae,onClick:()=>M(U=>Math.min(Ae,U+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}async function RO(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}function PO(){const{currentUser:t,userProfile:e}=Th(),[n,r]=V.useState(""),[s,i]=V.useState(""),[o,a]=V.useState(""),[c,d]=V.useState(""),[h,m]=V.useState(""),[g,x]=V.useState(""),[T,k]=V.useState(!1),[D,b]=V.useState(!1),[E,A]=V.useState(""),[P,M]=V.useState(""),[B,w]=V.useState(""),[y,S]=V.useState("");V.useEffect(()=>{r((e==null?void 0:e.nome)||""),i((e==null?void 0:e.telefone)||""),a((e==null?void 0:e.avatarUrl)||"")},[e]);const N=async I=>{var ae;const se=(ae=I.target.files)==null?void 0:ae[0];if(se)try{const G=await RO(se);a(G)}catch(G){M((G==null?void 0:G.message)||"No foi possvel carregar a imagem.")}finally{I.target.value=""}},_=async I=>{if(I.preventDefault(),!(!t||!re)){A(""),M(""),k(!0);try{await Su(ut(re,"users",t.uid),{nome:n.trim(),telefone:s.trim(),avatarUrl:o||null,updatedAt:$e()},{merge:!0}),A("Perfil atualizado com sucesso.")}catch(se){M((se==null?void 0:se.message)||"No foi possvel atualizar o perfil.")}finally{k(!1)}}},C=async I=>{if(I.preventDefault(),!(!(t!=null&&t.email)||!(xt!=null&&xt.currentUser))){if(w(""),S(""),!c.trim()){S("Informe sua senha atual.");return}if(h.length<6){S("A nova senha deve ter pelo menos 6 caracteres.");return}if(h!==g){S("A confirmao da senha no confere.");return}b(!0);try{const se=Si.credential(t.email,c);await hV(xt.currentUser,se),await pV(xt.currentUser,h),d(""),m(""),x(""),w("Senha atualizada com sucesso.")}catch(se){(se==null?void 0:se.code)==="auth/wrong-password"||(se==null?void 0:se.code)==="auth/invalid-credential"?S("Senha atual invlida."):S((se==null?void 0:se.message)||"No foi possvel alterar a senha.")}finally{b(!1)}}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Meu Perfil"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Atualize suas informaes e sua senha de acesso."})]}),u.jsxs("form",{onSubmit:_,className:"glass-panel p-5 border border-slate-200/60 flex flex-col gap-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Dados pessoais"}),P&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:P}),E&&u.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:E}),u.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[u.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:o?u.jsx("img",{src:o,alt:"Avatar do usurio",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-400 text-sm",children:"Sem avatar"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Avatar"}),u.jsx("input",{type:"file",accept:"image/*",onChange:N,className:"form-control !py-2 mt-1"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Nome",u.jsx("input",{value:n,onChange:I=>r(I.target.value),placeholder:"Nome",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["E-mail",u.jsx("input",{value:(e==null?void 0:e.email)||(t==null?void 0:t.email)||"",disabled:!0,className:"form-control !py-2.5 bg-slate-100 text-slate-500"})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600 md:col-span-2",children:["Telefone",u.jsx("input",{value:s,onChange:I=>i(I.target.value),placeholder:"Telefone",className:"form-control !py-2.5"})]})]}),u.jsx("button",{type:"submit",disabled:T,className:"h-10 px-4 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:"Salvar perfil"})]}),u.jsxs("form",{onSubmit:C,className:"glass-panel p-5 border border-slate-200/60 flex flex-col gap-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Alterar senha"}),y&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:y}),B&&u.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:B}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Senha atual",u.jsx("input",{type:"password",value:c,onChange:I=>d(I.target.value),placeholder:"Senha atual",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Nova senha",u.jsx("input",{type:"password",value:h,onChange:I=>m(I.target.value),placeholder:"Nova senha",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Confirmar nova senha",u.jsx("input",{type:"password",value:g,onChange:I=>x(I.target.value),placeholder:"Confirmar nova senha",className:"form-control !py-2.5",required:!0})]})]}),u.jsx("button",{type:"submit",disabled:D,className:"h-10 px-4 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:"Alterar senha"})]})]})}const iw={1:{id:"1",turmaId:"t1",name:"Joo Pedro",status:"draft",avatar:"https://ui-avatars.com/api/?name=Joao+Pedro&background=e2e8f0&color=0f172a"},2:{id:"2",turmaId:"t2",name:"Maria Clara",status:"pending",avatar:"https://ui-avatars.com/api/?name=Maria+Clara&background=fef08a&color=854d0e"},3:{id:"3",turmaId:"t2",name:"Enzo Gabriel",status:"pending",avatar:"https://ui-avatars.com/api/?name=Enzo+G&background=bfdbfe&color=1e3a8a"},4:{id:"4",turmaId:"t1",name:"Sofia M.",status:"sent",avatar:"https://ui-avatars.com/api/?name=Sofia+M&background=fbcfe8&color=831843"},5:{id:"5",turmaId:"t1",name:"Lucas T.",status:"pending",avatar:"https://ui-avatars.com/api/?name=Lucas+T&background=dcfce7&color=166534"},6:{id:"6",turmaId:"t1",name:"Alice R.",status:"pending",avatar:"https://ui-avatars.com/api/?name=Alice+R&background=fce7f3&color=9d174d"}},Kf=[];function DO(){const{currentUser:t,userRole:e,userProfile:n,logout:r}=Th(),[s,i]=V.useState("caderneta"),[o,a]=V.useState("dashboard"),[c,d]=V.useState(null),[h,m]=V.useState(null),[g,x]=V.useState(iw),[T,k]=V.useState(Kf),[D,b]=V.useState(!0),[E,A]=V.useState(!1),[P,M]=V.useState(!1),[B,w]=V.useState(()=>navigator.onLine?"online":"offline"),y=V.useRef(null),S=V.useRef(null);if(V.useEffect(()=>{e==="admin"&&!s.startsWith("admin-")&&s!=="perfil"&&i("admin-dashboard")},[e,s]),V.useEffect(()=>{if(!re||e!=="teacher"||!(t!=null&&t.uid))return e!=="teacher"&&(k(Kf),x(iw)),b(!1),()=>{};b(!0);const Z=yi(wt(re,"classrooms"),ra("professorId","==",t.uid)),le=Xt(Z,Ie=>{const De=Ie.docs.map(Ve=>{const qe=Ve.data();return{id:Ve.id,nome:qe.nome||"Sem nome",periodo:qe.periodo||""}}).sort((Ve,qe)=>Ve.nome.localeCompare(qe.nome,"pt-BR"));k(De)},()=>{k(Kf)}),Ae=Xt(wt(re,"students"),Ie=>{const De={};Ie.docs.forEach(Ve=>{const qe=Ve.data();De[Ve.id]={id:Ve.id,turmaId:qe.turmaId||"",name:qe.nome||"Sem nome",status:qe.cadernetaStatus||"pending",avatar:qe.fotoUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(qe.nome||"Aluno")}&background=e2e8f0&color=0f172a`}}),x(De),b(!1)},()=>{x({}),b(!1)});return()=>{le(),Ae()}},[e,t==null?void 0:t.uid]),V.useEffect(()=>{if(e!=="teacher")return;const Z=new Set(T.map(le=>le.id));x(le=>Object.values(le).filter(Ie=>Z.has(Ie.turmaId)).reduce((Ie,De)=>(Ie[De.id]=De,Ie),{}))},[T,e]),V.useEffect(()=>{const Z=le=>{y.current&&!y.current.contains(le.target)&&A(!1)};return document.addEventListener("mousedown",Z),()=>document.removeEventListener("mousedown",Z)},[]),V.useEffect(()=>{const Z=()=>{w("syncing"),S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{w("online")},1500)},le=()=>{S.current&&clearTimeout(S.current),w("offline")};return window.addEventListener("online",Z),window.addEventListener("offline",le),()=>{window.removeEventListener("online",Z),window.removeEventListener("offline",le),S.current&&clearTimeout(S.current)}},[]),!t)return u.jsx(gO,{});const N=Z=>{d(Z),a("diario")},_=Z=>{m(Z),a("aluno")},C=(Z,le)=>{x(Ae=>({...Ae,[Z]:{...Ae[Z],status:le}})),!(!re||!Z)&&Kt(ut(re,"students",Z),{cadernetaStatus:le}).catch(()=>{})},I=()=>o==="dashboard"?u.jsx(Ex,{onOpenTurma:N,turmas:T,studentsStatus:g,carregando:D}):o==="diario"&&c?u.jsx(lj,{turma:c,studentsStatus:g,onBack:()=>a("dashboard"),onOpenStudent:_}):o==="aluno"&&h?u.jsx(cj,{student:g[h],turma:c,onBack:()=>a("diario"),onUpdateStatus:Z=>C(h,Z)}):u.jsx(Ex,{onOpenTurma:N,turmas:T,studentsStatus:g,carregando:D}),se=()=>{if(s==="perfil")return u.jsx(PO,{});if(e==="admin")return s==="admin-dashboard"?u.jsx(vO,{}):s==="admin-calendar"?u.jsx(xO,{}):s==="admin-professores"?u.jsx(bO,{}):s==="admin-responsaveis"?u.jsx(CO,{}):s==="admin-alunos"?u.jsx(sw,{}):s==="admin-turmas"?u.jsx(kO,{}):u.jsx(sw,{});if(e==="parent"){if(s==="caderneta")return u.jsx(yO,{});if(s==="calendario")return u.jsx(Tx,{});if(s==="comunicacao")return u.jsx(bx,{})}switch(s){case"caderneta":return I();case"calendario":return u.jsx(Tx,{});case"comunicacao":return u.jsx(bx,{});default:return I()}},ae=Z=>{i(Z),A(!1),M(!1),Z==="caderneta"&&a("dashboard")},G=()=>{i("perfil"),A(!1),M(!1)},$=e==="admin"?[{id:"admin-dashboard",label:"Dashboard",icon:sl},{id:"admin-calendar",label:"Calendrio",icon:sl},{id:"admin-professores",label:"Professores",icon:zs},{id:"admin-turmas",label:"Turmas",icon:E1},{id:"admin-responsaveis",label:"Responsveis",icon:To},{id:"admin-alunos",label:"Alunos",icon:ed}]:[{id:"caderneta",label:e==="admin"?"Viso Geral":e==="parent"?"Meu Filho":"Dashboard",icon:ed},{id:"calendario",label:"Calendrio",icon:sl},{id:"comunicacao",label:"Mensagens",icon:x1}],O=(n==null?void 0:n.nome)||(t==null?void 0:t.displayName)||"Usurio",K=(n==null?void 0:n.email)||(t==null?void 0:t.email)||"",Q=(n==null?void 0:n.avatarUrl)||"",ue=B==="offline"?{label:"Offline",className:"bg-red-50 text-red-600 border-red-200",dotClassName:"bg-red-500"}:B==="syncing"?{label:"Sincronizando...",className:"bg-amber-50 text-amber-700 border-amber-200",dotClassName:"bg-amber-500"}:{label:"Online",className:"bg-emerald-50 text-emerald-700 border-emerald-200",dotClassName:"bg-emerald-500"};return u.jsxs("div",{className:"flex h-screen overflow-hidden bg-bg-app",children:[u.jsxs("div",{className:"lg:hidden fixed top-0 w-full h-16 bg-white border-b border-slate-200 flex items-center justify-between px-4 z-50",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>M(Z=>!Z),className:"w-9 h-9 rounded-lg border border-slate-200 bg-white text-slate-600 inline-flex items-center justify-center","aria-label":P?"Fechar menu":"Abrir menu",children:P?u.jsx(ms,{size:18}):u.jsx(MC,{size:18})}),u.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-primary to-primary-light flex items-center justify-center text-white font-bold text-sm shadow-[0_2px_8px_rgba(16,185,129,0.3)]",children:"V"}),u.jsx("span",{className:"font-bold text-slate-800 tracking-tight",children:"Verdy"})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{className:"text-slate-500 hover:text-primary",children:u.jsx(O_,{size:20})}),u.jsxs("div",{className:`hidden sm:inline-flex items-center gap-1.5 px-2 py-1 rounded-full border text-[11px] font-medium ${ue.className}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${ue.dotClassName}`}),ue.label]}),u.jsxs("div",{ref:y,className:"relative",children:[u.jsx("button",{onClick:()=>A(Z=>!Z),className:"w-9 h-9 rounded-full bg-slate-100 border border-slate-200 overflow-hidden flex items-center justify-center text-slate-500",children:Q?u.jsx("img",{src:Q,alt:O,className:"w-full h-full object-cover"}):u.jsx(zs,{size:18})}),E&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-56 rounded-xl border border-slate-200 bg-white shadow-lg p-2 z-20",children:[u.jsxs("div",{className:"px-3 py-2 border-b border-slate-100 mb-1",children:[u.jsx("div",{className:"text-xs font-semibold text-slate-800 truncate",children:O}),u.jsx("div",{className:"text-[11px] text-slate-500 truncate",children:K||"Conta ativa"})]}),u.jsxs("button",{onClick:G,className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-700 hover:bg-slate-50",children:[u.jsx(zs,{size:16}),"Meu perfil"]}),u.jsxs("button",{onClick:r,className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50",children:[u.jsx(L_,{size:16}),"Sair do sistema"]})]})]})]})]}),P&&u.jsxs("div",{className:"lg:hidden fixed inset-0 z-40",children:[u.jsx("button",{onClick:()=>M(!1),className:"absolute inset-0 bg-slate-900/40","aria-label":"Fechar menu"}),u.jsxs("aside",{className:"absolute left-0 top-0 h-full w-full bg-white border-r border-slate-200 p-5 flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-primary to-primary-light flex items-center justify-center text-white font-bold text-sm",children:"V"}),u.jsx("span",{className:"font-bold text-slate-800 tracking-tight",children:"Verdy"})]}),u.jsx("button",{onClick:()=>M(!1),className:"w-8 h-8 rounded-lg border border-slate-200 text-slate-600 inline-flex items-center justify-center","aria-label":"Fechar menu",children:u.jsx(ms,{size:16})})]}),u.jsx("nav",{className:"flex flex-col gap-2",children:$.map(Z=>u.jsxs("button",{onClick:()=>ae(Z.id),className:`flex items-center gap-3 w-full text-left px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${s===Z.id?"bg-primary text-white":"text-slate-600 hover:bg-slate-50"}`,children:[u.jsx(Z.icon,{size:18}),Z.label]},Z.id))})]})]}),u.jsxs("aside",{className:"hidden lg:flex w-[280px] bg-white border-r border-slate-200 flex-col p-6 z-10 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-10 mt-2",children:[u.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-primary-light flex items-center justify-center text-white font-bold text-xl shadow-[0_4px_10px_rgba(16,185,129,0.3)]",children:"V"}),u.jsx("h2",{className:"font-bold text-2xl text-slate-800 tracking-tight",children:"Colgio Verdy"})]}),u.jsx("nav",{className:"flex flex-col gap-2 flex-1 mt-4",children:$.map(Z=>u.jsxs("button",{onClick:()=>ae(Z.id),className:`flex items-center gap-3 w-full text-left px-4 py-3.5 rounded-xl font-medium text-[15px] transition-all ${s===Z.id?"bg-primary text-white shadow-md":"text-slate-500 hover:bg-slate-50 hover:text-primary"}`,children:[u.jsx(Z.icon,{size:20}),Z.label]},Z.id))})]}),u.jsxs("main",{className:"flex-1 flex flex-col pt-16 lg:pt-0 overflow-hidden relative",children:[u.jsx("header",{className:"hidden lg:flex h-20 items-center justify-between px-8 bg-white border-b border-slate-200 shrink-0",children:u.jsxs("div",{className:"flex ml-auto items-center gap-6",children:[u.jsx("button",{className:"p-2 text-slate-500 hover:text-primary hover:bg-slate-50 rounded-full transition-colors",children:u.jsx(O_,{size:20})}),u.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-xs font-medium ${ue.className}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${ue.dotClassName}`}),ue.label]}),u.jsxs("div",{ref:y,className:"relative",children:[u.jsxs("button",{onClick:()=>A(Z=>!Z),className:"flex items-center gap-3 select-none hover:bg-slate-50 rounded-xl px-2 py-1.5 transition-colors",children:[u.jsx("div",{className:"w-11 h-11 rounded-full bg-slate-100 border-2 border-white shadow-sm overflow-hidden flex items-center justify-center text-slate-500",children:Q?u.jsx("img",{src:Q,alt:O,className:"w-full h-full object-cover"}):u.jsx(zs,{size:20})}),u.jsxs("div",{className:"flex flex-col text-left",children:[u.jsx("span",{className:"font-semibold text-sm text-slate-800 uppercase",children:O}),u.jsx("span",{className:"text-xs text-slate-500 truncate max-w-[180px]",children:K||"Conta ativa"})]}),u.jsx(AC,{size:16,className:`text-slate-400 transition-transform ${E?"rotate-180":""}`})]}),E&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-56 rounded-xl border border-slate-200 bg-white shadow-lg p-2 z-20",children:[u.jsxs("button",{onClick:G,className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-700 hover:bg-slate-50",children:[u.jsx(zs,{size:16}),"Meu perfil"]}),u.jsxs("button",{onClick:r,className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50",children:[u.jsx(L_,{size:16}),"Sair do sistema"]})]})]})]})}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 lg:p-8 pb-8",children:se()})]})]})}function jO(){return u.jsx(pO,{children:u.jsx(DO,{})})}xC({immediate:!0});Wf.createRoot(document.getElementById("root")).render(u.jsx(iA.StrictMode,{children:u.jsx(jO,{})}));
