(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function wA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Dw={exports:{}},Hd={},jw={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tc=Symbol.for("react.element"),EA=Symbol.for("react.portal"),IA=Symbol.for("react.fragment"),TA=Symbol.for("react.strict_mode"),bA=Symbol.for("react.profiler"),SA=Symbol.for("react.provider"),AA=Symbol.for("react.context"),NA=Symbol.for("react.forward_ref"),CA=Symbol.for("react.suspense"),kA=Symbol.for("react.memo"),RA=Symbol.for("react.lazy"),Xv=Symbol.iterator;function PA(t){return t===null||typeof t!="object"?null:(t=Xv&&t[Xv]||t["@@iterator"],typeof t=="function"?t:null)}var Vw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ow=Object.assign,Mw={};function Zo(t,e,n){this.props=t,this.context=e,this.refs=Mw,this.updater=n||Vw}Zo.prototype.isReactComponent={};Zo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Zo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Lw(){}Lw.prototype=Zo.prototype;function Hp(t,e,n){this.props=t,this.context=e,this.refs=Mw,this.updater=n||Vw}var Gp=Hp.prototype=new Lw;Gp.constructor=Hp;Ow(Gp,Zo.prototype);Gp.isPureReactComponent=!0;var Zv=Array.isArray,Fw=Object.prototype.hasOwnProperty,Kp={current:null},Uw={key:!0,ref:!0,__self:!0,__source:!0};function zw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Fw.call(e,r)&&!Uw.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),d=0;d<a;d++)c[d]=arguments[d+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:tc,type:t,key:i,ref:o,props:s,_owner:Kp.current}}function DA(t,e){return{$$typeof:tc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Wp(t){return typeof t=="object"&&t!==null&&t.$$typeof===tc}function jA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var e_=/\/+/g;function lf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?jA(""+t.key):e.toString(36)}function fu(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case tc:case EA:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+lf(o,0):r,Zv(s)?(n="",t!=null&&(n=t.replace(e_,"$&/")+"/"),fu(s,e,n,"",function(d){return d})):s!=null&&(Wp(s)&&(s=DA(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(e_,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Zv(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+lf(i,a);o+=fu(i,e,n,c,s)}else if(c=PA(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+lf(i,a++),o+=fu(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Vc(t,e,n){if(t==null)return t;var r=[],s=0;return fu(t,r,"","",function(i){return e.call(n,i,s++)}),r}function VA(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qt={current:null},mu={transition:null},OA={ReactCurrentDispatcher:qt,ReactCurrentBatchConfig:mu,ReactCurrentOwner:Kp};function Bw(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:Vc,forEach:function(t,e,n){Vc(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Vc(t,function(){e++}),e},toArray:function(t){return Vc(t,function(e){return e})||[]},only:function(t){if(!Wp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};xe.Component=Zo;xe.Fragment=IA;xe.Profiler=bA;xe.PureComponent=Hp;xe.StrictMode=TA;xe.Suspense=CA;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OA;xe.act=Bw;xe.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Ow({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Kp.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Fw.call(e,c)&&!Uw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var d=0;d<c;d++)a[d]=arguments[d+2];r.children=a}return{$$typeof:tc,type:t.type,key:s,ref:i,props:r,_owner:o}};xe.createContext=function(t){return t={$$typeof:AA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:SA,_context:t},t.Consumer=t};xe.createElement=zw;xe.createFactory=function(t){var e=zw.bind(null,t);return e.type=t,e};xe.createRef=function(){return{current:null}};xe.forwardRef=function(t){return{$$typeof:NA,render:t}};xe.isValidElement=Wp;xe.lazy=function(t){return{$$typeof:RA,_payload:{_status:-1,_result:t},_init:VA}};xe.memo=function(t,e){return{$$typeof:kA,type:t,compare:e===void 0?null:e}};xe.startTransition=function(t){var e=mu.transition;mu.transition={};try{t()}finally{mu.transition=e}};xe.unstable_act=Bw;xe.useCallback=function(t,e){return qt.current.useCallback(t,e)};xe.useContext=function(t){return qt.current.useContext(t)};xe.useDebugValue=function(){};xe.useDeferredValue=function(t){return qt.current.useDeferredValue(t)};xe.useEffect=function(t,e){return qt.current.useEffect(t,e)};xe.useId=function(){return qt.current.useId()};xe.useImperativeHandle=function(t,e,n){return qt.current.useImperativeHandle(t,e,n)};xe.useInsertionEffect=function(t,e){return qt.current.useInsertionEffect(t,e)};xe.useLayoutEffect=function(t,e){return qt.current.useLayoutEffect(t,e)};xe.useMemo=function(t,e){return qt.current.useMemo(t,e)};xe.useReducer=function(t,e,n){return qt.current.useReducer(t,e,n)};xe.useRef=function(t){return qt.current.useRef(t)};xe.useState=function(t){return qt.current.useState(t)};xe.useSyncExternalStore=function(t,e,n){return qt.current.useSyncExternalStore(t,e,n)};xe.useTransition=function(){return qt.current.useTransition()};xe.version="18.3.1";jw.exports=xe;var P=jw.exports;const MA=wA(P);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LA=P,FA=Symbol.for("react.element"),UA=Symbol.for("react.fragment"),zA=Object.prototype.hasOwnProperty,BA=LA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,$A={key:!0,ref:!0,__self:!0,__source:!0};function $w(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)zA.call(e,r)&&!$A.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:FA,type:t,key:i,ref:o,props:s,_owner:BA.current}}Hd.Fragment=UA;Hd.jsx=$w;Hd.jsxs=$w;Dw.exports=Hd;var u=Dw.exports,um={},qw={exports:{}},mn={},Hw={exports:{}},Gw={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e($,L){var G=$.length;$.push(L);e:for(;0<G;){var Y=G-1>>>1,W=$[Y];if(0<s(W,L))$[Y]=L,$[G]=W,G=Y;else break e}}function n($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var L=$[0],G=$.pop();if(G!==L){$[0]=G;e:for(var Y=0,W=$.length,me=W>>>1;Y<me;){var ue=2*(Y+1)-1,Se=$[ue],_e=ue+1,Ne=$[_e];if(0>s(Se,G))_e<W&&0>s(Ne,Se)?($[Y]=Ne,$[_e]=G,Y=_e):($[Y]=Se,$[ue]=G,Y=ue);else if(_e<W&&0>s(Ne,G))$[Y]=Ne,$[_e]=G,Y=_e;else break e}}return L}function s($,L){var G=$.sortIndex-L.sortIndex;return G!==0?G:$.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],d=[],h=1,m=null,g=3,x=!1,A=!1,C=!1,R=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T($){for(var L=n(d);L!==null;){if(L.callback===null)r(d);else if(L.startTime<=$)r(d),L.sortIndex=L.expirationTime,e(c,L);else break;L=n(d)}}function D($){if(C=!1,T($),!A)if(n(c)!==null)A=!0,K(O);else{var L=n(d);L!==null&&we(D,L.startTime-$)}}function O($,L){A=!1,C&&(C=!1,I(y),y=-1),x=!0;var G=g;try{for(T(L),m=n(c);m!==null&&(!(m.expirationTime>L)||$&&!w());){var Y=m.callback;if(typeof Y=="function"){m.callback=null,g=m.priorityLevel;var W=Y(m.expirationTime<=L);L=t.unstable_now(),typeof W=="function"?m.callback=W:m===n(c)&&r(c),T(L)}else r(c);m=n(c)}if(m!==null)var me=!0;else{var ue=n(d);ue!==null&&we(D,ue.startTime-L),me=!1}return me}finally{m=null,g=G,x=!1}}var U=!1,E=null,y=-1,S=5,N=-1;function w(){return!(t.unstable_now()-N<S)}function k(){if(E!==null){var $=t.unstable_now();N=$;var L=!0;try{L=E(!0,$)}finally{L?b():(U=!1,E=null)}}else U=!1}var b;if(typeof v=="function")b=function(){v(k)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,ae=se.port2;se.port1.onmessage=k,b=function(){ae.postMessage(null)}}else b=function(){R(k,0)};function K($){E=$,U||(U=!0,b())}function we($,L){y=R(function(){$(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function($){$.callback=null},t.unstable_continueExecution=function(){A||x||(A=!0,K(O))},t.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<$?Math.floor(1e3/$):5},t.unstable_getCurrentPriorityLevel=function(){return g},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function($){switch(g){case 1:case 2:case 3:var L=3;break;default:L=g}var G=g;g=L;try{return $()}finally{g=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function($,L){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var G=g;g=$;try{return L()}finally{g=G}},t.unstable_scheduleCallback=function($,L,G){var Y=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?Y+G:Y):G=Y,$){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=G+W,$={id:h++,callback:L,priorityLevel:$,startTime:G,expirationTime:W,sortIndex:-1},G>Y?($.sortIndex=G,e(d,$),n(c)===null&&$===n(d)&&(C?(I(y),y=-1):C=!0,we(D,G-Y))):($.sortIndex=W,e(c,$),A||x||(A=!0,K(O))),$},t.unstable_shouldYield=w,t.unstable_wrapCallback=function($){var L=g;return function(){var G=g;g=L;try{return $.apply(this,arguments)}finally{g=G}}}})(Gw);Hw.exports=Gw;var qA=Hw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HA=P,hn=qA;function H(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Kw=new Set,Il={};function ki(t,e){To(t,e),To(t+"Capture",e)}function To(t,e){for(Il[t]=e,t=0;t<e.length;t++)Kw.add(e[t])}var vr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dm=Object.prototype.hasOwnProperty,GA=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,t_={},n_={};function KA(t){return dm.call(n_,t)?!0:dm.call(t_,t)?!1:GA.test(t)?n_[t]=!0:(t_[t]=!0,!1)}function WA(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QA(t,e,n,r){if(e===null||typeof e>"u"||WA(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ht(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var bt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){bt[t]=new Ht(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];bt[e]=new Ht(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){bt[t]=new Ht(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){bt[t]=new Ht(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){bt[t]=new Ht(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){bt[t]=new Ht(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){bt[t]=new Ht(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){bt[t]=new Ht(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){bt[t]=new Ht(t,5,!1,t.toLowerCase(),null,!1,!1)});var Qp=/[\-:]([a-z])/g;function Yp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Qp,Yp);bt[e]=new Ht(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Qp,Yp);bt[e]=new Ht(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Qp,Yp);bt[e]=new Ht(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){bt[t]=new Ht(t,1,!1,t.toLowerCase(),null,!1,!1)});bt.xlinkHref=new Ht("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){bt[t]=new Ht(t,1,!1,t.toLowerCase(),null,!0,!0)});function Jp(t,e,n,r){var s=bt.hasOwnProperty(e)?bt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QA(e,n,s,r)&&(n=null),r||s===null?KA(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Rr=HA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oc=Symbol.for("react.element"),Zi=Symbol.for("react.portal"),eo=Symbol.for("react.fragment"),Xp=Symbol.for("react.strict_mode"),hm=Symbol.for("react.profiler"),Ww=Symbol.for("react.provider"),Qw=Symbol.for("react.context"),Zp=Symbol.for("react.forward_ref"),fm=Symbol.for("react.suspense"),mm=Symbol.for("react.suspense_list"),eg=Symbol.for("react.memo"),Wr=Symbol.for("react.lazy"),Yw=Symbol.for("react.offscreen"),r_=Symbol.iterator;function Ia(t){return t===null||typeof t!="object"?null:(t=r_&&t[r_]||t["@@iterator"],typeof t=="function"?t:null)}var We=Object.assign,cf;function Ba(t){if(cf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);cf=e&&e[1]||""}return`
`+cf+t}var uf=!1;function df(t,e){if(!t||uf)return"";uf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{uf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ba(t):""}function YA(t){switch(t.tag){case 5:return Ba(t.type);case 16:return Ba("Lazy");case 13:return Ba("Suspense");case 19:return Ba("SuspenseList");case 0:case 2:case 15:return t=df(t.type,!1),t;case 11:return t=df(t.type.render,!1),t;case 1:return t=df(t.type,!0),t;default:return""}}function pm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case eo:return"Fragment";case Zi:return"Portal";case hm:return"Profiler";case Xp:return"StrictMode";case fm:return"Suspense";case mm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Qw:return(t.displayName||"Context")+".Consumer";case Ww:return(t._context.displayName||"Context")+".Provider";case Zp:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case eg:return e=t.displayName||null,e!==null?e:pm(t.type)||"Memo";case Wr:e=t._payload,t=t._init;try{return pm(t(e))}catch{}}return null}function JA(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pm(e);case 8:return e===Xp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ws(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Jw(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function XA(t){var e=Jw(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Mc(t){t._valueTracker||(t._valueTracker=XA(t))}function Xw(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Jw(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Bu(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gm(t,e){var n=e.checked;return We({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function s_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ws(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Zw(t,e){e=e.checked,e!=null&&Jp(t,"checked",e,!1)}function ym(t,e){Zw(t,e);var n=ws(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vm(t,e.type,n):e.hasOwnProperty("defaultValue")&&vm(t,e.type,ws(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function i_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vm(t,e,n){(e!=="number"||Bu(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var $a=Array.isArray;function fo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ws(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function _m(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(H(91));return We({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function o_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(H(92));if($a(n)){if(1<n.length)throw Error(H(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ws(n)}}function eE(t,e){var n=ws(e.value),r=ws(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function a_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function tE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?tE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Lc,nE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Lc=Lc||document.createElement("div"),Lc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Lc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Tl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var el={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ZA=["Webkit","ms","Moz","O"];Object.keys(el).forEach(function(t){ZA.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),el[e]=el[t]})});function rE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||el.hasOwnProperty(t)&&el[t]?(""+e).trim():e+"px"}function sE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=rE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var eN=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wm(t,e){if(e){if(eN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(H(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(H(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(H(61))}if(e.style!=null&&typeof e.style!="object")throw Error(H(62))}}function Em(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Im=null;function tg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Tm=null,mo=null,po=null;function l_(t){if(t=sc(t)){if(typeof Tm!="function")throw Error(H(280));var e=t.stateNode;e&&(e=Yd(e),Tm(t.stateNode,t.type,e))}}function iE(t){mo?po?po.push(t):po=[t]:mo=t}function oE(){if(mo){var t=mo,e=po;if(po=mo=null,l_(t),e)for(t=0;t<e.length;t++)l_(e[t])}}function aE(t,e){return t(e)}function lE(){}var hf=!1;function cE(t,e,n){if(hf)return t(e,n);hf=!0;try{return aE(t,e,n)}finally{hf=!1,(mo!==null||po!==null)&&(lE(),oE())}}function bl(t,e){var n=t.stateNode;if(n===null)return null;var r=Yd(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(H(231,e,typeof n));return n}var bm=!1;if(vr)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){bm=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{bm=!1}function tN(t,e,n,r,s,i,o,a,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var tl=!1,$u=null,qu=!1,Sm=null,nN={onError:function(t){tl=!0,$u=t}};function rN(t,e,n,r,s,i,o,a,c){tl=!1,$u=null,tN.apply(nN,arguments)}function sN(t,e,n,r,s,i,o,a,c){if(rN.apply(this,arguments),tl){if(tl){var d=$u;tl=!1,$u=null}else throw Error(H(198));qu||(qu=!0,Sm=d)}}function Ri(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function uE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function c_(t){if(Ri(t)!==t)throw Error(H(188))}function iN(t){var e=t.alternate;if(!e){if(e=Ri(t),e===null)throw Error(H(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return c_(s),t;if(i===r)return c_(s),e;i=i.sibling}throw Error(H(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(H(189))}}if(n.alternate!==r)throw Error(H(190))}if(n.tag!==3)throw Error(H(188));return n.stateNode.current===n?t:e}function dE(t){return t=iN(t),t!==null?hE(t):null}function hE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=hE(t);if(e!==null)return e;t=t.sibling}return null}var fE=hn.unstable_scheduleCallback,u_=hn.unstable_cancelCallback,oN=hn.unstable_shouldYield,aN=hn.unstable_requestPaint,tt=hn.unstable_now,lN=hn.unstable_getCurrentPriorityLevel,ng=hn.unstable_ImmediatePriority,mE=hn.unstable_UserBlockingPriority,Hu=hn.unstable_NormalPriority,cN=hn.unstable_LowPriority,pE=hn.unstable_IdlePriority,Gd=null,Xn=null;function uN(t){if(Xn&&typeof Xn.onCommitFiberRoot=="function")try{Xn.onCommitFiberRoot(Gd,t,void 0,(t.current.flags&128)===128)}catch{}}var Pn=Math.clz32?Math.clz32:fN,dN=Math.log,hN=Math.LN2;function fN(t){return t>>>=0,t===0?32:31-(dN(t)/hN|0)|0}var Fc=64,Uc=4194304;function qa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Gu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=qa(a):(i&=o,i!==0&&(r=qa(i)))}else o=n&~s,o!==0?r=qa(o):i!==0&&(r=qa(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Pn(e),s=1<<n,r|=t[n],e&=~s;return r}function mN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function pN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Pn(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=mN(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function Am(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function gE(){var t=Fc;return Fc<<=1,!(Fc&4194240)&&(Fc=64),t}function ff(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function nc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Pn(e),t[e]=n}function gN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Pn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function rg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Pn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Re=0;function yE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var vE,sg,_E,xE,wE,Nm=!1,zc=[],ls=null,cs=null,us=null,Sl=new Map,Al=new Map,Yr=[],yN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function d_(t,e){switch(t){case"focusin":case"focusout":ls=null;break;case"dragenter":case"dragleave":cs=null;break;case"mouseover":case"mouseout":us=null;break;case"pointerover":case"pointerout":Sl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Al.delete(e.pointerId)}}function ba(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=sc(e),e!==null&&sg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function vN(t,e,n,r,s){switch(e){case"focusin":return ls=ba(ls,t,e,n,r,s),!0;case"dragenter":return cs=ba(cs,t,e,n,r,s),!0;case"mouseover":return us=ba(us,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Sl.set(i,ba(Sl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Al.set(i,ba(Al.get(i)||null,t,e,n,r,s)),!0}return!1}function EE(t){var e=ti(t.target);if(e!==null){var n=Ri(e);if(n!==null){if(e=n.tag,e===13){if(e=uE(n),e!==null){t.blockedOn=e,wE(t.priority,function(){_E(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function pu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Cm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Im=r,n.target.dispatchEvent(r),Im=null}else return e=sc(n),e!==null&&sg(e),t.blockedOn=n,!1;e.shift()}return!0}function h_(t,e,n){pu(t)&&n.delete(e)}function _N(){Nm=!1,ls!==null&&pu(ls)&&(ls=null),cs!==null&&pu(cs)&&(cs=null),us!==null&&pu(us)&&(us=null),Sl.forEach(h_),Al.forEach(h_)}function Sa(t,e){t.blockedOn===e&&(t.blockedOn=null,Nm||(Nm=!0,hn.unstable_scheduleCallback(hn.unstable_NormalPriority,_N)))}function Nl(t){function e(s){return Sa(s,t)}if(0<zc.length){Sa(zc[0],t);for(var n=1;n<zc.length;n++){var r=zc[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ls!==null&&Sa(ls,t),cs!==null&&Sa(cs,t),us!==null&&Sa(us,t),Sl.forEach(e),Al.forEach(e),n=0;n<Yr.length;n++)r=Yr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Yr.length&&(n=Yr[0],n.blockedOn===null);)EE(n),n.blockedOn===null&&Yr.shift()}var go=Rr.ReactCurrentBatchConfig,Ku=!0;function xN(t,e,n,r){var s=Re,i=go.transition;go.transition=null;try{Re=1,ig(t,e,n,r)}finally{Re=s,go.transition=i}}function wN(t,e,n,r){var s=Re,i=go.transition;go.transition=null;try{Re=4,ig(t,e,n,r)}finally{Re=s,go.transition=i}}function ig(t,e,n,r){if(Ku){var s=Cm(t,e,n,r);if(s===null)If(t,e,r,Wu,n),d_(t,r);else if(vN(s,t,e,n,r))r.stopPropagation();else if(d_(t,r),e&4&&-1<yN.indexOf(t)){for(;s!==null;){var i=sc(s);if(i!==null&&vE(i),i=Cm(t,e,n,r),i===null&&If(t,e,r,Wu,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else If(t,e,r,null,n)}}var Wu=null;function Cm(t,e,n,r){if(Wu=null,t=tg(r),t=ti(t),t!==null)if(e=Ri(t),e===null)t=null;else if(n=e.tag,n===13){if(t=uE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Wu=t,null}function IE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lN()){case ng:return 1;case mE:return 4;case Hu:case cN:return 16;case pE:return 536870912;default:return 16}default:return 16}}var is=null,og=null,gu=null;function TE(){if(gu)return gu;var t,e=og,n=e.length,r,s="value"in is?is.value:is.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return gu=s.slice(t,1<r?1-r:void 0)}function yu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Bc(){return!0}function f_(){return!1}function pn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Bc:f_,this.isPropagationStopped=f_,this}return We(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Bc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Bc)},persist:function(){},isPersistent:Bc}),e}var ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ag=pn(ea),rc=We({},ea,{view:0,detail:0}),EN=pn(rc),mf,pf,Aa,Kd=We({},rc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Aa&&(Aa&&t.type==="mousemove"?(mf=t.screenX-Aa.screenX,pf=t.screenY-Aa.screenY):pf=mf=0,Aa=t),mf)},movementY:function(t){return"movementY"in t?t.movementY:pf}}),m_=pn(Kd),IN=We({},Kd,{dataTransfer:0}),TN=pn(IN),bN=We({},rc,{relatedTarget:0}),gf=pn(bN),SN=We({},ea,{animationName:0,elapsedTime:0,pseudoElement:0}),AN=pn(SN),NN=We({},ea,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),CN=pn(NN),kN=We({},ea,{data:0}),p_=pn(kN),RN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},PN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},DN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=DN[t])?!!e[t]:!1}function lg(){return jN}var VN=We({},rc,{key:function(t){if(t.key){var e=RN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=yu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?PN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lg,charCode:function(t){return t.type==="keypress"?yu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?yu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ON=pn(VN),MN=We({},Kd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),g_=pn(MN),LN=We({},rc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lg}),FN=pn(LN),UN=We({},ea,{propertyName:0,elapsedTime:0,pseudoElement:0}),zN=pn(UN),BN=We({},Kd,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),$N=pn(BN),qN=[9,13,27,32],cg=vr&&"CompositionEvent"in window,nl=null;vr&&"documentMode"in document&&(nl=document.documentMode);var HN=vr&&"TextEvent"in window&&!nl,bE=vr&&(!cg||nl&&8<nl&&11>=nl),y_=" ",v_=!1;function SE(t,e){switch(t){case"keyup":return qN.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function AE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var to=!1;function GN(t,e){switch(t){case"compositionend":return AE(e);case"keypress":return e.which!==32?null:(v_=!0,y_);case"textInput":return t=e.data,t===y_&&v_?null:t;default:return null}}function KN(t,e){if(to)return t==="compositionend"||!cg&&SE(t,e)?(t=TE(),gu=og=is=null,to=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return bE&&e.locale!=="ko"?null:e.data;default:return null}}var WN={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function __(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!WN[t.type]:e==="textarea"}function NE(t,e,n,r){iE(r),e=Qu(e,"onChange"),0<e.length&&(n=new ag("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var rl=null,Cl=null;function QN(t){FE(t,0)}function Wd(t){var e=so(t);if(Xw(e))return t}function YN(t,e){if(t==="change")return e}var CE=!1;if(vr){var yf;if(vr){var vf="oninput"in document;if(!vf){var x_=document.createElement("div");x_.setAttribute("oninput","return;"),vf=typeof x_.oninput=="function"}yf=vf}else yf=!1;CE=yf&&(!document.documentMode||9<document.documentMode)}function w_(){rl&&(rl.detachEvent("onpropertychange",kE),Cl=rl=null)}function kE(t){if(t.propertyName==="value"&&Wd(Cl)){var e=[];NE(e,Cl,t,tg(t)),cE(QN,e)}}function JN(t,e,n){t==="focusin"?(w_(),rl=e,Cl=n,rl.attachEvent("onpropertychange",kE)):t==="focusout"&&w_()}function XN(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Wd(Cl)}function ZN(t,e){if(t==="click")return Wd(e)}function eC(t,e){if(t==="input"||t==="change")return Wd(e)}function tC(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Vn=typeof Object.is=="function"?Object.is:tC;function kl(t,e){if(Vn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!dm.call(e,s)||!Vn(t[s],e[s]))return!1}return!0}function E_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function I_(t,e){var n=E_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=E_(n)}}function RE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?RE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function PE(){for(var t=window,e=Bu();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Bu(t.document)}return e}function ug(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function nC(t){var e=PE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&RE(n.ownerDocument.documentElement,n)){if(r!==null&&ug(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=I_(n,i);var o=I_(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var rC=vr&&"documentMode"in document&&11>=document.documentMode,no=null,km=null,sl=null,Rm=!1;function T_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Rm||no==null||no!==Bu(r)||(r=no,"selectionStart"in r&&ug(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),sl&&kl(sl,r)||(sl=r,r=Qu(km,"onSelect"),0<r.length&&(e=new ag("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=no)))}function $c(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ro={animationend:$c("Animation","AnimationEnd"),animationiteration:$c("Animation","AnimationIteration"),animationstart:$c("Animation","AnimationStart"),transitionend:$c("Transition","TransitionEnd")},_f={},DE={};vr&&(DE=document.createElement("div").style,"AnimationEvent"in window||(delete ro.animationend.animation,delete ro.animationiteration.animation,delete ro.animationstart.animation),"TransitionEvent"in window||delete ro.transitionend.transition);function Qd(t){if(_f[t])return _f[t];if(!ro[t])return t;var e=ro[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in DE)return _f[t]=e[n];return t}var jE=Qd("animationend"),VE=Qd("animationiteration"),OE=Qd("animationstart"),ME=Qd("transitionend"),LE=new Map,b_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ks(t,e){LE.set(t,e),ki(e,[t])}for(var xf=0;xf<b_.length;xf++){var wf=b_[xf],sC=wf.toLowerCase(),iC=wf[0].toUpperCase()+wf.slice(1);ks(sC,"on"+iC)}ks(jE,"onAnimationEnd");ks(VE,"onAnimationIteration");ks(OE,"onAnimationStart");ks("dblclick","onDoubleClick");ks("focusin","onFocus");ks("focusout","onBlur");ks(ME,"onTransitionEnd");To("onMouseEnter",["mouseout","mouseover"]);To("onMouseLeave",["mouseout","mouseover"]);To("onPointerEnter",["pointerout","pointerover"]);To("onPointerLeave",["pointerout","pointerover"]);ki("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ki("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ki("onBeforeInput",["compositionend","keypress","textInput","paste"]);ki("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ki("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ki("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ha="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oC=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ha));function S_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,sN(r,e,void 0,t),t.currentTarget=null}function FE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,d=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;S_(s,a,d),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,d=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;S_(s,a,d),i=c}}}if(qu)throw t=Sm,qu=!1,Sm=null,t}function ze(t,e){var n=e[Om];n===void 0&&(n=e[Om]=new Set);var r=t+"__bubble";n.has(r)||(UE(e,t,2,!1),n.add(r))}function Ef(t,e,n){var r=0;e&&(r|=4),UE(n,t,r,e)}var qc="_reactListening"+Math.random().toString(36).slice(2);function Rl(t){if(!t[qc]){t[qc]=!0,Kw.forEach(function(n){n!=="selectionchange"&&(oC.has(n)||Ef(n,!1,t),Ef(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[qc]||(e[qc]=!0,Ef("selectionchange",!1,e))}}function UE(t,e,n,r){switch(IE(e)){case 1:var s=xN;break;case 4:s=wN;break;default:s=ig}n=s.bind(null,e,n,t),s=void 0,!bm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function If(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ti(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}cE(function(){var d=i,h=tg(n),m=[];e:{var g=LE.get(t);if(g!==void 0){var x=ag,A=t;switch(t){case"keypress":if(yu(n)===0)break e;case"keydown":case"keyup":x=ON;break;case"focusin":A="focus",x=gf;break;case"focusout":A="blur",x=gf;break;case"beforeblur":case"afterblur":x=gf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=m_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=TN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=FN;break;case jE:case VE:case OE:x=AN;break;case ME:x=zN;break;case"scroll":x=EN;break;case"wheel":x=$N;break;case"copy":case"cut":case"paste":x=CN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=g_}var C=(e&4)!==0,R=!C&&t==="scroll",I=C?g!==null?g+"Capture":null:g;C=[];for(var v=d,T;v!==null;){T=v;var D=T.stateNode;if(T.tag===5&&D!==null&&(T=D,I!==null&&(D=bl(v,I),D!=null&&C.push(Pl(v,D,T)))),R)break;v=v.return}0<C.length&&(g=new x(g,A,null,n,h),m.push({event:g,listeners:C}))}}if(!(e&7)){e:{if(g=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",g&&n!==Im&&(A=n.relatedTarget||n.fromElement)&&(ti(A)||A[_r]))break e;if((x||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,x?(A=n.relatedTarget||n.toElement,x=d,A=A?ti(A):null,A!==null&&(R=Ri(A),A!==R||A.tag!==5&&A.tag!==6)&&(A=null)):(x=null,A=d),x!==A)){if(C=m_,D="onMouseLeave",I="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(C=g_,D="onPointerLeave",I="onPointerEnter",v="pointer"),R=x==null?g:so(x),T=A==null?g:so(A),g=new C(D,v+"leave",x,n,h),g.target=R,g.relatedTarget=T,D=null,ti(h)===d&&(C=new C(I,v+"enter",A,n,h),C.target=T,C.relatedTarget=R,D=C),R=D,x&&A)t:{for(C=x,I=A,v=0,T=C;T;T=zi(T))v++;for(T=0,D=I;D;D=zi(D))T++;for(;0<v-T;)C=zi(C),v--;for(;0<T-v;)I=zi(I),T--;for(;v--;){if(C===I||I!==null&&C===I.alternate)break t;C=zi(C),I=zi(I)}C=null}else C=null;x!==null&&A_(m,g,x,C,!1),A!==null&&R!==null&&A_(m,R,A,C,!0)}}e:{if(g=d?so(d):window,x=g.nodeName&&g.nodeName.toLowerCase(),x==="select"||x==="input"&&g.type==="file")var O=YN;else if(__(g))if(CE)O=eC;else{O=XN;var U=JN}else(x=g.nodeName)&&x.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(O=ZN);if(O&&(O=O(t,d))){NE(m,O,n,h);break e}U&&U(t,g,d),t==="focusout"&&(U=g._wrapperState)&&U.controlled&&g.type==="number"&&vm(g,"number",g.value)}switch(U=d?so(d):window,t){case"focusin":(__(U)||U.contentEditable==="true")&&(no=U,km=d,sl=null);break;case"focusout":sl=km=no=null;break;case"mousedown":Rm=!0;break;case"contextmenu":case"mouseup":case"dragend":Rm=!1,T_(m,n,h);break;case"selectionchange":if(rC)break;case"keydown":case"keyup":T_(m,n,h)}var E;if(cg)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else to?SE(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(bE&&n.locale!=="ko"&&(to||y!=="onCompositionStart"?y==="onCompositionEnd"&&to&&(E=TE()):(is=h,og="value"in is?is.value:is.textContent,to=!0)),U=Qu(d,y),0<U.length&&(y=new p_(y,t,null,n,h),m.push({event:y,listeners:U}),E?y.data=E:(E=AE(n),E!==null&&(y.data=E)))),(E=HN?GN(t,n):KN(t,n))&&(d=Qu(d,"onBeforeInput"),0<d.length&&(h=new p_("onBeforeInput","beforeinput",null,n,h),m.push({event:h,listeners:d}),h.data=E))}FE(m,e)})}function Pl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Qu(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=bl(t,n),i!=null&&r.unshift(Pl(t,i,s)),i=bl(t,e),i!=null&&r.push(Pl(t,i,s))),t=t.return}return r}function zi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function A_(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,d=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&d!==null&&(a=d,s?(c=bl(n,i),c!=null&&o.unshift(Pl(n,c,a))):s||(c=bl(n,i),c!=null&&o.push(Pl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var aC=/\r\n?/g,lC=/\u0000|\uFFFD/g;function N_(t){return(typeof t=="string"?t:""+t).replace(aC,`
`).replace(lC,"")}function Hc(t,e,n){if(e=N_(e),N_(t)!==e&&n)throw Error(H(425))}function Yu(){}var Pm=null,Dm=null;function jm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Vm=typeof setTimeout=="function"?setTimeout:void 0,cC=typeof clearTimeout=="function"?clearTimeout:void 0,C_=typeof Promise=="function"?Promise:void 0,uC=typeof queueMicrotask=="function"?queueMicrotask:typeof C_<"u"?function(t){return C_.resolve(null).then(t).catch(dC)}:Vm;function dC(t){setTimeout(function(){throw t})}function Tf(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Nl(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Nl(e)}function ds(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function k_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ta=Math.random().toString(36).slice(2),Kn="__reactFiber$"+ta,Dl="__reactProps$"+ta,_r="__reactContainer$"+ta,Om="__reactEvents$"+ta,hC="__reactListeners$"+ta,fC="__reactHandles$"+ta;function ti(t){var e=t[Kn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[_r]||n[Kn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=k_(t);t!==null;){if(n=t[Kn])return n;t=k_(t)}return e}t=n,n=t.parentNode}return null}function sc(t){return t=t[Kn]||t[_r],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function so(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(H(33))}function Yd(t){return t[Dl]||null}var Mm=[],io=-1;function Rs(t){return{current:t}}function Be(t){0>io||(t.current=Mm[io],Mm[io]=null,io--)}function Me(t,e){io++,Mm[io]=t.current,t.current=e}var Es={},Mt=Rs(Es),Xt=Rs(!1),fi=Es;function bo(t,e){var n=t.type.contextTypes;if(!n)return Es;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Zt(t){return t=t.childContextTypes,t!=null}function Ju(){Be(Xt),Be(Mt)}function R_(t,e,n){if(Mt.current!==Es)throw Error(H(168));Me(Mt,e),Me(Xt,n)}function zE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(H(108,JA(t)||"Unknown",s));return We({},n,r)}function Xu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Es,fi=Mt.current,Me(Mt,t),Me(Xt,Xt.current),!0}function P_(t,e,n){var r=t.stateNode;if(!r)throw Error(H(169));n?(t=zE(t,e,fi),r.__reactInternalMemoizedMergedChildContext=t,Be(Xt),Be(Mt),Me(Mt,t)):Be(Xt),Me(Xt,n)}var ur=null,Jd=!1,bf=!1;function BE(t){ur===null?ur=[t]:ur.push(t)}function mC(t){Jd=!0,BE(t)}function Ps(){if(!bf&&ur!==null){bf=!0;var t=0,e=Re;try{var n=ur;for(Re=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ur=null,Jd=!1}catch(s){throw ur!==null&&(ur=ur.slice(t+1)),fE(ng,Ps),s}finally{Re=e,bf=!1}}return null}var oo=[],ao=0,Zu=null,ed=0,yn=[],vn=0,mi=null,dr=1,hr="";function Gs(t,e){oo[ao++]=ed,oo[ao++]=Zu,Zu=t,ed=e}function $E(t,e,n){yn[vn++]=dr,yn[vn++]=hr,yn[vn++]=mi,mi=t;var r=dr;t=hr;var s=32-Pn(r)-1;r&=~(1<<s),n+=1;var i=32-Pn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,dr=1<<32-Pn(e)+s|n<<s|r,hr=i+t}else dr=1<<i|n<<s|r,hr=t}function dg(t){t.return!==null&&(Gs(t,1),$E(t,1,0))}function hg(t){for(;t===Zu;)Zu=oo[--ao],oo[ao]=null,ed=oo[--ao],oo[ao]=null;for(;t===mi;)mi=yn[--vn],yn[vn]=null,hr=yn[--vn],yn[vn]=null,dr=yn[--vn],yn[vn]=null}var cn=null,sn=null,qe=!1,kn=null;function qE(t,e){var n=xn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function D_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,cn=t,sn=ds(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,cn=t,sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=mi!==null?{id:dr,overflow:hr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=xn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,cn=t,sn=null,!0):!1;default:return!1}}function Lm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Fm(t){if(qe){var e=sn;if(e){var n=e;if(!D_(t,e)){if(Lm(t))throw Error(H(418));e=ds(n.nextSibling);var r=cn;e&&D_(t,e)?qE(r,n):(t.flags=t.flags&-4097|2,qe=!1,cn=t)}}else{if(Lm(t))throw Error(H(418));t.flags=t.flags&-4097|2,qe=!1,cn=t}}}function j_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;cn=t}function Gc(t){if(t!==cn)return!1;if(!qe)return j_(t),qe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!jm(t.type,t.memoizedProps)),e&&(e=sn)){if(Lm(t))throw HE(),Error(H(418));for(;e;)qE(t,e),e=ds(e.nextSibling)}if(j_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(H(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){sn=ds(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}sn=null}}else sn=cn?ds(t.stateNode.nextSibling):null;return!0}function HE(){for(var t=sn;t;)t=ds(t.nextSibling)}function So(){sn=cn=null,qe=!1}function fg(t){kn===null?kn=[t]:kn.push(t)}var pC=Rr.ReactCurrentBatchConfig;function Na(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(H(309));var r=n.stateNode}if(!r)throw Error(H(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(H(284));if(!n._owner)throw Error(H(290,t))}return t}function Kc(t,e){throw t=Object.prototype.toString.call(e),Error(H(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function V_(t){var e=t._init;return e(t._payload)}function GE(t){function e(I,v){if(t){var T=I.deletions;T===null?(I.deletions=[v],I.flags|=16):T.push(v)}}function n(I,v){if(!t)return null;for(;v!==null;)e(I,v),v=v.sibling;return null}function r(I,v){for(I=new Map;v!==null;)v.key!==null?I.set(v.key,v):I.set(v.index,v),v=v.sibling;return I}function s(I,v){return I=ps(I,v),I.index=0,I.sibling=null,I}function i(I,v,T){return I.index=T,t?(T=I.alternate,T!==null?(T=T.index,T<v?(I.flags|=2,v):T):(I.flags|=2,v)):(I.flags|=1048576,v)}function o(I){return t&&I.alternate===null&&(I.flags|=2),I}function a(I,v,T,D){return v===null||v.tag!==6?(v=Pf(T,I.mode,D),v.return=I,v):(v=s(v,T),v.return=I,v)}function c(I,v,T,D){var O=T.type;return O===eo?h(I,v,T.props.children,D,T.key):v!==null&&(v.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Wr&&V_(O)===v.type)?(D=s(v,T.props),D.ref=Na(I,v,T),D.return=I,D):(D=Tu(T.type,T.key,T.props,null,I.mode,D),D.ref=Na(I,v,T),D.return=I,D)}function d(I,v,T,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==T.containerInfo||v.stateNode.implementation!==T.implementation?(v=Df(T,I.mode,D),v.return=I,v):(v=s(v,T.children||[]),v.return=I,v)}function h(I,v,T,D,O){return v===null||v.tag!==7?(v=oi(T,I.mode,D,O),v.return=I,v):(v=s(v,T),v.return=I,v)}function m(I,v,T){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Pf(""+v,I.mode,T),v.return=I,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Oc:return T=Tu(v.type,v.key,v.props,null,I.mode,T),T.ref=Na(I,null,v),T.return=I,T;case Zi:return v=Df(v,I.mode,T),v.return=I,v;case Wr:var D=v._init;return m(I,D(v._payload),T)}if($a(v)||Ia(v))return v=oi(v,I.mode,T,null),v.return=I,v;Kc(I,v)}return null}function g(I,v,T,D){var O=v!==null?v.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return O!==null?null:a(I,v,""+T,D);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Oc:return T.key===O?c(I,v,T,D):null;case Zi:return T.key===O?d(I,v,T,D):null;case Wr:return O=T._init,g(I,v,O(T._payload),D)}if($a(T)||Ia(T))return O!==null?null:h(I,v,T,D,null);Kc(I,T)}return null}function x(I,v,T,D,O){if(typeof D=="string"&&D!==""||typeof D=="number")return I=I.get(T)||null,a(v,I,""+D,O);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Oc:return I=I.get(D.key===null?T:D.key)||null,c(v,I,D,O);case Zi:return I=I.get(D.key===null?T:D.key)||null,d(v,I,D,O);case Wr:var U=D._init;return x(I,v,T,U(D._payload),O)}if($a(D)||Ia(D))return I=I.get(T)||null,h(v,I,D,O,null);Kc(v,D)}return null}function A(I,v,T,D){for(var O=null,U=null,E=v,y=v=0,S=null;E!==null&&y<T.length;y++){E.index>y?(S=E,E=null):S=E.sibling;var N=g(I,E,T[y],D);if(N===null){E===null&&(E=S);break}t&&E&&N.alternate===null&&e(I,E),v=i(N,v,y),U===null?O=N:U.sibling=N,U=N,E=S}if(y===T.length)return n(I,E),qe&&Gs(I,y),O;if(E===null){for(;y<T.length;y++)E=m(I,T[y],D),E!==null&&(v=i(E,v,y),U===null?O=E:U.sibling=E,U=E);return qe&&Gs(I,y),O}for(E=r(I,E);y<T.length;y++)S=x(E,I,y,T[y],D),S!==null&&(t&&S.alternate!==null&&E.delete(S.key===null?y:S.key),v=i(S,v,y),U===null?O=S:U.sibling=S,U=S);return t&&E.forEach(function(w){return e(I,w)}),qe&&Gs(I,y),O}function C(I,v,T,D){var O=Ia(T);if(typeof O!="function")throw Error(H(150));if(T=O.call(T),T==null)throw Error(H(151));for(var U=O=null,E=v,y=v=0,S=null,N=T.next();E!==null&&!N.done;y++,N=T.next()){E.index>y?(S=E,E=null):S=E.sibling;var w=g(I,E,N.value,D);if(w===null){E===null&&(E=S);break}t&&E&&w.alternate===null&&e(I,E),v=i(w,v,y),U===null?O=w:U.sibling=w,U=w,E=S}if(N.done)return n(I,E),qe&&Gs(I,y),O;if(E===null){for(;!N.done;y++,N=T.next())N=m(I,N.value,D),N!==null&&(v=i(N,v,y),U===null?O=N:U.sibling=N,U=N);return qe&&Gs(I,y),O}for(E=r(I,E);!N.done;y++,N=T.next())N=x(E,I,y,N.value,D),N!==null&&(t&&N.alternate!==null&&E.delete(N.key===null?y:N.key),v=i(N,v,y),U===null?O=N:U.sibling=N,U=N);return t&&E.forEach(function(k){return e(I,k)}),qe&&Gs(I,y),O}function R(I,v,T,D){if(typeof T=="object"&&T!==null&&T.type===eo&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Oc:e:{for(var O=T.key,U=v;U!==null;){if(U.key===O){if(O=T.type,O===eo){if(U.tag===7){n(I,U.sibling),v=s(U,T.props.children),v.return=I,I=v;break e}}else if(U.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Wr&&V_(O)===U.type){n(I,U.sibling),v=s(U,T.props),v.ref=Na(I,U,T),v.return=I,I=v;break e}n(I,U);break}else e(I,U);U=U.sibling}T.type===eo?(v=oi(T.props.children,I.mode,D,T.key),v.return=I,I=v):(D=Tu(T.type,T.key,T.props,null,I.mode,D),D.ref=Na(I,v,T),D.return=I,I=D)}return o(I);case Zi:e:{for(U=T.key;v!==null;){if(v.key===U)if(v.tag===4&&v.stateNode.containerInfo===T.containerInfo&&v.stateNode.implementation===T.implementation){n(I,v.sibling),v=s(v,T.children||[]),v.return=I,I=v;break e}else{n(I,v);break}else e(I,v);v=v.sibling}v=Df(T,I.mode,D),v.return=I,I=v}return o(I);case Wr:return U=T._init,R(I,v,U(T._payload),D)}if($a(T))return A(I,v,T,D);if(Ia(T))return C(I,v,T,D);Kc(I,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,v!==null&&v.tag===6?(n(I,v.sibling),v=s(v,T),v.return=I,I=v):(n(I,v),v=Pf(T,I.mode,D),v.return=I,I=v),o(I)):n(I,v)}return R}var Ao=GE(!0),KE=GE(!1),td=Rs(null),nd=null,lo=null,mg=null;function pg(){mg=lo=nd=null}function gg(t){var e=td.current;Be(td),t._currentValue=e}function Um(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function yo(t,e){nd=t,mg=lo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wt=!0),t.firstContext=null)}function Tn(t){var e=t._currentValue;if(mg!==t)if(t={context:t,memoizedValue:e,next:null},lo===null){if(nd===null)throw Error(H(308));lo=t,nd.dependencies={lanes:0,firstContext:t}}else lo=lo.next=t;return e}var ni=null;function yg(t){ni===null?ni=[t]:ni.push(t)}function WE(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,yg(e)):(n.next=s.next,s.next=n),e.interleaved=n,xr(t,r)}function xr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Qr=!1;function vg(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function QE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function gr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function hs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,be&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,xr(t,n)}return s=r.interleaved,s===null?(e.next=e,yg(r)):(e.next=s.next,s.next=e),r.interleaved=e,xr(t,n)}function vu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rg(t,n)}}function O_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function rd(t,e,n,r){var s=t.updateQueue;Qr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=d:a.next=d,h.lastBaseUpdate=c))}if(i!==null){var m=s.baseState;o=0,h=d=c=null,a=i;do{var g=a.lane,x=a.eventTime;if((r&g)===g){h!==null&&(h=h.next={eventTime:x,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var A=t,C=a;switch(g=e,x=n,C.tag){case 1:if(A=C.payload,typeof A=="function"){m=A.call(x,m,g);break e}m=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=C.payload,g=typeof A=="function"?A.call(x,m,g):A,g==null)break e;m=We({},m,g);break e;case 2:Qr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,g=s.effects,g===null?s.effects=[a]:g.push(a))}else x={eventTime:x,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(d=h=x,c=m):h=h.next=x,o|=g;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;g=a,a=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(h===null&&(c=m),s.baseState=c,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);gi|=o,t.lanes=o,t.memoizedState=m}}function M_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(H(191,s));s.call(r)}}}var ic={},Zn=Rs(ic),jl=Rs(ic),Vl=Rs(ic);function ri(t){if(t===ic)throw Error(H(174));return t}function _g(t,e){switch(Me(Vl,e),Me(jl,t),Me(Zn,ic),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:xm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=xm(e,t)}Be(Zn),Me(Zn,e)}function No(){Be(Zn),Be(jl),Be(Vl)}function YE(t){ri(Vl.current);var e=ri(Zn.current),n=xm(e,t.type);e!==n&&(Me(jl,t),Me(Zn,n))}function xg(t){jl.current===t&&(Be(Zn),Be(jl))}var He=Rs(0);function sd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Sf=[];function wg(){for(var t=0;t<Sf.length;t++)Sf[t]._workInProgressVersionPrimary=null;Sf.length=0}var _u=Rr.ReactCurrentDispatcher,Af=Rr.ReactCurrentBatchConfig,pi=0,Ke=null,ct=null,_t=null,id=!1,il=!1,Ol=0,gC=0;function At(){throw Error(H(321))}function Eg(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Vn(t[n],e[n]))return!1;return!0}function Ig(t,e,n,r,s,i){if(pi=i,Ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,_u.current=t===null||t.memoizedState===null?xC:wC,t=n(r,s),il){i=0;do{if(il=!1,Ol=0,25<=i)throw Error(H(301));i+=1,_t=ct=null,e.updateQueue=null,_u.current=EC,t=n(r,s)}while(il)}if(_u.current=od,e=ct!==null&&ct.next!==null,pi=0,_t=ct=Ke=null,id=!1,e)throw Error(H(300));return t}function Tg(){var t=Ol!==0;return Ol=0,t}function qn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _t===null?Ke.memoizedState=_t=t:_t=_t.next=t,_t}function bn(){if(ct===null){var t=Ke.alternate;t=t!==null?t.memoizedState:null}else t=ct.next;var e=_t===null?Ke.memoizedState:_t.next;if(e!==null)_t=e,ct=t;else{if(t===null)throw Error(H(310));ct=t,t={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},_t===null?Ke.memoizedState=_t=t:_t=_t.next=t}return _t}function Ml(t,e){return typeof e=="function"?e(t):e}function Nf(t){var e=bn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=ct,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,d=i;do{var h=d.lane;if((pi&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var m={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(a=c=m,o=r):c=c.next=m,Ke.lanes|=h,gi|=h}d=d.next}while(d!==null&&d!==i);c===null?o=r:c.next=a,Vn(r,e.memoizedState)||(Wt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ke.lanes|=i,gi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Cf(t){var e=bn(),n=e.queue;if(n===null)throw Error(H(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Vn(i,e.memoizedState)||(Wt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function JE(){}function XE(t,e){var n=Ke,r=bn(),s=e(),i=!Vn(r.memoizedState,s);if(i&&(r.memoizedState=s,Wt=!0),r=r.queue,bg(tI.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||_t!==null&&_t.memoizedState.tag&1){if(n.flags|=2048,Ll(9,eI.bind(null,n,r,s,e),void 0,null),xt===null)throw Error(H(349));pi&30||ZE(n,e,s)}return s}function ZE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function eI(t,e,n,r){e.value=n,e.getSnapshot=r,nI(e)&&rI(t)}function tI(t,e,n){return n(function(){nI(e)&&rI(t)})}function nI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Vn(t,n)}catch{return!0}}function rI(t){var e=xr(t,1);e!==null&&Dn(e,t,1,-1)}function L_(t){var e=qn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ml,lastRenderedState:t},e.queue=t,t=t.dispatch=_C.bind(null,Ke,t),[e.memoizedState,t]}function Ll(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function sI(){return bn().memoizedState}function xu(t,e,n,r){var s=qn();Ke.flags|=t,s.memoizedState=Ll(1|e,n,void 0,r===void 0?null:r)}function Xd(t,e,n,r){var s=bn();r=r===void 0?null:r;var i=void 0;if(ct!==null){var o=ct.memoizedState;if(i=o.destroy,r!==null&&Eg(r,o.deps)){s.memoizedState=Ll(e,n,i,r);return}}Ke.flags|=t,s.memoizedState=Ll(1|e,n,i,r)}function F_(t,e){return xu(8390656,8,t,e)}function bg(t,e){return Xd(2048,8,t,e)}function iI(t,e){return Xd(4,2,t,e)}function oI(t,e){return Xd(4,4,t,e)}function aI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function lI(t,e,n){return n=n!=null?n.concat([t]):null,Xd(4,4,aI.bind(null,e,t),n)}function Sg(){}function cI(t,e){var n=bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Eg(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function uI(t,e){var n=bn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Eg(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function dI(t,e,n){return pi&21?(Vn(n,e)||(n=gE(),Ke.lanes|=n,gi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wt=!0),t.memoizedState=n)}function yC(t,e){var n=Re;Re=n!==0&&4>n?n:4,t(!0);var r=Af.transition;Af.transition={};try{t(!1),e()}finally{Re=n,Af.transition=r}}function hI(){return bn().memoizedState}function vC(t,e,n){var r=ms(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},fI(t))mI(e,n);else if(n=WE(t,e,n,r),n!==null){var s=Bt();Dn(n,t,r,s),pI(n,e,r)}}function _C(t,e,n){var r=ms(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(fI(t))mI(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Vn(a,o)){var c=e.interleaved;c===null?(s.next=s,yg(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=WE(t,e,s,r),n!==null&&(s=Bt(),Dn(n,t,r,s),pI(n,e,r))}}function fI(t){var e=t.alternate;return t===Ke||e!==null&&e===Ke}function mI(t,e){il=id=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function pI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rg(t,n)}}var od={readContext:Tn,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useInsertionEffect:At,useLayoutEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useMutableSource:At,useSyncExternalStore:At,useId:At,unstable_isNewReconciler:!1},xC={readContext:Tn,useCallback:function(t,e){return qn().memoizedState=[t,e===void 0?null:e],t},useContext:Tn,useEffect:F_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,xu(4194308,4,aI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return xu(4194308,4,t,e)},useInsertionEffect:function(t,e){return xu(4,2,t,e)},useMemo:function(t,e){var n=qn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=qn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=vC.bind(null,Ke,t),[r.memoizedState,t]},useRef:function(t){var e=qn();return t={current:t},e.memoizedState=t},useState:L_,useDebugValue:Sg,useDeferredValue:function(t){return qn().memoizedState=t},useTransition:function(){var t=L_(!1),e=t[0];return t=yC.bind(null,t[1]),qn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ke,s=qn();if(qe){if(n===void 0)throw Error(H(407));n=n()}else{if(n=e(),xt===null)throw Error(H(349));pi&30||ZE(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,F_(tI.bind(null,r,i,t),[t]),r.flags|=2048,Ll(9,eI.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=qn(),e=xt.identifierPrefix;if(qe){var n=hr,r=dr;n=(r&~(1<<32-Pn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Ol++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=gC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},wC={readContext:Tn,useCallback:cI,useContext:Tn,useEffect:bg,useImperativeHandle:lI,useInsertionEffect:iI,useLayoutEffect:oI,useMemo:uI,useReducer:Nf,useRef:sI,useState:function(){return Nf(Ml)},useDebugValue:Sg,useDeferredValue:function(t){var e=bn();return dI(e,ct.memoizedState,t)},useTransition:function(){var t=Nf(Ml)[0],e=bn().memoizedState;return[t,e]},useMutableSource:JE,useSyncExternalStore:XE,useId:hI,unstable_isNewReconciler:!1},EC={readContext:Tn,useCallback:cI,useContext:Tn,useEffect:bg,useImperativeHandle:lI,useInsertionEffect:iI,useLayoutEffect:oI,useMemo:uI,useReducer:Cf,useRef:sI,useState:function(){return Cf(Ml)},useDebugValue:Sg,useDeferredValue:function(t){var e=bn();return ct===null?e.memoizedState=t:dI(e,ct.memoizedState,t)},useTransition:function(){var t=Cf(Ml)[0],e=bn().memoizedState;return[t,e]},useMutableSource:JE,useSyncExternalStore:XE,useId:hI,unstable_isNewReconciler:!1};function An(t,e){if(t&&t.defaultProps){e=We({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function zm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:We({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Zd={isMounted:function(t){return(t=t._reactInternals)?Ri(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Bt(),s=ms(t),i=gr(r,s);i.payload=e,n!=null&&(i.callback=n),e=hs(t,i,s),e!==null&&(Dn(e,t,s,r),vu(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Bt(),s=ms(t),i=gr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=hs(t,i,s),e!==null&&(Dn(e,t,s,r),vu(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Bt(),r=ms(t),s=gr(n,r);s.tag=2,e!=null&&(s.callback=e),e=hs(t,s,r),e!==null&&(Dn(e,t,r,n),vu(e,t,r))}};function U_(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!kl(n,r)||!kl(s,i):!0}function gI(t,e,n){var r=!1,s=Es,i=e.contextType;return typeof i=="object"&&i!==null?i=Tn(i):(s=Zt(e)?fi:Mt.current,r=e.contextTypes,i=(r=r!=null)?bo(t,s):Es),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zd,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function z_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Zd.enqueueReplaceState(e,e.state,null)}function Bm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},vg(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Tn(i):(i=Zt(e)?fi:Mt.current,s.context=bo(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(zm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Zd.enqueueReplaceState(s,s.state,null),rd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Co(t,e){try{var n="",r=e;do n+=YA(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function kf(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function $m(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var IC=typeof WeakMap=="function"?WeakMap:Map;function yI(t,e,n){n=gr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ld||(ld=!0,Zm=r),$m(t,e)},n}function vI(t,e,n){n=gr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){$m(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){$m(t,e),typeof r!="function"&&(fs===null?fs=new Set([this]):fs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function B_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new IC;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=MC.bind(null,t,e,n),e.then(t,t))}function $_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function q_(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=gr(-1,1),e.tag=2,hs(n,e,1))),n.lanes|=1),t)}var TC=Rr.ReactCurrentOwner,Wt=!1;function zt(t,e,n,r){e.child=t===null?KE(e,null,n,r):Ao(e,t.child,n,r)}function H_(t,e,n,r,s){n=n.render;var i=e.ref;return yo(e,s),r=Ig(t,e,n,r,i,s),n=Tg(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,wr(t,e,s)):(qe&&n&&dg(e),e.flags|=1,zt(t,e,r,s),e.child)}function G_(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!jg(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,_I(t,e,i,r,s)):(t=Tu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:kl,n(o,r)&&t.ref===e.ref)return wr(t,e,s)}return e.flags|=1,t=ps(i,r),t.ref=e.ref,t.return=e,e.child=t}function _I(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(kl(i,r)&&t.ref===e.ref)if(Wt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Wt=!0);else return e.lanes=t.lanes,wr(t,e,s)}return qm(t,e,n,r,s)}function xI(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Me(uo,nn),nn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Me(uo,nn),nn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Me(uo,nn),nn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Me(uo,nn),nn|=r;return zt(t,e,s,n),e.child}function wI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function qm(t,e,n,r,s){var i=Zt(n)?fi:Mt.current;return i=bo(e,i),yo(e,s),n=Ig(t,e,n,r,i,s),r=Tg(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,wr(t,e,s)):(qe&&r&&dg(e),e.flags|=1,zt(t,e,n,s),e.child)}function K_(t,e,n,r,s){if(Zt(n)){var i=!0;Xu(e)}else i=!1;if(yo(e,s),e.stateNode===null)wu(t,e),gI(e,n,r),Bm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Tn(d):(d=Zt(n)?fi:Mt.current,d=bo(e,d));var h=n.getDerivedStateFromProps,m=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";m||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==d)&&z_(e,o,r,d),Qr=!1;var g=e.memoizedState;o.state=g,rd(e,r,o,s),c=e.memoizedState,a!==r||g!==c||Xt.current||Qr?(typeof h=="function"&&(zm(e,n,h,r),c=e.memoizedState),(a=Qr||U_(e,n,a,r,g,c,d))?(m||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=d,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,QE(t,e),a=e.memoizedProps,d=e.type===e.elementType?a:An(e.type,a),o.props=d,m=e.pendingProps,g=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Tn(c):(c=Zt(n)?fi:Mt.current,c=bo(e,c));var x=n.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==m||g!==c)&&z_(e,o,r,c),Qr=!1,g=e.memoizedState,o.state=g,rd(e,r,o,s);var A=e.memoizedState;a!==m||g!==A||Xt.current||Qr?(typeof x=="function"&&(zm(e,n,x,r),A=e.memoizedState),(d=Qr||U_(e,n,d,r,g,A,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,A,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,A,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=A),o.props=r,o.state=A,o.context=c,r=d):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&g===t.memoizedState||(e.flags|=1024),r=!1)}return Hm(t,e,n,r,i,s)}function Hm(t,e,n,r,s,i){wI(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&P_(e,n,!1),wr(t,e,i);r=e.stateNode,TC.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ao(e,t.child,null,i),e.child=Ao(e,null,a,i)):zt(t,e,a,i),e.memoizedState=r.state,s&&P_(e,n,!0),e.child}function EI(t){var e=t.stateNode;e.pendingContext?R_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&R_(t,e.context,!1),_g(t,e.containerInfo)}function W_(t,e,n,r,s){return So(),fg(s),e.flags|=256,zt(t,e,n,r),e.child}var Gm={dehydrated:null,treeContext:null,retryLane:0};function Km(t){return{baseLanes:t,cachePool:null,transitions:null}}function II(t,e,n){var r=e.pendingProps,s=He.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Me(He,s&1),t===null)return Fm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=nh(o,r,0,null),t=oi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Km(n),e.memoizedState=Gm,t):Ag(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return bC(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ps(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ps(a,i):(i=oi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Km(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Gm,r}return i=t.child,t=i.sibling,r=ps(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ag(t,e){return e=nh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wc(t,e,n,r){return r!==null&&fg(r),Ao(e,t.child,null,n),t=Ag(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bC(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=kf(Error(H(422))),Wc(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=nh({mode:"visible",children:r.children},s,0,null),i=oi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ao(e,t.child,null,o),e.child.memoizedState=Km(o),e.memoizedState=Gm,i);if(!(e.mode&1))return Wc(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(H(419)),r=kf(i,r,void 0),Wc(t,e,o,r)}if(a=(o&t.childLanes)!==0,Wt||a){if(r=xt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,xr(t,s),Dn(r,t,s,-1))}return Dg(),r=kf(Error(H(421))),Wc(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=LC.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,sn=ds(s.nextSibling),cn=e,qe=!0,kn=null,t!==null&&(yn[vn++]=dr,yn[vn++]=hr,yn[vn++]=mi,dr=t.id,hr=t.overflow,mi=e),e=Ag(e,r.children),e.flags|=4096,e)}function Q_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Um(t.return,e,n)}function Rf(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function TI(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(zt(t,e,r.children,n),r=He.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Q_(t,n,e);else if(t.tag===19)Q_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Me(He,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&sd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Rf(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&sd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Rf(e,!0,n,null,i);break;case"together":Rf(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function wu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function wr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),gi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(H(153));if(e.child!==null){for(t=e.child,n=ps(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ps(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function SC(t,e,n){switch(e.tag){case 3:EI(e),So();break;case 5:YE(e);break;case 1:Zt(e.type)&&Xu(e);break;case 4:_g(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Me(td,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Me(He,He.current&1),e.flags|=128,null):n&e.child.childLanes?II(t,e,n):(Me(He,He.current&1),t=wr(t,e,n),t!==null?t.sibling:null);Me(He,He.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return TI(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Me(He,He.current),r)break;return null;case 22:case 23:return e.lanes=0,xI(t,e,n)}return wr(t,e,n)}var bI,Wm,SI,AI;bI=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Wm=function(){};SI=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ri(Zn.current);var i=null;switch(n){case"input":s=gm(t,s),r=gm(t,r),i=[];break;case"select":s=We({},s,{value:void 0}),r=We({},r,{value:void 0}),i=[];break;case"textarea":s=_m(t,s),r=_m(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Yu)}wm(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var a=s[d];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Il.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(a=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&c!==a&&(c!=null||a!=null))if(d==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Il.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ze("scroll",t),i||a===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};AI=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ca(t,e){if(!qe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Nt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function AC(t,e,n){var r=e.pendingProps;switch(hg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(e),null;case 1:return Zt(e.type)&&Ju(),Nt(e),null;case 3:return r=e.stateNode,No(),Be(Xt),Be(Mt),wg(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Gc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,kn!==null&&(np(kn),kn=null))),Wm(t,e),Nt(e),null;case 5:xg(e);var s=ri(Vl.current);if(n=e.type,t!==null&&e.stateNode!=null)SI(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(H(166));return Nt(e),null}if(t=ri(Zn.current),Gc(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Kn]=e,r[Dl]=i,t=(e.mode&1)!==0,n){case"dialog":ze("cancel",r),ze("close",r);break;case"iframe":case"object":case"embed":ze("load",r);break;case"video":case"audio":for(s=0;s<Ha.length;s++)ze(Ha[s],r);break;case"source":ze("error",r);break;case"img":case"image":case"link":ze("error",r),ze("load",r);break;case"details":ze("toggle",r);break;case"input":s_(r,i),ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},ze("invalid",r);break;case"textarea":o_(r,i),ze("invalid",r)}wm(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Hc(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Hc(r.textContent,a,t),s=["children",""+a]):Il.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ze("scroll",r)}switch(n){case"input":Mc(r),i_(r,i,!0);break;case"textarea":Mc(r),a_(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Yu)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=tE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Kn]=e,t[Dl]=r,bI(t,e,!1,!1),e.stateNode=t;e:{switch(o=Em(n,r),n){case"dialog":ze("cancel",t),ze("close",t),s=r;break;case"iframe":case"object":case"embed":ze("load",t),s=r;break;case"video":case"audio":for(s=0;s<Ha.length;s++)ze(Ha[s],t);s=r;break;case"source":ze("error",t),s=r;break;case"img":case"image":case"link":ze("error",t),ze("load",t),s=r;break;case"details":ze("toggle",t),s=r;break;case"input":s_(t,r),s=gm(t,r),ze("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=We({},r,{value:void 0}),ze("invalid",t);break;case"textarea":o_(t,r),s=_m(t,r),ze("invalid",t);break;default:s=r}wm(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?sE(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&nE(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Tl(t,c):typeof c=="number"&&Tl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Il.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ze("scroll",t):c!=null&&Jp(t,i,c,o))}switch(n){case"input":Mc(t),i_(t,r,!1);break;case"textarea":Mc(t),a_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ws(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?fo(t,!!r.multiple,i,!1):r.defaultValue!=null&&fo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Yu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Nt(e),null;case 6:if(t&&e.stateNode!=null)AI(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(H(166));if(n=ri(Vl.current),ri(Zn.current),Gc(e)){if(r=e.stateNode,n=e.memoizedProps,r[Kn]=e,(i=r.nodeValue!==n)&&(t=cn,t!==null))switch(t.tag){case 3:Hc(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Hc(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Kn]=e,e.stateNode=r}return Nt(e),null;case 13:if(Be(He),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(qe&&sn!==null&&e.mode&1&&!(e.flags&128))HE(),So(),e.flags|=98560,i=!1;else if(i=Gc(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(H(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(H(317));i[Kn]=e}else So(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Nt(e),i=!1}else kn!==null&&(np(kn),kn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||He.current&1?dt===0&&(dt=3):Dg())),e.updateQueue!==null&&(e.flags|=4),Nt(e),null);case 4:return No(),Wm(t,e),t===null&&Rl(e.stateNode.containerInfo),Nt(e),null;case 10:return gg(e.type._context),Nt(e),null;case 17:return Zt(e.type)&&Ju(),Nt(e),null;case 19:if(Be(He),i=e.memoizedState,i===null)return Nt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ca(i,!1);else{if(dt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=sd(t),o!==null){for(e.flags|=128,Ca(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Me(He,He.current&1|2),e.child}t=t.sibling}i.tail!==null&&tt()>ko&&(e.flags|=128,r=!0,Ca(i,!1),e.lanes=4194304)}else{if(!r)if(t=sd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ca(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!qe)return Nt(e),null}else 2*tt()-i.renderingStartTime>ko&&n!==1073741824&&(e.flags|=128,r=!0,Ca(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=tt(),e.sibling=null,n=He.current,Me(He,r?n&1|2:n&1),e):(Nt(e),null);case 22:case 23:return Pg(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?nn&1073741824&&(Nt(e),e.subtreeFlags&6&&(e.flags|=8192)):Nt(e),null;case 24:return null;case 25:return null}throw Error(H(156,e.tag))}function NC(t,e){switch(hg(e),e.tag){case 1:return Zt(e.type)&&Ju(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return No(),Be(Xt),Be(Mt),wg(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return xg(e),null;case 13:if(Be(He),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(H(340));So()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Be(He),null;case 4:return No(),null;case 10:return gg(e.type._context),null;case 22:case 23:return Pg(),null;case 24:return null;default:return null}}var Qc=!1,Pt=!1,CC=typeof WeakSet=="function"?WeakSet:Set,ne=null;function co(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ye(t,e,r)}else n.current=null}function Qm(t,e,n){try{n()}catch(r){Ye(t,e,r)}}var Y_=!1;function kC(t,e){if(Pm=Ku,t=PE(),ug(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,d=0,h=0,m=t,g=null;t:for(;;){for(var x;m!==n||s!==0&&m.nodeType!==3||(a=o+s),m!==i||r!==0&&m.nodeType!==3||(c=o+r),m.nodeType===3&&(o+=m.nodeValue.length),(x=m.firstChild)!==null;)g=m,m=x;for(;;){if(m===t)break t;if(g===n&&++d===s&&(a=o),g===i&&++h===r&&(c=o),(x=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=x}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dm={focusedElem:t,selectionRange:n},Ku=!1,ne=e;ne!==null;)if(e=ne,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ne=t;else for(;ne!==null;){e=ne;try{var A=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var C=A.memoizedProps,R=A.memoizedState,I=e.stateNode,v=I.getSnapshotBeforeUpdate(e.elementType===e.type?C:An(e.type,C),R);I.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(H(163))}}catch(D){Ye(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,ne=t;break}ne=e.return}return A=Y_,Y_=!1,A}function ol(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Qm(e,n,i)}s=s.next}while(s!==r)}}function eh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ym(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function NI(t){var e=t.alternate;e!==null&&(t.alternate=null,NI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Kn],delete e[Dl],delete e[Om],delete e[hC],delete e[fC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function CI(t){return t.tag===5||t.tag===3||t.tag===4}function J_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||CI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Jm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Yu));else if(r!==4&&(t=t.child,t!==null))for(Jm(t,e,n),t=t.sibling;t!==null;)Jm(t,e,n),t=t.sibling}function Xm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Xm(t,e,n),t=t.sibling;t!==null;)Xm(t,e,n),t=t.sibling}var wt=null,Nn=!1;function $r(t,e,n){for(n=n.child;n!==null;)kI(t,e,n),n=n.sibling}function kI(t,e,n){if(Xn&&typeof Xn.onCommitFiberUnmount=="function")try{Xn.onCommitFiberUnmount(Gd,n)}catch{}switch(n.tag){case 5:Pt||co(n,e);case 6:var r=wt,s=Nn;wt=null,$r(t,e,n),wt=r,Nn=s,wt!==null&&(Nn?(t=wt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):wt.removeChild(n.stateNode));break;case 18:wt!==null&&(Nn?(t=wt,n=n.stateNode,t.nodeType===8?Tf(t.parentNode,n):t.nodeType===1&&Tf(t,n),Nl(t)):Tf(wt,n.stateNode));break;case 4:r=wt,s=Nn,wt=n.stateNode.containerInfo,Nn=!0,$r(t,e,n),wt=r,Nn=s;break;case 0:case 11:case 14:case 15:if(!Pt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Qm(n,e,o),s=s.next}while(s!==r)}$r(t,e,n);break;case 1:if(!Pt&&(co(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ye(n,e,a)}$r(t,e,n);break;case 21:$r(t,e,n);break;case 22:n.mode&1?(Pt=(r=Pt)||n.memoizedState!==null,$r(t,e,n),Pt=r):$r(t,e,n);break;default:$r(t,e,n)}}function X_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new CC),e.forEach(function(r){var s=FC.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Sn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:wt=a.stateNode,Nn=!1;break e;case 3:wt=a.stateNode.containerInfo,Nn=!0;break e;case 4:wt=a.stateNode.containerInfo,Nn=!0;break e}a=a.return}if(wt===null)throw Error(H(160));kI(i,o,s),wt=null,Nn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(d){Ye(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)RI(e,t),e=e.sibling}function RI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Sn(e,t),$n(t),r&4){try{ol(3,t,t.return),eh(3,t)}catch(C){Ye(t,t.return,C)}try{ol(5,t,t.return)}catch(C){Ye(t,t.return,C)}}break;case 1:Sn(e,t),$n(t),r&512&&n!==null&&co(n,n.return);break;case 5:if(Sn(e,t),$n(t),r&512&&n!==null&&co(n,n.return),t.flags&32){var s=t.stateNode;try{Tl(s,"")}catch(C){Ye(t,t.return,C)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&Zw(s,i),Em(a,o);var d=Em(a,i);for(o=0;o<c.length;o+=2){var h=c[o],m=c[o+1];h==="style"?sE(s,m):h==="dangerouslySetInnerHTML"?nE(s,m):h==="children"?Tl(s,m):Jp(s,h,m,d)}switch(a){case"input":ym(s,i);break;case"textarea":eE(s,i);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?fo(s,!!i.multiple,x,!1):g!==!!i.multiple&&(i.defaultValue!=null?fo(s,!!i.multiple,i.defaultValue,!0):fo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Dl]=i}catch(C){Ye(t,t.return,C)}}break;case 6:if(Sn(e,t),$n(t),r&4){if(t.stateNode===null)throw Error(H(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(C){Ye(t,t.return,C)}}break;case 3:if(Sn(e,t),$n(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Nl(e.containerInfo)}catch(C){Ye(t,t.return,C)}break;case 4:Sn(e,t),$n(t);break;case 13:Sn(e,t),$n(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(kg=tt())),r&4&&X_(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Pt=(d=Pt)||h,Sn(e,t),Pt=d):Sn(e,t),$n(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(ne=t,h=t.child;h!==null;){for(m=ne=h;ne!==null;){switch(g=ne,x=g.child,g.tag){case 0:case 11:case 14:case 15:ol(4,g,g.return);break;case 1:co(g,g.return);var A=g.stateNode;if(typeof A.componentWillUnmount=="function"){r=g,n=g.return;try{e=r,A.props=e.memoizedProps,A.state=e.memoizedState,A.componentWillUnmount()}catch(C){Ye(r,n,C)}}break;case 5:co(g,g.return);break;case 22:if(g.memoizedState!==null){e0(m);continue}}x!==null?(x.return=g,ne=x):e0(m)}h=h.sibling}e:for(h=null,m=t;;){if(m.tag===5){if(h===null){h=m;try{s=m.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=m.stateNode,c=m.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=rE("display",o))}catch(C){Ye(t,t.return,C)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(C){Ye(t,t.return,C)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===t)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===t)break e;for(;m.sibling===null;){if(m.return===null||m.return===t)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Sn(e,t),$n(t),r&4&&X_(t);break;case 21:break;default:Sn(e,t),$n(t)}}function $n(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(CI(n)){var r=n;break e}n=n.return}throw Error(H(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Tl(s,""),r.flags&=-33);var i=J_(t);Xm(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=J_(t);Jm(t,a,o);break;default:throw Error(H(161))}}catch(c){Ye(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function RC(t,e,n){ne=t,PI(t)}function PI(t,e,n){for(var r=(t.mode&1)!==0;ne!==null;){var s=ne,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Qc;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Pt;a=Qc;var d=Pt;if(Qc=o,(Pt=c)&&!d)for(ne=s;ne!==null;)o=ne,c=o.child,o.tag===22&&o.memoizedState!==null?t0(s):c!==null?(c.return=o,ne=c):t0(s);for(;i!==null;)ne=i,PI(i),i=i.sibling;ne=s,Qc=a,Pt=d}Z_(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,ne=i):Z_(t)}}function Z_(t){for(;ne!==null;){var e=ne;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Pt||eh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Pt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:An(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&M_(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}M_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Nl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(H(163))}Pt||e.flags&512&&Ym(e)}catch(g){Ye(e,e.return,g)}}if(e===t){ne=null;break}if(n=e.sibling,n!==null){n.return=e.return,ne=n;break}ne=e.return}}function e0(t){for(;ne!==null;){var e=ne;if(e===t){ne=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ne=n;break}ne=e.return}}function t0(t){for(;ne!==null;){var e=ne;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{eh(4,e)}catch(c){Ye(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Ye(e,s,c)}}var i=e.return;try{Ym(e)}catch(c){Ye(e,i,c)}break;case 5:var o=e.return;try{Ym(e)}catch(c){Ye(e,o,c)}}}catch(c){Ye(e,e.return,c)}if(e===t){ne=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ne=a;break}ne=e.return}}var PC=Math.ceil,ad=Rr.ReactCurrentDispatcher,Ng=Rr.ReactCurrentOwner,En=Rr.ReactCurrentBatchConfig,be=0,xt=null,it=null,Tt=0,nn=0,uo=Rs(0),dt=0,Fl=null,gi=0,th=0,Cg=0,al=null,Gt=null,kg=0,ko=1/0,cr=null,ld=!1,Zm=null,fs=null,Yc=!1,os=null,cd=0,ll=0,ep=null,Eu=-1,Iu=0;function Bt(){return be&6?tt():Eu!==-1?Eu:Eu=tt()}function ms(t){return t.mode&1?be&2&&Tt!==0?Tt&-Tt:pC.transition!==null?(Iu===0&&(Iu=gE()),Iu):(t=Re,t!==0||(t=window.event,t=t===void 0?16:IE(t.type)),t):1}function Dn(t,e,n,r){if(50<ll)throw ll=0,ep=null,Error(H(185));nc(t,n,r),(!(be&2)||t!==xt)&&(t===xt&&(!(be&2)&&(th|=n),dt===4&&Jr(t,Tt)),en(t,r),n===1&&be===0&&!(e.mode&1)&&(ko=tt()+500,Jd&&Ps()))}function en(t,e){var n=t.callbackNode;pN(t,e);var r=Gu(t,t===xt?Tt:0);if(r===0)n!==null&&u_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&u_(n),e===1)t.tag===0?mC(n0.bind(null,t)):BE(n0.bind(null,t)),uC(function(){!(be&6)&&Ps()}),n=null;else{switch(yE(r)){case 1:n=ng;break;case 4:n=mE;break;case 16:n=Hu;break;case 536870912:n=pE;break;default:n=Hu}n=UI(n,DI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function DI(t,e){if(Eu=-1,Iu=0,be&6)throw Error(H(327));var n=t.callbackNode;if(vo()&&t.callbackNode!==n)return null;var r=Gu(t,t===xt?Tt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ud(t,r);else{e=r;var s=be;be|=2;var i=VI();(xt!==t||Tt!==e)&&(cr=null,ko=tt()+500,ii(t,e));do try{VC();break}catch(a){jI(t,a)}while(!0);pg(),ad.current=i,be=s,it!==null?e=0:(xt=null,Tt=0,e=dt)}if(e!==0){if(e===2&&(s=Am(t),s!==0&&(r=s,e=tp(t,s))),e===1)throw n=Fl,ii(t,0),Jr(t,r),en(t,tt()),n;if(e===6)Jr(t,r);else{if(s=t.current.alternate,!(r&30)&&!DC(s)&&(e=ud(t,r),e===2&&(i=Am(t),i!==0&&(r=i,e=tp(t,i))),e===1))throw n=Fl,ii(t,0),Jr(t,r),en(t,tt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(H(345));case 2:Ks(t,Gt,cr);break;case 3:if(Jr(t,r),(r&130023424)===r&&(e=kg+500-tt(),10<e)){if(Gu(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Bt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Vm(Ks.bind(null,t,Gt,cr),e);break}Ks(t,Gt,cr);break;case 4:if(Jr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Pn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=tt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*PC(r/1960))-r,10<r){t.timeoutHandle=Vm(Ks.bind(null,t,Gt,cr),r);break}Ks(t,Gt,cr);break;case 5:Ks(t,Gt,cr);break;default:throw Error(H(329))}}}return en(t,tt()),t.callbackNode===n?DI.bind(null,t):null}function tp(t,e){var n=al;return t.current.memoizedState.isDehydrated&&(ii(t,e).flags|=256),t=ud(t,e),t!==2&&(e=Gt,Gt=n,e!==null&&np(e)),t}function np(t){Gt===null?Gt=t:Gt.push.apply(Gt,t)}function DC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Vn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Jr(t,e){for(e&=~Cg,e&=~th,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Pn(e),r=1<<n;t[n]=-1,e&=~r}}function n0(t){if(be&6)throw Error(H(327));vo();var e=Gu(t,0);if(!(e&1))return en(t,tt()),null;var n=ud(t,e);if(t.tag!==0&&n===2){var r=Am(t);r!==0&&(e=r,n=tp(t,r))}if(n===1)throw n=Fl,ii(t,0),Jr(t,e),en(t,tt()),n;if(n===6)throw Error(H(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ks(t,Gt,cr),en(t,tt()),null}function Rg(t,e){var n=be;be|=1;try{return t(e)}finally{be=n,be===0&&(ko=tt()+500,Jd&&Ps())}}function yi(t){os!==null&&os.tag===0&&!(be&6)&&vo();var e=be;be|=1;var n=En.transition,r=Re;try{if(En.transition=null,Re=1,t)return t()}finally{Re=r,En.transition=n,be=e,!(be&6)&&Ps()}}function Pg(){nn=uo.current,Be(uo)}function ii(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,cC(n)),it!==null)for(n=it.return;n!==null;){var r=n;switch(hg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ju();break;case 3:No(),Be(Xt),Be(Mt),wg();break;case 5:xg(r);break;case 4:No();break;case 13:Be(He);break;case 19:Be(He);break;case 10:gg(r.type._context);break;case 22:case 23:Pg()}n=n.return}if(xt=t,it=t=ps(t.current,null),Tt=nn=e,dt=0,Fl=null,Cg=th=gi=0,Gt=al=null,ni!==null){for(e=0;e<ni.length;e++)if(n=ni[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}ni=null}return t}function jI(t,e){do{var n=it;try{if(pg(),_u.current=od,id){for(var r=Ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}id=!1}if(pi=0,_t=ct=Ke=null,il=!1,Ol=0,Ng.current=null,n===null||n.return===null){dt=1,Fl=e,it=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=Tt,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=a,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=$_(o);if(x!==null){x.flags&=-257,q_(x,o,a,i,e),x.mode&1&&B_(i,d,e),e=x,c=d;var A=e.updateQueue;if(A===null){var C=new Set;C.add(c),e.updateQueue=C}else A.add(c);break e}else{if(!(e&1)){B_(i,d,e),Dg();break e}c=Error(H(426))}}else if(qe&&a.mode&1){var R=$_(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),q_(R,o,a,i,e),fg(Co(c,a));break e}}i=c=Co(c,a),dt!==4&&(dt=2),al===null?al=[i]:al.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var I=yI(i,c,e);O_(i,I);break e;case 1:a=c;var v=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(fs===null||!fs.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var D=vI(i,a,e);O_(i,D);break e}}i=i.return}while(i!==null)}MI(n)}catch(O){e=O,it===n&&n!==null&&(it=n=n.return);continue}break}while(!0)}function VI(){var t=ad.current;return ad.current=od,t===null?od:t}function Dg(){(dt===0||dt===3||dt===2)&&(dt=4),xt===null||!(gi&268435455)&&!(th&268435455)||Jr(xt,Tt)}function ud(t,e){var n=be;be|=2;var r=VI();(xt!==t||Tt!==e)&&(cr=null,ii(t,e));do try{jC();break}catch(s){jI(t,s)}while(!0);if(pg(),be=n,ad.current=r,it!==null)throw Error(H(261));return xt=null,Tt=0,dt}function jC(){for(;it!==null;)OI(it)}function VC(){for(;it!==null&&!oN();)OI(it)}function OI(t){var e=FI(t.alternate,t,nn);t.memoizedProps=t.pendingProps,e===null?MI(t):it=e,Ng.current=null}function MI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=NC(n,e),n!==null){n.flags&=32767,it=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{dt=6,it=null;return}}else if(n=AC(n,e,nn),n!==null){it=n;return}if(e=e.sibling,e!==null){it=e;return}it=e=t}while(e!==null);dt===0&&(dt=5)}function Ks(t,e,n){var r=Re,s=En.transition;try{En.transition=null,Re=1,OC(t,e,n,r)}finally{En.transition=s,Re=r}return null}function OC(t,e,n,r){do vo();while(os!==null);if(be&6)throw Error(H(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(H(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(gN(t,i),t===xt&&(it=xt=null,Tt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Yc||(Yc=!0,UI(Hu,function(){return vo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=En.transition,En.transition=null;var o=Re;Re=1;var a=be;be|=4,Ng.current=null,kC(t,n),RI(n,t),nC(Dm),Ku=!!Pm,Dm=Pm=null,t.current=n,RC(n),aN(),be=a,Re=o,En.transition=i}else t.current=n;if(Yc&&(Yc=!1,os=t,cd=s),i=t.pendingLanes,i===0&&(fs=null),uN(n.stateNode),en(t,tt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(ld)throw ld=!1,t=Zm,Zm=null,t;return cd&1&&t.tag!==0&&vo(),i=t.pendingLanes,i&1?t===ep?ll++:(ll=0,ep=t):ll=0,Ps(),null}function vo(){if(os!==null){var t=yE(cd),e=En.transition,n=Re;try{if(En.transition=null,Re=16>t?16:t,os===null)var r=!1;else{if(t=os,os=null,cd=0,be&6)throw Error(H(331));var s=be;for(be|=4,ne=t.current;ne!==null;){var i=ne,o=i.child;if(ne.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var d=a[c];for(ne=d;ne!==null;){var h=ne;switch(h.tag){case 0:case 11:case 15:ol(8,h,i)}var m=h.child;if(m!==null)m.return=h,ne=m;else for(;ne!==null;){h=ne;var g=h.sibling,x=h.return;if(NI(h),h===d){ne=null;break}if(g!==null){g.return=x,ne=g;break}ne=x}}}var A=i.alternate;if(A!==null){var C=A.child;if(C!==null){A.child=null;do{var R=C.sibling;C.sibling=null,C=R}while(C!==null)}}ne=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ne=o;else e:for(;ne!==null;){if(i=ne,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ol(9,i,i.return)}var I=i.sibling;if(I!==null){I.return=i.return,ne=I;break e}ne=i.return}}var v=t.current;for(ne=v;ne!==null;){o=ne;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ne=T;else e:for(o=v;ne!==null;){if(a=ne,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:eh(9,a)}}catch(O){Ye(a,a.return,O)}if(a===o){ne=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,ne=D;break e}ne=a.return}}if(be=s,Ps(),Xn&&typeof Xn.onPostCommitFiberRoot=="function")try{Xn.onPostCommitFiberRoot(Gd,t)}catch{}r=!0}return r}finally{Re=n,En.transition=e}}return!1}function r0(t,e,n){e=Co(n,e),e=yI(t,e,1),t=hs(t,e,1),e=Bt(),t!==null&&(nc(t,1,e),en(t,e))}function Ye(t,e,n){if(t.tag===3)r0(t,t,n);else for(;e!==null;){if(e.tag===3){r0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(fs===null||!fs.has(r))){t=Co(n,t),t=vI(e,t,1),e=hs(e,t,1),t=Bt(),e!==null&&(nc(e,1,t),en(e,t));break}}e=e.return}}function MC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Bt(),t.pingedLanes|=t.suspendedLanes&n,xt===t&&(Tt&n)===n&&(dt===4||dt===3&&(Tt&130023424)===Tt&&500>tt()-kg?ii(t,0):Cg|=n),en(t,e)}function LI(t,e){e===0&&(t.mode&1?(e=Uc,Uc<<=1,!(Uc&130023424)&&(Uc=4194304)):e=1);var n=Bt();t=xr(t,e),t!==null&&(nc(t,e,n),en(t,n))}function LC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),LI(t,n)}function FC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(H(314))}r!==null&&r.delete(e),LI(t,n)}var FI;FI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xt.current)Wt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Wt=!1,SC(t,e,n);Wt=!!(t.flags&131072)}else Wt=!1,qe&&e.flags&1048576&&$E(e,ed,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;wu(t,e),t=e.pendingProps;var s=bo(e,Mt.current);yo(e,n),s=Ig(null,e,r,t,s,n);var i=Tg();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Zt(r)?(i=!0,Xu(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,vg(e),s.updater=Zd,e.stateNode=s,s._reactInternals=e,Bm(e,r,t,n),e=Hm(null,e,r,!0,i,n)):(e.tag=0,qe&&i&&dg(e),zt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(wu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=zC(r),t=An(r,t),s){case 0:e=qm(null,e,r,t,n);break e;case 1:e=K_(null,e,r,t,n);break e;case 11:e=H_(null,e,r,t,n);break e;case 14:e=G_(null,e,r,An(r.type,t),n);break e}throw Error(H(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:An(r,s),qm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:An(r,s),K_(t,e,r,s,n);case 3:e:{if(EI(e),t===null)throw Error(H(387));r=e.pendingProps,i=e.memoizedState,s=i.element,QE(t,e),rd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Co(Error(H(423)),e),e=W_(t,e,r,n,s);break e}else if(r!==s){s=Co(Error(H(424)),e),e=W_(t,e,r,n,s);break e}else for(sn=ds(e.stateNode.containerInfo.firstChild),cn=e,qe=!0,kn=null,n=KE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(So(),r===s){e=wr(t,e,n);break e}zt(t,e,r,n)}e=e.child}return e;case 5:return YE(e),t===null&&Fm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,jm(r,s)?o=null:i!==null&&jm(r,i)&&(e.flags|=32),wI(t,e),zt(t,e,o,n),e.child;case 6:return t===null&&Fm(e),null;case 13:return II(t,e,n);case 4:return _g(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ao(e,null,r,n):zt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:An(r,s),H_(t,e,r,s,n);case 7:return zt(t,e,e.pendingProps,n),e.child;case 8:return zt(t,e,e.pendingProps.children,n),e.child;case 12:return zt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Me(td,r._currentValue),r._currentValue=o,i!==null)if(Vn(i.value,o)){if(i.children===s.children&&!Xt.current){e=wr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=gr(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),Um(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(H(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Um(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}zt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,yo(e,n),s=Tn(s),r=r(s),e.flags|=1,zt(t,e,r,n),e.child;case 14:return r=e.type,s=An(r,e.pendingProps),s=An(r.type,s),G_(t,e,r,s,n);case 15:return _I(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:An(r,s),wu(t,e),e.tag=1,Zt(r)?(t=!0,Xu(e)):t=!1,yo(e,n),gI(e,r,s),Bm(e,r,s,n),Hm(null,e,r,!0,t,n);case 19:return TI(t,e,n);case 22:return xI(t,e,n)}throw Error(H(156,e.tag))};function UI(t,e){return fE(t,e)}function UC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xn(t,e,n,r){return new UC(t,e,n,r)}function jg(t){return t=t.prototype,!(!t||!t.isReactComponent)}function zC(t){if(typeof t=="function")return jg(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zp)return 11;if(t===eg)return 14}return 2}function ps(t,e){var n=t.alternate;return n===null?(n=xn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Tu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")jg(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case eo:return oi(n.children,s,i,e);case Xp:o=8,s|=8;break;case hm:return t=xn(12,n,e,s|2),t.elementType=hm,t.lanes=i,t;case fm:return t=xn(13,n,e,s),t.elementType=fm,t.lanes=i,t;case mm:return t=xn(19,n,e,s),t.elementType=mm,t.lanes=i,t;case Yw:return nh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Ww:o=10;break e;case Qw:o=9;break e;case Zp:o=11;break e;case eg:o=14;break e;case Wr:o=16,r=null;break e}throw Error(H(130,t==null?t:typeof t,""))}return e=xn(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function oi(t,e,n,r){return t=xn(7,t,r,e),t.lanes=n,t}function nh(t,e,n,r){return t=xn(22,t,r,e),t.elementType=Yw,t.lanes=n,t.stateNode={isHidden:!1},t}function Pf(t,e,n){return t=xn(6,t,null,e),t.lanes=n,t}function Df(t,e,n){return e=xn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function BC(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ff(0),this.expirationTimes=ff(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ff(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Vg(t,e,n,r,s,i,o,a,c){return t=new BC(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=xn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vg(i),t}function $C(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function zI(t){if(!t)return Es;t=t._reactInternals;e:{if(Ri(t)!==t||t.tag!==1)throw Error(H(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Zt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(H(171))}if(t.tag===1){var n=t.type;if(Zt(n))return zE(t,n,e)}return e}function BI(t,e,n,r,s,i,o,a,c){return t=Vg(n,r,!0,t,s,i,o,a,c),t.context=zI(null),n=t.current,r=Bt(),s=ms(n),i=gr(r,s),i.callback=e??null,hs(n,i,s),t.current.lanes=s,nc(t,s,r),en(t,r),t}function rh(t,e,n,r){var s=e.current,i=Bt(),o=ms(s);return n=zI(n),e.context===null?e.context=n:e.pendingContext=n,e=gr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=hs(s,e,o),t!==null&&(Dn(t,s,o,i),vu(t,s,o)),o}function dd(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function s0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Og(t,e){s0(t,e),(t=t.alternate)&&s0(t,e)}function qC(){return null}var $I=typeof reportError=="function"?reportError:function(t){console.error(t)};function Mg(t){this._internalRoot=t}sh.prototype.render=Mg.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(H(409));rh(t,e,null,null)};sh.prototype.unmount=Mg.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;yi(function(){rh(null,t,null,null)}),e[_r]=null}};function sh(t){this._internalRoot=t}sh.prototype.unstable_scheduleHydration=function(t){if(t){var e=xE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Yr.length&&e!==0&&e<Yr[n].priority;n++);Yr.splice(n,0,t),n===0&&EE(t)}};function Lg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function ih(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function i0(){}function HC(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=dd(o);i.call(d)}}var o=BI(e,r,t,0,null,!1,!1,"",i0);return t._reactRootContainer=o,t[_r]=o.current,Rl(t.nodeType===8?t.parentNode:t),yi(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var d=dd(c);a.call(d)}}var c=Vg(t,0,!1,null,null,!1,!1,"",i0);return t._reactRootContainer=c,t[_r]=c.current,Rl(t.nodeType===8?t.parentNode:t),yi(function(){rh(e,c,n,r)}),c}function oh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=dd(o);a.call(c)}}rh(e,o,t,s)}else o=HC(n,e,t,s,r);return dd(o)}vE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=qa(e.pendingLanes);n!==0&&(rg(e,n|1),en(e,tt()),!(be&6)&&(ko=tt()+500,Ps()))}break;case 13:yi(function(){var r=xr(t,1);if(r!==null){var s=Bt();Dn(r,t,1,s)}}),Og(t,1)}};sg=function(t){if(t.tag===13){var e=xr(t,134217728);if(e!==null){var n=Bt();Dn(e,t,134217728,n)}Og(t,134217728)}};_E=function(t){if(t.tag===13){var e=ms(t),n=xr(t,e);if(n!==null){var r=Bt();Dn(n,t,e,r)}Og(t,e)}};xE=function(){return Re};wE=function(t,e){var n=Re;try{return Re=t,e()}finally{Re=n}};Tm=function(t,e,n){switch(e){case"input":if(ym(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Yd(r);if(!s)throw Error(H(90));Xw(r),ym(r,s)}}}break;case"textarea":eE(t,n);break;case"select":e=n.value,e!=null&&fo(t,!!n.multiple,e,!1)}};aE=Rg;lE=yi;var GC={usingClientEntryPoint:!1,Events:[sc,so,Yd,iE,oE,Rg]},ka={findFiberByHostInstance:ti,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KC={bundleType:ka.bundleType,version:ka.version,rendererPackageName:ka.rendererPackageName,rendererConfig:ka.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=dE(t),t===null?null:t.stateNode},findFiberByHostInstance:ka.findFiberByHostInstance||qC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jc.isDisabled&&Jc.supportsFiber)try{Gd=Jc.inject(KC),Xn=Jc}catch{}}mn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GC;mn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lg(e))throw Error(H(200));return $C(t,e,null,n)};mn.createRoot=function(t,e){if(!Lg(t))throw Error(H(299));var n=!1,r="",s=$I;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Vg(t,1,!1,null,null,n,!1,r,s),t[_r]=e.current,Rl(t.nodeType===8?t.parentNode:t),new Mg(e)};mn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(H(188)):(t=Object.keys(t).join(","),Error(H(268,t)));return t=dE(e),t=t===null?null:t.stateNode,t};mn.flushSync=function(t){return yi(t)};mn.hydrate=function(t,e,n){if(!ih(e))throw Error(H(200));return oh(null,t,e,!0,n)};mn.hydrateRoot=function(t,e,n){if(!Lg(t))throw Error(H(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=$I;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=BI(e,null,t,1,n??null,s,!1,i,o),t[_r]=e.current,Rl(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new sh(e)};mn.render=function(t,e,n){if(!ih(e))throw Error(H(200));return oh(null,t,e,!1,n)};mn.unmountComponentAtNode=function(t){if(!ih(t))throw Error(H(40));return t._reactRootContainer?(yi(function(){oh(null,null,t,!1,function(){t._reactRootContainer=null,t[_r]=null})}),!0):!1};mn.unstable_batchedUpdates=Rg;mn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!ih(n))throw Error(H(200));if(t==null||t._reactInternals===void 0)throw Error(H(38));return oh(t,e,n,!1,r)};mn.version="18.3.1-next-f1338f8080-20240426";function qI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qI)}catch(t){console.error(t)}}qI(),qw.exports=mn;var WC=qw.exports,o0=WC;um.createRoot=o0.createRoot,um.hydrateRoot=o0.hydrateRoot;const QC="modulepreload",YC=function(t){return"/"+t},a0={},JC=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=YC(c),c in a0)return;a0[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":QC,d||(m.as="script"),m.crossOrigin="",m.href=c,a&&m.setAttribute("nonce",a),document.head.appendChild(m),d)return new Promise((g,x)=>{m.addEventListener("load",g),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};function XC(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:i,onRegisterError:o}=t;let a,c;const d=async(m=!0)=>{await c};async function h(){if("serviceWorker"in navigator){if(a=await JC(async()=>{const{Workbox:m}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:m}},[]).then(({Workbox:m})=>new m("/sw.js",{scope:"/",type:"classic"})).catch(m=>{o==null||o(m)}),!a)return;a.addEventListener("activated",m=>{(m.isUpdate||m.isExternal)&&window.location.reload()}),a.addEventListener("installed",m=>{m.isUpdate||r==null||r()}),a.register({immediate:e}).then(m=>{i?i("/sw.js",m):s==null||s(m)}).catch(m=>{o==null||o(m)})}}return c=h(),d}var ZC={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ek=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ge=(t,e)=>{const n=P.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:a,...c},d)=>P.createElement("svg",{ref:d,...ZC,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${ek(t)}`,...c},[...e.map(([h,m])=>P.createElement(h,m)),...(Array.isArray(a)?a:[a])||[]]));return n.displayName=`${t}`,n},HI=ge("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]),l0=ge("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Fg=ge("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),cl=ge("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]),rp=ge("CalendarDays",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),sp=ge("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),tk=ge("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),GI=ge("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),nk=ge("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),KI=ge("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),ah=ge("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),rk=ge("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Ug=ge("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),WI=ge("Coffee",[["path",{d:"M17 8h1a4 4 0 1 1 0 8h-1",key:"jx4kbh"}],["path",{d:"M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z",key:"1bxrl0"}],["line",{x1:"6",x2:"6",y1:"2",y2:"4",key:"1cr9l3"}],["line",{x1:"10",x2:"10",y1:"2",y2:"4",key:"170wym"}],["line",{x1:"14",x2:"14",y1:"2",y2:"4",key:"1c5f70"}]]),lh=ge("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),sk=ge("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),ik=ge("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),c0=ge("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),ok=ge("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),ak=ge("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),QI=ge("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]),lk=ge("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),ck=ge("MessageSquareDashed",[["path",{d:"M3 6V5c0-1.1.9-2 2-2h2",key:"9usibi"}],["path",{d:"M11 3h3",key:"1c3ji7"}],["path",{d:"M18 3h1c1.1 0 2 .9 2 2",key:"19esxn"}],["path",{d:"M21 9v2",key:"p14lih"}],["path",{d:"M21 15c0 1.1-.9 2-2 2h-1",key:"1fo1j8"}],["path",{d:"M14 17h-3",key:"1w4p2m"}],["path",{d:"m7 17-4 4v-5",key:"ph9x1h"}],["path",{d:"M3 12v-2",key:"856n1q"}]]),u0=ge("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),YI=ge("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),uk=ge("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),ip=ge("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),wn=ge("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),oc=ge("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),JI=ge("School",[["path",{d:"m4 6 8-4 8 4",key:"1q0ilc"}],["path",{d:"m18 10 4 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-8l4-2",key:"1vwozw"}],["path",{d:"M14 22v-4a2 2 0 0 0-2-2v0a2 2 0 0 0-2 2v4",key:"cpkuc4"}],["path",{d:"M18 5v17",key:"1sw6gf"}],["path",{d:"M6 5v17",key:"1xfsm0"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]]),dk=ge("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),hk=ge("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Is=ge("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ts=ge("ShieldMinus",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M8 11h8",key:"vwpz6n"}]]),d0=ge("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),fk=ge("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),mk=ge("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),hd=ge("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Ra=ge("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ul=ge("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Er=ge("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),pk=()=>{};var h0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},gk=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},ZI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,d=c?t[s+2]:0,h=i>>2,m=(i&3)<<4|a>>4;let g=(a&15)<<2|d>>6,x=d&63;c||(x=64,o||(g=64)),r.push(n[h],n[m],n[g],n[x])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(XI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):gk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const m=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||d==null||m==null)throw new yk;const g=i<<2|a>>4;if(r.push(g),d!==64){const x=a<<4&240|d>>2;if(r.push(x),m!==64){const A=d<<6&192|m;r.push(A)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const vk=function(t){const e=XI(t);return ZI.encodeByteArray(e,!0)},fd=function(t){return vk(t).replace(/\./g,"")},e1=function(t){try{return ZI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t1(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _k=()=>t1().__FIREBASE_DEFAULTS__,xk=()=>{if(typeof process>"u"||typeof h0>"u")return;const t=h0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},wk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&e1(t[1]);return e&&JSON.parse(e)},ch=()=>{try{return pk()||_k()||xk()||wk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},n1=t=>{var e,n;return(n=(e=ch())==null?void 0:e.emulatorHosts)==null?void 0:n[t]},r1=t=>{const e=n1(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},s1=()=>{var t;return(t=ch())==null?void 0:t.config},i1=t=>{var e;return(e=ch())==null?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ek{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ir(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function uh(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...t};return[fd(JSON.stringify(n)),fd(JSON.stringify(o)),""].join(".")}const ul={};function Tk(){const t={prod:[],emulator:[]};for(const e of Object.keys(ul))ul[e]?t.emulator.push(e):t.prod.push(e);return t}function bk(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let f0=!1;function zg(t,e){if(typeof window>"u"||typeof document>"u"||!ir(window.location.host)||ul[t]===e||ul[t]||f0)return;ul[t]=e;function n(g){return`__firebase__banner__${g}`}const r="__firebase__banner",i=Tk().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,x){g.setAttribute("width","24"),g.setAttribute("id",x),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function d(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{f0=!0,o()},g}function h(g,x){g.setAttribute("id",x),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function m(){const g=bk(r),x=n("text"),A=document.getElementById(x)||document.createElement("span"),C=n("learnmore"),R=document.getElementById(C)||document.createElement("a"),I=n("preprendIcon"),v=document.getElementById(I)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const T=g.element;a(T),h(R,C);const D=d();c(v,I),T.append(v,A,R,D),document.body.appendChild(T)}i?(A.innerText="Preview backend disconnected.",v.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(v.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",x)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mt())}function o1(){var e;const t=(e=ch())==null?void 0:e.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Ak(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Nk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Ck(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kk(){const t=mt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function a1(){return!o1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function l1(){return!o1()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function c1(){try{return typeof indexedDB=="object"}catch{return!1}}function Rk(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)==null?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pk="FirebaseError";class Mn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Pk,Object.setPrototypeOf(this,Mn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ac.prototype.create)}}class ac{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Dk(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Mn(s,a,r)}}function Dk(t,e){return t.replace(jk,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const jk=/\{\$([^}]+)}/g;function Vk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function vi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(m0(i)&&m0(o)){if(!vi(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function m0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lc(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ga(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Ka(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Ok(t,e){const n=new Mk(t,e);return n.subscribe.bind(n)}class Mk{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Lk(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=jf),s.error===void 0&&(s.error=jf),s.complete===void 0&&(s.complete=jf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Lk(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function jf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function De(t){return t&&t._delegate?t._delegate:t}class Ir{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ws="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ek;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(e==null?void 0:e.optional)??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(zk(e))try{this.getOrInitializeService({instanceIdentifier:Ws})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ws){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ws){return this.instances.has(e)}getOptions(e=Ws){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){const r=this.normalizeInstanceIdentifier(n),s=this.onInitCallbacks.get(r)??new Set;s.add(e),this.onInitCallbacks.set(r,s);const i=this.instances.get(r);return i&&e(i,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Uk(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ws){return this.component?this.component.multipleInstances?e:Ws:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Uk(t){return t===Ws?void 0:t}function zk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Fk(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const $k={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},qk=Ee.INFO,Hk={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},Gk=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Hk[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Bg{constructor(e){this.name=e,this._logLevel=qk,this._logHandler=Gk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$k[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const Kk=(t,e)=>e.some(n=>t instanceof n);let p0,g0;function Wk(){return p0||(p0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Qk(){return g0||(g0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const u1=new WeakMap,op=new WeakMap,d1=new WeakMap,Vf=new WeakMap,$g=new WeakMap;function Yk(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(gs(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&u1.set(n,t)}).catch(()=>{}),$g.set(e,t),e}function Jk(t){if(op.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});op.set(t,e)}let ap={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return op.get(t);if(e==="objectStoreNames")return t.objectStoreNames||d1.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return gs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Xk(t){ap=t(ap)}function Zk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Of(this),e,...n);return d1.set(r,e.sort?e.sort():[e]),gs(r)}:Qk().includes(t)?function(...e){return t.apply(Of(this),e),gs(u1.get(this))}:function(...e){return gs(t.apply(Of(this),e))}}function eR(t){return typeof t=="function"?Zk(t):(t instanceof IDBTransaction&&Jk(t),Kk(t,Wk())?new Proxy(t,ap):t)}function gs(t){if(t instanceof IDBRequest)return Yk(t);if(Vf.has(t))return Vf.get(t);const e=eR(t);return e!==t&&(Vf.set(t,e),$g.set(e,t)),e}const Of=t=>$g.get(t);function tR(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=gs(o);return r&&o.addEventListener("upgradeneeded",c=>{r(gs(o.result),c.oldVersion,c.newVersion,gs(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}const nR=["get","getKey","getAll","getAllKeys","count"],rR=["put","add","delete","clear"],Mf=new Map;function y0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Mf.get(e))return Mf.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=rR.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||nR.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[n](...a),s&&c.done]))[0]};return Mf.set(e,i),i}Xk(t=>({...t,get:(e,n,r)=>y0(e,n)||t.get(e,n,r),has:(e,n)=>!!y0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(iR(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function iR(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lp="@firebase/app",v0="0.14.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tr=new Bg("@firebase/app"),oR="@firebase/app-compat",aR="@firebase/analytics-compat",lR="@firebase/analytics",cR="@firebase/app-check-compat",uR="@firebase/app-check",dR="@firebase/auth",hR="@firebase/auth-compat",fR="@firebase/database",mR="@firebase/data-connect",pR="@firebase/database-compat",gR="@firebase/functions",yR="@firebase/functions-compat",vR="@firebase/installations",_R="@firebase/installations-compat",xR="@firebase/messaging",wR="@firebase/messaging-compat",ER="@firebase/performance",IR="@firebase/performance-compat",TR="@firebase/remote-config",bR="@firebase/remote-config-compat",SR="@firebase/storage",AR="@firebase/storage-compat",NR="@firebase/firestore",CR="@firebase/ai",kR="@firebase/firestore-compat",RR="firebase",PR="12.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp="[DEFAULT]",DR={[lp]:"fire-core",[oR]:"fire-core-compat",[lR]:"fire-analytics",[aR]:"fire-analytics-compat",[uR]:"fire-app-check",[cR]:"fire-app-check-compat",[dR]:"fire-auth",[hR]:"fire-auth-compat",[fR]:"fire-rtdb",[mR]:"fire-data-connect",[pR]:"fire-rtdb-compat",[gR]:"fire-fn",[yR]:"fire-fn-compat",[vR]:"fire-iid",[_R]:"fire-iid-compat",[xR]:"fire-fcm",[wR]:"fire-fcm-compat",[ER]:"fire-perf",[IR]:"fire-perf-compat",[TR]:"fire-rc",[bR]:"fire-rc-compat",[SR]:"fire-gcs",[AR]:"fire-gcs-compat",[NR]:"fire-fst",[kR]:"fire-fst-compat",[CR]:"fire-vertex","fire-js":"fire-js",[RR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md=new Map,jR=new Map,up=new Map;function _0(t,e){try{t.container.addComponent(e)}catch(n){Tr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function bs(t){const e=t.name;if(up.has(e))return Tr.debug(`There were multiple attempts to register component ${e}.`),!1;up.set(e,t);for(const n of md.values())_0(n,t);for(const n of jR.values())_0(n,t);return!0}function cc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Kt(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ys=new ac("app","Firebase",VR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e,n,r){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ir("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ys.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pi=PR;function h1(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r={name:cp,automaticDataCollectionEnabled:!0,...e},s=r.name;if(typeof s!="string"||!s)throw ys.create("bad-app-name",{appName:String(s)});if(n||(n=s1()),!n)throw ys.create("no-options");const i=md.get(s);if(i){if(vi(n,i.options)&&vi(r,i.config))return i;throw ys.create("duplicate-app",{appName:s})}const o=new Bk(s);for(const c of up.values())o.addComponent(c);const a=new OR(n,r,o);return md.set(s,a),a}function qg(t=cp){const e=md.get(t);if(!e&&t===cp&&s1())return h1();if(!e)throw ys.create("no-app",{appName:t});return e}function In(t,e,n){let r=DR[t]??t;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=e.match(/\s|\//);if(s||i){const o=[`Unable to register library "${r}" with version "${e}":`];s&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&o.push("and"),i&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Tr.warn(o.join(" "));return}bs(new Ir(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR="firebase-heartbeat-database",LR=1,zl="firebase-heartbeat-store";let Lf=null;function f1(){return Lf||(Lf=tR(MR,LR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(zl)}catch(n){console.warn(n)}}}}).catch(t=>{throw ys.create("idb-open",{originalErrorMessage:t.message})})),Lf}async function FR(t){try{const n=(await f1()).transaction(zl),r=await n.objectStore(zl).get(m1(t));return await n.done,r}catch(e){if(e instanceof Mn)Tr.warn(e.message);else{const n=ys.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Tr.warn(n.message)}}}async function x0(t,e){try{const r=(await f1()).transaction(zl,"readwrite");await r.objectStore(zl).put(e,m1(t)),await r.done}catch(n){if(n instanceof Mn)Tr.warn(n.message);else{const r=ys.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Tr.warn(r.message)}}}function m1(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR=1024,zR=30;class BR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new qR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=w0();if(((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)==null?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>zR){const o=HR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Tr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)==null?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=w0(),{heartbeatsToSend:r,unsentEntries:s}=$R(this._heartbeatsCache.heartbeats),i=fd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Tr.warn(n),""}}}function w0(){return new Date().toISOString().substring(0,10)}function $R(t,e=UR){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),E0(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),E0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class qR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return c1()?Rk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await FR(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return x0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const r=await this.read();return x0(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function E0(t){return fd(JSON.stringify({version:2,heartbeats:t})).length}function HR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GR(t){bs(new Ir("platform-logger",e=>new sR(e),"PRIVATE")),bs(new Ir("heartbeat",e=>new BR(e),"PRIVATE")),In(lp,v0,t),In(lp,v0,"esm2020"),In("fire-js","")}GR("");var I0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var vs,p1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,y){function S(){}S.prototype=y.prototype,E.F=y.prototype,E.prototype=new S,E.prototype.constructor=E,E.D=function(N,w,k){for(var b=Array(arguments.length-2),se=2;se<arguments.length;se++)b[se-2]=arguments[se];return y.prototype[w].apply(N,b)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,y,S){S||(S=0);const N=Array(16);if(typeof y=="string")for(var w=0;w<16;++w)N[w]=y.charCodeAt(S++)|y.charCodeAt(S++)<<8|y.charCodeAt(S++)<<16|y.charCodeAt(S++)<<24;else for(w=0;w<16;++w)N[w]=y[S++]|y[S++]<<8|y[S++]<<16|y[S++]<<24;y=E.g[0],S=E.g[1],w=E.g[2];let k=E.g[3],b;b=y+(k^S&(w^k))+N[0]+3614090360&4294967295,y=S+(b<<7&4294967295|b>>>25),b=k+(w^y&(S^w))+N[1]+3905402710&4294967295,k=y+(b<<12&4294967295|b>>>20),b=w+(S^k&(y^S))+N[2]+606105819&4294967295,w=k+(b<<17&4294967295|b>>>15),b=S+(y^w&(k^y))+N[3]+3250441966&4294967295,S=w+(b<<22&4294967295|b>>>10),b=y+(k^S&(w^k))+N[4]+4118548399&4294967295,y=S+(b<<7&4294967295|b>>>25),b=k+(w^y&(S^w))+N[5]+1200080426&4294967295,k=y+(b<<12&4294967295|b>>>20),b=w+(S^k&(y^S))+N[6]+2821735955&4294967295,w=k+(b<<17&4294967295|b>>>15),b=S+(y^w&(k^y))+N[7]+4249261313&4294967295,S=w+(b<<22&4294967295|b>>>10),b=y+(k^S&(w^k))+N[8]+1770035416&4294967295,y=S+(b<<7&4294967295|b>>>25),b=k+(w^y&(S^w))+N[9]+2336552879&4294967295,k=y+(b<<12&4294967295|b>>>20),b=w+(S^k&(y^S))+N[10]+4294925233&4294967295,w=k+(b<<17&4294967295|b>>>15),b=S+(y^w&(k^y))+N[11]+2304563134&4294967295,S=w+(b<<22&4294967295|b>>>10),b=y+(k^S&(w^k))+N[12]+1804603682&4294967295,y=S+(b<<7&4294967295|b>>>25),b=k+(w^y&(S^w))+N[13]+4254626195&4294967295,k=y+(b<<12&4294967295|b>>>20),b=w+(S^k&(y^S))+N[14]+2792965006&4294967295,w=k+(b<<17&4294967295|b>>>15),b=S+(y^w&(k^y))+N[15]+1236535329&4294967295,S=w+(b<<22&4294967295|b>>>10),b=y+(w^k&(S^w))+N[1]+4129170786&4294967295,y=S+(b<<5&4294967295|b>>>27),b=k+(S^w&(y^S))+N[6]+3225465664&4294967295,k=y+(b<<9&4294967295|b>>>23),b=w+(y^S&(k^y))+N[11]+643717713&4294967295,w=k+(b<<14&4294967295|b>>>18),b=S+(k^y&(w^k))+N[0]+3921069994&4294967295,S=w+(b<<20&4294967295|b>>>12),b=y+(w^k&(S^w))+N[5]+3593408605&4294967295,y=S+(b<<5&4294967295|b>>>27),b=k+(S^w&(y^S))+N[10]+38016083&4294967295,k=y+(b<<9&4294967295|b>>>23),b=w+(y^S&(k^y))+N[15]+3634488961&4294967295,w=k+(b<<14&4294967295|b>>>18),b=S+(k^y&(w^k))+N[4]+3889429448&4294967295,S=w+(b<<20&4294967295|b>>>12),b=y+(w^k&(S^w))+N[9]+568446438&4294967295,y=S+(b<<5&4294967295|b>>>27),b=k+(S^w&(y^S))+N[14]+3275163606&4294967295,k=y+(b<<9&4294967295|b>>>23),b=w+(y^S&(k^y))+N[3]+4107603335&4294967295,w=k+(b<<14&4294967295|b>>>18),b=S+(k^y&(w^k))+N[8]+1163531501&4294967295,S=w+(b<<20&4294967295|b>>>12),b=y+(w^k&(S^w))+N[13]+2850285829&4294967295,y=S+(b<<5&4294967295|b>>>27),b=k+(S^w&(y^S))+N[2]+4243563512&4294967295,k=y+(b<<9&4294967295|b>>>23),b=w+(y^S&(k^y))+N[7]+1735328473&4294967295,w=k+(b<<14&4294967295|b>>>18),b=S+(k^y&(w^k))+N[12]+2368359562&4294967295,S=w+(b<<20&4294967295|b>>>12),b=y+(S^w^k)+N[5]+4294588738&4294967295,y=S+(b<<4&4294967295|b>>>28),b=k+(y^S^w)+N[8]+2272392833&4294967295,k=y+(b<<11&4294967295|b>>>21),b=w+(k^y^S)+N[11]+1839030562&4294967295,w=k+(b<<16&4294967295|b>>>16),b=S+(w^k^y)+N[14]+4259657740&4294967295,S=w+(b<<23&4294967295|b>>>9),b=y+(S^w^k)+N[1]+2763975236&4294967295,y=S+(b<<4&4294967295|b>>>28),b=k+(y^S^w)+N[4]+1272893353&4294967295,k=y+(b<<11&4294967295|b>>>21),b=w+(k^y^S)+N[7]+4139469664&4294967295,w=k+(b<<16&4294967295|b>>>16),b=S+(w^k^y)+N[10]+3200236656&4294967295,S=w+(b<<23&4294967295|b>>>9),b=y+(S^w^k)+N[13]+681279174&4294967295,y=S+(b<<4&4294967295|b>>>28),b=k+(y^S^w)+N[0]+3936430074&4294967295,k=y+(b<<11&4294967295|b>>>21),b=w+(k^y^S)+N[3]+3572445317&4294967295,w=k+(b<<16&4294967295|b>>>16),b=S+(w^k^y)+N[6]+76029189&4294967295,S=w+(b<<23&4294967295|b>>>9),b=y+(S^w^k)+N[9]+3654602809&4294967295,y=S+(b<<4&4294967295|b>>>28),b=k+(y^S^w)+N[12]+3873151461&4294967295,k=y+(b<<11&4294967295|b>>>21),b=w+(k^y^S)+N[15]+530742520&4294967295,w=k+(b<<16&4294967295|b>>>16),b=S+(w^k^y)+N[2]+3299628645&4294967295,S=w+(b<<23&4294967295|b>>>9),b=y+(w^(S|~k))+N[0]+4096336452&4294967295,y=S+(b<<6&4294967295|b>>>26),b=k+(S^(y|~w))+N[7]+1126891415&4294967295,k=y+(b<<10&4294967295|b>>>22),b=w+(y^(k|~S))+N[14]+2878612391&4294967295,w=k+(b<<15&4294967295|b>>>17),b=S+(k^(w|~y))+N[5]+4237533241&4294967295,S=w+(b<<21&4294967295|b>>>11),b=y+(w^(S|~k))+N[12]+1700485571&4294967295,y=S+(b<<6&4294967295|b>>>26),b=k+(S^(y|~w))+N[3]+2399980690&4294967295,k=y+(b<<10&4294967295|b>>>22),b=w+(y^(k|~S))+N[10]+4293915773&4294967295,w=k+(b<<15&4294967295|b>>>17),b=S+(k^(w|~y))+N[1]+2240044497&4294967295,S=w+(b<<21&4294967295|b>>>11),b=y+(w^(S|~k))+N[8]+1873313359&4294967295,y=S+(b<<6&4294967295|b>>>26),b=k+(S^(y|~w))+N[15]+4264355552&4294967295,k=y+(b<<10&4294967295|b>>>22),b=w+(y^(k|~S))+N[6]+2734768916&4294967295,w=k+(b<<15&4294967295|b>>>17),b=S+(k^(w|~y))+N[13]+1309151649&4294967295,S=w+(b<<21&4294967295|b>>>11),b=y+(w^(S|~k))+N[4]+4149444226&4294967295,y=S+(b<<6&4294967295|b>>>26),b=k+(S^(y|~w))+N[11]+3174756917&4294967295,k=y+(b<<10&4294967295|b>>>22),b=w+(y^(k|~S))+N[2]+718787259&4294967295,w=k+(b<<15&4294967295|b>>>17),b=S+(k^(w|~y))+N[9]+3951481745&4294967295,E.g[0]=E.g[0]+y&4294967295,E.g[1]=E.g[1]+(w+(b<<21&4294967295|b>>>11))&4294967295,E.g[2]=E.g[2]+w&4294967295,E.g[3]=E.g[3]+k&4294967295}r.prototype.v=function(E,y){y===void 0&&(y=E.length);const S=y-this.blockSize,N=this.C;let w=this.h,k=0;for(;k<y;){if(w==0)for(;k<=S;)s(this,E,k),k+=this.blockSize;if(typeof E=="string"){for(;k<y;)if(N[w++]=E.charCodeAt(k++),w==this.blockSize){s(this,N),w=0;break}}else for(;k<y;)if(N[w++]=E[k++],w==this.blockSize){s(this,N),w=0;break}}this.h=w,this.o+=y},r.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var y=1;y<E.length-8;++y)E[y]=0;y=this.o*8;for(var S=E.length-8;S<E.length;++S)E[S]=y&255,y/=256;for(this.v(E),E=Array(16),y=0,S=0;S<4;++S)for(let N=0;N<32;N+=8)E[y++]=this.g[S]>>>N&255;return E};function i(E,y){var S=a;return Object.prototype.hasOwnProperty.call(S,E)?S[E]:S[E]=y(E)}function o(E,y){this.h=y;const S=[];let N=!0;for(let w=E.length-1;w>=0;w--){const k=E[w]|0;N&&k==y||(S[w]=k,N=!1)}this.g=S}var a={};function c(E){return-128<=E&&E<128?i(E,function(y){return new o([y|0],y<0?-1:0)}):new o([E|0],E<0?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return m;if(E<0)return R(d(-E));const y=[];let S=1;for(let N=0;E>=S;N++)y[N]=E/S|0,S*=4294967296;return new o(y,0)}function h(E,y){if(E.length==0)throw Error("number format error: empty string");if(y=y||10,y<2||36<y)throw Error("radix out of range: "+y);if(E.charAt(0)=="-")return R(h(E.substring(1),y));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const S=d(Math.pow(y,8));let N=m;for(let k=0;k<E.length;k+=8){var w=Math.min(8,E.length-k);const b=parseInt(E.substring(k,k+w),y);w<8?(w=d(Math.pow(y,w)),N=N.j(w).add(d(b))):(N=N.j(S),N=N.add(d(b)))}return N}var m=c(0),g=c(1),x=c(16777216);t=o.prototype,t.m=function(){if(C(this))return-R(this).m();let E=0,y=1;for(let S=0;S<this.g.length;S++){const N=this.i(S);E+=(N>=0?N:4294967296+N)*y,y*=4294967296}return E},t.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(A(this))return"0";if(C(this))return"-"+R(this).toString(E);const y=d(Math.pow(E,6));var S=this;let N="";for(;;){const w=D(S,y).g;S=I(S,w.j(y));let k=((S.g.length>0?S.g[0]:S.h)>>>0).toString(E);if(S=w,A(S))return k+N;for(;k.length<6;)k="0"+k;N=k+N}},t.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function A(E){if(E.h!=0)return!1;for(let y=0;y<E.g.length;y++)if(E.g[y]!=0)return!1;return!0}function C(E){return E.h==-1}t.l=function(E){return E=I(this,E),C(E)?-1:A(E)?0:1};function R(E){const y=E.g.length,S=[];for(let N=0;N<y;N++)S[N]=~E.g[N];return new o(S,~E.h).add(g)}t.abs=function(){return C(this)?R(this):this},t.add=function(E){const y=Math.max(this.g.length,E.g.length),S=[];let N=0;for(let w=0;w<=y;w++){let k=N+(this.i(w)&65535)+(E.i(w)&65535),b=(k>>>16)+(this.i(w)>>>16)+(E.i(w)>>>16);N=b>>>16,k&=65535,b&=65535,S[w]=b<<16|k}return new o(S,S[S.length-1]&-2147483648?-1:0)};function I(E,y){return E.add(R(y))}t.j=function(E){if(A(this)||A(E))return m;if(C(this))return C(E)?R(this).j(R(E)):R(R(this).j(E));if(C(E))return R(this.j(R(E)));if(this.l(x)<0&&E.l(x)<0)return d(this.m()*E.m());const y=this.g.length+E.g.length,S=[];for(var N=0;N<2*y;N++)S[N]=0;for(N=0;N<this.g.length;N++)for(let w=0;w<E.g.length;w++){const k=this.i(N)>>>16,b=this.i(N)&65535,se=E.i(w)>>>16,ae=E.i(w)&65535;S[2*N+2*w]+=b*ae,v(S,2*N+2*w),S[2*N+2*w+1]+=k*ae,v(S,2*N+2*w+1),S[2*N+2*w+1]+=b*se,v(S,2*N+2*w+1),S[2*N+2*w+2]+=k*se,v(S,2*N+2*w+2)}for(E=0;E<y;E++)S[E]=S[2*E+1]<<16|S[2*E];for(E=y;E<2*y;E++)S[E]=0;return new o(S,0)};function v(E,y){for(;(E[y]&65535)!=E[y];)E[y+1]+=E[y]>>>16,E[y]&=65535,y++}function T(E,y){this.g=E,this.h=y}function D(E,y){if(A(y))throw Error("division by zero");if(A(E))return new T(m,m);if(C(E))return y=D(R(E),y),new T(R(y.g),R(y.h));if(C(y))return y=D(E,R(y)),new T(R(y.g),y.h);if(E.g.length>30){if(C(E)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var S=g,N=y;N.l(E)<=0;)S=O(S),N=O(N);var w=U(S,1),k=U(N,1);for(N=U(N,2),S=U(S,2);!A(N);){var b=k.add(N);b.l(E)<=0&&(w=w.add(S),k=b),N=U(N,1),S=U(S,1)}return y=I(E,w.j(y)),new T(w,y)}for(w=m;E.l(y)>=0;){for(S=Math.max(1,Math.floor(E.m()/y.m())),N=Math.ceil(Math.log(S)/Math.LN2),N=N<=48?1:Math.pow(2,N-48),k=d(S),b=k.j(y);C(b)||b.l(E)>0;)S-=N,k=d(S),b=k.j(y);A(k)&&(k=g),w=w.add(k),E=I(E,b)}return new T(w,E)}t.B=function(E){return D(this,E).h},t.and=function(E){const y=Math.max(this.g.length,E.g.length),S=[];for(let N=0;N<y;N++)S[N]=this.i(N)&E.i(N);return new o(S,this.h&E.h)},t.or=function(E){const y=Math.max(this.g.length,E.g.length),S=[];for(let N=0;N<y;N++)S[N]=this.i(N)|E.i(N);return new o(S,this.h|E.h)},t.xor=function(E){const y=Math.max(this.g.length,E.g.length),S=[];for(let N=0;N<y;N++)S[N]=this.i(N)^E.i(N);return new o(S,this.h^E.h)};function O(E){const y=E.g.length+1,S=[];for(let N=0;N<y;N++)S[N]=E.i(N)<<1|E.i(N-1)>>>31;return new o(S,E.h)}function U(E,y){const S=y>>5;y%=32;const N=E.g.length-S,w=[];for(let k=0;k<N;k++)w[k]=y>0?E.i(k+S)>>>y|E.i(k+S+1)<<32-y:E.i(k+S);return new o(w,E.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,p1=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,vs=o}).apply(typeof I0<"u"?I0:typeof self<"u"?self:typeof window<"u"?window:{});var Xc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var g1,Wa,y1,bu,dp,v1,_1,x1;(function(){var t,e=Object.defineProperty;function n(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof Xc=="object"&&Xc];for(var f=0;f<l.length;++f){var p=l[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var r=n(this);function s(l,f){if(f)e:{var p=r;l=l.split(".");for(var _=0;_<l.length-1;_++){var V=l[_];if(!(V in p))break e;p=p[V]}l=l[l.length-1],_=p[l],f=f(_),f!=_&&f!=null&&e(p,l,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(f){var p=[],_;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&p.push([_,f[_]]);return p}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var i=i||{},o=this||self;function a(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function c(l,f,p){return l.call.apply(l.bind,arguments)}function d(l,f,p){return d=c,d.apply(null,arguments)}function h(l,f){var p=Array.prototype.slice.call(arguments,1);return function(){var _=p.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function m(l,f){function p(){}p.prototype=f.prototype,l.Z=f.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(_,V,M){for(var X=Array(arguments.length-2),ye=2;ye<arguments.length;ye++)X[ye-2]=arguments[ye];return f.prototype[V].apply(_,X)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function x(l){const f=l.length;if(f>0){const p=Array(f);for(let _=0;_<f;_++)p[_]=l[_];return p}return[]}function A(l,f){for(let _=1;_<arguments.length;_++){const V=arguments[_];var p=typeof V;if(p=p!="object"?p:V?Array.isArray(V)?"array":p:"null",p=="array"||p=="object"&&typeof V.length=="number"){p=l.length||0;const M=V.length||0;l.length=p+M;for(let X=0;X<M;X++)l[p+X]=V[X]}else l.push(V)}}class C{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function R(l){o.setTimeout(()=>{throw l},0)}function I(){var l=E;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class v{constructor(){this.h=this.g=null}add(f,p){const _=T.get();_.set(f,p),this.h?this.h.next=_:this.g=_,this.h=_}}var T=new C(()=>new D,l=>l.reset());class D{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let O,U=!1,E=new v,y=()=>{const l=Promise.resolve(void 0);O=()=>{l.then(S)}};function S(){for(var l;l=I();){try{l.h.call(l.g)}catch(p){R(p)}var f=T;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}U=!1}function N(){this.u=this.u,this.C=this.C}N.prototype.u=!1,N.prototype.dispose=function(){this.u||(this.u=!0,this.N())},N.prototype[Symbol.dispose]=function(){this.dispose()},N.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function w(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}w.prototype.h=function(){this.defaultPrevented=!0};var k=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};o.addEventListener("test",p,f),o.removeEventListener("test",p,f)}catch{}return l}();function b(l){return/^[\s\xa0]*$/.test(l)}function se(l,f){w.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}m(se,w),se.prototype.init=function(l,f){const p=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(p=="mouseover"?f=l.fromElement:p=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&se.Z.h.call(this)},se.prototype.h=function(){se.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var ae="closure_listenable_"+(Math.random()*1e6|0),K=0;function we(l,f,p,_,V){this.listener=l,this.proxy=null,this.src=f,this.type=p,this.capture=!!_,this.ha=V,this.key=++K,this.da=this.fa=!1}function $(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function L(l,f,p){for(const _ in l)f.call(p,l[_],_,l)}function G(l,f){for(const p in l)f.call(void 0,l[p],p,l)}function Y(l){const f={};for(const p in l)f[p]=l[p];return f}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function me(l,f){let p,_;for(let V=1;V<arguments.length;V++){_=arguments[V];for(p in _)l[p]=_[p];for(let M=0;M<W.length;M++)p=W[M],Object.prototype.hasOwnProperty.call(_,p)&&(l[p]=_[p])}}function ue(l){this.src=l,this.g={},this.h=0}ue.prototype.add=function(l,f,p,_,V){const M=l.toString();l=this.g[M],l||(l=this.g[M]=[],this.h++);const X=_e(l,f,_,V);return X>-1?(f=l[X],p||(f.fa=!1)):(f=new we(f,this.src,M,!!_,V),f.fa=p,l.push(f)),f};function Se(l,f){const p=f.type;if(p in l.g){var _=l.g[p],V=Array.prototype.indexOf.call(_,f,void 0),M;(M=V>=0)&&Array.prototype.splice.call(_,V,1),M&&($(f),l.g[p].length==0&&(delete l.g[p],l.h--))}}function _e(l,f,p,_){for(let V=0;V<l.length;++V){const M=l[V];if(!M.da&&M.listener==f&&M.capture==!!p&&M.ha==_)return V}return-1}var Ne="closure_lm_"+(Math.random()*1e6|0),je={};function St(l,f,p,_,V){if(Array.isArray(f)){for(let M=0;M<f.length;M++)St(l,f[M],p,_,V);return null}return p=Mi(p),l&&l[ae]?l.J(f,p,a(_)?!!_.capture:!1,V):Ln(l,f,p,!1,_,V)}function Ln(l,f,p,_,V,M){if(!f)throw Error("Invalid event type");const X=a(V)?!!V.capture:!!V;let ye=Un(l);if(ye||(l[Ne]=ye=new ue(l)),p=ye.add(f,p,_,X,M),p.proxy)return p;if(_=Vi(),p.proxy=_,_.src=l,_.listener=p,l.addEventListener)k||(V=X),V===void 0&&(V=!1),l.addEventListener(f.toString(),_,V);else if(l.attachEvent)l.attachEvent(Oi(f.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return p}function Vi(){function l(p){return f.call(l.src,l.listener,p)}const f=gt;return l}function Or(l,f,p,_,V){if(Array.isArray(f))for(var M=0;M<f.length;M++)Or(l,f[M],p,_,V);else _=a(_)?!!_.capture:!!_,p=Mi(p),l&&l[ae]?(l=l.i,M=String(f).toString(),M in l.g&&(f=l.g[M],p=_e(f,p,_,V),p>-1&&($(f[p]),Array.prototype.splice.call(f,p,1),f.length==0&&(delete l.g[M],l.h--)))):l&&(l=Un(l))&&(f=l.g[f.toString()],l=-1,f&&(l=_e(f,p,_,V)),(p=l>-1?f[l]:null)&&Fn(p))}function Fn(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[ae])Se(f.i,l);else{var p=l.type,_=l.proxy;f.removeEventListener?f.removeEventListener(p,_,l.capture):f.detachEvent?f.detachEvent(Oi(p),_):f.addListener&&f.removeListener&&f.removeListener(_),(p=Un(f))?(Se(p,l),p.h==0&&(p.src=null,f[Ne]=null)):$(l)}}}function Oi(l){return l in je?je[l]:je[l]="on"+l}function gt(l,f){if(l.da)l=!0;else{f=new se(f,this);const p=l.listener,_=l.ha||l.src;l.fa&&Fn(l),l=p.call(_,f)}return l}function Un(l){return l=l[Ne],l instanceof ue?l:null}var Fs="__closure_events_fn_"+(Math.random()*1e9>>>0);function Mi(l){return typeof l=="function"?l:(l[Fs]||(l[Fs]=function(f){return l.handleEvent(f)}),l[Fs])}function B(){N.call(this),this.i=new ue(this),this.M=this,this.G=null}m(B,N),B.prototype[ae]=!0,B.prototype.removeEventListener=function(l,f,p,_){Or(this,l,f,p,_)};function le(l,f){var p,_=l.G;if(_)for(p=[];_;_=_.G)p.push(_);if(l=l.M,_=f.type||f,typeof f=="string")f=new w(f,l);else if(f instanceof w)f.target=f.target||l;else{var V=f;f=new w(_,l),me(f,V)}V=!0;let M,X;if(p)for(X=p.length-1;X>=0;X--)M=f.g=p[X],V=F(M,_,!0,f)&&V;if(M=f.g=l,V=F(M,_,!0,f)&&V,V=F(M,_,!1,f)&&V,p)for(X=0;X<p.length;X++)M=f.g=p[X],V=F(M,_,!1,f)&&V}B.prototype.N=function(){if(B.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const p=l.g[f];for(let _=0;_<p.length;_++)$(p[_]);delete l.g[f],l.h--}}this.G=null},B.prototype.J=function(l,f,p,_){return this.i.add(String(l),f,!1,p,_)},B.prototype.K=function(l,f,p,_){return this.i.add(String(l),f,!0,p,_)};function F(l,f,p,_){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let V=!0;for(let M=0;M<f.length;++M){const X=f[M];if(X&&!X.da&&X.capture==p){const ye=X.listener,lt=X.ha||X.src;X.fa&&Se(l.i,X),V=ye.call(lt,_)!==!1&&V}}return V&&!_.defaultPrevented}function Z(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=d(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(l,f||0)}function te(l){l.g=Z(()=>{l.g=null,l.i&&(l.i=!1,te(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class de extends N{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:te(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pe(l){N.call(this),this.h=l,this.g={}}m(pe,N);var Lt=[];function ar(l){L(l.g,function(f,p){this.g.hasOwnProperty(p)&&Fn(f)},l),l.g={}}pe.prototype.N=function(){pe.Z.N.call(this),ar(this)},pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gn=o.JSON.stringify,qh=o.JSON.parse,XS=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function av(){}function lv(){}var la={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Hh(){w.call(this,"d")}m(Hh,w);function Gh(){w.call(this,"c")}m(Gh,w);var Us={},cv=null;function Tc(){return cv=cv||new B}Us.Ia="serverreachability";function uv(l){w.call(this,Us.Ia,l)}m(uv,w);function ca(l){const f=Tc();le(f,new uv(f))}Us.STAT_EVENT="statevent";function dv(l,f){w.call(this,Us.STAT_EVENT,l),this.stat=f}m(dv,w);function Ft(l){const f=Tc();le(f,new dv(f,l))}Us.Ja="timingevent";function hv(l,f){w.call(this,Us.Ja,l),this.size=f}m(hv,w);function ua(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},f)}function da(){this.g=!0}da.prototype.ua=function(){this.g=!1};function ZS(l,f,p,_,V,M){l.info(function(){if(l.g)if(M){var X="",ye=M.split("&");for(let Ve=0;Ve<ye.length;Ve++){var lt=ye[Ve].split("=");if(lt.length>1){const yt=lt[0];lt=lt[1];const Bn=yt.split("_");X=Bn.length>=2&&Bn[1]=="type"?X+(yt+"="+lt+"&"):X+(yt+"=redacted&")}}}else X=null;else X=M;return"XMLHTTP REQ ("+_+") [attempt "+V+"]: "+f+`
`+p+`
`+X})}function eA(l,f,p,_,V,M,X){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+V+"]: "+f+`
`+p+`
`+M+" "+X})}function Li(l,f,p,_){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+nA(l,p)+(_?" "+_:"")})}function tA(l,f){l.info(function(){return"TIMEOUT: "+f})}da.prototype.info=function(){};function nA(l,f){if(!l.g)return f;if(!f)return null;try{const M=JSON.parse(f);if(M){for(l=0;l<M.length;l++)if(Array.isArray(M[l])){var p=M[l];if(!(p.length<2)){var _=p[1];if(Array.isArray(_)&&!(_.length<1)){var V=_[0];if(V!="noop"&&V!="stop"&&V!="close")for(let X=1;X<_.length;X++)_[X]=""}}}}return gn(M)}catch{return f}}var bc={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},fv={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},mv;function Kh(){}m(Kh,av),Kh.prototype.g=function(){return new XMLHttpRequest},mv=new Kh;function ha(l){return encodeURIComponent(String(l))}function rA(l){var f=1;l=l.split(":");const p=[];for(;f>0&&l.length;)p.push(l.shift()),f--;return l.length&&p.push(l.join(":")),p}function Mr(l,f,p,_){this.j=l,this.i=f,this.l=p,this.S=_||1,this.V=new pe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new pv}function pv(){this.i=null,this.g="",this.h=!1}var gv={},Wh={};function Qh(l,f,p){l.M=1,l.A=Ac(zn(f)),l.u=p,l.R=!0,yv(l,null)}function yv(l,f){l.F=Date.now(),Sc(l),l.B=zn(l.A);var p=l.B,_=l.S;Array.isArray(_)||(_=[String(_)]),kv(p.i,"t",_),l.C=0,p=l.j.L,l.h=new pv,l.g=Wv(l.j,p?f:null,!l.u),l.P>0&&(l.O=new de(d(l.Y,l,l.g),l.P)),f=l.V,p=l.g,_=l.ba;var V="readystatechange";Array.isArray(V)||(V&&(Lt[0]=V.toString()),V=Lt);for(let M=0;M<V.length;M++){const X=St(p,V[M],_||f.handleEvent,!1,f.h||f);if(!X)break;f.g[X.key]=X}f=l.J?Y(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),ca(),ZS(l.i,l.v,l.B,l.l,l.S,l.u)}Mr.prototype.ba=function(l){l=l.target;const f=this.O;f&&Ur(l)==3?f.j():this.Y(l)},Mr.prototype.Y=function(l){try{if(l==this.g)e:{const ye=Ur(this.g),lt=this.g.ya(),Ve=this.g.ca();if(!(ye<3)&&(ye!=3||this.g&&(this.h.h||this.g.la()||Mv(this.g)))){this.K||ye!=4||lt==7||(lt==8||Ve<=0?ca(3):ca(2)),Yh(this);var f=this.g.ca();this.X=f;var p=sA(this);if(this.o=f==200,eA(this.i,this.v,this.B,this.l,this.S,ye,f),this.o){if(this.U&&!this.L){t:{if(this.g){var _,V=this.g;if((_=V.g?V.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(_)){var M=_;break t}}M=null}if(l=M)Li(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Jh(this,l);else{this.o=!1,this.m=3,Ft(12),zs(this),fa(this);break e}}if(this.R){l=!0;let yt;for(;!this.K&&this.C<p.length;)if(yt=iA(this,p),yt==Wh){ye==4&&(this.m=4,Ft(14),l=!1),Li(this.i,this.l,null,"[Incomplete Response]");break}else if(yt==gv){this.m=4,Ft(15),Li(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else Li(this.i,this.l,yt,null),Jh(this,yt);if(vv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ye!=4||p.length!=0||this.h.h||(this.m=1,Ft(16),l=!1),this.o=this.o&&l,!l)Li(this.i,this.l,p,"[Invalid Chunked Response]"),zs(this),fa(this);else if(p.length>0&&!this.W){this.W=!0;var X=this.j;X.g==this&&X.aa&&!X.P&&(X.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),of(X),X.P=!0,Ft(11))}}else Li(this.i,this.l,p,null),Jh(this,p);ye==4&&zs(this),this.o&&!this.K&&(ye==4?qv(this.j,this):(this.o=!1,Sc(this)))}else _A(this.g),f==400&&p.indexOf("Unknown SID")>0?(this.m=3,Ft(12)):(this.m=0,Ft(13)),zs(this),fa(this)}}}catch{}finally{}};function sA(l){if(!vv(l))return l.g.la();const f=Mv(l.g);if(f==="")return"";let p="";const _=f.length,V=Ur(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return zs(l),fa(l),"";l.h.i=new o.TextDecoder}for(let M=0;M<_;M++)l.h.h=!0,p+=l.h.i.decode(f[M],{stream:!(V&&M==_-1)});return f.length=0,l.h.g+=p,l.C=0,l.h.g}function vv(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function iA(l,f){var p=l.C,_=f.indexOf(`
`,p);return _==-1?Wh:(p=Number(f.substring(p,_)),isNaN(p)?gv:(_+=1,_+p>f.length?Wh:(f=f.slice(_,_+p),l.C=_+p,f)))}Mr.prototype.cancel=function(){this.K=!0,zs(this)};function Sc(l){l.T=Date.now()+l.H,_v(l,l.H)}function _v(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=ua(d(l.aa,l),f)}function Yh(l){l.D&&(o.clearTimeout(l.D),l.D=null)}Mr.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(tA(this.i,this.B),this.M!=2&&(ca(),Ft(17)),zs(this),this.m=2,fa(this)):_v(this,this.T-l)};function fa(l){l.j.I==0||l.K||qv(l.j,l)}function zs(l){Yh(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,ar(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function Jh(l,f){try{var p=l.j;if(p.I!=0&&(p.g==l||Xh(p.h,l))){if(!l.L&&Xh(p.h,l)&&p.I==3){try{var _=p.Ba.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var V=_;if(V[0]==0){e:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)Pc(p),kc(p);else break e;sf(p),Ft(18)}}else p.xa=V[1],0<p.xa-p.K&&V[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=ua(d(p.Va,p),6e3));Ev(p.h)<=1&&p.ta&&(p.ta=void 0)}else $s(p,11)}else if((l.L||p.g==l)&&Pc(p),!b(f))for(V=p.Ba.g.parse(f),f=0;f<V.length;f++){let Ve=V[f];const yt=Ve[0];if(!(yt<=p.K))if(p.K=yt,Ve=Ve[1],p.I==2)if(Ve[0]=="c"){p.M=Ve[1],p.ba=Ve[2];const Bn=Ve[3];Bn!=null&&(p.ka=Bn,p.j.info("VER="+p.ka));const qs=Ve[4];qs!=null&&(p.za=qs,p.j.info("SVER="+p.za));const zr=Ve[5];zr!=null&&typeof zr=="number"&&zr>0&&(_=1.5*zr,p.O=_,p.j.info("backChannelRequestTimeoutMs_="+_)),_=p;const Br=l.g;if(Br){const jc=Br.g?Br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(jc){var M=_.h;M.g||jc.indexOf("spdy")==-1&&jc.indexOf("quic")==-1&&jc.indexOf("h2")==-1||(M.j=M.l,M.g=new Set,M.h&&(Zh(M,M.h),M.h=null))}if(_.G){const af=Br.g?Br.g.getResponseHeader("X-HTTP-Session-Id"):null;af&&(_.wa=af,Ue(_.J,_.G,af))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),_=p;var X=l;if(_.na=Kv(_,_.L?_.ba:null,_.W),X.L){Iv(_.h,X);var ye=X,lt=_.O;lt&&(ye.H=lt),ye.D&&(Yh(ye),Sc(ye)),_.g=X}else Bv(_);p.i.length>0&&Rc(p)}else Ve[0]!="stop"&&Ve[0]!="close"||$s(p,7);else p.I==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?$s(p,7):rf(p):Ve[0]!="noop"&&p.l&&p.l.qa(Ve),p.A=0)}}ca(4)}catch{}}var oA=class{constructor(l,f){this.g=l,this.map=f}};function xv(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function wv(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Ev(l){return l.h?1:l.g?l.g.size:0}function Xh(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function Zh(l,f){l.g?l.g.add(f):l.h=f}function Iv(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}xv.prototype.cancel=function(){if(this.i=Tv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function Tv(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const p of l.g.values())f=f.concat(p.G);return f}return x(l.i)}var bv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function aA(l,f){if(l){l=l.split("&");for(let p=0;p<l.length;p++){const _=l[p].indexOf("=");let V,M=null;_>=0?(V=l[p].substring(0,_),M=l[p].substring(_+1)):V=l[p],f(V,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Lr(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof Lr?(this.l=l.l,ma(this,l.j),this.o=l.o,this.g=l.g,pa(this,l.u),this.h=l.h,ef(this,Rv(l.i)),this.m=l.m):l&&(f=String(l).match(bv))?(this.l=!1,ma(this,f[1]||"",!0),this.o=ga(f[2]||""),this.g=ga(f[3]||"",!0),pa(this,f[4]),this.h=ga(f[5]||"",!0),ef(this,f[6]||"",!0),this.m=ga(f[7]||"")):(this.l=!1,this.i=new va(null,this.l))}Lr.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(ya(f,Sv,!0),":");var p=this.g;return(p||f=="file")&&(l.push("//"),(f=this.o)&&l.push(ya(f,Sv,!0),"@"),l.push(ha(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(ya(p,p.charAt(0)=="/"?uA:cA,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",ya(p,hA)),l.join("")},Lr.prototype.resolve=function(l){const f=zn(this);let p=!!l.j;p?ma(f,l.j):p=!!l.o,p?f.o=l.o:p=!!l.g,p?f.g=l.g:p=l.u!=null;var _=l.h;if(p)pa(f,l.u);else if(p=!!l.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var V=f.h.lastIndexOf("/");V!=-1&&(_=f.h.slice(0,V+1)+_)}if(V=_,V==".."||V==".")_="";else if(V.indexOf("./")!=-1||V.indexOf("/.")!=-1){_=V.lastIndexOf("/",0)==0,V=V.split("/");const M=[];for(let X=0;X<V.length;){const ye=V[X++];ye=="."?_&&X==V.length&&M.push(""):ye==".."?((M.length>1||M.length==1&&M[0]!="")&&M.pop(),_&&X==V.length&&M.push("")):(M.push(ye),_=!0)}_=M.join("/")}else _=V}return p?f.h=_:p=l.i.toString()!=="",p?ef(f,Rv(l.i)):p=!!l.m,p&&(f.m=l.m),f};function zn(l){return new Lr(l)}function ma(l,f,p){l.j=p?ga(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function pa(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function ef(l,f,p){f instanceof va?(l.i=f,fA(l.i,l.l)):(p||(f=ya(f,dA)),l.i=new va(f,l.l))}function Ue(l,f,p){l.i.set(f,p)}function Ac(l){return Ue(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function ga(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function ya(l,f,p){return typeof l=="string"?(l=encodeURI(l).replace(f,lA),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function lA(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var Sv=/[#\/\?@]/g,cA=/[#\?:]/g,uA=/[#\?]/g,dA=/[#\?@]/g,hA=/#/g;function va(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Bs(l){l.g||(l.g=new Map,l.h=0,l.i&&aA(l.i,function(f,p){l.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}t=va.prototype,t.add=function(l,f){Bs(this),this.i=null,l=Fi(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(f),this.h+=1,this};function Av(l,f){Bs(l),f=Fi(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Nv(l,f){return Bs(l),f=Fi(l,f),l.g.has(f)}t.forEach=function(l,f){Bs(this),this.g.forEach(function(p,_){p.forEach(function(V){l.call(f,V,_,this)},this)},this)};function Cv(l,f){Bs(l);let p=[];if(typeof f=="string")Nv(l,f)&&(p=p.concat(l.g.get(Fi(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)p=p.concat(l[f]);return p}t.set=function(l,f){return Bs(this),this.i=null,l=Fi(this,l),Nv(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},t.get=function(l,f){return l?(l=Cv(this,l),l.length>0?String(l[0]):f):f};function kv(l,f,p){Av(l,f),p.length>0&&(l.i=null,l.g.set(Fi(l,f),x(p)),l.h+=p.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let _=0;_<f.length;_++){var p=f[_];const V=ha(p);p=Cv(this,p);for(let M=0;M<p.length;M++){let X=V;p[M]!==""&&(X+="="+ha(p[M])),l.push(X)}}return this.i=l.join("&")};function Rv(l){const f=new va;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function Fi(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function fA(l,f){f&&!l.j&&(Bs(l),l.i=null,l.g.forEach(function(p,_){const V=_.toLowerCase();_!=V&&(Av(this,_),kv(this,V,p))},l)),l.j=f}function mA(l,f){const p=new da;if(o.Image){const _=new Image;_.onload=h(Fr,p,"TestLoadImage: loaded",!0,f,_),_.onerror=h(Fr,p,"TestLoadImage: error",!1,f,_),_.onabort=h(Fr,p,"TestLoadImage: abort",!1,f,_),_.ontimeout=h(Fr,p,"TestLoadImage: timeout",!1,f,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else f(!1)}function pA(l,f){const p=new da,_=new AbortController,V=setTimeout(()=>{_.abort(),Fr(p,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:_.signal}).then(M=>{clearTimeout(V),M.ok?Fr(p,"TestPingServer: ok",!0,f):Fr(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),Fr(p,"TestPingServer: error",!1,f)})}function Fr(l,f,p,_,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),_(p)}catch{}}function gA(){this.g=new XS}function tf(l){this.i=l.Sb||null,this.h=l.ab||!1}m(tf,av),tf.prototype.g=function(){return new Nc(this.i,this.h)};function Nc(l,f){B.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(Nc,B),t=Nc.prototype,t.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,xa(this)},t.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,_a(this)),this.readyState=0},t.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,xa(this)),this.g&&(this.readyState=3,xa(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Pv(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Pv(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}t.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?_a(this):xa(this),this.readyState==3&&Pv(this)}},t.Oa=function(l){this.g&&(this.response=this.responseText=l,_a(this))},t.Na=function(l){this.g&&(this.response=l,_a(this))},t.ga=function(){this.g&&_a(this)};function _a(l){l.readyState=4,l.l=null,l.j=null,l.B=null,xa(l)}t.setRequestHeader=function(l,f){this.A.append(l,f)},t.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=f.next();return l.join(`\r
`)};function xa(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Nc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function Dv(l){let f="";return L(l,function(p,_){f+=_,f+=":",f+=p,f+=`\r
`}),f}function nf(l,f,p){e:{for(_ in p){var _=!1;break e}_=!0}_||(p=Dv(p),typeof l=="string"?p!=null&&ha(p):Ue(l,f,p))}function Qe(l){B.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(Qe,B);var yA=/^https?$/i,vA=["POST","PUT"];t=Qe.prototype,t.Fa=function(l){this.H=l},t.ea=function(l,f,p,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():mv.g(),this.g.onreadystatechange=g(d(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(M){jv(this,M);return}if(l=p||"",p=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var V in _)p.set(V,_[V]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const M of _.keys())p.set(M,_.get(M));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(p.keys()).find(M=>M.toLowerCase()=="content-type"),V=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(vA,f,void 0)>=0)||_||V||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[M,X]of p)this.g.setRequestHeader(M,X);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(M){jv(this,M)}};function jv(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,Vv(l),Cc(l)}function Vv(l){l.A||(l.A=!0,le(l,"complete"),le(l,"error"))}t.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,le(this,"complete"),le(this,"abort"),Cc(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Cc(this,!0)),Qe.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?Ov(this):this.Xa())},t.Xa=function(){Ov(this)};function Ov(l){if(l.h&&typeof i<"u"){if(l.v&&Ur(l)==4)setTimeout(l.Ca.bind(l),0);else if(le(l,"readystatechange"),Ur(l)==4){l.h=!1;try{const M=l.ca();e:switch(M){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var p;if(!(p=f)){var _;if(_=M===0){let X=String(l.D).match(bv)[1]||null;!X&&o.self&&o.self.location&&(X=o.self.location.protocol.slice(0,-1)),_=!yA.test(X?X.toLowerCase():"")}p=_}if(p)le(l,"complete"),le(l,"success");else{l.o=6;try{var V=Ur(l)>2?l.g.statusText:""}catch{V=""}l.l=V+" ["+l.ca()+"]",Vv(l)}}finally{Cc(l)}}}}function Cc(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const p=l.g;l.g=null,f||le(l,"ready");try{p.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function Ur(l){return l.g?l.g.readyState:0}t.ca=function(){try{return Ur(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),qh(f)}};function Mv(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function _A(l){const f={};l=(l.g&&Ur(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(b(l[_]))continue;var p=rA(l[_]);const V=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const M=f[V]||[];f[V]=M,M.push(p)}G(f,function(_){return _.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function wa(l,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||f}function Lv(l){this.za=0,this.i=[],this.j=new da,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=wa("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=wa("baseRetryDelayMs",5e3,l),this.Za=wa("retryDelaySeedMs",1e4,l),this.Ta=wa("forwardChannelMaxRetries",2,l),this.va=wa("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new xv(l&&l.concurrentRequestLimit),this.Ba=new gA,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=Lv.prototype,t.ka=8,t.I=1,t.connect=function(l,f,p,_){Ft(0),this.W=l,this.H=f||{},p&&_!==void 0&&(this.H.OSID=p,this.H.OAID=_),this.F=this.X,this.J=Kv(this,null,this.W),Rc(this)};function rf(l){if(Fv(l),l.I==3){var f=l.V++,p=zn(l.J);if(Ue(p,"SID",l.M),Ue(p,"RID",f),Ue(p,"TYPE","terminate"),Ea(l,p),f=new Mr(l,l.j,f),f.M=2,f.A=Ac(zn(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=f.A,p=!0),p||(f.g=Wv(f.j,null),f.g.ea(f.A)),f.F=Date.now(),Sc(f)}Gv(l)}function kc(l){l.g&&(of(l),l.g.cancel(),l.g=null)}function Fv(l){kc(l),l.v&&(o.clearTimeout(l.v),l.v=null),Pc(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function Rc(l){if(!wv(l.h)&&!l.m){l.m=!0;var f=l.Ea;O||y(),U||(O(),U=!0),E.add(f,l),l.D=0}}function xA(l,f){return Ev(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=ua(d(l.Ea,l,f),Hv(l,l.D)),l.D++,!0)}t.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const V=new Mr(this,this.j,l);let M=this.o;if(this.U&&(M?(M=Y(M),me(M,this.U)):M=this.U),this.u!==null||this.R||(V.J=M,M=null),this.S)e:{for(var f=0,p=0;p<this.i.length;p++){t:{var _=this.i[p];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break t}_=void 0}if(_===void 0)break;if(f+=_,f>4096){f=p;break e}if(f===4096||p===this.i.length-1){f=p+1;break e}}f=1e3}else f=1e3;f=zv(this,V,f),p=zn(this.J),Ue(p,"RID",l),Ue(p,"CVER",22),this.G&&Ue(p,"X-HTTP-Session-Id",this.G),Ea(this,p),M&&(this.R?f="headers="+ha(Dv(M))+"&"+f:this.u&&nf(p,this.u,M)),Zh(this.h,V),this.Ra&&Ue(p,"TYPE","init"),this.S?(Ue(p,"$req",f),Ue(p,"SID","null"),V.U=!0,Qh(V,p,null)):Qh(V,p,f),this.I=2}}else this.I==3&&(l?Uv(this,l):this.i.length==0||wv(this.h)||Uv(this))};function Uv(l,f){var p;f?p=f.l:p=l.V++;const _=zn(l.J);Ue(_,"SID",l.M),Ue(_,"RID",p),Ue(_,"AID",l.K),Ea(l,_),l.u&&l.o&&nf(_,l.u,l.o),p=new Mr(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),f&&(l.i=f.G.concat(l.i)),f=zv(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),Zh(l.h,p),Qh(p,_,f)}function Ea(l,f){l.H&&L(l.H,function(p,_){Ue(f,_,p)}),l.l&&L({},function(p,_){Ue(f,_,p)})}function zv(l,f,p){p=Math.min(l.i.length,p);const _=l.l?d(l.l.Ka,l.l,l):null;e:{var V=l.i;let ye=-1;for(;;){const lt=["count="+p];ye==-1?p>0?(ye=V[0].g,lt.push("ofs="+ye)):ye=0:lt.push("ofs="+ye);let Ve=!0;for(let yt=0;yt<p;yt++){var M=V[yt].g;const Bn=V[yt].map;if(M-=ye,M<0)ye=Math.max(0,V[yt].g-100),Ve=!1;else try{M="req"+M+"_"||"";try{var X=Bn instanceof Map?Bn:Object.entries(Bn);for(const[qs,zr]of X){let Br=zr;a(zr)&&(Br=gn(zr)),lt.push(M+qs+"="+encodeURIComponent(Br))}}catch(qs){throw lt.push(M+"type="+encodeURIComponent("_badmap")),qs}}catch{_&&_(Bn)}}if(Ve){X=lt.join("&");break e}}X=void 0}return l=l.i.splice(0,p),f.G=l,X}function Bv(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;O||y(),U||(O(),U=!0),E.add(f,l),l.A=0}}function sf(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=ua(d(l.Da,l),Hv(l,l.A)),l.A++,!0)}t.Da=function(){if(this.v=null,$v(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=ua(d(this.Wa,this),l)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Ft(10),kc(this),$v(this))};function of(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function $v(l){l.g=new Mr(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=zn(l.na);Ue(f,"RID","rpc"),Ue(f,"SID",l.M),Ue(f,"AID",l.K),Ue(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&Ue(f,"TO",l.ia),Ue(f,"TYPE","xmlhttp"),Ea(l,f),l.u&&l.o&&nf(f,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=Ac(zn(f)),p.u=null,p.R=!0,yv(p,l)}t.Va=function(){this.C!=null&&(this.C=null,kc(this),sf(this),Ft(19))};function Pc(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function qv(l,f){var p=null;if(l.g==f){Pc(l),of(l),l.g=null;var _=2}else if(Xh(l.h,f))p=f.G,Iv(l.h,f),_=1;else return;if(l.I!=0){if(f.o)if(_==1){p=f.u?f.u.length:0,f=Date.now()-f.F;var V=l.D;_=Tc(),le(_,new hv(_,p)),Rc(l)}else Bv(l);else if(V=f.m,V==3||V==0&&f.X>0||!(_==1&&xA(l,f)||_==2&&sf(l)))switch(p&&p.length>0&&(f=l.h,f.i=f.i.concat(p)),V){case 1:$s(l,5);break;case 4:$s(l,10);break;case 3:$s(l,6);break;default:$s(l,2)}}}function Hv(l,f){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*f}function $s(l,f){if(l.j.info("Error code "+f),f==2){var p=d(l.bb,l),_=l.Ua;const V=!_;_=new Lr(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ma(_,"https"),Ac(_),V?mA(_.toString(),p):pA(_.toString(),p)}else Ft(2);l.I=0,l.l&&l.l.pa(f),Gv(l),Fv(l)}t.bb=function(l){l?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function Gv(l){if(l.I=0,l.ja=[],l.l){const f=Tv(l.h);(f.length!=0||l.i.length!=0)&&(A(l.ja,f),A(l.ja,l.i),l.h.i.length=0,x(l.i),l.i.length=0),l.l.oa()}}function Kv(l,f,p){var _=p instanceof Lr?zn(p):new Lr(p);if(_.g!="")f&&(_.g=f+"."+_.g),pa(_,_.u);else{var V=o.location;_=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;const M=new Lr(null);_&&ma(M,_),f&&(M.g=f),V&&pa(M,V),p&&(M.h=p),_=M}return p=l.G,f=l.wa,p&&f&&Ue(_,p,f),Ue(_,"VER",l.ka),Ea(l,_),_}function Wv(l,f,p){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new Qe(new tf({ab:p})):new Qe(l.ma),f.Fa(l.L),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qv(){}t=Qv.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function Dc(){}Dc.prototype.g=function(l,f){return new tn(l,f)};function tn(l,f){B.call(this),this.g=new Lv(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!b(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!b(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new Ui(this)}m(tn,B),tn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},tn.prototype.close=function(){rf(this.g)},tn.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=gn(l),l=p);f.i.push(new oA(f.Ya++,l)),f.I==3&&Rc(f)},tn.prototype.N=function(){this.g.l=null,delete this.j,rf(this.g),delete this.g,tn.Z.N.call(this)};function Yv(l){Hh.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(const p in f){l=p;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}m(Yv,Hh);function Jv(){Gh.call(this),this.status=1}m(Jv,Gh);function Ui(l){this.g=l}m(Ui,Qv),Ui.prototype.ra=function(){le(this.g,"a")},Ui.prototype.qa=function(l){le(this.g,new Yv(l))},Ui.prototype.pa=function(l){le(this.g,new Jv)},Ui.prototype.oa=function(){le(this.g,"b")},Dc.prototype.createWebChannel=Dc.prototype.g,tn.prototype.send=tn.prototype.o,tn.prototype.open=tn.prototype.m,tn.prototype.close=tn.prototype.close,x1=function(){return new Dc},_1=function(){return Tc()},v1=Us,dp={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},bc.NO_ERROR=0,bc.TIMEOUT=8,bc.HTTP_ERROR=6,bu=bc,fv.COMPLETE="complete",y1=fv,lv.EventType=la,la.OPEN="a",la.CLOSE="b",la.ERROR="c",la.MESSAGE="d",B.prototype.listen=B.prototype.J,Wa=lv,Qe.prototype.listenOnce=Qe.prototype.K,Qe.prototype.getLastError=Qe.prototype.Ha,Qe.prototype.getLastErrorCode=Qe.prototype.ya,Qe.prototype.getStatus=Qe.prototype.ca,Qe.prototype.getResponseJson=Qe.prototype.La,Qe.prototype.getResponseText=Qe.prototype.la,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Fa,g1=Qe}).apply(typeof Xc<"u"?Xc:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}kt.UNAUTHENTICATED=new kt(null),kt.GOOGLE_CREDENTIALS=new kt("google-credentials-uid"),kt.FIRST_PARTY=new kt("first-party-uid"),kt.MOCK_USER=new kt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let na="12.9.0";function KR(t){na=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _i=new Bg("@firebase/firestore");function Wi(){return _i.logLevel}function q(t,...e){if(_i.logLevel<=Ee.DEBUG){const n=e.map(Hg);_i.debug(`Firestore (${na}): ${t}`,...n)}}function nt(t,...e){if(_i.logLevel<=Ee.ERROR){const n=e.map(Hg);_i.error(`Firestore (${na}): ${t}`,...n)}}function Ro(t,...e){if(_i.logLevel<=Ee.WARN){const n=e.map(Hg);_i.warn(`Firestore (${na}): ${t}`,...n)}}function Hg(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function re(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,w1(t,r,n)}function w1(t,e,n){let r=`FIRESTORE (${na}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw nt(r),new Error(r)}function oe(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||w1(e,s,r)}function ie(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Q extends Mn{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WR{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(kt.UNAUTHENTICATED))}shutdown(){}}class YR{constructor(e){this.t=e,this.currentUser=kt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){oe(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new er;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new er,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new er)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(oe(typeof r.accessToken=="string",31837,{l:r}),new WR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return oe(e===null||typeof e=="string",2055,{h:e}),new kt(e)}}class JR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=kt.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);const e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}}class XR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new JR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(kt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class T0{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ZR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Kt(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){oe(this.o===void 0,3512);const r=i=>{i.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,q("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new T0(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(oe(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new T0(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=eP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function fe(t,e){return t<e?-1:t>e?1:0}function hp(t,e){const n=Math.min(t.length,e.length);for(let r=0;r<n;r++){const s=t.charAt(r),i=e.charAt(r);if(s!==i)return Ff(s)===Ff(i)?fe(s,i):Ff(s)?1:-1}return fe(t.length,e.length)}const tP=55296,nP=57343;function Ff(t){const e=t.charCodeAt(0);return e>=tP&&e<=nP}function Po(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function E1(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0="__name__";class Hn{constructor(e,n,r){n===void 0?n=0:n>e.length&&re(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&re(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Hn.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Hn?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=Hn.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return fe(e.length,n.length)}static compareSegments(e,n){const r=Hn.isNumericId(e),s=Hn.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?Hn.extractNumericId(e).compare(Hn.extractNumericId(n)):hp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return vs.fromString(e.substring(4,e.length-2))}}class Ae extends Hn{construct(e,n,r){return new Ae(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new Q(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Ae(n)}static emptyPath(){return new Ae([])}}const rP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ge extends Hn{construct(e,n,r){return new Ge(e,n,r)}static isValidIdentifier(e){return rP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ge.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===b0}static keyField(){return new Ge([b0])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new Q(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new Q(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Q(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new Q(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ge(n)}static emptyPath(){return new Ge([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ee{constructor(e){this.path=e}static fromPath(e){return new ee(Ae.fromString(e))}static fromName(e){return new ee(Ae.fromString(e).popFirst(5))}static empty(){return new ee(Ae.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ae.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Ae.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new Ae(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1(t,e,n){if(!n)throw new Q(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function sP(t,e,n,r){if(e===!0&&r===!0)throw new Q(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function S0(t){if(!ee.isDocumentKey(t))throw new Q(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function A0(t){if(ee.isDocumentKey(t))throw new Q(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function T1(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function dh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":re(12329,{type:typeof t})}function un(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Q(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=dh(t);throw new Q(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function at(t,e){const n={typeString:t};return e&&(n.value=e),n}function uc(t,e){if(!T1(t))throw new Q(z.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const s=e[r].typeString,i="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const o=t[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(i!==void 0&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new Q(z.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N0=-62135596800,C0=1e6;class Ce{static now(){return Ce.fromMillis(Date.now())}static fromDate(e){return Ce.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*C0);return new Ce(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<N0)throw new Q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/C0}_compareTo(e){return this.seconds===e.seconds?fe(this.nanoseconds,e.nanoseconds):fe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ce._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(uc(e,Ce._jsonSchema))return new Ce(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-N0;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ce._jsonSchemaVersion="firestore/timestamp/1.0",Ce._jsonSchema={type:at("string",Ce._jsonSchemaVersion),seconds:at("number"),nanoseconds:at("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ce{static fromTimestamp(e){return new ce(e)}static min(){return new ce(new Ce(0,0))}static max(){return new ce(new Ce(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Do=-1;class pd{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function fp(t){return t.fields.find(e=>e.kind===2)}function Qs(t){return t.fields.filter(e=>e.kind!==2)}pd.UNKNOWN_ID=-1;class Su{constructor(e,n){this.fieldPath=e,this.kind=n}}class Bl{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Bl(0,fn.min())}}function b1(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=ce.fromTimestamp(r===1e9?new Ce(n+1,0):new Ce(n,r));return new fn(s,ee.empty(),e)}function S1(t){return new fn(t.readTime,t.key,Do)}class fn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new fn(ce.min(),ee.empty(),Do)}static max(){return new fn(ce.max(),ee.empty(),Do)}}function Kg(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ee.comparator(t.documentKey,e.documentKey),n!==0?n:fe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class N1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ds(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==A1)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&re(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new j((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof j?n:j.resolve(n)}catch(n){return j.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):j.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):j.reject(n)}static resolve(e){return new j((n,r)=>{n(e)})}static reject(e){return new j((n,r)=>{r(e)})}static waitFor(e){return new j((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=j.resolve(!1);for(const r of e)n=n.next(s=>s?j.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new j((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const d=c;n(e[d]).next(h=>{o[d]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new j((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rn="SimpleDb";class hh{static open(e,n,r,s){try{return new hh(n,e.transaction(s,r))}catch(i){throw new dl(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new er,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new dl(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=Wg(r.target.error);this.S.reject(new dl(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(q(rn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new oP(n)}}class _s{static delete(e){return q(rn,"Removing database:",e),Js(t1().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!c1())return!1;if(_s.F())return!0;const e=mt(),n=_s.M(e),r=0<n&&n<10,s=C1(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)==null?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)==="YES"}static O(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.N=r,this.B=null,_s.M(mt())===12.2&&nt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(q(rn,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new dl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new Q(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Q(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new dl(e,o))},s.onupgradeneeded=i=>{q(rn,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.N.k(o,s.transaction,i.oldVersion,this.version).next(()=>{q(rn,"Database upgrade to version "+this.version+" complete")})}})),this.K&&(this.db.onversionchange=n=>this.K(n)),this.db}q(e){this.K=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.L(e);const a=hh.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(d=>(a.C(),d)).catch(d=>(a.abort(d),j.reject(d))).toPromise();return c.catch(()=>{}),await a.D,c}catch(a){const c=a,d=c.name!=="FirebaseError"&&o<3;if(q(rn,"Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function C1(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class iP{constructor(e){this.U=e,this.$=!1,this.W=null}get isDone(){return this.$}get G(){return this.W}set cursor(e){this.U=e}done(){this.$=!0}j(e){this.W=e}delete(){return Js(this.U.delete())}}class dl extends Q{constructor(e,n){super(z.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function js(t){return t.name==="IndexedDbTransactionError"}class oP{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(q(rn,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(q(rn,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Js(r)}add(e){return q(rn,"ADD",this.store.name,e,e),Js(this.store.add(e))}get(e){return Js(this.store.get(e)).next(n=>(n===void 0&&(n=null),q(rn,"GET",this.store.name,e,n),n))}delete(e){return q(rn,"DELETE",this.store.name,e),Js(this.store.delete(e))}count(){return q(rn,"COUNT",this.store.name),Js(this.store.count())}H(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new j((o,a)=>{i.onerror=c=>{a(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.J(i,(a,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new j((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){q(rn,"DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const s=this.cursor(r);return this.J(s,(i,o,a)=>a.delete())}ee(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.J(s,n)}te(e){const n=this.cursor({});return new j((r,s)=>{n.onerror=i=>{const o=Wg(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}J(e,n){const r=[];return new j((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new iP(a),d=n(a.primaryKey,a.value,c);if(d instanceof j){const h=d.catch(m=>(c.done(),j.reject(m)));r.push(h)}c.isDone?s():c.G===null?a.continue():a.continue(c.G)}}).next(()=>j.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Js(t){return new j((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=Wg(r.target.error);n(s)}})}let k0=!1;function Wg(t){const e=_s.M(mt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new Q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return k0||(k0=!0,setTimeout(()=>{throw r},0)),r}}return t}const hl="IndexBackfiller";class aP{constructor(e,n){this.asyncQueue=e,this.ne=n,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){q(hl,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.ne.ie();q(hl,`Documents written: ${n}`)}catch(n){js(n)?q(hl,"Ignoring IndexedDB error during index backfill: ",n):await Ds(n)}await this.re(6e4)})}}class lP{constructor(e,n){this.localStore=e,this.persistence=n}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.se(n,e))}se(e,n){const r=new Set;let s=n,i=!0;return j.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return q(hl,`Processing collection: ${o}`),this.oe(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}oe(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this._e(s,i)).next(a=>(q(hl,`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}_e(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=S1(i);Kg(o,r)>0&&(r=o)}),new fn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>n.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Qt.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai=-1;function fh(t){return t==null}function $l(t){return t===0&&1/t==-1/0}function k1(t){return typeof t=="number"&&Number.isInteger(t)&&!$l(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gd="";function Vt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=R0(e)),e=cP(t.get(n),e);return R0(e)}function cP(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case gd:n+="";break;default:n+=i}}return n}function R0(t){return t+gd+""}function Wn(t){const e=t.length;if(oe(e>=2,64408,{path:t}),e===2)return oe(t.charAt(0)===gd&&t.charAt(1)==="",56145,{path:t}),Ae.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(gd,i);switch((o<0||o>n)&&re(50515,{path:t}),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:re(61167,{path:t})}i=o+2}return new Ae(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="remoteDocuments",dc="owner",Bi="owner",ql="mutationQueues",uP="userId",Cn="mutations",P0="batchId",si="userMutationsIndex",D0=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(t,e){return[t,Vt(e)]}function R1(t,e,n){return[t,Vt(e),n]}const dP={},jo="documentMutations",yd="remoteDocumentsV14",hP=["prefixPath","collectionGroup","readTime","documentId"],Nu="documentKeyIndex",fP=["prefixPath","collectionGroup","documentId"],P1="collectionGroupIndex",mP=["collectionGroup","readTime","prefixPath","documentId"],Hl="remoteDocumentGlobal",mp="remoteDocumentGlobalKey",Vo="targets",D1="queryTargetsIndex",pP=["canonicalId","targetId"],Oo="targetDocuments",gP=["targetId","path"],Qg="documentTargetsIndex",yP=["path","targetId"],vd="targetGlobalKey",li="targetGlobal",Gl="collectionParents",vP=["collectionId","parent"],Mo="clientMetadata",_P="clientId",mh="bundles",xP="bundleId",ph="namedQueries",wP="name",Yg="indexConfiguration",EP="indexId",pp="collectionGroupIndex",IP="collectionGroup",fl="indexState",TP=["indexId","uid"],j1="sequenceNumberIndex",bP=["uid","sequenceNumber"],ml="indexEntries",SP=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],V1="documentKeyIndex",AP=["indexId","uid","orderedDocumentKey"],gh="documentOverlays",NP=["userId","collectionPath","documentId"],gp="collectionPathOverlayIndex",CP=["userId","collectionPath","largestBatchId"],O1="collectionGroupOverlayIndex",kP=["userId","collectionGroup","largestBatchId"],Jg="globals",RP="name",M1=[ql,Cn,jo,Ys,Vo,dc,li,Oo,Mo,Hl,Gl,mh,ph],PP=[...M1,gh],L1=[ql,Cn,jo,yd,Vo,dc,li,Oo,Mo,Hl,Gl,mh,ph,gh],F1=L1,Xg=[...F1,Yg,fl,ml],DP=Xg,U1=[...Xg,Jg],jP=U1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp extends N1{constructor(e,n){super(),this.le=e,this.currentSequenceNumber=n}}function pt(t,e){const n=ie(t);return _s.O(n.le,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j0(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Vs(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function z1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,n){this.comparator=e,this.root=n||Et.EMPTY}insert(e,n){return new Fe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Et.BLACK,null,null))}remove(e){return new Fe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Et.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zc(this.root,e,this.comparator,!0)}}class Zc{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Et{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Et.RED,this.left=s??Et.EMPTY,this.right=i??Et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Et(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Et.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw re(43730,{key:this.key,value:this.value});if(this.right.isRed())throw re(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw re(27949);return e+(this.isRed()?0:1)}}Et.EMPTY=null,Et.RED=!0,Et.BLACK=!1;Et.EMPTY=new class{constructor(){this.size=0}get key(){throw re(57766)}get value(){throw re(16141)}get color(){throw re(16727)}get left(){throw re(29726)}get right(){throw re(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new Et(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e){this.comparator=e,this.data=new Fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new V0(this.data.getIterator())}getIteratorFrom(e){return new V0(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Pe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Pe(this.comparator);return n.data=e,n}}class V0{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $i(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt{constructor(e){this.fields=e,e.sort(Ge.comparator)}static empty(){return new Yt([])}unionWith(e){let n=new Pe(Ge.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Yt(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Po(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new B1("Invalid base64 string: "+i):i}}(e);return new rt(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new rt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return fe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rt.EMPTY_BYTE_STRING=new rt("");const VP=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function br(t){if(oe(!!t,39018),typeof t=="string"){let e=0;const n=VP.exec(t);if(oe(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:$e(t.seconds),nanos:$e(t.nanos)}}function $e(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Sr(t){return typeof t=="string"?rt.fromBase64String(t):rt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $1="server_timestamp",q1="__type__",H1="__previous_value__",G1="__local_write_time__";function Zg(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[q1])==null?void 0:r.stringValue)===$1}function yh(t){const e=t.mapValue.fields[H1];return Zg(e)?yh(e):e}function Kl(t){const e=br(t.mapValue.fields[G1].timestampValue);return new Ce(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OP{constructor(e,n,r,s,i,o,a,c,d,h,m){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h,this.apiKey=m}}const _d="(default)";class xi{constructor(e,n){this.projectId=e,this.database=n||_d}static empty(){return new xi("","")}get isDefaultDatabase(){return this.database===_d}isEqual(e){return e instanceof xi&&e.projectId===this.projectId&&e.database===this.database}}function MP(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Q(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new xi(t.options.projectId,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ey="__type__",K1="__max__",as={mapValue:{fields:{__type__:{stringValue:K1}}}},ty="__vector__",Lo="value",Cu={nullValue:"NULL_VALUE"};function Ss(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Zg(t)?4:W1(t)?9007199254740991:vh(t)?10:11:re(28295,{value:t})}function sr(t,e){if(t===e)return!0;const n=Ss(t);if(n!==Ss(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Kl(t).isEqual(Kl(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=br(s.timestampValue),a=br(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return Sr(s.bytesValue).isEqual(Sr(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return $e(s.geoPointValue.latitude)===$e(i.geoPointValue.latitude)&&$e(s.geoPointValue.longitude)===$e(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return $e(s.integerValue)===$e(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=$e(s.doubleValue),a=$e(i.doubleValue);return o===a?$l(o)===$l(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Po(t.arrayValue.values||[],e.arrayValue.values||[],sr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(j0(o)!==j0(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!sr(o[c],a[c])))return!1;return!0}(t,e);default:return re(52216,{left:t})}}function Wl(t,e){return(t.values||[]).find(n=>sr(n,e))!==void 0}function As(t,e){if(t===e)return 0;const n=Ss(t),r=Ss(e);if(n!==r)return fe(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return fe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const a=$e(i.integerValue||i.doubleValue),c=$e(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return O0(t.timestampValue,e.timestampValue);case 4:return O0(Kl(t),Kl(e));case 5:return hp(t.stringValue,e.stringValue);case 6:return function(i,o){const a=Sr(i),c=Sr(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){const h=fe(a[d],c[d]);if(h!==0)return h}return fe(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const a=fe($e(i.latitude),$e(o.latitude));return a!==0?a:fe($e(i.longitude),$e(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return M0(t.arrayValue,e.arrayValue);case 10:return function(i,o){var g,x,A,C;const a=i.fields||{},c=o.fields||{},d=(g=a[Lo])==null?void 0:g.arrayValue,h=(x=c[Lo])==null?void 0:x.arrayValue,m=fe(((A=d==null?void 0:d.values)==null?void 0:A.length)||0,((C=h==null?void 0:h.values)==null?void 0:C.length)||0);return m!==0?m:M0(d,h)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===as.mapValue&&o===as.mapValue)return 0;if(i===as.mapValue)return 1;if(o===as.mapValue)return-1;const a=i.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let m=0;m<c.length&&m<h.length;++m){const g=hp(c[m],h[m]);if(g!==0)return g;const x=As(a[c[m]],d[h[m]]);if(x!==0)return x}return fe(c.length,h.length)}(t.mapValue,e.mapValue);default:throw re(23264,{he:n})}}function O0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return fe(t,e);const n=br(t),r=br(e),s=fe(n.seconds,r.seconds);return s!==0?s:fe(n.nanos,r.nanos)}function M0(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=As(n[s],r[s]);if(i)return i}return fe(n.length,r.length)}function Fo(t){return vp(t)}function vp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=br(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Sr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ee.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=vp(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${vp(n.fields[o])}`;return s+"}"}(t.mapValue):re(61005,{value:t})}function ku(t){switch(Ss(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=yh(t);return e?16+ku(e):16;case 5:return 2*t.stringValue.length;case 6:return Sr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+ku(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Vs(r.fields,(i,o)=>{s+=i.length+ku(o)}),s}(t.mapValue);default:throw re(13486,{value:t})}}function Ql(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _p(t){return!!t&&"integerValue"in t}function Yl(t){return!!t&&"arrayValue"in t}function L0(t){return!!t&&"nullValue"in t}function F0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ru(t){return!!t&&"mapValue"in t}function vh(t){var n,r;return((r=(((n=t==null?void 0:t.mapValue)==null?void 0:n.fields)||{})[ey])==null?void 0:r.stringValue)===ty}function pl(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return Vs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=pl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=pl(t.arrayValue.values[n]);return e}return{...t}}function W1(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===K1}const Q1={mapValue:{fields:{[ey]:{stringValue:ty},[Lo]:{arrayValue:{}}}}};function LP(t){return"nullValue"in t?Cu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ql(xi.empty(),ee.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?vh(t)?Q1:{mapValue:{}}:re(35942,{value:t})}function FP(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ql(xi.empty(),ee.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?Q1:"mapValue"in t?vh(t)?{mapValue:{}}:as:re(61959,{value:t})}function U0(t,e){const n=As(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function z0(t,e){const n=As(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.value=e}static empty(){return new Dt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ru(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=pl(n)}setAll(e){let n=Ge.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=pl(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Ru(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return sr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Ru(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Vs(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Dt(pl(this.value))}}function Y1(t){const e=[];return Vs(t.fields,(n,r)=>{const s=new Ge([n]);if(Ru(r)){const i=Y1(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new Yt(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Je{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Je(e,0,ce.min(),ce.min(),ce.min(),Dt.empty(),0)}static newFoundDocument(e,n,r,s){return new Je(e,1,n,ce.min(),r,s,0)}static newNoDocument(e,n){return new Je(e,2,n,ce.min(),ce.min(),Dt.empty(),0)}static newUnknownDocument(e,n){return new Je(e,3,n,ce.min(),ce.min(),Dt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ce.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Dt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Dt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Je&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Je(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uo{constructor(e,n){this.position=e,this.inclusive=n}}function B0(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=ee.comparator(ee.fromName(o.referenceValue),n.key):r=As(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function $0(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!sr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl{constructor(e,n="asc"){this.field=e,this.dir=n}}function UP(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{}class Ie extends J1{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new zP(e,n,r):n==="array-contains"?new qP(e,r):n==="in"?new rT(e,r):n==="not-in"?new HP(e,r):n==="array-contains-any"?new GP(e,r):new Ie(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new BP(e,r):new $P(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(As(n,this.value)):n!==null&&Ss(this.value)===Ss(n)&&this.matchesComparison(As(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return re(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ke extends J1{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new ke(e,n)}matches(e){return zo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function zo(t){return t.op==="and"}function xp(t){return t.op==="or"}function ny(t){return X1(t)&&zo(t)}function X1(t){for(const e of t.filters)if(e instanceof ke)return!1;return!0}function wp(t){if(t instanceof Ie)return t.field.canonicalString()+t.op.toString()+Fo(t.value);if(ny(t))return t.filters.map(e=>wp(e)).join(",");{const e=t.filters.map(n=>wp(n)).join(",");return`${t.op}(${e})`}}function Z1(t,e){return t instanceof Ie?function(r,s){return s instanceof Ie&&r.op===s.op&&r.field.isEqual(s.field)&&sr(r.value,s.value)}(t,e):t instanceof ke?function(r,s){return s instanceof ke&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&Z1(o,s.filters[a]),!0):!1}(t,e):void re(19439)}function eT(t,e){const n=t.filters.concat(e);return ke.create(n,t.op)}function tT(t){return t instanceof Ie?function(n){return`${n.field.canonicalString()} ${n.op} ${Fo(n.value)}`}(t):t instanceof ke?function(n){return n.op.toString()+" {"+n.getFilters().map(tT).join(" ,")+"}"}(t):"Filter"}class zP extends Ie{constructor(e,n,r){super(e,n,r),this.key=ee.fromName(r.referenceValue)}matches(e){const n=ee.comparator(e.key,this.key);return this.matchesComparison(n)}}class BP extends Ie{constructor(e,n){super(e,"in",n),this.keys=nT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class $P extends Ie{constructor(e,n){super(e,"not-in",n),this.keys=nT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function nT(t,e){var n;return(((n=e.arrayValue)==null?void 0:n.values)||[]).map(r=>ee.fromName(r.referenceValue))}class qP extends Ie{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Yl(n)&&Wl(n.arrayValue,this.value)}}class rT extends Ie{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Wl(this.value.arrayValue,n)}}class HP extends Ie{constructor(e,n){super(e,"not-in",n)}matches(e){if(Wl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Wl(this.value.arrayValue,n)}}class GP extends Ie{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Yl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Wl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.Te=null}}function Ep(t,e=null,n=[],r=[],s=null,i=null,o=null){return new KP(t,e,n,r,s,i,o)}function wi(t){const e=ie(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>wp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),fh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Fo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Fo(r)).join(",")),e.Te=n}return e.Te}function hc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!UP(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Z1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$0(t.startAt,e.startAt)&&$0(t.endAt,e.endAt)}function xd(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function wd(t,e){return t.filters.filter(n=>n instanceof Ie&&n.field.isEqual(e))}function q0(t,e,n){let r=Cu,s=!0;for(const i of wd(t,e)){let o=Cu,a=!0;switch(i.op){case"<":case"<=":o=LP(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Cu}U0({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];U0({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function H0(t,e,n){let r=as,s=!0;for(const i of wd(t,e)){let o=as,a=!0;switch(i.op){case">=":case">":o=FP(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=as}z0({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];z0({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}}function sT(t,e,n,r,s,i,o,a){return new ra(t,e,n,r,s,i,o,a)}function fc(t){return new ra(t)}function G0(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function WP(t){return ee.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function iT(t){return t.collectionGroup!==null}function gl(t){const e=ie(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ie.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Pe(Ge.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ie.push(new Jl(i,r))}),n.has(Ge.keyField().canonicalString())||e.Ie.push(new Jl(Ge.keyField(),r))}return e.Ie}function dn(t){const e=ie(t);return e.Ee||(e.Ee=QP(e,gl(t))),e.Ee}function QP(t,e){if(t.limitType==="F")return Ep(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Jl(s.field,i)});const n=t.endAt?new Uo(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Uo(t.startAt.position,t.startAt.inclusive):null;return Ep(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ip(t,e){const n=t.filters.concat([e]);return new ra(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function YP(t,e){const n=t.explicitOrderBy.concat([e]);return new ra(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}function Ed(t,e,n){return new ra(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function _h(t,e){return hc(dn(t),dn(e))&&t.limitType===e.limitType}function oT(t){return`${wi(dn(t))}|lt:${t.limitType}`}function Qi(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>tT(s)).join(", ")}]`),fh(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>Fo(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>Fo(s)).join(",")),`Target(${r})`}(dn(t))}; limitType=${t.limitType})`}function mc(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):ee.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of gl(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,a,c){const d=B0(o,a,c);return o.inclusive?d<=0:d<0}(r.startAt,gl(r),s)||r.endAt&&!function(o,a,c){const d=B0(o,a,c);return o.inclusive?d>=0:d>0}(r.endAt,gl(r),s))}(t,e)}function aT(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function lT(t){return(e,n)=>{let r=!1;for(const s of gl(t)){const i=JP(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function JP(t,e,n){const r=t.field.isKeyField()?ee.comparator(e.key,n.key):function(i,o,a){const c=o.data.field(i),d=a.data.field(i);return c!==null&&d!==null?As(c,d):re(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return re(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Vs(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return z1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP=new Fe(ee.comparator);function on(){return XP}const cT=new Fe(ee.comparator);function Qa(...t){let e=cT;for(const n of t)e=e.insert(n.key,n);return e}function uT(t){let e=cT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Qn(){return yl()}function dT(){return yl()}function yl(){return new Pr(t=>t.toString(),(t,e)=>t.isEqual(e))}const ZP=new Fe(ee.comparator),e2=new Pe(ee.comparator);function ve(...t){let e=e2;for(const n of t)e=e.add(n);return e}const t2=new Pe(fe);function ry(){return t2}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$l(e)?"-0":e}}function hT(t){return{integerValue:""+t}}function n2(t,e){return k1(e)?hT(e):sy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xh{constructor(){this._=void 0}}function r2(t,e,n){return t instanceof Bo?function(s,i){const o={fields:{[q1]:{stringValue:$1},[G1]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Zg(i)&&(i=yh(i)),i&&(o.fields[H1]=i),{mapValue:o}}(n,e):t instanceof $o?mT(t,e):t instanceof qo?pT(t,e):function(s,i){const o=fT(s,i),a=K0(o)+K0(s.Ae);return _p(o)&&_p(s.Ae)?hT(a):sy(s.serializer,a)}(t,e)}function s2(t,e,n){return t instanceof $o?mT(t,e):t instanceof qo?pT(t,e):n}function fT(t,e){return t instanceof Xl?function(r){return _p(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Bo extends xh{}class $o extends xh{constructor(e){super(),this.elements=e}}function mT(t,e){const n=gT(e);for(const r of t.elements)n.some(s=>sr(s,r))||n.push(r);return{arrayValue:{values:n}}}class qo extends xh{constructor(e){super(),this.elements=e}}function pT(t,e){let n=gT(e);for(const r of t.elements)n=n.filter(s=>!sr(s,r));return{arrayValue:{values:n}}}class Xl extends xh{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function K0(t){return $e(t.integerValue||t.doubleValue)}function gT(t){return Yl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(e,n){this.field=e,this.transform=n}}function i2(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof $o&&s instanceof $o||r instanceof qo&&s instanceof qo?Po(r.elements,s.elements,sr):r instanceof Xl&&s instanceof Xl?sr(r.Ae,s.Ae):r instanceof Bo&&s instanceof Bo}(t.transform,e.transform)}class o2{constructor(e,n){this.version=e,this.transformResults=n}}class jt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new jt}static exists(e){return new jt(void 0,e)}static updateTime(e){return new jt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Pu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class wh{}function vT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Eh(t.key,jt.none()):new sa(t.key,t.data,jt.none());{const n=t.data,r=Dt.empty();let s=new Pe(Ge.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Dr(t.key,r,new Yt(s.toArray()),jt.none())}}function a2(t,e,n){t instanceof sa?function(s,i,o){const a=s.value.clone(),c=Q0(s.fieldTransforms,i,o.transformResults);a.setAll(c),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Dr?function(s,i,o){if(!Pu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Q0(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(_T(s)),c.setAll(a),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function vl(t,e,n,r){return t instanceof sa?function(i,o,a,c){if(!Pu(i.precondition,o))return a;const d=i.value.clone(),h=Y0(i.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Dr?function(i,o,a,c){if(!Pu(i.precondition,o))return a;const d=Y0(i.fieldTransforms,c,o),h=o.data;return h.setAll(_T(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(m=>m.field))}(t,e,n,r):function(i,o,a){return Pu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function l2(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=fT(r.transform,s||null);i!=null&&(n===null&&(n=Dt.empty()),n.set(r.field,i))}return n||null}function W0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Po(r,s,(i,o)=>i2(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class sa extends wh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Dr extends wh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function _T(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Q0(t,e,n){const r=new Map;oe(t.length===n.length,32656,{Ve:n.length,de:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,s2(o,a,n[s]))}return r}function Y0(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,r2(i,o,e))}return r}class Eh extends wh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xT extends wh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&a2(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=vl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=vl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=dT();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=vT(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(ce.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ve())}isEqual(e){return this.batchId===e.batchId&&Po(this.mutations,e.mutations,(n,r)=>W0(n,r))&&Po(this.baseMutations,e.baseMutations,(n,r)=>W0(n,r))}}class oy{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){oe(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let s=function(){return ZP}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new oy(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ay{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st,Te;function u2(t){switch(t){case z.OK:return re(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return re(15467,{code:t})}}function wT(t){if(t===void 0)return nt("GRPC error has no .code"),z.UNKNOWN;switch(t){case st.OK:return z.OK;case st.CANCELLED:return z.CANCELLED;case st.UNKNOWN:return z.UNKNOWN;case st.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case st.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case st.INTERNAL:return z.INTERNAL;case st.UNAVAILABLE:return z.UNAVAILABLE;case st.UNAUTHENTICATED:return z.UNAUTHENTICATED;case st.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case st.NOT_FOUND:return z.NOT_FOUND;case st.ALREADY_EXISTS:return z.ALREADY_EXISTS;case st.PERMISSION_DENIED:return z.PERMISSION_DENIED;case st.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case st.ABORTED:return z.ABORTED;case st.OUT_OF_RANGE:return z.OUT_OF_RANGE;case st.UNIMPLEMENTED:return z.UNIMPLEMENTED;case st.DATA_LOSS:return z.DATA_LOSS;default:return re(39323,{code:t})}}(Te=st||(st={}))[Te.OK=0]="OK",Te[Te.CANCELLED=1]="CANCELLED",Te[Te.UNKNOWN=2]="UNKNOWN",Te[Te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Te[Te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Te[Te.NOT_FOUND=5]="NOT_FOUND",Te[Te.ALREADY_EXISTS=6]="ALREADY_EXISTS",Te[Te.PERMISSION_DENIED=7]="PERMISSION_DENIED",Te[Te.UNAUTHENTICATED=16]="UNAUTHENTICATED",Te[Te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Te[Te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Te[Te.ABORTED=10]="ABORTED",Te[Te.OUT_OF_RANGE=11]="OUT_OF_RANGE",Te[Te.UNIMPLEMENTED=12]="UNIMPLEMENTED",Te[Te.INTERNAL=13]="INTERNAL",Te[Te.UNAVAILABLE=14]="UNAVAILABLE",Te[Te.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d2(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h2=new vs([4294967295,4294967295],0);function J0(t){const e=d2().encode(t),n=new p1;return n.update(e),new Uint8Array(n.digest())}function X0(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new vs([n,r],0),new vs([s,i],0)]}class ly{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ya(`Invalid padding: ${n}`);if(r<0)throw new Ya(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ya(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ya(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=vs.fromNumber(this.ge)}ye(e,n,r){let s=e.add(n.multiply(vs.fromNumber(r)));return s.compare(h2)===1&&(s=new vs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=J0(e),[r,s]=X0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);if(!this.we(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new ly(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;const n=J0(e),[r,s]=X0(n);for(let i=0;i<this.hashCount;i++){const o=this.ye(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ya extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,gc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new pc(ce.min(),s,new Fe(fe),on(),ve())}}class gc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new gc(r,n,ve(),ve(),ve())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n,r,s){this.Se=e,this.removedTargetIds=n,this.key=r,this.De=s}}class ET{constructor(e,n){this.targetId=e,this.Ce=n}}class IT{constructor(e,n,r=rt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Z0{constructor(){this.ve=0,this.Fe=ex(),this.Me=rt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ve(),n=ve(),r=ve();return this.Fe.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:re(38017,{changeType:i})}}),new gc(this.Me,this.xe,e,n,r)}Ke(){this.Oe=!1,this.Fe=ex()}qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,oe(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}}class f2{constructor(e){this.Ge=e,this.ze=new Map,this.je=on(),this.He=eu(),this.Je=eu(),this.Ze=new Fe(fe)}Xe(e){for(const n of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,n=>{const r=this.nt(n);switch(e.state){case 0:this.rt(n)&&r.Le(e.resumeToken);break;case 1:r.We(),r.Ne||r.Ke(),r.Le(e.resumeToken);break;case 2:r.We(),r.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(r.Qe(),r.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),r.Le(e.resumeToken));break;default:re(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach((r,s)=>{this.rt(s)&&n(s)})}st(e){const n=e.targetId,r=e.Ce.count,s=this.ot(n);if(s){const i=s.target;if(xd(i))if(r===0){const o=new ee(i.path);this.et(n,o,Je.newNoDocument(o,ce.min()))}else oe(r===1,20013,{expectedCount:r});else{const o=this._t(n);if(o!==r){const a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,d)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,a;try{o=Sr(r).toUint8Array()}catch(c){if(c instanceof B1)return Ro("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new ly(o,s,i)}catch(c){return Ro(c instanceof Ya?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,n,r){return n.Ce.count===r-this.Pt(e,n.targetId)?0:2}Pt(e,n){const r=this.Ge.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.et(n,i,null),s++)}),s}Tt(e){const n=new Map;this.ze.forEach((i,o)=>{const a=this.ot(o);if(a){if(i.current&&xd(a.target)){const c=new ee(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,Je.newNoDocument(c,e))}i.Be&&(n.set(o,i.ke()),i.Ke())}});let r=ve();this.Je.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.je.forEach((i,o)=>o.setReadTime(e));const s=new pc(e,n,this.Ze,this.je,r);return this.je=on(),this.He=eu(),this.Je=eu(),this.Ze=new Fe(fe),s}Ye(e,n){if(!this.rt(e))return;const r=this.Et(e,n.key)?2:0;this.nt(e).qe(n.key,r),this.je=this.je.insert(n.key,n),this.He=this.He.insert(n.key,this.It(n.key).add(e)),this.Je=this.Je.insert(n.key,this.Rt(n.key).add(e))}et(e,n,r){if(!this.rt(e))return;const s=this.nt(e);this.Et(e,n)?s.qe(n,1):s.Ue(n),this.Je=this.Je.insert(n,this.Rt(n).delete(e)),this.Je=this.Je.insert(n,this.Rt(n).add(e)),r&&(this.je=this.je.insert(n,r))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let n=this.ze.get(e);return n||(n=new Z0,this.ze.set(e,n)),n}Rt(e){let n=this.Je.get(e);return n||(n=new Pe(fe),this.Je=this.Je.insert(e,n)),n}It(e){let n=this.He.get(e);return n||(n=new Pe(fe),this.He=this.He.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Z0),this.Ge.getRemoteKeysForTarget(e).forEach(n=>{this.et(e,n,null)})}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function eu(){return new Fe(ee.comparator)}function ex(){return new Fe(ee.comparator)}const m2={asc:"ASCENDING",desc:"DESCENDING"},p2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},g2={and:"AND",or:"OR"};class y2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Tp(t,e){return t.useProto3Json||fh(e)?e:{value:e}}function Ho(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function v2(t,e){return Ho(t,e.toTimestamp())}function $t(t){return oe(!!t,49232),ce.fromTimestamp(function(n){const r=br(n);return new Ce(r.seconds,r.nanos)}(t))}function cy(t,e){return bp(t,e).canonicalString()}function bp(t,e){const n=function(s){return new Ae(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function bT(t){const e=Ae.fromString(t);return oe(jT(e),10190,{key:e.toString()}),e}function Id(t,e){return cy(t.databaseId,e.path)}function ci(t,e){const n=bT(e);if(n.get(1)!==t.databaseId.projectId)throw new Q(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Q(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ee(NT(n))}function ST(t,e){return cy(t.databaseId,e)}function AT(t){const e=bT(t);return e.length===4?Ae.emptyPath():NT(e)}function Sp(t){return new Ae(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function NT(t){return oe(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function tx(t,e,n){return{name:Id(t,e),fields:n.value.mapValue.fields}}function _2(t,e,n){const r=ci(t,e.name),s=$t(e.updateTime),i=e.createTime?$t(e.createTime):ce.min(),o=new Dt({mapValue:{fields:e.fields}}),a=Je.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function x2(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:re(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(oe(h===void 0||typeof h=="string",58123),rt.fromBase64String(h||"")):(oe(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),rt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(d){const h=d.code===void 0?z.UNKNOWN:wT(d.code);return new Q(h,d.message||"")}(o);n=new IT(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=ci(t,r.document.name),i=$t(r.document.updateTime),o=r.document.createTime?$t(r.document.createTime):ce.min(),a=new Dt({mapValue:{fields:r.document.fields}}),c=Je.newFoundDocument(s,i,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Du(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=ci(t,r.document),i=r.readTime?$t(r.readTime):ce.min(),o=Je.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Du([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=ci(t,r.document),i=r.removedTargetIds||[];n=new Du([],i,s,null)}else{if(!("filter"in e))return re(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new c2(s,i),a=r.targetId;n=new ET(a,o)}}return n}function Td(t,e){let n;if(e instanceof sa)n={update:tx(t,e.key,e.value)};else if(e instanceof Eh)n={delete:Id(t,e.key)};else if(e instanceof Dr)n={update:tx(t,e.key,e.data),updateMask:S2(e.fieldMask)};else{if(!(e instanceof xT))return re(16599,{dt:e.type});n={verify:Id(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Bo)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof $o)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof qo)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Xl)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw re(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:v2(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:re(27497)}(t,e.precondition)),n}function Ap(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?jt.updateTime($t(i.updateTime)):i.exists!==void 0?jt.exists(i.exists):jt.none()}(e.currentDocument):jt.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,a){let c=null;if("setToServerValue"in a)oe(a.setToServerValue==="REQUEST_TIME",16630,{proto:a}),c=new Bo;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];c=new $o(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];c=new qo(h)}else"increment"in a?c=new Xl(o,a.increment):re(16584,{proto:a});const d=Ge.fromServerFormat(a.fieldPath);return new yT(d,c)}(t,s)):[];if(e.update){e.update.name;const s=ci(t,e.update.name),i=new Dt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const d=c.fieldPaths||[];return new Yt(d.map(h=>Ge.fromServerFormat(h)))}(e.updateMask);return new Dr(s,i,o,n,r)}return new sa(s,i,n,r)}if(e.delete){const s=ci(t,e.delete);return new Eh(s,n)}if(e.verify){const s=ci(t,e.verify);return new xT(s,n)}return re(1463,{proto:e})}function w2(t,e){return t&&t.length>0?(oe(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?$t(s.updateTime):$t(i);return o.isEqual(ce.min())&&(o=$t(i)),new o2(o,s.transformResults||[])}(n,e))):[]}function CT(t,e){return{documents:[ST(t,e.path)]}}function kT(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=ST(t,s);const i=function(d){if(d.length!==0)return DT(ke.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(g){return{field:Yi(g.field),direction:I2(g.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Tp(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{ft:n,parent:s}}function RT(t){let e=AT(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){oe(r===1,65062);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(m){const g=PT(m);return g instanceof ke&&ny(g)?g.getFilters():[g]}(n.where));let o=[];n.orderBy&&(o=function(m){return m.map(g=>function(A){return new Jl(Ji(A.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(g))}(n.orderBy));let a=null;n.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,fh(g)?null:g}(n.limit));let c=null;n.startAt&&(c=function(m){const g=!!m.before,x=m.values||[];return new Uo(x,g)}(n.startAt));let d=null;return n.endAt&&(d=function(m){const g=!m.before,x=m.values||[];return new Uo(x,g)}(n.endAt)),sT(e,s,o,i,a,"F",c,d)}function E2(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return re(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function PT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ji(n.unaryFilter.field);return Ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ji(n.unaryFilter.field);return Ie.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ji(n.unaryFilter.field);return Ie.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ji(n.unaryFilter.field);return Ie.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return re(61313);default:return re(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ie.create(Ji(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return re(58110);default:return re(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ke.create(n.compositeFilter.filters.map(r=>PT(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return re(1026)}}(n.compositeFilter.op))}(t):re(30097,{filter:t})}function I2(t){return m2[t]}function T2(t){return p2[t]}function b2(t){return g2[t]}function Yi(t){return{fieldPath:t.canonicalString()}}function Ji(t){return Ge.fromServerFormat(t.fieldPath)}function DT(t){return t instanceof Ie?function(n){if(n.op==="=="){if(F0(n.value))return{unaryFilter:{field:Yi(n.field),op:"IS_NAN"}};if(L0(n.value))return{unaryFilter:{field:Yi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(F0(n.value))return{unaryFilter:{field:Yi(n.field),op:"IS_NOT_NAN"}};if(L0(n.value))return{unaryFilter:{field:Yi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yi(n.field),op:T2(n.op),value:n.value}}}(t):t instanceof ke?function(n){const r=n.getFilters().map(s=>DT(s));return r.length===1?r[0]:{compositeFilter:{op:b2(n.op),filters:r}}}(t):re(54877,{filter:t})}function S2(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function jT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}function VT(t){return!!t&&typeof t._toProto=="function"&&t._protoValueType==="ProtoValue"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e,n,r,s,i=ce.min(),o=ce.min(),a=rt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new fr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new fr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OT{constructor(e){this.yt=e}}function A2(t,e){let n;if(e.document)n=_2(t.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ee.fromSegments(e.noDocument.path),s=Ii(e.noDocument.readTime);n=Je.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return re(56709);{const r=ee.fromSegments(e.unknownDocument.path),s=Ii(e.unknownDocument.version);n=Je.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new Ce(s[0],s[1]);return ce.fromTimestamp(i)}(e.readTime)),n}function nx(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:bd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Id(i,o.key),fields:o.data.value.mapValue.fields,updateTime:Ho(i,o.version.toTimestamp()),createTime:Ho(i,o.createTime.toTimestamp())}}(t.yt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ei(e.version)};else{if(!e.isUnknownDocument())return re(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:Ei(e.version)}}return r}function bd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ei(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ii(t){const e=new Ce(t.seconds,t.nanoseconds);return ce.fromTimestamp(e)}function Xs(t,e){const n=(e.baseMutations||[]).map(i=>Ap(t.yt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>Ap(t.yt,i)),s=Ce.fromMillis(e.localWriteTimeMs);return new iy(e.batchId,s,n,r)}function Ja(t){const e=Ii(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ii(t.lastLimboFreeSnapshotVersion):ce.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return oe(o===1,1966,{count:o}),dn(fc(AT(i.documents[0])))}(t.query):function(i){return dn(RT(i))}(t.query),new fr(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,rt.fromBase64String(t.resumeToken))}function MT(t,e){const n=Ei(e.snapshotVersion),r=Ei(e.lastLimboFreeSnapshotVersion);let s;s=xd(e.target)?CT(t.yt,e.target):kT(t.yt,e.target).ft;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:wi(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function LT(t){const e=RT({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ed(e,e.limit,"L"):e}function Uf(t,e){return new ay(e.largestBatchId,Ap(t.yt,e.overlayMutation))}function rx(t,e){const n=e.path.lastSegment();return[t,Vt(e.path.popLast()),n]}function sx(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ei(r.readTime),documentKey:Vt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N2{getBundleMetadata(e,n){return ix(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:Ii(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return ix(e).put(function(s){return{bundleId:s.id,createTime:Ei($t(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return ox(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:LT(i.bundledQuery),readTime:Ii(i.readTime)}}(r)})}saveNamedQuery(e,n){return ox(e).put(function(s){return{name:s.name,readTime:Ei($t(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function ix(t){return pt(t,mh)}function ox(t){return pt(t,ph)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(e,n){this.serializer=e,this.userId=n}static wt(e,n){const r=n.uid||"";return new Ih(e,r)}getOverlay(e,n){return Pa(e).get(rx(this.userId,n)).next(r=>r?Uf(this.serializer,r):null)}getOverlays(e,n){const r=Qn();return j.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new ay(n,o);s.push(this.bt(e,a))}),j.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Vt(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Pa(e).X(gp,a))}),j.waitFor(i)}getOverlaysForCollection(e,n,r){const s=Qn(),i=Vt(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Pa(e).H(gp,o).next(a=>{for(const c of a){const d=Uf(this.serializer,c);s.set(d.getKey(),d)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=Qn();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Pa(e).ee({index:O1,range:a},(c,d,h)=>{const m=Uf(this.serializer,d);i.size()<s||m.largestBatchId===o?(i.set(m.getKey(),m),o=m.largestBatchId):h.done()}).next(()=>i)}bt(e,n){return Pa(e).put(function(s,i,o){const[a,c,d]=rx(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:d,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Td(s.yt,o.mutation)}}(this.serializer,this.userId,n))}}function Pa(t){return pt(t,gh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C2{St(e){return pt(e,Jg)}getSessionToken(e){return this.St(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?rt.fromUint8Array(r):rt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.St(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zs{constructor(){}Dt(e,n){this.Ct(e,n),n.vt()}Ct(e,n){if("nullValue"in e)this.Ft(n,5);else if("booleanValue"in e)this.Ft(n,10),n.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(n,15),n.Mt($e(e.integerValue));else if("doubleValue"in e){const r=$e(e.doubleValue);isNaN(r)?this.Ft(n,13):(this.Ft(n,15),$l(r)?n.Mt(0):n.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(n,20),typeof r=="string"&&(r=br(r)),n.xt(`${r.seconds||""}`),n.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,n),this.Nt(n);else if("bytesValue"in e)this.Ft(n,30),n.Bt(Sr(e.bytesValue)),this.Nt(n);else if("referenceValue"in e)this.Lt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(n,45),n.Mt(r.latitude||0),n.Mt(r.longitude||0)}else"mapValue"in e?W1(e)?this.Ft(n,Number.MAX_SAFE_INTEGER):vh(e)?this.kt(e.mapValue,n):(this.Kt(e.mapValue,n),this.Nt(n)):"arrayValue"in e?(this.qt(e.arrayValue,n),this.Nt(n)):re(19022,{Ut:e})}Ot(e,n){this.Ft(n,25),this.$t(e,n)}$t(e,n){n.xt(e)}Kt(e,n){const r=e.fields||{};this.Ft(n,55);for(const s of Object.keys(r))this.Ot(s,n),this.Ct(r[s],n)}kt(e,n){var o,a;const r=e.fields||{};this.Ft(n,53);const s=Lo,i=((a=(o=r[s].arrayValue)==null?void 0:o.values)==null?void 0:a.length)||0;this.Ft(n,15),n.Mt($e(i)),this.Ot(s,n),this.Ct(r[s],n)}qt(e,n){const r=e.values||[];this.Ft(n,50);for(const s of r)this.Ct(s,n)}Lt(e,n){this.Ft(n,37),ee.fromName(e).path.forEach(r=>{this.Ft(n,60),this.$t(r,n)})}Ft(e,n){e.Mt(n)}Nt(e){e.Mt(2)}}Zs.Wt=new Zs;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qi=255;function k2(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function ax(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=k2(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class R2{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Qt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Gt(r.value),r=n.next();this.zt()}jt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ht(r.value),r=n.next();this.Jt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{const s=n.codePointAt(0);this.Gt(240|s>>>18),this.Gt(128|63&s>>>12),this.Gt(128|63&s>>>6),this.Gt(128|63&s)}}this.zt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ht(r);else if(r<2048)this.Ht(960|r>>>6),this.Ht(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ht(480|r>>>12),this.Ht(128|63&r>>>6),this.Ht(128|63&r);else{const s=n.codePointAt(0);this.Ht(240|s>>>18),this.Ht(128|63&s>>>12),this.Ht(128|63&s>>>6),this.Ht(128|63&s)}}this.Jt()}Yt(e){const n=this.en(e),r=ax(n);this.tn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}nn(e){const n=this.en(e),r=ax(n);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}rn(){this.sn(qi),this.sn(255)}_n(){this.an(qi),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}Gt(e){const n=255&e;n===0?(this.sn(0),this.sn(255)):n===qi?(this.sn(qi),this.sn(0)):this.sn(n)}Ht(e){const n=255&e;n===0?(this.an(0),this.an(255)):n===qi?(this.an(qi),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Jt(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class P2{constructor(e){this.cn=e}Bt(e){this.cn.Qt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.Yt(e)}vt(){this.cn.rn()}}class D2{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Xt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Da{constructor(){this.cn=new R2,this.ascending=new P2(this.cn),this.descending=new D2(this.cn)}seed(e){this.cn.seed(e)}ln(e){return e===0?this.ascending:this.descending}un(){return this.cn.un()}reset(){this.cn.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(e,n,r,s){this.hn=e,this.Pn=n,this.Tn=r,this.In=s}En(){const e=this.In.length,n=e===0||this.In[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.In,0),n!==e?r.set([0],this.In.length):++r[r.length-1],new ei(this.hn,this.Pn,this.Tn,r)}Rn(e,n,r){return{indexId:this.hn,uid:e,arrayValue:ju(this.Tn),directionalValue:ju(this.In),orderedDocumentKey:ju(n),documentKey:r.path.toArray()}}An(e,n,r){const s=this.Rn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function qr(t,e){let n=t.hn-e.hn;return n!==0?n:(n=lx(t.Tn,e.Tn),n!==0?n:(n=lx(t.In,e.In),n!==0?n:ee.comparator(t.Pn,e.Pn)))}function lx(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function ju(t){return l1()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function cx(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class ux{constructor(e){this.Vn=new Pe((n,r)=>Ge.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.dn=e.orderBy,this.mn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Vn=this.Vn.add(r):this.mn.push(r)}}get fn(){return this.Vn.size>1}gn(e){if(oe(e.collectionGroup===this.collectionId,49279),this.fn)return!1;const n=fp(e);if(n!==void 0&&!this.pn(n))return!1;const r=Qs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.pn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Vn.size>0){const a=this.Vn.getIterator().getNext();if(!s.has(a.field.canonicalString())){const c=r[i];if(!this.yn(a,c)||!this.wn(this.dn[o++],c))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.dn.length||!this.wn(this.dn[o++],a))return!1}return!0}bn(){if(this.fn)return null;let e=new Pe(Ge.comparator);const n=[];for(const r of this.mn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Su(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Su(r.field,0))}for(const r of this.dn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Su(r.field,r.dir==="asc"?0:1)));return new pd(pd.UNKNOWN_ID,this.collectionId,n,Bl.empty())}pn(e){for(const n of this.mn)if(this.yn(n,e))return!0;return!1}yn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}wn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FT(t){var n,r;if(oe(t instanceof Ie||t instanceof ke,20012),t instanceof Ie){if(t instanceof rT){const s=((r=(n=t.value.arrayValue)==null?void 0:n.values)==null?void 0:r.map(i=>Ie.create(t.field,"==",i)))||[];return ke.create(s,"or")}return t}const e=t.filters.map(s=>FT(s));return ke.create(e,t.op)}function j2(t){if(t.getFilters().length===0)return[];const e=kp(FT(t));return oe(UT(e),7391),Np(e)||Cp(e)?[e]:e.getFilters()}function Np(t){return t instanceof Ie}function Cp(t){return t instanceof ke&&ny(t)}function UT(t){return Np(t)||Cp(t)||function(n){if(n instanceof ke&&xp(n)){for(const r of n.getFilters())if(!Np(r)&&!Cp(r))return!1;return!0}return!1}(t)}function kp(t){if(oe(t instanceof Ie||t instanceof ke,34018),t instanceof Ie)return t;if(t.filters.length===1)return kp(t.filters[0]);const e=t.filters.map(r=>kp(r));let n=ke.create(e,t.op);return n=Sd(n),UT(n)?n:(oe(n instanceof ke,64498),oe(zo(n),40251),oe(n.filters.length>1,57927),n.filters.reduce((r,s)=>uy(r,s)))}function uy(t,e){let n;return oe(t instanceof Ie||t instanceof ke,38388),oe(e instanceof Ie||e instanceof ke,25473),n=t instanceof Ie?e instanceof Ie?function(s,i){return ke.create([s,i],"and")}(t,e):dx(t,e):e instanceof Ie?dx(e,t):function(s,i){if(oe(s.filters.length>0&&i.filters.length>0,48005),zo(s)&&zo(i))return eT(s,i.getFilters());const o=xp(s)?s:i,a=xp(s)?i:s,c=o.filters.map(d=>uy(d,a));return ke.create(c,"or")}(t,e),Sd(n)}function dx(t,e){if(zo(e))return eT(e,t.getFilters());{const n=e.filters.map(r=>uy(t,r));return ke.create(n,"or")}}function Sd(t){if(oe(t instanceof Ie||t instanceof ke,11850),t instanceof Ie)return t;const e=t.getFilters();if(e.length===1)return Sd(e[0]);if(X1(t))return t;const n=e.map(s=>Sd(s)),r=[];return n.forEach(s=>{s instanceof Ie?r.push(s):s instanceof ke&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:ke.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V2{constructor(){this.Sn=new dy}addToCollectionParentIndex(e,n){return this.Sn.add(n),j.resolve()}getCollectionParents(e,n){return j.resolve(this.Sn.getEntries(n))}addFieldIndex(e,n){return j.resolve()}deleteFieldIndex(e,n){return j.resolve()}deleteAllFieldIndexes(e){return j.resolve()}createTargetIndexes(e,n){return j.resolve()}getDocumentsMatchingTarget(e,n){return j.resolve(null)}getIndexType(e,n){return j.resolve(0)}getFieldIndexes(e,n){return j.resolve([])}getNextCollectionGroupToUpdate(e){return j.resolve(null)}getMinOffset(e,n){return j.resolve(fn.min())}getMinOffsetFromCollectionGroup(e,n){return j.resolve(fn.min())}updateCollectionGroup(e,n,r){return j.resolve()}updateIndexEntries(e,n){return j.resolve()}}class dy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Pe(Ae.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Pe(Ae.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx="IndexedDbIndexManager",tu=new Uint8Array(0);class O2{constructor(e,n){this.databaseId=n,this.Dn=new dy,this.Cn=new Pr(r=>wi(r),(r,s)=>hc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Dn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Dn.add(n)});const i={collectionId:r,parent:Vt(s)};return fx(e).put(i)}return j.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[E1(n),""],!1,!0);return fx(e).H(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(Wn(o.parent))}return r})}addFieldIndex(e,n){const r=ja(e),s=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Gi(e);return i.next(a=>{o.put(sx(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=ja(e),s=Gi(e),i=Hi(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ja(e),r=Hi(e),s=Gi(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return j.forEach(this.vn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new ux(r).bn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Hi(e);let s=!0;const i=new Map;return j.forEach(this.vn(n),o=>this.Fn(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ve();const a=[];return j.forEach(i,(c,d)=>{q(hx,`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(c)} to execute ${wi(n)}`);const h=function(T,D){const O=fp(D);if(O===void 0)return null;for(const U of wd(T,O.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null}(d,c),m=function(T,D){const O=new Map;for(const U of Qs(D))for(const E of wd(T,U.fieldPath))switch(E.op){case"==":case"in":O.set(U.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return O.set(U.fieldPath.canonicalString(),E.value),Array.from(O.values())}return null}(d,c),g=function(T,D){const O=[];let U=!0;for(const E of Qs(D)){const y=E.kind===0?q0(T,E.fieldPath,T.startAt):H0(T,E.fieldPath,T.startAt);O.push(y.value),U&&(U=y.inclusive)}return new Uo(O,U)}(d,c),x=function(T,D){const O=[];let U=!0;for(const E of Qs(D)){const y=E.kind===0?H0(T,E.fieldPath,T.endAt):q0(T,E.fieldPath,T.endAt);O.push(y.value),U&&(U=y.inclusive)}return new Uo(O,U)}(d,c),A=this.Mn(c,d,g),C=this.Mn(c,d,x),R=this.xn(c,d,m),I=this.On(c.indexId,h,A,g.inclusive,C,x.inclusive,R);return j.forEach(I,v=>r.Z(v,n.limit).next(T=>{T.forEach(D=>{const O=ee.fromSegments(D.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return j.resolve(null)})}vn(e){let n=this.Cn.get(e);return n||(e.filters.length===0?n=[e]:n=j2(ke.create(e.filters,"and")).map(r=>Ep(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Cn.set(e,n),n)}On(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),d=c/(n!=null?n.length:1),h=[];for(let m=0;m<c;++m){const g=n?this.Nn(n[m/d]):tu,x=this.Bn(e,g,r[m%d],s),A=this.Ln(e,g,i[m%d],o),C=a.map(R=>this.Bn(e,g,R,!0));h.push(...this.createRange(x,A,C))}return h}Bn(e,n,r,s){const i=new ei(e,ee.empty(),n,r);return s?i:i.En()}Ln(e,n,r,s){const i=new ei(e,ee.empty(),n,r);return s?i.En():i}Fn(e,n){const r=new ux(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.gn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.vn(n);return j.forEach(s,i=>this.Fn(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let d=new Pe(Ge.comparator),h=!1;for(const m of c.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:d=d.add(g.field));for(const m of c.orderBy)m.field.isKeyField()||(d=d.add(m.field));return d.size+(h?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}kn(e,n){const r=new Da;for(const s of Qs(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.ln(s.kind);Zs.Wt.Dt(i,o)}return r.un()}Nn(e){const n=new Da;return Zs.Wt.Dt(e,n.ln(0)),n.un()}Kn(e,n){const r=new Da;return Zs.Wt.Dt(Ql(this.databaseId,n),r.ln(function(i){const o=Qs(i);return o.length===0?0:o[o.length-1].kind}(e))),r.un()}xn(e,n,r){if(r===null)return[];let s=[];s.push(new Da);let i=0;for(const o of Qs(e)){const a=r[i++];for(const c of s)if(this.qn(n,o.fieldPath)&&Yl(a))s=this.Un(s,o,a);else{const d=c.ln(o.kind);Zs.Wt.Dt(a,d)}}return this.$n(s)}Mn(e,n,r){return this.xn(e,n,r.position)}$n(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].un();return n}Un(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new Da;c.seed(a.un()),Zs.Wt.Dt(o,c.ln(n.kind)),i.push(c)}return i}qn(e,n){return!!e.filters.find(r=>r instanceof Ie&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ja(e),s=Gi(e);return(n?r.H(pp,IDBKeyRange.bound(n,n)):r.H()).next(i=>{const o=[];return j.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(h,m){const g=m?new Bl(m.sequenceNumber,new fn(Ii(m.readTime),new ee(Wn(m.documentKey)),m.largestBatchId)):Bl.empty(),x=h.fields.map(([A,C])=>new Su(Ge.fromServerFormat(A),C));return new pd(h.indexId,h.collectionGroup,x,g)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:fe(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=ja(e),i=Gi(e);return this.Wn(e).next(o=>s.H(pp,IDBKeyRange.bound(n,n)).next(a=>j.forEach(a,c=>i.put(sx(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return j.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?j.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),j.forEach(a,c=>this.Qn(e,s,c).next(d=>{const h=this.Gn(i,c);return d.isEqual(h)?j.resolve():this.zn(e,i,c,d,h)}))))})}jn(e,n,r,s){return Hi(e).put(s.Rn(this.uid,this.Kn(r,n.key),n.key))}Hn(e,n,r,s){return Hi(e).delete(s.An(this.uid,this.Kn(r,n.key),n.key))}Qn(e,n,r){const s=Hi(e);let i=new Pe(qr);return s.ee({index:V1,range:IDBKeyRange.only([r.indexId,this.uid,ju(this.Kn(r,n))])},(o,a)=>{i=i.add(new ei(r.indexId,n,cx(a.arrayValue),cx(a.directionalValue)))}).next(()=>i)}Gn(e,n){let r=new Pe(qr);const s=this.kn(n,e);if(s==null)return r;const i=fp(n);if(i!=null){const o=e.data.field(i.fieldPath);if(Yl(o))for(const a of o.arrayValue.values||[])r=r.add(new ei(n.indexId,e.key,this.Nn(a),s))}else r=r.add(new ei(n.indexId,e.key,tu,s));return r}zn(e,n,r,s,i){q(hx,"Updating index entries for document '%s'",n.key);const o=[];return function(c,d,h,m,g){const x=c.getIterator(),A=d.getIterator();let C=$i(x),R=$i(A);for(;C||R;){let I=!1,v=!1;if(C&&R){const T=h(C,R);T<0?v=!0:T>0&&(I=!0)}else C!=null?v=!0:I=!0;I?(m(R),R=$i(A)):v?(g(C),C=$i(x)):(C=$i(x),R=$i(A))}}(s,i,qr,a=>{o.push(this.jn(e,n,r,a))},a=>{o.push(this.Hn(e,n,r,a))}),j.waitFor(o)}Wn(e){let n=1;return Gi(e).ee({index:j1,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>qr(o,a)).filter((o,a,c)=>!a||qr(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=qr(o,e),c=qr(o,n);if(a===0)s[0]=e.En();else if(a>0&&c<0)s.push(o),s.push(o.En());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Jn(s[o],s[o+1]))return[];const a=s[o].An(this.uid,tu,ee.empty()),c=s[o+1].An(this.uid,tu,ee.empty());i.push(IDBKeyRange.bound(a,c))}return i}Jn(e,n){return qr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(mx)}getMinOffset(e,n){return j.mapArray(this.vn(n),r=>this.Fn(e,r).next(s=>s||re(44426))).next(mx)}}function fx(t){return pt(t,Gl)}function Hi(t){return pt(t,ml)}function ja(t){return pt(t,Yg)}function Gi(t){return pt(t,fl)}function mx(t){oe(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;Kg(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new fn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const px={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},zT=41943040;class Rt{static withCacheSize(e){return new Rt(e,Rt.DEFAULT_COLLECTION_PERCENTILE,Rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BT(t,e,n){const r=t.store(Cn),s=t.store(jo),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.ee({range:o},(h,m,g)=>(a++,g.delete()));i.push(c.next(()=>{oe(a===1,47070,{batchId:n.batchId})}));const d=[];for(const h of n.mutations){const m=R1(e,h.key.path,n.batchId);i.push(s.delete(m)),d.push(h.key)}return j.waitFor(i).next(()=>d)}function Ad(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw re(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rt.DEFAULT_COLLECTION_PERCENTILE=10,Rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rt.DEFAULT=new Rt(zT,Rt.DEFAULT_COLLECTION_PERCENTILE,Rt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rt.DISABLED=new Rt(-1,0,0);class Th{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Zn={}}static wt(e,n,r,s){oe(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Th(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Hr(e).ee({index:si,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Xi(e),o=Hr(e);return o.add({}).next(a=>{oe(typeof a=="number",49019);const c=new iy(a,n,r,s),d=function(x,A,C){const R=C.baseMutations.map(v=>Td(x.yt,v)),I=C.mutations.map(v=>Td(x.yt,v));return{userId:A,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:R,mutations:I}}(this.serializer,this.userId,c),h=[];let m=new Pe((g,x)=>fe(g.canonicalString(),x.canonicalString()));for(const g of s){const x=R1(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),h.push(o.put(d)),h.push(i.put(x,dP))}return m.forEach(g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Zn[a]=c.keys()}),j.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return Hr(e).get(n).next(r=>r?(oe(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),Xs(this.serializer,r)):null)}Xn(e,n){return this.Zn[n]?j.resolve(this.Zn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Zn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Hr(e).ee({index:si,range:s},(o,a,c)=>{a.userId===this.userId&&(oe(a.batchId>=r,47524,{Yn:r}),i=Xs(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=ai;return Hr(e).ee({index:si,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,ai],[this.userId,Number.POSITIVE_INFINITY]);return Hr(e).H(si,n).next(r=>r.map(s=>Xs(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Au(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Xi(e).ee({range:s},(o,a,c)=>{const[d,h,m]=o,g=Wn(h);if(d===this.userId&&n.path.isEqual(g))return Hr(e).get(m).next(x=>{if(!x)throw re(61480,{er:o,batchId:m});oe(x.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:x.userId,batchId:m}),i.push(Xs(this.serializer,x))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Pe(fe);const s=[];return n.forEach(i=>{const o=Au(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=Xi(e).ee({range:a},(d,h,m)=>{const[g,x,A]=d,C=Wn(x);g===this.userId&&i.path.isEqual(C)?r=r.add(A):m.done()});s.push(c)}),j.waitFor(s).next(()=>this.tr(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Au(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new Pe(fe);return Xi(e).ee({range:o},(c,d,h)=>{const[m,g,x]=c,A=Wn(g);m===this.userId&&r.isPrefixOf(A)?A.length===s&&(a=a.add(x)):h.done()}).next(()=>this.tr(e,a))}tr(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Hr(e).get(i).next(o=>{if(o===null)throw re(35274,{batchId:i});oe(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(Xs(this.serializer,o))}))}),j.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return BT(e.le,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.nr(n.batchId)}),j.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}nr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return j.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Xi(e).ee({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=Wn(i[1]);s.push(c)}else a.done()}).next(()=>{oe(s.length===0,56720,{rr:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return $T(e,this.userId,n)}ir(e){return qT(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:ai,lastStreamToken:""})}}function $T(t,e,n){const r=Au(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Xi(t).ee({range:i,Y:!0},(a,c,d)=>{const[h,m,g]=a;h===e&&m===s&&(o=!0),d.done()}).next(()=>o)}function Hr(t){return pt(t,Cn)}function Xi(t){return pt(t,jo)}function qT(t){return pt(t,ql)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new Ti(0)}static ar(){return new Ti(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.ur(e).next(n=>{const r=new Ti(n.highestTargetId);return n.highestTargetId=r.next(),this.cr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.ur(e).next(n=>ce.fromTimestamp(new Ce(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.ur(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.ur(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.cr(e,s)))}addTargetData(e,n){return this.lr(e,n).next(()=>this.ur(e).next(r=>(r.targetCount+=1,this.hr(n,r),this.cr(e,r))))}updateTargetData(e,n){return this.lr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ki(e).delete(n.targetId)).next(()=>this.ur(e)).next(r=>(oe(r.targetCount>0,8065),r.targetCount-=1,this.cr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Ki(e).ee((o,a)=>{const c=Ja(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>j.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Ki(e).ee((r,s)=>{const i=Ja(s);n(i)})}ur(e){return gx(e).get(vd).next(n=>(oe(n!==null,2888),n))}cr(e,n){return gx(e).put(vd,n)}lr(e,n){return Ki(e).put(MT(this.serializer,n))}hr(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.ur(e).next(n=>n.targetCount)}getTargetData(e,n){const r=wi(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Ki(e).ee({range:s,index:D1},(o,a,c)=>{const d=Ja(a);hc(n,d.target)&&(i=d,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Xr(e);return n.forEach(o=>{const a=Vt(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),j.waitFor(s)}removeMatchingKeys(e,n,r){const s=Xr(e);return j.forEach(n,i=>{const o=Vt(i.path);return j.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Xr(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Xr(e);let i=ve();return s.ee({range:r,Y:!0},(o,a,c)=>{const d=Wn(o[1]),h=new ee(d);i=i.add(h)}).next(()=>i)}containsKey(e,n){const r=Vt(n.path),s=IDBKeyRange.bound([r],[E1(r)],!1,!0);let i=0;return Xr(e).ee({index:Qg,Y:!0,range:s},([o,a],c,d)=>{o!==0&&(i++,d.done())}).next(()=>i>0)}At(e,n){return Ki(e).get(n).next(r=>r?Ja(r):null)}}function Ki(t){return pt(t,Vo)}function gx(t){return pt(t,li)}function Xr(t){return pt(t,Oo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yx="LruGarbageCollector",HT=1048576;function vx([t,e],[n,r]){const s=fe(t,n);return s===0?fe(e,r):s}class L2{constructor(e){this.Pr=e,this.buffer=new Pe(vx),this.Tr=0}Ir(){return++this.Tr}Er(e){const n=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();vx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class GT{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Ar(e){q(yx,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){js(n)?q(yx,"Ignoring IndexedDB error during garbage collection: ",n):await Ds(n)}await this.Ar(3e5)})}}class F2{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.dr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return j.resolve(Qt.ce);const r=new L2(n);return this.Vr.forEachTarget(e,s=>r.Er(s.sequenceNumber)).next(()=>this.Vr.mr(e,s=>r.Er(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),j.resolve(px)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),px):this.gr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,n){let r,s,i,o,a,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),s=this.params.maximumSequenceNumbersToCollect):s=m,o=Date.now(),this.nthSequenceNumber(e,s))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,n))).next(m=>(i=m,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(d=Date.now(),Wi()<=Ee.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${m} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),j.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:m})))}}function KT(t,e){return new F2(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{constructor(e,n){this.db=e,this.garbageCollector=KT(this,n)}dr(e){const n=this.pr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}mr(e,n){return this.yr(e,(r,s)=>n(s))}addReference(e,n,r){return nu(e,r)}removeReference(e,n,r){return nu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return nu(e,n)}wr(e,n){return function(s,i){let o=!1;return qT(s).te(a=>$T(s,a,i).next(c=>(c&&(o=!0),j.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.yr(e,(o,a)=>{if(a<=n){const c=this.wr(e,o).next(d=>{if(!d)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ce.min()),Xr(e).delete(function(m){return[0,Vt(m.path)]}(o))))});s.push(c)}}).next(()=>j.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return nu(e,n)}yr(e,n){const r=Xr(e);let s,i=Qt.ce;return r.ee({index:Qg},([o,a],{path:c,sequenceNumber:d})=>{o===0?(i!==Qt.ce&&n(new ee(Wn(s)),i),i=d,s=c):i=Qt.ce}).next(()=>{i!==Qt.ce&&n(new ee(Wn(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nu(t,e){return Xr(t).put(function(r,s){return{targetId:0,path:Vt(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(){this.changes=new Pr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Je.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?j.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Hs(e).put(r)}removeEntry(e,n,r){return Hs(e).delete(function(i,o){const a=i.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],bd(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.br(e,r)))}getEntry(e,n){let r=Je.newInvalidDocument(n);return Hs(e).ee({index:Nu,range:IDBKeyRange.only(Va(n))},(s,i)=>{r=this.Sr(n,i)}).next(()=>r)}Dr(e,n){let r={size:0,document:Je.newInvalidDocument(n)};return Hs(e).ee({index:Nu,range:IDBKeyRange.only(Va(n))},(s,i)=>{r={document:this.Sr(n,i),size:Ad(i)}}).next(()=>r)}getEntries(e,n){let r=on();return this.Cr(e,n,(s,i)=>{const o=this.Sr(s,i);r=r.insert(s,o)}).next(()=>r)}vr(e,n){let r=on(),s=new Fe(ee.comparator);return this.Cr(e,n,(i,o)=>{const a=this.Sr(i,o);r=r.insert(i,a),s=s.insert(i,Ad(o))}).next(()=>({documents:r,Fr:s}))}Cr(e,n,r){if(n.isEmpty())return j.resolve();let s=new Pe(wx);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Va(s.first()),Va(s.last())),o=s.getIterator();let a=o.getNext();return Hs(e).ee({index:Nu,range:i},(c,d,h)=>{const m=ee.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;a&&wx(a,m)<0;)r(a,null),a=o.getNext();a&&a.isEqual(m)&&(r(a,d),a=o.hasNext()?o.getNext():null),a?h.j(Va(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),bd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hs(e).H(IDBKeyRange.bound(a,c,!0)).next(d=>{i==null||i.incrementDocumentReadCount(d.length);let h=on();for(const m of d){const g=this.Sr(ee.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(mc(n,g)||s.has(g.key))&&(h=h.insert(g.key,g))}return h})}getAllFromCollectionGroup(e,n,r,s){let i=on();const o=xx(n,r),a=xx(n,fn.max());return Hs(e).ee({index:P1,range:IDBKeyRange.bound(o,a,!0)},(c,d,h)=>{const m=this.Sr(ee.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);i=i.insert(m.key,m),i.size===s&&h.done()}).next(()=>i)}newChangeBuffer(e){return new B2(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return _x(e).get(mp).next(n=>(oe(!!n,20021),n))}br(e,n){return _x(e).put(mp,n)}Sr(e,n){if(n){const r=A2(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ce.min())))return r}return Je.newInvalidDocument(e)}}function QT(t){return new z2(t)}class B2 extends WT{constructor(e,n){super(),this.Mr=e,this.trackRemovals=n,this.Or=new Pr(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Pe((i,o)=>fe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Or.get(i);if(n.push(this.Mr.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=nx(this.Mr.serializer,o);s=s.add(i.path.popLast());const d=Ad(c);r+=d-a.size,n.push(this.Mr.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=nx(this.Mr.serializer,o.convertToNoDocument(ce.min()));n.push(this.Mr.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Mr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Mr.updateMetadata(e,r)),j.waitFor(n)}getFromCache(e,n){return this.Mr.Dr(e,n).next(r=>(this.Or.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Mr.vr(e,n).next(({documents:r,Fr:s})=>(s.forEach((i,o)=>{this.Or.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function _x(t){return pt(t,Hl)}function Hs(t){return pt(t,yd)}function Va(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function xx(t,e){const n=e.documentKey.path.toArray();return[t,bd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function wx(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=fe(n[i],r[i]),s)return s;return s=fe(n.length,r.length),s||(s=fe(n[n.length-2],r[r.length-2]),s||fe(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YT{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&vl(r.mutation,s,Yt.empty(),Ce.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ve()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ve()){const s=Qn();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Qa();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Qn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ve()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=on();const o=yl(),a=function(){return yl()}();return n.forEach((c,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Dr)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),vl(h.mutation,d,h.mutation.getFieldMask(),Ce.now())):o.set(d.key,Yt.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>a.set(d,new $2(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,n){const r=yl();let s=new Fe((o,a)=>o-a),i=ve();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||Yt.empty();h=a.applyToLocalView(d,h),r.set(c,h);const m=(s.get(a.batchId)||ve()).add(c);s=s.insert(a.batchId,m)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),d=c.key,h=c.value,m=dT();h.forEach(g=>{if(!i.has(g)){const x=vT(n.get(g),r.get(g));x!==null&&m.set(g,x),i=i.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,m))}return j.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return WP(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):iT(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):j.resolve(Qn());let a=Do,c=i;return o.next(d=>j.forEach(d,(h,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),i.get(h)?j.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{c=c.insert(h,g)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,c,d,ve())).next(h=>({batchId:a,changes:uT(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ee(n)).next(r=>{let s=Qa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Qa();return this.indexManager.getCollectionParents(e,i).next(a=>j.forEach(a,c=>{const d=function(m,g){return new ra(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((m,g)=>{o=o.insert(m,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Je.newInvalidDocument(h)))});let a=Qa();return o.forEach((c,d)=>{const h=i.get(c);h!==void 0&&vl(h.mutation,d,Yt.empty(),Ce.now()),mc(n,d)&&(a=a.insert(c,d))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q2{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,n){return j.resolve(this.Nr.get(n))}saveBundleMetadata(e,n){return this.Nr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:$t(s.createTime)}}(n)),j.resolve()}getNamedQuery(e,n){return j.resolve(this.Br.get(n))}saveNamedQuery(e,n){return this.Br.set(n.name,function(s){return{name:s.name,query:LT(s.bundledQuery),readTime:$t(s.readTime)}}(n)),j.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H2{constructor(){this.overlays=new Fe(ee.comparator),this.Lr=new Map}getOverlay(e,n){return j.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Qn();return j.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),j.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Lr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Lr.delete(r)),j.resolve()}getOverlaysForCollection(e,n,r){const s=Qn(),i=n.length+1,o=new ee(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return j.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Fe((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Qn(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const a=Qn(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=s)););return j.resolve(a)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Lr.get(s.largestBatchId).delete(r.key);this.Lr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ay(n,r));let i=this.Lr.get(n);i===void 0&&(i=ve(),this.Lr.set(n,i)),this.Lr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{constructor(){this.sessionToken=rt.EMPTY_BYTE_STRING}getSessionToken(e){return j.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,j.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(){this.kr=new Pe(vt.Kr),this.qr=new Pe(vt.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,n){const r=new vt(e,n);this.kr=this.kr.add(r),this.qr=this.qr.add(r)}$r(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new vt(e,n))}Qr(e,n){e.forEach(r=>this.removeReference(r,n))}Gr(e){const n=new ee(new Ae([])),r=new vt(n,e),s=new vt(n,e+1),i=[];return this.qr.forEachInRange([r,s],o=>{this.Wr(o),i.push(o.key)}),i}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){const n=new ee(new Ae([])),r=new vt(n,e),s=new vt(n,e+1);let i=ve();return this.qr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new vt(e,0),r=this.kr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class vt{constructor(e,n){this.key=e,this.Hr=n}static Kr(e,n){return ee.comparator(e.key,n.key)||fe(e.Hr,n.Hr)}static Ur(e,n){return fe(e.Hr,n.Hr)||ee.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Yn=1,this.Jr=new Pe(vt.Kr)}checkEmpty(e){return j.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new iy(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Jr=this.Jr.add(new vt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return j.resolve(o)}lookupMutationBatch(e,n){return j.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.Xr(r),i=s<0?0:s;return j.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return j.resolve(this.mutationQueue.length===0?ai:this.Yn-1)}getAllMutationBatches(e){return j.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new vt(n,0),s=new vt(n,Number.POSITIVE_INFINITY),i=[];return this.Jr.forEachInRange([r,s],o=>{const a=this.Zr(o.Hr);i.push(a)}),j.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Pe(fe);return n.forEach(s=>{const i=new vt(s,0),o=new vt(s,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([i,o],a=>{r=r.add(a.Hr)})}),j.resolve(this.Yr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;ee.isDocumentKey(i)||(i=i.child(""));const o=new vt(new ee(i),0);let a=new Pe(fe);return this.Jr.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(a=a.add(c.Hr)),!0)},o),j.resolve(this.Yr(a))}Yr(e){const n=[];return e.forEach(r=>{const s=this.Zr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){oe(this.ei(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Jr;return j.forEach(n.mutations,s=>{const i=new vt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Jr=r})}nr(e){}containsKey(e,n){const r=new vt(n,0),s=this.Jr.firstAfterOrEqual(r);return j.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,j.resolve()}ei(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(e){this.ti=e,this.docs=function(){return new Fe(ee.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ti(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return j.resolve(r?r.document.mutableCopy():Je.newInvalidDocument(n))}getEntries(e,n){let r=on();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Je.newInvalidDocument(s))}),j.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=on();const o=n.path,a=new ee(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||Kg(S1(h),r)<=0||(s.has(h.key)||mc(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return j.resolve(i)}getAllFromCollectionGroup(e,n,r,s){re(9500)}ni(e,n){return j.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Q2(this)}getSize(e){return j.resolve(this.size)}}class Q2 extends WT{constructor(e){super(),this.Mr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Mr.addEntry(e,s)):this.Mr.removeEntry(r)}),j.waitFor(n)}getFromCache(e,n){return this.Mr.getEntry(e,n)}getAllFromCache(e,n){return this.Mr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y2{constructor(e){this.persistence=e,this.ri=new Pr(n=>wi(n),hc),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.ii=0,this.si=new hy,this.targetCount=0,this.oi=Ti._r()}forEachTarget(e,n){return this.ri.forEach((r,s)=>n(s)),j.resolve()}getLastRemoteSnapshotVersion(e){return j.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return j.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),j.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ii&&(this.ii=n),j.resolve()}lr(e){this.ri.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.oi=new Ti(n),this.highestTargetId=n),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,n){return this.lr(n),this.targetCount+=1,j.resolve()}updateTargetData(e,n){return this.lr(n),j.resolve()}removeTargetData(e,n){return this.ri.delete(n.target),this.si.Gr(n.targetId),this.targetCount-=1,j.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.ri.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.ri.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),j.waitFor(i).next(()=>s)}getTargetCount(e){return j.resolve(this.targetCount)}getTargetData(e,n){const r=this.ri.get(n)||null;return j.resolve(r)}addMatchingKeys(e,n,r){return this.si.$r(n,r),j.resolve()}removeMatchingKeys(e,n,r){this.si.Qr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),j.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.si.Gr(n),j.resolve()}getMatchingKeysForTargetId(e,n){const r=this.si.jr(n);return j.resolve(r)}containsKey(e,n){return j.resolve(this.si.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fy{constructor(e,n){this._i={},this.overlays={},this.ai=new Qt(0),this.ui=!1,this.ui=!0,this.ci=new G2,this.referenceDelegate=e(this),this.li=new Y2(this),this.indexManager=new V2,this.remoteDocumentCache=function(s){return new W2(s)}(r=>this.referenceDelegate.hi(r)),this.serializer=new OT(n),this.Pi=new q2(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new H2,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this._i[e.toKey()];return r||(r=new K2(n,this.referenceDelegate),this._i[e.toKey()]=r),r}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const s=new J2(this.ai.next());return this.referenceDelegate.Ti(),r(s).next(i=>this.referenceDelegate.Ii(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ei(e,n){return j.or(Object.values(this._i).map(r=>()=>r.containsKey(e,n)))}}class J2 extends N1{constructor(e){super(),this.currentSequenceNumber=e}}class bh{constructor(e){this.persistence=e,this.Ri=new hy,this.Ai=null}static Vi(e){return new bh(e)}get di(){if(this.Ai)return this.Ai;throw re(60996)}addReference(e,n,r){return this.Ri.addReference(r,n),this.di.delete(r.toString()),j.resolve()}removeReference(e,n,r){return this.Ri.removeReference(r,n),this.di.add(r.toString()),j.resolve()}markPotentiallyOrphaned(e,n){return this.di.add(n.toString()),j.resolve()}removeTarget(e,n){this.Ri.Gr(n.targetId).forEach(s=>this.di.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.di.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Ti(){this.Ai=new Set}Ii(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return j.forEach(this.di,r=>{const s=ee.fromPath(r);return this.mi(e,s).next(i=>{i||n.removeEntry(s,ce.min())})}).next(()=>(this.Ai=null,n.apply(e)))}updateLimboDocument(e,n){return this.mi(e,n).next(r=>{r?this.di.delete(n.toString()):this.di.add(n.toString())})}hi(e){return 0}mi(e,n){return j.or([()=>j.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class Nd{constructor(e,n){this.persistence=e,this.fi=new Pr(r=>Vt(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=KT(this,n)}static Vi(e,n){return new Nd(e,n)}Ti(){}Ii(e){return j.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}dr(e){const n=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}pr(e){let n=0;return this.mr(e,r=>{n++}).next(()=>n)}mr(e,n){return j.forEach(this.fi,(r,s)=>this.wr(e,r,s).next(i=>i?j.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.ni(e,o=>this.wr(e,o,n).next(a=>{a||(r++,i.removeEntry(o,ce.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.fi.set(n,e.currentSequenceNumber),j.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),j.resolve()}removeReference(e,n,r){return this.fi.set(r,e.currentSequenceNumber),j.resolve()}updateLimboDocument(e,n){return this.fi.set(n,e.currentSequenceNumber),j.resolve()}hi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=ku(e.data.value)),n}wr(e,n,r){return j.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.fi.get(n);return j.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e){this.serializer=e}k(e,n,r,s){const i=new hh("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(dc)}(e),function(c){c.createObjectStore(ql,{keyPath:uP}),c.createObjectStore(Cn,{keyPath:P0,autoIncrement:!0}).createIndex(si,D0,{unique:!0}),c.createObjectStore(jo)}(e),Ex(e),function(c){c.createObjectStore(Ys)}(e));let o=j.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(Oo),c.deleteObjectStore(Vo),c.deleteObjectStore(li)}(e),Ex(e)),o=o.next(()=>function(c){const d=c.store(li),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ce.min().toTimestamp(),targetCount:0};return d.put(vd,h)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,d){return d.store(Cn).H().next(m=>{c.deleteObjectStore(Cn),c.createObjectStore(Cn,{keyPath:P0,autoIncrement:!0}).createIndex(si,D0,{unique:!0});const g=d.store(Cn),x=m.map(A=>g.put(A));return j.waitFor(x)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(Mo,{keyPath:_P})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.gi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Hl)}(e),this.pi(i)))),r<7&&s>=7&&(o=o.next(()=>this.yi(i))),r<8&&s>=8&&(o=o.next(()=>this.wi(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.bi(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(mh,{keyPath:xP})})(e),function(c){c.createObjectStore(ph,{keyPath:wP})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const d=c.createObjectStore(gh,{keyPath:NP});d.createIndex(gp,CP,{unique:!1}),d.createIndex(O1,kP,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const d=c.createObjectStore(yd,{keyPath:hP});d.createIndex(Nu,fP),d.createIndex(P1,mP)}(e)).next(()=>this.Si(e,i)).next(()=>e.deleteObjectStore(Ys))),r<14&&s>=14&&(o=o.next(()=>this.Di(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(Yg,{keyPath:EP,autoIncrement:!0}).createIndex(pp,IP,{unique:!1}),c.createObjectStore(fl,{keyPath:TP}).createIndex(j1,bP,{unique:!1}),c.createObjectStore(ml,{keyPath:SP}).createIndex(V1,AP,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(fl).clear()}).next(()=>{n.objectStore(ml).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(Jg,{keyPath:RP})})(e)})),r<18&&s>=18&&l1()&&(o=o.next(()=>{n.objectStore(fl).clear()}).next(()=>{n.objectStore(ml).clear()})),o}pi(e){let n=0;return e.store(Ys).ee((r,s)=>{n+=Ad(s)}).next(()=>{const r={byteSize:n};return e.store(Hl).put(mp,r)})}gi(e){const n=e.store(ql),r=e.store(Cn);return n.H().next(s=>j.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,ai],[i.userId,i.lastAcknowledgedBatchId]);return r.H(si,o).next(a=>j.forEach(a,c=>{oe(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const d=Xs(this.serializer,c);return BT(e,i.userId,d).next(()=>{})}))}))}yi(e){const n=e.store(Oo),r=e.store(Ys);return e.store(li).get(vd).next(s=>{const i=[];return r.ee((o,a)=>{const c=new Ae(o),d=function(m){return[0,Vt(m)]}(c);i.push(n.get(d).next(h=>h?j.resolve():(m=>n.put({targetId:0,path:Vt(m),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>j.waitFor(i))})}wi(e,n){e.createObjectStore(Gl,{keyPath:vP});const r=n.store(Gl),s=new dy,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Vt(c)})}};return n.store(Ys).ee({Y:!0},(o,a)=>{const c=new Ae(o);return i(c.popLast())}).next(()=>n.store(jo).ee({Y:!0},([o,a,c],d)=>{const h=Wn(a);return i(h.popLast())}))}bi(e){const n=e.store(Vo);return n.ee((r,s)=>{const i=Ja(s),o=MT(this.serializer,i);return n.put(o)})}Si(e,n){const r=n.store(Ys),s=[];return r.ee((i,o)=>{const a=n.store(yd),c=function(m){return m.document?new ee(Ae.fromString(m.document.name).popFirst(5)):m.noDocument?ee.fromSegments(m.noDocument.path):m.unknownDocument?ee.fromSegments(m.unknownDocument.path):re(36783)}(o).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>j.waitFor(s))}Di(e,n){const r=n.store(Cn),s=QT(this.serializer),i=new fy(bh.Vi,this.serializer.yt);return r.H().next(o=>{const a=new Map;return o.forEach(c=>{let d=a.get(c.userId)??ve();Xs(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),j.forEach(a,(c,d)=>{const h=new kt(d),m=Ih.wt(this.serializer,h),g=i.getIndexManager(h),x=Th.wt(h,this.serializer,g,i.referenceDelegate);return new YT(s,x,m,g).recalculateAndSaveOverlaysForDocumentKeys(new yp(n,Qt.ce),c).next()})})}}function Ex(t){t.createObjectStore(Oo,{keyPath:gP}).createIndex(Qg,yP,{unique:!0}),t.createObjectStore(Vo,{keyPath:"targetId"}).createIndex(D1,pP,{unique:!0}),t.createObjectStore(li)}const Gr="IndexedDbPersistence",zf=18e5,Bf=5e3,$f="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Z2="main";class my{constructor(e,n,r,s,i,o,a,c,d,h,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Ci=i,this.window=o,this.document=a,this.Fi=d,this.Mi=h,this.xi=m,this.ai=null,this.ui=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Oi=null,this.inForeground=!1,this.Ni=null,this.Bi=null,this.Li=Number.NEGATIVE_INFINITY,this.ki=g=>Promise.resolve(),!my.v())throw new Q(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new U2(this,s),this.Ki=n+Z2,this.serializer=new OT(c),this.qi=new _s(this.Ki,this.xi,new X2(this.serializer)),this.ci=new C2,this.li=new M2(this.referenceDelegate,this.serializer),this.remoteDocumentCache=QT(this.serializer),this.Pi=new N2,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,h===!1&&nt(Gr,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.$i().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Q(z.FAILED_PRECONDITION,$f);return this.Wi(),this.Qi(),this.Gi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.li.getHighestSequenceNumber(e))}).then(e=>{this.ai=new Qt(e,this.Fi)}).then(()=>{this.ui=!0}).catch(e=>(this.qi&&this.qi.close(),Promise.reject(e)))}zi(e){return this.ki=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.qi.q(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ci.enqueueAndForget(async()=>{this.started&&await this.$i()}))}$i(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ru(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ji(e).next(n=>{n||(this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)))})}).next(()=>this.Hi(e)).next(n=>this.isPrimary&&!n?this.Ji(e).next(()=>!1):!!n&&this.Zi(e).next(()=>!0))).catch(e=>{if(js(e))return q(Gr,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q(Gr,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ci.enqueueRetryable(()=>this.ki(e)),this.isPrimary=e})}ji(e){return Oa(e).get(Bi).next(n=>j.resolve(this.Xi(n)))}Yi(e){return ru(e).delete(this.clientId)}async es(){if(this.isPrimary&&!this.ts(this.Li,zf)){this.Li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=pt(n,Mo);return r.H().next(s=>{const i=this.ns(s,zf),o=s.filter(a=>i.indexOf(a)===-1);return j.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Ui)for(const n of e)this.Ui.removeItem(this.rs(n.clientId))}}Gi(){this.Bi=this.Ci.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.$i().then(()=>this.es()).then(()=>this.Gi()))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.Mi?j.resolve(!0):Oa(e).get(Bi).next(n=>{if(n!==null&&this.ts(n.leaseTimestampMs,Bf)&&!this.ss(n.ownerId)){if(this.Xi(n)&&this.networkEnabled)return!0;if(!this.Xi(n)){if(!n.allowTabSynchronization)throw new Q(z.FAILED_PRECONDITION,$f);return!1}}return!(!this.networkEnabled||!this.inForeground)||ru(e).H().next(r=>this.ns(r,Bf).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&q(Gr,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.ui=!1,this._s(),this.Bi&&(this.Bi.cancel(),this.Bi=null),this.us(),this.cs(),await this.qi.runTransaction("shutdown","readwrite",[dc,Mo],e=>{const n=new yp(e,Qt.ce);return this.Ji(n).next(()=>this.Yi(n))}),this.qi.close(),this.ls()}ns(e,n){return e.filter(r=>this.ts(r.updateTimeMs,n)&&!this.ss(r.clientId))}hs(){return this.runTransaction("getActiveClients","readonly",e=>ru(e).H().next(n=>this.ns(n,zf).map(r=>r.clientId)))}get started(){return this.ui}getGlobalsCache(){return this.ci}getMutationQueue(e,n){return Th.wt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new O2(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return Ih.wt(this.serializer,e)}getBundleCache(){return this.Pi}runTransaction(e,n,r){q(Gr,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?jP:c===17?U1:c===16?DP:c===15?Xg:c===14?F1:c===13?L1:c===12?PP:c===11?M1:void re(60245)}(this.xi);let o;return this.qi.runTransaction(e,s,i,a=>(o=new yp(a,this.ai?this.ai.next():Qt.ce),n==="readwrite-primary"?this.ji(o).next(c=>!!c||this.Hi(o)).next(c=>{if(!c)throw nt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ci.enqueueRetryable(()=>this.ki(!1)),new Q(z.FAILED_PRECONDITION,A1);return r(o)}).next(c=>this.Zi(o).next(()=>c)):this.Ps(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ps(e){return Oa(e).get(Bi).next(n=>{if(n!==null&&this.ts(n.leaseTimestampMs,Bf)&&!this.ss(n.ownerId)&&!this.Xi(n)&&!(this.Mi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new Q(z.FAILED_PRECONDITION,$f)})}Zi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Oa(e).put(Bi,n)}static v(){return _s.v()}Ji(e){const n=Oa(e);return n.get(Bi).next(r=>this.Xi(r)?(q(Gr,"Releasing primary lease."),n.delete(Bi)):j.resolve())}ts(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(nt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ni=()=>{this.Ci.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.$i()))},this.document.addEventListener("visibilitychange",this.Ni),this.inForeground=this.document.visibilityState==="visible")}us(){this.Ni&&(this.document.removeEventListener("visibilitychange",this.Ni),this.Ni=null)}Qi(){var e;typeof((e=this.window)==null?void 0:e.addEventListener)=="function"&&(this.Oi=()=>{this._s();const n=/(?:Version|Mobile)\/1[456]/;a1()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.Ci.enterRestrictedMode(!0),this.Ci.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Oi))}cs(){this.Oi&&(this.window.removeEventListener("pagehide",this.Oi),this.Oi=null)}ss(e){var n;try{const r=((n=this.Ui)==null?void 0:n.getItem(this.rs(e)))!==null;return q(Gr,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return nt(Gr,"Failed to get zombied client id.",r),!1}}_s(){if(this.Ui)try{this.Ui.setItem(this.rs(this.clientId),String(Date.now()))}catch(e){nt("Failed to set zombie client id.",e)}}ls(){if(this.Ui)try{this.Ui.removeItem(this.rs(this.clientId))}catch{}}rs(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Oa(t){return pt(t,dc)}function ru(t){return pt(t,Mo)}function JT(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class py{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Ts=r,this.Is=s}static Es(e,n){let r=ve(),s=ve();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new py(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XT{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=function(){return a1()?8:C1(mt())>0?6:4}()}initialize(e,n){this.fs=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.gs(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.ps(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new eD;return this.ys(e,n,o).next(a=>{if(i.result=a,this.As)return this.ws(e,n,o,a.size)})}).next(()=>i.result)}ws(e,n,r,s){return r.documentReadCount<this.Vs?(Wi()<=Ee.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Qi(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),j.resolve()):(Wi()<=Ee.DEBUG&&q("QueryEngine","Query:",Qi(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ds*s?(Wi()<=Ee.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Qi(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,dn(n))):j.resolve())}gs(e,n){if(G0(n))return j.resolve(null);let r=dn(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Ed(n,null,"F"),r=dn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ve(...i);return this.fs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.bs(n,a);return this.Ss(n,d,o,c.readTime)?this.gs(e,Ed(n,null,"F")):this.Ds(e,d,n,c)}))})))}ps(e,n,r,s){return G0(n)||s.isEqual(ce.min())?j.resolve(null):this.fs.getDocuments(e,r).next(i=>{const o=this.bs(n,i);return this.Ss(n,o,r,s)?j.resolve(null):(Wi()<=Ee.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Qi(n)),this.Ds(e,o,n,b1(s,Do)).next(a=>a))})}bs(e,n){let r=new Pe(lT(e));return n.forEach((s,i)=>{mc(e,i)&&(r=r.add(i))}),r}Ss(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}ys(e,n,r){return Wi()<=Ee.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Qi(n)),this.fs.getDocumentsMatchingQuery(e,n,fn.min(),r)}Ds(e,n,r,s){return this.fs.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gy="LocalStore",tD=3e8;class nD{constructor(e,n,r,s){this.persistence=e,this.Cs=n,this.serializer=s,this.vs=new Fe(fe),this.Fs=new Pr(i=>wi(i),hc),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(r)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new YT(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.vs))}}function ZT(t,e,n,r){return new nD(t,e,n,r)}async function eb(t,e){const n=ie(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Os(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=ve();for(const d of s){o.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of i){a.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({Ns:d,removedBatchIds:o,addedBatchIds:a}))})})}function rD(t,e){const n=ie(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.xs.newChangeBuffer({trackRemovals:!0});return function(a,c,d,h){const m=d.batch,g=m.keys();let x=j.resolve();return g.forEach(A=>{x=x.next(()=>h.getEntry(c,A)).next(C=>{const R=d.docVersions.get(A);oe(R!==null,48541),C.version.compareTo(R)<0&&(m.applyToRemoteDocument(C,d),C.isValidDocument()&&(C.setReadTime(d.commitVersion),h.addEntry(C)))})}),x.next(()=>a.mutationQueue.removeMutationBatch(c,m))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=ve();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function tb(t){const e=ie(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.li.getLastRemoteSnapshotVersion(n))}function sD(t,e){const n=ie(t),r=e.snapshotVersion;let s=n.vs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.xs.newChangeBuffer({trackRemovals:!0});s=n.vs;const a=[];e.targetChanges.forEach((h,m)=>{const g=s.get(m);if(!g)return;a.push(n.li.removeMatchingKeys(i,h.removedDocuments,m).next(()=>n.li.addMatchingKeys(i,h.addedDocuments,m)));let x=g.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(m)!==null?x=x.withResumeToken(rt.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,r)),s=s.insert(m,x),function(C,R,I){return C.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=tD?!0:I.addedDocuments.size+I.modifiedDocuments.size+I.removedDocuments.size>0}(g,x,h)&&a.push(n.li.updateTargetData(i,x))});let c=on(),d=ve();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(iD(i,o,e.documentUpdates).next(h=>{c=h.Bs,d=h.Ls})),!r.isEqual(ce.min())){const h=n.li.getLastRemoteSnapshotVersion(i).next(m=>n.li.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return j.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,d)).next(()=>c)}).then(i=>(n.vs=s,i))}function iD(t,e,n){let r=ve(),s=ve();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=on();return n.forEach((a,c)=>{const d=i.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(ce.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):q(gy,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{Bs:o,Ls:s}})}function oD(t,e){const n=ie(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=ai),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Cd(t,e){const n=ie(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.li.getTargetData(r,e).next(i=>i?(s=i,j.resolve(s)):n.li.allocateTargetId(r).next(o=>(s=new fr(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.li.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.vs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.vs=n.vs.insert(r.targetId,r),n.Fs.set(e,r.targetId)),r})}async function Go(t,e,n){const r=ie(t),s=r.vs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!js(o))throw o;q(gy,`Failed to update sequence numbers for target ${e}: ${o}`)}r.vs=r.vs.remove(e),r.Fs.delete(s.target)}function Rp(t,e,n){const r=ie(t);let s=ce.min(),i=ve();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,d,h){const m=ie(c),g=m.Fs.get(h);return g!==void 0?j.resolve(m.vs.get(g)):m.li.getTargetData(d,h)}(r,o,dn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.li.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,n?s:ce.min(),n?i:ve())).next(a=>(sb(r,aT(e),a),{documents:a,ks:i})))}function nb(t,e){const n=ie(t),r=ie(n.li),s=n.vs.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.At(i,e).next(o=>o?o.target:null))}function rb(t,e){const n=ie(t),r=n.Ms.get(e)||ce.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.xs.getAllFromCollectionGroup(s,e,b1(r,Do),Number.MAX_SAFE_INTEGER)).then(s=>(sb(n,e,s),s))}function sb(t,e,n){let r=t.Ms.get(e)||ce.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ms.set(e,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ib="firestore_clients";function Ix(t,e){return`${ib}_${t}_${e}`}const ob="firestore_mutations";function Tx(t,e,n){let r=`${ob}_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}const ab="firestore_targets";function qf(t,e){return`${ab}_${t}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gn="SharedClientState";class kd{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static $s(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new Q(s.error.code,s.error.message))),o?new kd(e,n,s.state,i):(nt(Gn,`Failed to parse mutation state for ID '${n}': ${r}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class _l{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static $s(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new Q(r.error.code,r.error.message))),i?new _l(e,r.state,s):(nt(Gn,`Failed to parse target state for ID '${e}': ${n}`),null)}Ws(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Rd{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static $s(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=ry();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=k1(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Rd(e,i):(nt(Gn,`Failed to parse client data for instance '${e}': ${n}`),null)}}class yy{constructor(e,n){this.clientId=e,this.onlineState=n}static $s(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new yy(n.clientId,n.onlineState):(nt(Gn,`Failed to parse online state: ${e}`),null)}}class Pp{constructor(){this.activeTargetIds=ry()}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Hf{constructor(e,n,r,s,i){this.window=e,this.Ci=n,this.persistenceKey=r,this.zs=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.js=this.Hs.bind(this),this.Js=new Fe(fe),this.started=!1,this.Zs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Xs=Ix(this.persistenceKey,this.zs),this.Ys=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Js=this.Js.insert(this.zs,new Pp),this.eo=new RegExp(`^${ib}_${o}_([^_]*)$`),this.no=new RegExp(`^${ob}_${o}_(\\d+)(?:_(.*))?$`),this.ro=new RegExp(`^${ab}_${o}_(\\d+)$`),this.io=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.so=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.js)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.hs();for(const r of e){if(r===this.zs)continue;const s=this.getItem(Ix(this.persistenceKey,r));if(s){const i=Rd.$s(r,s);i&&(this.Js=this.Js.insert(i.clientId,i))}}this.oo();const n=this.storage.getItem(this.io);if(n){const r=this._o(n);r&&this.ao(r)}for(const r of this.Zs)this.Hs(r);this.Zs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ys,JSON.stringify(e))}getAllActiveQueryTargets(){return this.uo(this.Js)}isActiveQueryTarget(e){let n=!1;return this.Js.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.co(e,"pending")}updateMutationState(e,n,r){this.co(e,n,r),this.lo(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(qf(this.persistenceKey,e));if(s){const i=_l.$s(e,s);i&&(r=i.state)}}return n&&this.ho.Qs(e),this.oo(),r}removeLocalQueryTarget(e){this.ho.Gs(e),this.oo()}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(qf(this.persistenceKey,e))}updateQueryState(e,n,r){this.Po(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.lo(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.To(e)}notifyBundleLoaded(e){this.Io(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.js),this.removeItem(this.Xs),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return q(Gn,"READ",e,n),n}setItem(e,n){q(Gn,"SET",e,n),this.storage.setItem(e,n)}removeItem(e){q(Gn,"REMOVE",e),this.storage.removeItem(e)}Hs(e){const n=e;if(n.storageArea===this.storage){if(q(Gn,"EVENT",n.key,n.newValue),n.key===this.Xs)return void nt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ci.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.eo.test(n.key)){if(n.newValue==null){const r=this.Eo(n.key);return this.Ro(r,null)}{const r=this.Ao(n.key,n.newValue);if(r)return this.Ro(r.clientId,r)}}else if(this.no.test(n.key)){if(n.newValue!==null){const r=this.Vo(n.key,n.newValue);if(r)return this.mo(r)}}else if(this.ro.test(n.key)){if(n.newValue!==null){const r=this.fo(n.key,n.newValue);if(r)return this.po(r)}}else if(n.key===this.io){if(n.newValue!==null){const r=this._o(n.newValue);if(r)return this.ao(r)}}else if(n.key===this.Ys){const r=function(i){let o=Qt.ce;if(i!=null)try{const a=JSON.parse(i);oe(typeof a=="number",30636,{yo:i}),o=a}catch(a){nt(Gn,"Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Qt.ce&&this.sequenceNumberHandler(r)}else if(n.key===this.so){const r=this.wo(n.newValue);await Promise.all(r.map(s=>this.syncEngine.bo(s)))}}}else this.Zs.push(n)})}}get ho(){return this.Js.get(this.zs)}oo(){this.setItem(this.Xs,this.ho.Ws())}co(e,n,r){const s=new kd(this.currentUser,e,n,r),i=Tx(this.persistenceKey,this.currentUser,e);this.setItem(i,s.Ws())}lo(e){const n=Tx(this.persistenceKey,this.currentUser,e);this.removeItem(n)}To(e){const n={clientId:this.zs,onlineState:e};this.storage.setItem(this.io,JSON.stringify(n))}Po(e,n,r){const s=qf(this.persistenceKey,e),i=new _l(e,n,r);this.setItem(s,i.Ws())}Io(e){const n=JSON.stringify(Array.from(e));this.setItem(this.so,n)}Eo(e){const n=this.eo.exec(e);return n?n[1]:null}Ao(e,n){const r=this.Eo(e);return Rd.$s(r,n)}Vo(e,n){const r=this.no.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return kd.$s(new kt(i),s,n)}fo(e,n){const r=this.ro.exec(e),s=Number(r[1]);return _l.$s(s,n)}_o(e){return yy.$s(e)}wo(e){return JSON.parse(e)}async mo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.So(e.batchId,e.state,e.error);q(Gn,`Ignoring mutation for non-active user ${e.user.uid}`)}po(e){return this.syncEngine.Do(e.targetId,e.state,e.error)}Ro(e,n){const r=n?this.Js.insert(e,n):this.Js.remove(e),s=this.uo(this.Js),i=this.uo(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Co(o,a).then(()=>{this.Js=r})}ao(e){this.Js.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}uo(e){let n=ry();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class lb{constructor(){this.vo=new Pp,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,n,r){this.Fo[e]=n}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new Pp,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{Mo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx="ConnectivityMonitor";class Sx{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){q(bx,"Network connectivity changed: AVAILABLE");for(const e of this.Lo)e(0)}Bo(){q(bx,"Network connectivity changed: UNAVAILABLE");for(const e of this.Lo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let su=null;function Dp(){return su===null?su=function(){return 268435456+Math.round(2147483648*Math.random())}():su++,"0x"+su.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gf="RestConnection",lD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};class cD{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.qo=n+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.$o=this.databaseId.database===_d?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,n,r,s,i){const o=Dp(),a=this.Qo(e,n.toUriEncodedString());q(Gf,`Sending RPC '${e}' ${o}:`,a,r);const c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(c,s,i);const{host:d}=new URL(a),h=ir(d);return this.zo(e,a,c,r,h).then(m=>(q(Gf,`Received RPC '${e}' ${o}: `,m),m),m=>{throw Ro(Gf,`RPC '${e}' ${o} failed with error: `,m,"url: ",a,"request:",r),m})}jo(e,n,r,s,i,o){return this.Wo(e,n,r,s,i)}Go(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+na}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}Qo(e,n){const r=lD[e];let s=`${this.qo}/v1/${n}:${r}`;return this.databaseInfo.apiKey&&(s=`${s}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),s}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ct="WebChannelConnection",Ma=(t,e,n)=>{t.listen(e,r=>{try{n(r)}catch(s){setTimeout(()=>{throw s},0)}})};class _o extends cD{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!_o.c_){const e=_1();Ma(e,v1.STAT_EVENT,n=>{n.stat===dp.PROXY?q(Ct,"STAT_EVENT: detected buffering proxy"):n.stat===dp.NOPROXY&&q(Ct,"STAT_EVENT: detected no buffering proxy")}),_o.c_=!0}}zo(e,n,r,s,i){const o=Dp();return new Promise((a,c)=>{const d=new g1;d.setWithCredentials(!0),d.listenOnce(y1.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case bu.NO_ERROR:const m=d.getResponseJson();q(Ct,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),a(m);break;case bu.TIMEOUT:q(Ct,`RPC '${e}' ${o} timed out`),c(new Q(z.DEADLINE_EXCEEDED,"Request time out"));break;case bu.HTTP_ERROR:const g=d.getStatus();if(q(Ct,`RPC '${e}' ${o} failed with status:`,g,"response text:",d.getResponseText()),g>0){let x=d.getResponseJson();Array.isArray(x)&&(x=x[0]);const A=x==null?void 0:x.error;if(A&&A.status&&A.message){const C=function(I){const v=I.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(v)>=0?v:z.UNKNOWN}(A.status);c(new Q(C,A.message))}else c(new Q(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new Q(z.UNAVAILABLE,"Connection failed."));break;default:re(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{q(Ct,`RPC '${e}' ${o} completed.`)}});const h=JSON.stringify(s);q(Ct,`RPC '${e}' ${o} sending request:`,s),d.send(n,"POST",h,r,15)})}T_(e,n,r){const s=Dp(),i=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=this.createWebChannelTransport(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Go(a.initMessageHeaders,n,r),a.encodeInitMessageHeaders=!0;const d=i.join("");q(Ct,`Creating RPC '${e}' stream ${s}: ${d}`,a);const h=o.createWebChannel(d,a);this.I_(h);let m=!1,g=!1;const x=new uD({Ho:A=>{g?q(Ct,`Not sending because RPC '${e}' stream ${s} is closed:`,A):(m||(q(Ct,`Opening RPC '${e}' stream ${s} transport.`),h.open(),m=!0),q(Ct,`RPC '${e}' stream ${s} sending:`,A),h.send(A))},Jo:()=>h.close()});return Ma(h,Wa.EventType.OPEN,()=>{g||(q(Ct,`RPC '${e}' stream ${s} transport opened.`),x.i_())}),Ma(h,Wa.EventType.CLOSE,()=>{g||(g=!0,q(Ct,`RPC '${e}' stream ${s} transport closed`),x.o_(),this.E_(h))}),Ma(h,Wa.EventType.ERROR,A=>{g||(g=!0,Ro(Ct,`RPC '${e}' stream ${s} transport errored. Name:`,A.name,"Message:",A.message),x.o_(new Q(z.UNAVAILABLE,"The operation could not be completed")))}),Ma(h,Wa.EventType.MESSAGE,A=>{var C;if(!g){const R=A.data[0];oe(!!R,16349);const I=R,v=(I==null?void 0:I.error)||((C=I[0])==null?void 0:C.error);if(v){q(Ct,`RPC '${e}' stream ${s} received error:`,v);const T=v.status;let D=function(E){const y=st[E];if(y!==void 0)return wT(y)}(T),O=v.message;T==="NOT_FOUND"&&O.includes("database")&&O.includes("does not exist")&&O.includes(this.databaseId.database)&&Ro(`Database '${this.databaseId.database}' not found. Please check your project configuration.`),D===void 0&&(D=z.INTERNAL,O="Unknown error status: "+T+" with message "+v.message),g=!0,x.o_(new Q(D,O)),h.close()}else q(Ct,`RPC '${e}' stream ${s} received:`,R),x.__(R)}}),_o.u_(),setTimeout(()=>{x.s_()},0),x}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(n=>n===e)}Go(e,n,r){super.Go(e,n,r),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return x1()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dD(t){return new _o(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(){return typeof window<"u"?window:null}function Vu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t){return new y2(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */_o.c_=!1;class ub{constructor(e,n,r=1e3,s=1.5,i=6e4){this.Ci=e,this.timerId=n,this.R_=r,this.A_=s,this.V_=i,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();const n=Math.floor(this.d_+this.y_()),r=Math.max(0,Date.now()-this.f_),s=Math.max(0,n-r);s>0&&q("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.d_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,s,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ax="PersistentStream";class db{constructor(e,n,r,s,i,o,a,c){this.Ci=e,this.b_=r,this.S_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ub(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(nt(n.toString()),nt("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(n)}W_(){}auth(){this.state=1;const e=this.Q_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.D_===n&&this.G_(r,s)},r=>{e(()=>{const s=new Q(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(s)})})}G_(e,n){const r=this.Q_(this.D_);this.stream=this.j_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.Yo(()=>{r(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(s=>{r(()=>this.z_(s))}),this.stream.onMessage(s=>{r(()=>++this.F_==1?this.H_(s):this.onNext(s))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return q(Ax,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return n=>{this.Ci.enqueueAndForget(()=>this.D_===e?n():(q(Ax,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hD extends db{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}j_(e,n){return this.connection.T_("Listen",e,n)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=x2(this.serializer,e),r=function(i){if(!("targetChange"in i))return ce.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?ce.min():o.readTime?$t(o.readTime):ce.min()}(e);return this.listener.J_(n,r)}Z_(e){const n={};n.database=Sp(this.serializer),n.addTarget=function(i,o){let a;const c=o.target;if(a=xd(c)?{documents:CT(i,c)}:{query:kT(i,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=TT(i,o.resumeToken);const d=Tp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(ce.min())>0){a.readTime=Ho(i,o.snapshotVersion.toTimestamp());const d=Tp(i,o.expectedCount);d!==null&&(a.expectedCount=d)}return a}(this.serializer,e);const r=E2(this.serializer,e);r&&(n.labels=r),this.K_(n)}X_(e){const n={};n.database=Sp(this.serializer),n.removeTarget=e,this.K_(n)}}class fD extends db{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}H_(e){return oe(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,oe(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){oe(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=w2(e.writeResults,e.commitTime),r=$t(e.commitTime);return this.listener.na(r,n)}ra(){const e={};e.database=Sp(this.serializer),this.K_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Td(this.serializer,r))};this.K_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{}class pD extends mD{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new Q(z.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Wo(e,bp(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Q(z.UNKNOWN,i.toString())})}jo(e,n,r,s,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.jo(e,bp(n,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Q(z.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}function gD(t,e,n,r){return new pD(t,e,n,r)}class yD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(nt(n),this.aa=!1):q("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi="RemoteStore";class vD{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=i,this.Aa.Mo(o=>{r.enqueueAndForget(async()=>{Di(this)&&(q(bi,"Restarting streams for network reachability change."),await async function(c){const d=ie(c);d.Ea.add(4),await yc(d),d.Va.set("Unknown"),d.Ea.delete(4),await Ah(d)}(this))})}),this.Va=new yD(r,s)}}async function Ah(t){if(Di(t))for(const e of t.Ra)await e(!0)}async function yc(t){for(const e of t.Ra)await e(!1)}function Nh(t,e){const n=ie(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),xy(n)?_y(n):oa(n).O_()&&vy(n,e))}function Ko(t,e){const n=ie(t),r=oa(n);n.Ia.delete(e),r.O_()&&hb(n,e),n.Ia.size===0&&(r.O_()?r.L_():Di(n)&&n.Va.set("Unknown"))}function vy(t,e){if(t.da.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ce.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}oa(t).Z_(e)}function hb(t,e){t.da.$e(e),oa(t).X_(e)}function _y(t){t.da=new f2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),oa(t).start(),t.Va.ua()}function xy(t){return Di(t)&&!oa(t).x_()&&t.Ia.size>0}function Di(t){return ie(t).Ea.size===0}function fb(t){t.da=void 0}async function _D(t){t.Va.set("Online")}async function xD(t){t.Ia.forEach((e,n)=>{vy(t,e)})}async function wD(t,e){fb(t),xy(t)?(t.Va.ha(e),_y(t)):t.Va.set("Unknown")}async function ED(t,e,n){if(t.Va.set("Online"),e instanceof IT&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.da.removeTarget(a))}(t,e)}catch(r){q(bi,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Pd(t,r)}else if(e instanceof Du?t.da.Xe(e):e instanceof ET?t.da.st(e):t.da.tt(e),!n.isEqual(ce.min()))try{const r=await tb(t.localStore);n.compareTo(r)>=0&&await function(i,o){const a=i.da.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.Ia.get(d);h&&i.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{const h=i.Ia.get(c);if(!h)return;i.Ia.set(c,h.withResumeToken(rt.EMPTY_BYTE_STRING,h.snapshotVersion)),hb(i,c);const m=new fr(h.target,c,d,h.sequenceNumber);vy(i,m)}),i.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){q(bi,"Failed to raise snapshot:",r),await Pd(t,r)}}async function Pd(t,e,n){if(!js(e))throw e;t.Ea.add(1),await yc(t),t.Va.set("Offline"),n||(n=()=>tb(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q(bi,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await Ah(t)})}function mb(t,e){return e().catch(n=>Pd(t,n,e))}async function ia(t){const e=ie(t),n=Ns(e);let r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:ai;for(;ID(e);)try{const s=await oD(e.localStore,r);if(s===null){e.Ta.length===0&&n.L_();break}r=s.batchId,TD(e,s)}catch(s){await Pd(e,s)}pb(e)&&gb(e)}function ID(t){return Di(t)&&t.Ta.length<10}function TD(t,e){t.Ta.push(e);const n=Ns(t);n.O_()&&n.Y_&&n.ea(e.mutations)}function pb(t){return Di(t)&&!Ns(t).x_()&&t.Ta.length>0}function gb(t){Ns(t).start()}async function bD(t){Ns(t).ra()}async function SD(t){const e=Ns(t);for(const n of t.Ta)e.ea(n.mutations)}async function AD(t,e,n){const r=t.Ta.shift(),s=oy.from(r,e,n);await mb(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ia(t)}async function ND(t,e){e&&Ns(t).Y_&&await async function(r,s){if(function(o){return u2(o)&&o!==z.ABORTED}(s.code)){const i=r.Ta.shift();Ns(r).B_(),await mb(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ia(r)}}(t,e),pb(t)&&gb(t)}async function Nx(t,e){const n=ie(t);n.asyncQueue.verifyOperationInProgress(),q(bi,"RemoteStore received new credentials");const r=Di(n);n.Ea.add(3),await yc(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await Ah(n)}async function jp(t,e){const n=ie(t);e?(n.Ea.delete(2),await Ah(n)):e||(n.Ea.add(2),await yc(n),n.Va.set("Unknown"))}function oa(t){return t.ma||(t.ma=function(n,r,s){const i=ie(n);return i.sa(),new hD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:_D.bind(null,t),Yo:xD.bind(null,t),t_:wD.bind(null,t),J_:ED.bind(null,t)}),t.Ra.push(async e=>{e?(t.ma.B_(),xy(t)?_y(t):t.Va.set("Unknown")):(await t.ma.stop(),fb(t))})),t.ma}function Ns(t){return t.fa||(t.fa=function(n,r,s){const i=ie(n);return i.sa(),new fD(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),Yo:bD.bind(null,t),t_:ND.bind(null,t),ta:SD.bind(null,t),na:AD.bind(null,t)}),t.Ra.push(async e=>{e?(t.fa.B_(),await ia(t)):(await t.fa.stop(),t.Ta.length>0&&(q(bi,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))})),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new er,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new wy(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Q(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ey(t,e){if(nt("AsyncQueue",`${e}: ${t}`),js(t))return new Q(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xo{static emptySet(e){return new xo(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||ee.comparator(n.key,r.key):(n,r)=>ee.comparator(n.key,r.key),this.keyedMap=Qa(),this.sortedSet=new Fe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof xo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new xo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cx{constructor(){this.ga=new Fe(ee.comparator)}track(e){const n=e.doc.key,r=this.ga.get(n);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(n,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(n):e.type===1&&r.type===2?this.ga=this.ga.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):re(63341,{Vt:e,pa:r}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal((n,r)=>{e.push(r)}),e}}class Wo{constructor(e,n,r,s,i,o,a,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Wo(e,n,xo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_h(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}}class kD{constructor(){this.queries=kx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const s=ie(n),i=s.queries;s.queries=kx(),i.forEach((o,a)=>{for(const c of a.ba)c.onError(r)})})(this,new Q(z.ABORTED,"Firestore shutting down"))}}function kx(){return new Pr(t=>oT(t),_h)}async function Iy(t,e){const n=ie(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.Sa()&&e.Da()&&(r=2):(i=new CD,r=e.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const a=Ey(o,`Initialization of query '${Qi(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.ba.push(e),e.va(n.onlineState),i.wa&&e.Fa(i.wa)&&by(n)}async function Ty(t,e){const n=ie(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ba.indexOf(e);o>=0&&(i.ba.splice(o,1),i.ba.length===0?s=e.Da()?0:1:!i.Sa()&&e.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function RD(t,e){const n=ie(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.ba)a.Fa(s)&&(r=!0);o.wa=s}}r&&by(n)}function PD(t,e,n){const r=ie(t),s=r.queries.get(e);if(s)for(const i of s.ba)i.onError(n);r.queries.delete(e)}function by(t){t.Ca.forEach(e=>{e.next()})}var Vp,Rx;(Rx=Vp||(Vp={})).Ma="default",Rx.Cache="cache";class Sy{constructor(e,n,r){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Wo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const r=n!=="Offline";return(!this.options.Ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=Wo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Vp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e){this.key=e}}class vb{constructor(e){this.key=e}}class DD{constructor(e,n){this.query=e,this.Za=n,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=ve(),this.mutatedKeys=ve(),this.eu=lT(e),this.tu=new xo(this.eu)}get nu(){return this.Za}ru(e,n){const r=n?n.iu:new Cx,s=n?n.tu:this.tu;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,m)=>{const g=s.get(h),x=mc(this.query,m)?m:null,A=!!g&&this.mutatedKeys.has(g.key),C=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let R=!1;g&&x?g.data.isEqual(x.data)?A!==C&&(r.track({type:3,doc:x}),R=!0):this.su(g,x)||(r.track({type:2,doc:x}),R=!0,(c&&this.eu(x,c)>0||d&&this.eu(x,d)<0)&&(a=!0)):!g&&x?(r.track({type:0,doc:x}),R=!0):g&&!x&&(r.track({type:1,doc:g}),R=!0,(c||d)&&(a=!0)),R&&(x?(o=o.add(x),i=C?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Ss:a,mutatedKeys:i}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const o=e.iu.ya();o.sort((h,m)=>function(x,A){const C=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return re(20277,{Vt:R})}};return C(x)-C(A)}(h.type,m.type)||this.eu(h.doc,m.doc)),this.ou(r),s=s??!1;const a=n&&!s?this._u():[],c=this.Ya.size===0&&this.current&&!s?1:0,d=c!==this.Xa;return this.Xa=c,o.length!==0||d?{snapshot:new Wo(this.query,e.tu,i,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Cx,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(n=>this.Za=this.Za.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Za=this.Za.delete(n)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Ya;this.Ya=ve(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new vb(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new yb(r))}),n}cu(e){this.Za=e.ks,this.Ya=ve();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return Wo.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Xa===0,this.hasCachedResults)}}const aa="SyncEngine";class jD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class VD{constructor(e){this.key=e,this.hu=!1}}class OD{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Pr(a=>oT(a),_h),this.Iu=new Map,this.Eu=new Set,this.Ru=new Fe(ee.comparator),this.Au=new Map,this.Vu=new hy,this.du={},this.mu=new Map,this.fu=Ti.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function MD(t,e,n=!0){const r=Ch(t);let s;const i=r.Tu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await _b(r,e,n,!0),s}async function LD(t,e){const n=Ch(t);await _b(n,e,!0,!1)}async function _b(t,e,n,r){const s=await Cd(t.localStore,dn(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await Ay(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Nh(t.remoteStore,s),a}async function Ay(t,e,n,r,s){t.pu=(m,g,x)=>async function(C,R,I,v){let T=R.view.ru(I);T.Ss&&(T=await Rp(C.localStore,R.query,!1).then(({documents:E})=>R.view.ru(E,T)));const D=v&&v.targetChanges.get(R.targetId),O=v&&v.targetMismatches.get(R.targetId)!=null,U=R.view.applyChanges(T,C.isPrimaryClient,D,O);return Op(C,R.targetId,U.au),U.snapshot}(t,m,g,x);const i=await Rp(t.localStore,e,!0),o=new DD(e,i.ks),a=o.ru(i.documents),c=gc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(a,t.isPrimaryClient,c);Op(t,n,d.au);const h=new jD(e,n,o);return t.Tu.set(e,h),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),d.snapshot}async function FD(t,e,n){const r=ie(t),s=r.Tu.get(e),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(o=>!_h(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Go(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Ko(r.remoteStore,s.targetId),Qo(r,s.targetId)}).catch(Ds)):(Qo(r,s.targetId),await Go(r.localStore,s.targetId,!0))}async function UD(t,e){const n=ie(t),r=n.Tu.get(e),s=n.Iu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ko(n.remoteStore,r.targetId))}async function zD(t,e,n){const r=Ry(t);try{const s=await function(o,a){const c=ie(o),d=Ce.now(),h=a.reduce((x,A)=>x.add(A.key),ve());let m,g;return c.persistence.runTransaction("Locally write mutations","readwrite",x=>{let A=on(),C=ve();return c.xs.getEntries(x,h).next(R=>{A=R,A.forEach((I,v)=>{v.isValidDocument()||(C=C.add(I))})}).next(()=>c.localDocuments.getOverlayedDocuments(x,A)).next(R=>{m=R;const I=[];for(const v of a){const T=l2(v,m.get(v.key).overlayedDocument);T!=null&&I.push(new Dr(v.key,T,Y1(T.value.mapValue),jt.exists(!0)))}return c.mutationQueue.addMutationBatch(x,d,I,a)}).next(R=>{g=R;const I=R.applyToLocalDocumentSet(m,C);return c.documentOverlayCache.saveOverlays(x,R.batchId,I)})}).then(()=>({batchId:g.batchId,changes:uT(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,c){let d=o.du[o.currentUser.toKey()];d||(d=new Fe(fe)),d=d.insert(a,c),o.du[o.currentUser.toKey()]=d}(r,s.batchId,n),await Os(r,s.changes),await ia(r.remoteStore)}catch(s){const i=Ey(s,"Failed to persist write");n.reject(i)}}async function xb(t,e){const n=ie(t);try{const r=await sD(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Au.get(i);o&&(oe(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?oe(o.hu,14607):s.removedDocuments.size>0&&(oe(o.hu,42227),o.hu=!1))}),await Os(n,r,e)}catch(r){await Ds(r)}}function Px(t,e,n){const r=ie(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Tu.forEach((i,o)=>{const a=o.view.va(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const c=ie(o);c.onlineState=a;let d=!1;c.queries.forEach((h,m)=>{for(const g of m.ba)g.va(a)&&(d=!0)}),d&&by(c)}(r.eventManager,e),s.length&&r.Pu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function BD(t,e,n){const r=ie(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Au.get(e),i=s&&s.key;if(i){let o=new Fe(ee.comparator);o=o.insert(i,Je.newNoDocument(i,ce.min()));const a=ve().add(i),c=new pc(ce.min(),new Map,new Fe(fe),o,a);await xb(r,c),r.Ru=r.Ru.remove(i),r.Au.delete(e),ky(r)}else await Go(r.localStore,e,!1).then(()=>Qo(r,e,n)).catch(Ds)}async function $D(t,e){const n=ie(t),r=e.batch.batchId;try{const s=await rD(n.localStore,e);Cy(n,r,null),Ny(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Os(n,s)}catch(s){await Ds(s)}}async function qD(t,e,n){const r=ie(t);try{const s=await function(o,a){const c=ie(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(m=>(oe(m!==null,37113),h=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);Cy(r,e,n),Ny(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Os(r,s)}catch(s){await Ds(s)}}function Ny(t,e){(t.mu.get(e)||[]).forEach(n=>{n.resolve()}),t.mu.delete(e)}function Cy(t,e,n){const r=ie(t);let s=r.du[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.du[r.currentUser.toKey()]=s}}function Qo(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Iu.get(e))t.Tu.delete(r),n&&t.Pu.yu(r,n);t.Iu.delete(e),t.isPrimaryClient&&t.Vu.Gr(e).forEach(r=>{t.Vu.containsKey(r)||wb(t,r)})}function wb(t,e){t.Eu.delete(e.path.canonicalString());const n=t.Ru.get(e);n!==null&&(Ko(t.remoteStore,n),t.Ru=t.Ru.remove(e),t.Au.delete(n),ky(t))}function Op(t,e,n){for(const r of n)r instanceof yb?(t.Vu.addReference(r.key,e),HD(t,r)):r instanceof vb?(q(aa,"Document no longer in limbo: "+r.key),t.Vu.removeReference(r.key,e),t.Vu.containsKey(r.key)||wb(t,r.key)):re(19791,{wu:r})}function HD(t,e){const n=e.key,r=n.path.canonicalString();t.Ru.get(n)||t.Eu.has(r)||(q(aa,"New document in limbo: "+n),t.Eu.add(r),ky(t))}function ky(t){for(;t.Eu.size>0&&t.Ru.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new ee(Ae.fromString(e)),r=t.fu.next();t.Au.set(r,new VD(n)),t.Ru=t.Ru.insert(n,r),Nh(t.remoteStore,new fr(dn(fc(n.path)),r,"TargetPurposeLimboResolution",Qt.ce))}}async function Os(t,e,n){const r=ie(t),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const m=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))==null?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){s.push(d);const m=py.Es(c.targetId,d);i.push(m)}}))}),await Promise.all(o),r.Pu.J_(s),await async function(c,d){const h=ie(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>j.forEach(d,g=>j.forEach(g.Ts,x=>h.persistence.referenceDelegate.addReference(m,g.targetId,x)).next(()=>j.forEach(g.Is,x=>h.persistence.referenceDelegate.removeReference(m,g.targetId,x)))))}catch(m){if(!js(m))throw m;q(gy,"Failed to update sequence numbers: "+m)}for(const m of d){const g=m.targetId;if(!m.fromCache){const x=h.vs.get(g),A=x.snapshotVersion,C=x.withLastLimboFreeSnapshotVersion(A);h.vs=h.vs.insert(g,C)}}}(r.localStore,i))}async function GD(t,e){const n=ie(t);if(!n.currentUser.isEqual(e)){q(aa,"User change. New user:",e.toKey());const r=await eb(n.localStore,e);n.currentUser=e,function(i,o){i.mu.forEach(a=>{a.forEach(c=>{c.reject(new Q(z.CANCELLED,o))})}),i.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Os(n,r.Ns)}}function KD(t,e){const n=ie(t),r=n.Au.get(e);if(r&&r.hu)return ve().add(r.key);{let s=ve();const i=n.Iu.get(e);if(!i)return s;for(const o of i){const a=n.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}async function WD(t,e){const n=ie(t),r=await Rp(n.localStore,e.query,!0),s=e.view.cu(r);return n.isPrimaryClient&&Op(n,e.targetId,s.au),s}async function QD(t,e){const n=ie(t);return rb(n.localStore,e).then(r=>Os(n,r))}async function YD(t,e,n,r){const s=ie(t),i=await function(a,c){const d=ie(a),h=ie(d.mutationQueue);return d.persistence.runTransaction("Lookup mutation documents","readonly",m=>h.Xn(m,c).next(g=>g?d.localDocuments.getDocuments(m,g):j.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await ia(s.remoteStore):n==="acknowledged"||n==="rejected"?(Cy(s,e,r||null),Ny(s,e),function(a,c){ie(ie(a).mutationQueue).nr(c)}(s.localStore,e)):re(6720,"Unknown batchState",{bu:n}),await Os(s,i)):q(aa,"Cannot apply mutation batch with id: "+e)}async function JD(t,e){const n=ie(t);if(Ch(n),Ry(n),e===!0&&n.gu!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await Dx(n,r.toArray());n.gu=!0,await jp(n.remoteStore,!0);for(const i of s)Nh(n.remoteStore,i)}else if(e===!1&&n.gu!==!1){const r=[];let s=Promise.resolve();n.Iu.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Qo(n,o),Go(n.localStore,o,!0))),Ko(n.remoteStore,o)}),await s,await Dx(n,r),function(o){const a=ie(o);a.Au.forEach((c,d)=>{Ko(a.remoteStore,d)}),a.Vu.zr(),a.Au=new Map,a.Ru=new Fe(ee.comparator)}(n),n.gu=!1,await jp(n.remoteStore,!1)}}async function Dx(t,e,n){const r=ie(t),s=[],i=[];for(const o of e){let a;const c=r.Iu.get(o);if(c&&c.length!==0){a=await Cd(r.localStore,dn(c[0]));for(const d of c){const h=r.Tu.get(d),m=await WD(r,h);m.snapshot&&i.push(m.snapshot)}}else{const d=await nb(r.localStore,o);a=await Cd(r.localStore,d),await Ay(r,Eb(d),o,!1,a.resumeToken)}s.push(a)}return r.Pu.J_(i),s}function Eb(t){return sT(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function XD(t){return function(n){return ie(ie(n).persistence).hs()}(ie(t).localStore)}async function ZD(t,e,n,r){const s=ie(t);if(s.gu)return void q(aa,"Ignoring unexpected query state notification.");const i=s.Iu.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await rb(s.localStore,aT(i[0])),a=pc.createSynthesizedRemoteEventForCurrentChange(e,n==="current",rt.EMPTY_BYTE_STRING);await Os(s,o,a);break}case"rejected":await Go(s.localStore,e,!0),Qo(s,e,r);break;default:re(64155,n)}}async function ej(t,e,n){const r=Ch(t);if(r.gu){for(const s of e){if(r.Iu.has(s)&&r.sharedClientState.isActiveQueryTarget(s)){q(aa,"Adding an already active target "+s);continue}const i=await nb(r.localStore,s),o=await Cd(r.localStore,i);await Ay(r,Eb(i),o.targetId,!1,o.resumeToken),Nh(r.remoteStore,o)}for(const s of n)r.Iu.has(s)&&await Go(r.localStore,s,!1).then(()=>{Ko(r.remoteStore,s),Qo(r,s)}).catch(Ds)}}function Ch(t){const e=ie(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=xb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=BD.bind(null,e),e.Pu.J_=RD.bind(null,e.eventManager),e.Pu.yu=PD.bind(null,e.eventManager),e}function Ry(t){const e=ie(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=$D.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=qD.bind(null,e),e}class Zl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Sh(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return ZT(this.persistence,new XT,e.initialUser,this.serializer)}Cu(e){return new fy(bh.Vi,this.serializer)}Du(e){return new lb}async terminate(){var e,n;(e=this.gcScheduler)==null||e.stop(),(n=this.indexBackfillerScheduler)==null||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zl.provider={build:()=>new Zl};class Ib extends Zl{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){oe(this.persistence.referenceDelegate instanceof Nd,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new GT(r,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Rt.withCacheSize(this.cacheSizeBytes):Rt.DEFAULT;return new fy(r=>Nd.Vi(r,n),this.serializer)}}class Tb extends Zl{constructor(e,n,r){super(),this.xu=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await Ry(this.xu.syncEngine),await ia(this.xu.remoteStore),await this.persistence.zi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return ZT(this.persistence,new XT,e.initialUser,this.serializer)}Fu(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new GT(r,e.asyncQueue,n)}Mu(e,n){const r=new lP(n,this.persistence);return new aP(e.asyncQueue,r)}Cu(e){const n=JT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Rt.withCacheSize(this.cacheSizeBytes):Rt.DEFAULT;return new my(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,cb(),Vu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new lb}}class tj extends Tb{constructor(e,n){super(e,n,!1),this.xu=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.xu.syncEngine;this.sharedClientState instanceof Hf&&(this.sharedClientState.syncEngine={So:YD.bind(null,n),Do:ZD.bind(null,n),Co:ej.bind(null,n),hs:XD.bind(null,n),bo:QD.bind(null,n)},await this.sharedClientState.start()),await this.persistence.zi(async r=>{await JD(this.xu.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Du(e){const n=cb();if(!Hf.v(n))throw new Q(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=JT(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Hf(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Yo{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Px(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=GD.bind(null,this.syncEngine),await jp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new kD}()}createDatastore(e){const n=Sh(e.databaseInfo.databaseId),r=dD(e.databaseInfo);return gD(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,a){return new vD(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Px(this.syncEngine,n,0),function(){return Sx.v()?new Sx:new aD}())}createSyncEngine(e,n){return function(s,i,o,a,c,d,h){const m=new OD(s,i,o,a,c,d);return h&&(m.gu=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ie(s);q(bi,"RemoteStore shutting down."),i.Ea.add(5),await yc(i),i.Aa.shutdown(),i.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)==null||e.terminate(),(n=this.eventManager)==null||n.terminate()}}Yo.provider={build:()=>new Yo};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Py{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):nt("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="FirestoreClient";class nj{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this._databaseInfo=s,this.user=kt.UNAUTHENTICATED,this.clientId=Gg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{q(Cs,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(q(Cs,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new er;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Ey(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Kf(t,e){t.asyncQueue.verifyOperationInProgress(),q(Cs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await eb(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function jx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await rj(t);q(Cs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Nx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Nx(e.remoteStore,s)),t._onlineComponents=e}async function rj(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q(Cs,"Using user provided OfflineComponentProvider");try{await Kf(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===z.FAILED_PRECONDITION||s.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Ro("Error using user provided cache. Falling back to memory cache: "+n),await Kf(t,new Zl)}}else q(Cs,"Using default OfflineComponentProvider"),await Kf(t,new Ib(void 0));return t._offlineComponents}async function bb(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q(Cs,"Using user provided OnlineComponentProvider"),await jx(t,t._uninitializedComponentsProvider._online)):(q(Cs,"Using default OnlineComponentProvider"),await jx(t,new Yo))),t._onlineComponents}function sj(t){return bb(t).then(e=>e.syncEngine)}async function Dd(t){const e=await bb(t),n=e.eventManager;return n.onListen=MD.bind(null,e.syncEngine),n.onUnlisten=FD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=LD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=UD.bind(null,e.syncEngine),n}function ij(t,e,n,r){const s=new Py(r),i=new Sy(e,s,n);return t.asyncQueue.enqueueAndForget(async()=>Iy(await Dd(t),i)),()=>{s.Nu(),t.asyncQueue.enqueueAndForget(async()=>Ty(await Dd(t),i))}}function oj(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new Py({next:g=>{h.Nu(),o.enqueueAndForget(()=>Ty(i,m));const x=g.docs.has(a);!x&&g.fromCache?d.reject(new Q(z.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&g.fromCache&&c&&c.source==="server"?d.reject(new Q(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new Sy(fc(a.path),h,{includeMetadataChanges:!0,Ka:!0});return Iy(i,m)}(await Dd(t),t.asyncQueue,e,n,r)),r.promise}function aj(t,e,n={}){const r=new er;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,a,c,d){const h=new Py({next:g=>{h.Nu(),o.enqueueAndForget(()=>Ty(i,m)),g.fromCache&&c.source==="server"?d.reject(new Q(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(g)},error:g=>d.reject(g)}),m=new Sy(a,h,{includeMetadataChanges:!0,Ka:!0});return Iy(i,m)}(await Dd(t),t.asyncQueue,e,n,r)),r.promise}function lj(t,e){const n=new er;return t.asyncQueue.enqueueAndForget(async()=>zD(await sj(t),e,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sb(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cj="ComponentProvider",Vx=new Map;function uj(t,e,n,r,s){return new OP(t,e,n,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,Sb(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj="firestore.googleapis.com",Ox=!0;class Mx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Q(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dj,this.ssl=Ox}else this.host=e.host,this.ssl=e.ssl??Ox;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=zT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<HT)throw new Q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}sP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Sb(e.experimentalLongPollingOptions??{}),function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new Q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Dy{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Mx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Q(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Q(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Mx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new QR;switch(r.type){case"firstParty":return new XR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Q(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Vx.get(n);r&&(q(cj,"Removing Datastore"),Vx.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new jr(this.firestore,e,this._query)}}class Xe{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xe(this.firestore,e,this._key)}toJSON(){return{type:Xe._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(uc(n,Xe._jsonSchema))return new Xe(e,r||null,new ee(Ae.fromString(n.referencePath)))}}Xe._jsonSchemaVersion="firestore/documentReference/1.0",Xe._jsonSchema={type:at("string",Xe._jsonSchemaVersion),referencePath:at("string")};class xs extends jr{constructor(e,n,r){super(e,n,fc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xe(this.firestore,null,new ee(e))}withConverter(e){return new xs(this.firestore,e,this._path)}}function Le(t,e,...n){if(t=De(t),I1("collection","path",e),t instanceof Dy){const r=Ae.fromString(e,...n);return A0(r),new xs(t,null,r)}{if(!(t instanceof Xe||t instanceof xs))throw new Q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ae.fromString(e,...n));return A0(r),new xs(t.firestore,null,r)}}function ht(t,e,...n){if(t=De(t),arguments.length===1&&(e=Gg.newId()),I1("doc","path",e),t instanceof Dy){const r=Ae.fromString(e,...n);return S0(r),new Xe(t,null,new ee(r))}{if(!(t instanceof Xe||t instanceof xs))throw new Q(z.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Ae.fromString(e,...n));return S0(r),new Xe(t.firestore,t instanceof xs?t.converter:null,new ee(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lx="AsyncQueue";class Fx{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ub(this,"async_queue_retry"),this._c=()=>{const r=Vu();r&&q(Lx,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;const n=Vu();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Vu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const n=new er;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(this.Yu.length!==0){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!js(e))throw e;q(Lx,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const n=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,nt("INTERNAL UNHANDLED ERROR: ",Ux(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=n,n}enqueueAfterDelay(e,n,r){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const s=wy.createAndSchedule(this,e,n,r,i=>this.hc(i));return this.tc.push(s),s}uc(){this.nc&&re(47125,{Pc:Ux(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Ux(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Ar extends Dy{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new Fx,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Fx(e),this._firestoreClient=void 0,await e}}}function zx(t,e,n){n||(n=_d);const r=cc(t,"firestore");if(r.isInitialized(n)){const s=r.getImmediate({identifier:n}),i=r.getOptions(n);if(vi(i,e))return s;throw new Q(z.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Q(z.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<HT)throw new Q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return e.host&&ir(e.host)&&uh(e.host),r.initialize({options:e,instanceIdentifier:n})}function kh(t){if(t._terminated)throw new Q(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||hj(t),t._firestoreClient}function hj(t){var r,s,i,o;const e=t._freezeSettings(),n=uj(t._databaseId,((r=t._app)==null?void 0:r.options.appId)||"",t._persistenceKey,(s=t._app)==null?void 0:s.options.apiKey,e);t._componentsProvider||(i=e.localCache)!=null&&i._offlineComponentProvider&&((o=e.localCache)!=null&&o._onlineComponentProvider)&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new nj(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&function(c){const d=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _n(rt.fromBase64String(e))}catch(n){throw new Q(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new _n(rt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:_n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(uc(e,_n._jsonSchema))return _n.fromBase64String(e.bytes)}}_n._jsonSchemaVersion="firestore/bytes/1.0",_n._jsonSchema={type:at("string",_n._jsonSchemaVersion),bytes:at("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Q(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Q(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Q(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return fe(this._lat,e._lat)||fe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:tr._jsonSchemaVersion}}static fromJSON(e){if(uc(e,tr._jsonSchema))return new tr(e.latitude,e.longitude)}}tr._jsonSchemaVersion="firestore/geoPoint/1.0",tr._jsonSchema={type:at("string",tr._jsonSchemaVersion),latitude:at("number"),longitude:at("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}toJSON(){return{type:jn._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(uc(e,jn._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new jn(e.vectorValues);throw new Q(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}jn._jsonSchemaVersion="firestore/vectorValue/1.0",jn._jsonSchema={type:at("string",jn._jsonSchemaVersion),vectorValues:at("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=/^__.*__$/;class mj{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Dr(e,this.data,this.fieldMask,n,this.fieldTransforms):new sa(e,this.data,n,this.fieldTransforms)}}class Ab{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Dr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Nb(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw re(40011,{dataSource:t})}}class Vy{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.validatePath(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new Vy({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){var s;const n=(s=this.path)==null?void 0:s.child(e),r=this.contextWith({path:n,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return jd(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(e.length===0)throw this.createError("Document fields must not be empty");if(Nb(this.dataSource)&&fj.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class pj{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Sh(e)}createContext(e,n,r,s=!1){return new Vy({dataSource:e,methodName:n,targetDoc:r,path:Ge.emptyPath(),arrayElement:!1,hasConverter:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ph(t){const e=t._freezeSettings(),n=Sh(t._databaseId);return new pj(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Cb(t,e,n,r,s,i={}){const o=t.createContext(i.merge||i.mergeFields?2:0,e,n,s);My("Data must be an object, but it was:",o,r);const a=kb(r,o);let c,d;if(i.merge)c=new Yt(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const m of i.mergeFields){const g=Si(e,m,n);if(!o.contains(g))throw new Q(z.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Db(h,g)||h.push(g)}c=new Yt(h),d=o.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=o.fieldTransforms;return new mj(new Dt(a),c,d)}class Dh extends Rh{_toFieldTransform(e){if(e.dataSource!==2)throw e.dataSource===1?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Dh}}class Oy extends Rh{_toFieldTransform(e){return new yT(e.path,new Bo)}isEqual(e){return e instanceof Oy}}function gj(t,e,n,r){const s=t.createContext(1,e,n);My("Data must be an object, but it was:",s,r);const i=[],o=Dt.empty();Vs(r,(c,d)=>{const h=Pb(e,c,n);d=De(d);const m=s.childContextForFieldPath(h);if(d instanceof Dh)i.push(h);else{const g=vc(d,m);g!=null&&(i.push(h),o.set(h,g))}});const a=new Yt(i);return new Ab(o,a,s.fieldTransforms)}function yj(t,e,n,r,s,i){const o=t.createContext(1,e,n),a=[Si(e,r,n)],c=[s];if(i.length%2!=0)throw new Q(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<i.length;g+=2)a.push(Si(e,i[g])),c.push(i[g+1]);const d=[],h=Dt.empty();for(let g=a.length-1;g>=0;--g)if(!Db(d,a[g])){const x=a[g];let A=c[g];A=De(A);const C=o.childContextForFieldPath(x);if(A instanceof Dh)d.push(x);else{const R=vc(A,C);R!=null&&(d.push(x),h.set(x,R))}}const m=new Yt(d);return new Ab(h,m,o.fieldTransforms)}function vj(t,e,n,r=!1){return vc(n,t.createContext(r?4:3,e))}function vc(t,e){if(Rb(t=De(t)))return My("Unsupported field value:",e,t),kb(t,e);if(t instanceof Rh)return function(r,s){if(!Nb(s.dataSource))throw s.createError(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.createError(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.arrayElement&&e.dataSource!==4)throw e.createError("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let c=vc(a,s.childContextForArray(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=De(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return n2(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Ce.fromDate(r);return{timestampValue:Ho(s.serializer,i)}}if(r instanceof Ce){const i=new Ce(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ho(s.serializer,i)}}if(r instanceof tr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof _n)return{bytesValue:TT(s.serializer,r._byteString)};if(r instanceof Xe){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.createError(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:cy(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof jn)return function(o,a){const c=o instanceof jn?o.toArray():o;return{mapValue:{fields:{[ey]:{stringValue:ty},[Lo]:{arrayValue:{values:c.map(h=>{if(typeof h!="number")throw a.createError("VectorValues must only contain numeric values.");return sy(a.serializer,h)})}}}}}}(r,s);if(VT(r))return r._toProto(s.serializer);throw s.createError(`Unsupported field value: ${dh(r)}`)}(t,e)}function kb(t,e){const n={};return z1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Vs(t,(r,s)=>{const i=vc(s,e.childContextForField(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function Rb(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ce||t instanceof tr||t instanceof _n||t instanceof Xe||t instanceof Rh||t instanceof jn||VT(t))}function My(t,e,n){if(!Rb(n)||!T1(n)){const r=dh(n);throw r==="an object"?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Si(t,e,n){if((e=De(e))instanceof jy)return e._internalPath;if(typeof e=="string")return Pb(t,e);throw jd("Field path arguments must be of type string or ",t,!1,void 0,n)}const _j=new RegExp("[~\\*/\\[\\]]");function Pb(t,e,n){if(e.search(_j)>=0)throw jd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new jy(...e.split("."))._internalPath}catch{throw jd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function jd(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new Q(z.INVALID_ARGUMENT,a+t+c)}function Db(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xj{convertValue(e,n="none"){switch(Ss(e)){case 0:return null;case 1:return e.booleanValue;case 2:return $e(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Sr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw re(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Vs(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var r,s,i;const n=(i=(s=(r=e.fields)==null?void 0:r[Lo].arrayValue)==null?void 0:s.values)==null?void 0:i.map(o=>$e(o.doubleValue));return new jn(n)}convertGeoPoint(e){return new tr($e(e.latitude),$e(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=yh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Kl(e));default:return null}}convertTimestamp(e){const n=br(e);return new Ce(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Ae.fromString(e);oe(jT(r),9688,{name:e});const s=new xi(r.get(1),r.get(3)),i=new ee(r.popFirst(5));return s.isEqual(n)||nt(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ly extends xj{constructor(e){super(),this.firestore=e}convertBytes(e){return new _n(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Xe(this.firestore,null,n)}}function Oe(){return new Oy("serverTimestamp")}const Bx="@firebase/firestore",$x="4.11.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Xe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wj(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){var e;return((e=this._document)==null?void 0:e.data.clone().value.mapValue.fields)??void 0}get(e){if(this._document){const n=this._document.data.field(Si("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class wj extends jb{data(){return super.data()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vb(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Q(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fy{}class Uy extends Fy{}function Ot(t,e,...n){let r=[];e instanceof Fy&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof zy).length,a=i.filter(c=>c instanceof jh).length;if(o>1||o>0&&a>0)throw new Q(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class jh extends Uy{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new jh(e,n,r)}_apply(e){const n=this._parse(e);return Mb(e._query,n),new jr(e.firestore,e.converter,Ip(e._query,n))}_parse(e){const n=Ph(e.firestore);return function(i,o,a,c,d,h,m){let g;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new Q(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Gx(m,h);const A=[];for(const C of m)A.push(Hx(c,i,C));g={arrayValue:{values:A}}}else g=Hx(c,i,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Gx(m,h),g=vj(a,o,m,h==="in"||h==="not-in");return Ie.create(d,h,g)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ot(t,e,n){const r=e,s=Si("where",t);return jh._create(s,r,n)}class zy extends Fy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new zy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ke.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const c of a)Mb(o,c),o=Ip(o,c)}(e._query,n),new jr(e.firestore,e.converter,Ip(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class By extends Uy{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new By(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new Q(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new Q(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Jl(i,o)}(e._query,this._field,this._direction);return new jr(e.firestore,e.converter,YP(e._query,n))}}function Ob(t,e="asc"){const n=e,r=Si("orderBy",t);return By._create(r,n)}class $y extends Uy{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new $y(e,n,r)}_apply(e){return new jr(e.firestore,e.converter,Ed(e._query,this._limit,this._limitType))}}function Ej(t){return $y._create("limit",t,"F")}function Hx(t,e,n){if(typeof(n=De(n))=="string"){if(n==="")throw new Q(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!iT(e)&&n.indexOf("/")!==-1)throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Ae.fromString(n));if(!ee.isDocumentKey(r))throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ql(t,new ee(r))}if(n instanceof Xe)return Ql(t,n._key);throw new Q(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${dh(n)}.`)}function Gx(t,e){if(!Array.isArray(t)||t.length===0)throw new Q(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Mb(t,e){const n=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new Q(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Q(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function Lb(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class Ij{constructor(e){this.kind="memory",this._onlineComponentProvider=Yo.provider,this._offlineComponentProvider=e!=null&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new Ib(void 0)}}toJSON(){return{kind:this.kind}}}class Tj{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=Cj(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function bj(t){return new Ij(t)}function Sj(t){return new Tj(t)}class Aj{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Yo.provider,this._offlineComponentProvider={build:n=>new Tb(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class Nj{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Yo.provider,this._offlineComponentProvider={build:n=>new tj(n,e==null?void 0:e.cacheSizeBytes)}}}function Cj(t){return new Aj(t==null?void 0:t.forceOwnership)}function kj(){return new Nj}class Xa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class ui extends jb{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Ou(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Si("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=ui._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}ui._jsonSchemaVersion="firestore/documentSnapshot/1.0",ui._jsonSchema={type:at("string",ui._jsonSchemaVersion),bundleSource:at("string","DocumentSnapshot"),bundleName:at("string"),bundle:at("string")};class Ou extends ui{data(e={}){return super.data(e)}}class di{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Xa(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ou(this._firestore,this._userDataWriter,r.key,r,new Xa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Q(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const c=new Ou(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Xa(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const c=new Ou(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Xa(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:Rj(a.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Q(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=di._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Gg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],s=[];return this.docs.forEach(i=>{i._document!==null&&(n.push(i._document),r.push(this._userDataWriter.convertObjectMap(i._document.data.value.mapValue.fields,"previous")),s.push(i.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Rj(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return re(61501,{type:t})}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */di._jsonSchemaVersion="firestore/querySnapshot/1.0",di._jsonSchema={type:at("string",di._jsonSchemaVersion),bundleSource:at("string","QuerySnapshot"),bundleName:at("string"),bundle:at("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pj(t){t=un(t,Xe);const e=un(t.firestore,Ar),n=kh(e);return oj(n,t._key).then(r=>Fb(e,t,r))}function Mp(t){t=un(t,jr);const e=un(t.firestore,Ar),n=kh(e),r=new Ly(e);return Vb(t._query),aj(n,t._query).then(s=>new di(e,r,t,s))}function xl(t,e,n){t=un(t,Xe);const r=un(t.firestore,Ar),s=Lb(t.converter,e,n),i=Ph(r);return Oh(r,[Cb(i,"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,jt.none())])}function an(t,e,n,...r){t=un(t,Xe);const s=un(t.firestore,Ar),i=Ph(s);let o;return o=typeof(e=De(e))=="string"||e instanceof jy?yj(i,"updateDoc",t._key,e,n,r):gj(i,"updateDoc",t._key,e),Oh(s,[o.toMutation(t._key,jt.exists(!0))])}function Dj(t){return Oh(un(t.firestore,Ar),[new Eh(t._key,jt.none())])}function Vh(t,e){const n=un(t.firestore,Ar),r=ht(t),s=Lb(t.converter,e),i=Ph(t.firestore);return Oh(n,[Cb(i,"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,jt.exists(!1))]).then(()=>r)}function ft(t,...e){var d,h,m;t=De(t);let n={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||qx(e[r])||(n=e[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(qx(e[r])){const g=e[r];e[r]=(d=g.next)==null?void 0:d.bind(g),e[r+1]=(h=g.error)==null?void 0:h.bind(g),e[r+2]=(m=g.complete)==null?void 0:m.bind(g)}let i,o,a;if(t instanceof Xe)o=un(t.firestore,Ar),a=fc(t._key.path),i={next:g=>{e[r]&&e[r](Fb(o,t,g))},error:e[r+1],complete:e[r+2]};else{const g=un(t,jr);o=un(g.firestore,Ar),a=g._query;const x=new Ly(o);i={next:A=>{e[r]&&e[r](new di(o,x,g,A))},error:e[r+1],complete:e[r+2]},Vb(t._query)}const c=kh(o);return ij(c,a,s,i)}function Oh(t,e){const n=kh(t);return lj(n,e)}function Fb(t,e,n){const r=n.docs.get(e._key),s=new Ly(t);return new ui(t,s,e._key,r,new Xa(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){KR(Pi),bs(new Ir("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new Ar(new YR(r.getProvider("auth-internal")),new ZR(o,r.getProvider("app-check-internal")),MP(o,s),o);return i={useFetchStreams:n,...i},a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),In(Bx,$x,e),In(Bx,$x,"esm2020")})();let jj={data:""},Vj=t=>{if(typeof window=="object"){let e=(t?t.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return e.nonce=window.__nonce__,e.parentNode||(t||document.head).appendChild(e),e.firstChild}return t||jj},Oj=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Mj=/\/\*[^]*?\*\/|  +/g,Kx=/\n+/g,Zr=(t,e)=>{let n="",r="",s="";for(let i in t){let o=t[i];i[0]=="@"?i[1]=="i"?n=i+" "+o+";":r+=i[1]=="f"?Zr(o,i):i+"{"+Zr(o,i[1]=="k"?"":e)+"}":typeof o=="object"?r+=Zr(o,e?e.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):i):o!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Zr.p?Zr.p(i,o):i+":"+o+";")}return n+(e&&s?e+"{"+s+"}":s)+r},lr={},Ub=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+Ub(t[n]);return e}return t},Lj=(t,e,n,r,s)=>{let i=Ub(t),o=lr[i]||(lr[i]=(c=>{let d=0,h=11;for(;d<c.length;)h=101*h+c.charCodeAt(d++)>>>0;return"go"+h})(i));if(!lr[o]){let c=i!==t?t:(d=>{let h,m,g=[{}];for(;h=Oj.exec(d.replace(Mj,""));)h[4]?g.shift():h[3]?(m=h[3].replace(Kx," ").trim(),g.unshift(g[0][m]=g[0][m]||{})):g[0][h[1]]=h[2].replace(Kx," ").trim();return g[0]})(t);lr[o]=Zr(s?{["@keyframes "+o]:c}:c,n?"":"."+o)}let a=n&&lr.g?lr.g:null;return n&&(lr.g=lr[o]),((c,d,h,m)=>{m?d.data=d.data.replace(m,c):d.data.indexOf(c)===-1&&(d.data=h?c+d.data:d.data+c)})(lr[o],e,r,a),o},Fj=(t,e,n)=>t.reduce((r,s,i)=>{let o=e[i];if(o&&o.call){let a=o(n),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;o=c?"."+c:a&&typeof a=="object"?a.props?"":Zr(a,""):a===!1?"":a}return r+s+(o??"")},"");function Mh(t){let e=this||{},n=t.call?t(e.p):t;return Lj(n.unshift?n.raw?Fj(n,[].slice.call(arguments,1),e.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(e.p):s),{}):n,Vj(e.target),e.g,e.o,e.k)}let zb,Lp,Fp;Mh.bind({g:1});let Nr=Mh.bind({k:1});function Uj(t,e,n,r){Zr.p=e,zb=t,Lp=n,Fp=r}function Ms(t,e){let n=this||{};return function(){let r=arguments;function s(i,o){let a=Object.assign({},i),c=a.className||s.className;n.p=Object.assign({theme:Lp&&Lp()},a),n.o=/ *go\d+/.test(c),a.className=Mh.apply(n,r)+(c?" "+c:"");let d=t;return t[0]&&(d=a.as||t,delete a.as),Fp&&d[0]&&Fp(a),zb(d,a)}return s}}var zj=t=>typeof t=="function",Vd=(t,e)=>zj(t)?t(e):t,Bj=(()=>{let t=0;return()=>(++t).toString()})(),Bb=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),$j=20,qy="default",$b=(t,e)=>{let{toastLimit:n}=t.settings;switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,n)};case 1:return{...t,toasts:t.toasts.map(o=>o.id===e.toast.id?{...o,...e.toast}:o)};case 2:let{toast:r}=e;return $b(t,{type:t.toasts.find(o=>o.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=e;return{...t,toasts:t.toasts.map(o=>o.id===s||s===void 0?{...o,dismissed:!0,visible:!1}:o)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(o=>o.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let i=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(o=>({...o,pauseDuration:o.pauseDuration+i}))}}},Mu=[],qb={toasts:[],pausedAt:void 0,settings:{toastLimit:$j}},Yn={},Hb=(t,e=qy)=>{Yn[e]=$b(Yn[e]||qb,t),Mu.forEach(([n,r])=>{n===e&&r(Yn[e])})},Gb=t=>Object.keys(Yn).forEach(e=>Hb(t,e)),qj=t=>Object.keys(Yn).find(e=>Yn[e].toasts.some(n=>n.id===t)),Lh=(t=qy)=>e=>{Hb(e,t)},Hj={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Gj=(t={},e=qy)=>{let[n,r]=P.useState(Yn[e]||qb),s=P.useRef(Yn[e]);P.useEffect(()=>(s.current!==Yn[e]&&r(Yn[e]),Mu.push([e,r]),()=>{let o=Mu.findIndex(([a])=>a===e);o>-1&&Mu.splice(o,1)}),[e]);let i=n.toasts.map(o=>{var a,c,d;return{...t,...t[o.type],...o,removeDelay:o.removeDelay||((a=t[o.type])==null?void 0:a.removeDelay)||(t==null?void 0:t.removeDelay),duration:o.duration||((c=t[o.type])==null?void 0:c.duration)||(t==null?void 0:t.duration)||Hj[o.type],style:{...t.style,...(d=t[o.type])==null?void 0:d.style,...o.style}}});return{...n,toasts:i}},Kj=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:(n==null?void 0:n.id)||Bj()}),_c=t=>(e,n)=>{let r=Kj(e,t,n);return Lh(r.toasterId||qj(r.id))({type:2,toast:r}),r.id},ut=(t,e)=>_c("blank")(t,e);ut.error=_c("error");ut.success=_c("success");ut.loading=_c("loading");ut.custom=_c("custom");ut.dismiss=(t,e)=>{let n={type:3,toastId:t};e?Lh(e)(n):Gb(n)};ut.dismissAll=t=>ut.dismiss(void 0,t);ut.remove=(t,e)=>{let n={type:4,toastId:t};e?Lh(e)(n):Gb(n)};ut.removeAll=t=>ut.remove(void 0,t);ut.promise=(t,e,n)=>{let r=ut.loading(e.loading,{...n,...n==null?void 0:n.loading});return typeof t=="function"&&(t=t()),t.then(s=>{let i=e.success?Vd(e.success,s):void 0;return i?ut.success(i,{id:r,...n,...n==null?void 0:n.success}):ut.dismiss(r),s}).catch(s=>{let i=e.error?Vd(e.error,s):void 0;i?ut.error(i,{id:r,...n,...n==null?void 0:n.error}):ut.dismiss(r)}),t};var Wj=1e3,Qj=(t,e="default")=>{let{toasts:n,pausedAt:r}=Gj(t,e),s=P.useRef(new Map).current,i=P.useCallback((m,g=Wj)=>{if(s.has(m))return;let x=setTimeout(()=>{s.delete(m),o({type:4,toastId:m})},g);s.set(m,x)},[]);P.useEffect(()=>{if(r)return;let m=Date.now(),g=n.map(x=>{if(x.duration===1/0)return;let A=(x.duration||0)+x.pauseDuration-(m-x.createdAt);if(A<0){x.visible&&ut.dismiss(x.id);return}return setTimeout(()=>ut.dismiss(x.id,e),A)});return()=>{g.forEach(x=>x&&clearTimeout(x))}},[n,r,e]);let o=P.useCallback(Lh(e),[e]),a=P.useCallback(()=>{o({type:5,time:Date.now()})},[o]),c=P.useCallback((m,g)=>{o({type:1,toast:{id:m,height:g}})},[o]),d=P.useCallback(()=>{r&&o({type:6,time:Date.now()})},[r,o]),h=P.useCallback((m,g)=>{let{reverseOrder:x=!1,gutter:A=8,defaultPosition:C}=g||{},R=n.filter(T=>(T.position||C)===(m.position||C)&&T.height),I=R.findIndex(T=>T.id===m.id),v=R.filter((T,D)=>D<I&&T.visible).length;return R.filter(T=>T.visible).slice(...x?[v+1]:[0,v]).reduce((T,D)=>T+(D.height||0)+A,0)},[n]);return P.useEffect(()=>{n.forEach(m=>{if(m.dismissed)i(m.id,m.removeDelay);else{let g=s.get(m.id);g&&(clearTimeout(g),s.delete(m.id))}})},[n,i]),{toasts:n,handlers:{updateHeight:c,startPause:a,endPause:d,calculateOffset:h}}},Yj=Nr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Jj=Nr`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Xj=Nr`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Zj=Ms("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Yj} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Jj} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Xj} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,eV=Nr`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,tV=Ms("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${eV} 1s linear infinite;
`,nV=Nr`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,rV=Nr`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,sV=Ms("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${nV} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${rV} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,iV=Ms("div")`
  position: absolute;
`,oV=Ms("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,aV=Nr`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,lV=Ms("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${aV} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,cV=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?P.createElement(lV,null,e):e:n==="blank"?null:P.createElement(oV,null,P.createElement(tV,{...r}),n!=="loading"&&P.createElement(iV,null,n==="error"?P.createElement(Zj,{...r}):P.createElement(sV,{...r})))},uV=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,dV=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,hV="0%{opacity:0;} 100%{opacity:1;}",fV="0%{opacity:1;} 100%{opacity:0;}",mV=Ms("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,pV=Ms("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,gV=(t,e)=>{let n=t.includes("top")?1:-1,[r,s]=Bb()?[hV,fV]:[uV(n),dV(n)];return{animation:e?`${Nr(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Nr(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},yV=P.memo(({toast:t,position:e,style:n,children:r})=>{let s=t.height?gV(t.position||e||"top-center",t.visible):{opacity:0},i=P.createElement(cV,{toast:t}),o=P.createElement(pV,{...t.ariaProps},Vd(t.message,t));return P.createElement(mV,{className:t.className,style:{...s,...n,...t.style}},typeof r=="function"?r({icon:i,message:o}):P.createElement(P.Fragment,null,i,o))});Uj(P.createElement);var vV=({id:t,className:e,style:n,onHeightUpdate:r,children:s})=>{let i=P.useCallback(o=>{if(o){let a=()=>{let c=o.getBoundingClientRect().height;r(t,c)};a(),new MutationObserver(a).observe(o,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return P.createElement("div",{ref:i,className:e,style:n},s)},_V=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},s=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Bb()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...s}},xV=Mh`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,iu=16,wV=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:s,toasterId:i,containerStyle:o,containerClassName:a})=>{let{toasts:c,handlers:d}=Qj(n,i);return P.createElement("div",{"data-rht-toaster":i||"",style:{position:"fixed",zIndex:9999,top:iu,left:iu,right:iu,bottom:iu,pointerEvents:"none",...o},className:a,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(h=>{let m=h.position||e,g=d.calculateOffset(h,{reverseOrder:t,gutter:r,defaultPosition:e}),x=_V(m,g);return P.createElement(vV,{id:h.id,key:h.id,onHeightUpdate:d.updateHeight,className:h.visible?xV:"",style:x},h.type==="custom"?Vd(h.message,h):s?s(h):P.createElement(yV,{toast:h,position:m}))}))},ou=ut,EV="firebase",IV="12.9.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */In(EV,IV,"app");function Kb(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const TV=Kb,Wb=new ac("auth","Firebase",Kb());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Od=new Bg("@firebase/auth");function bV(t,...e){Od.logLevel<=Ee.WARN&&Od.warn(`Auth (${Pi}): ${t}`,...e)}function Lu(t,...e){Od.logLevel<=Ee.ERROR&&Od.error(`Auth (${Pi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function On(t,...e){throw Hy(t,...e)}function nr(t,...e){return Hy(t,...e)}function Qb(t,e,n){const r={...TV(),[e]:n};return new ac("auth","Firebase",r).create(e,{appName:t.name})}function yr(t){return Qb(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Wb.create(t,...e)}function he(t,e,...n){if(!t)throw Hy(e,...n)}function mr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Lu(e),new Error(e)}function Cr(t,e){t||mr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Up(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.href)||""}function SV(){return Wx()==="http:"||Wx()==="https:"}function Wx(){var t;return typeof self<"u"&&((t=self.location)==null?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AV(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(SV()||Nk()||"connection"in navigator)?navigator.onLine:!0}function NV(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Cr(n>e,"Short delay should be less than long delay!"),this.isMobile=Sk()||Ck()}get(){return AV()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gy(t,e){Cr(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yb{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;mr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;mr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;mr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CV={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kV=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],RV=new xc(3e4,6e4);function Vr(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function or(t,e,n,r,s={}){return Jb(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=lc({key:t.config.apiKey,...o}).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const d={method:e,headers:c,...i};return Ak()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&ir(t.emulatorConfig.host)&&(d.credentials="include"),Yb.fetch()(await Xb(t,t.config.apiHost,n,a),d)})}async function Jb(t,e,n){t._canInitEmulator=!1;const r={...CV,...e};try{const s=new DV(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw au(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw au(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw au(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw au(t,"user-disabled",o);const h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw Qb(t,h,d);On(t,h)}}catch(s){if(s instanceof Mn)throw s;On(t,"network-request-failed",{message:String(s)})}}async function wc(t,e,n,r,s={}){const i=await or(t,e,n,r,s);return"mfaPendingCredential"in i&&On(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function Xb(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?Gy(t.config,s):`${t.config.apiScheme}://${s}`;return kV.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function PV(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class DV{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(nr(this.auth,"network-request-failed")),RV.get())})}}function au(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=nr(t,e,r);return s.customData._tokenResponse=n,s}function Qx(t){return t!==void 0&&t.enterprise!==void 0}class jV{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return PV(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function VV(t,e){return or(t,"GET","/v2/recaptchaConfig",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OV(t,e){return or(t,"POST","/v1/accounts:delete",e)}async function Md(t,e){return or(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function MV(t,e=!1){const n=De(t),r=await n.getIdToken(e),s=Ky(r);he(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:wl(Wf(s.auth_time)),issuedAtTime:wl(Wf(s.iat)),expirationTime:wl(Wf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Wf(t){return Number(t)*1e3}function Ky(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Lu("JWT malformed, contained fewer than 3 sections"),null;try{const s=e1(n);return s?JSON.parse(s):(Lu("Failed to decode base64 JWT payload"),null)}catch(s){return Lu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Yx(t){const e=Ky(t);return he(e,"internal-error"),he(typeof e.exp<"u","internal-error"),he(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jo(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Mn&&LV(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function LV({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FV{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zp{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=wl(this.lastLoginAt),this.creationTime=wl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ld(t){var m;const e=t.auth,n=await t.getIdToken(),r=await Jo(t,Md(e,{idToken:n}));he(r==null?void 0:r.users.length,e,"internal-error");const s=r.users[0];t._notifyReloadListener(s);const i=(m=s.providerUserInfo)!=null&&m.length?Zb(s.providerUserInfo):[],o=zV(t.providerData,i),a=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(o!=null&&o.length),d=a?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new zp(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function UV(t){const e=De(t);await Ld(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function zV(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Zb(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BV(t,e){const n=await Jb(t,{},async()=>{const r=lc({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await Xb(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:r};return t.emulatorConfig&&ir(t.emulatorConfig.host)&&(c.credentials="include"),Yb.fetch()(o,c)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function $V(t,e){return or(t,"POST","/v2/accounts:revokeToken",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){he(e.idToken,"internal-error"),he(typeof e.idToken<"u","internal-error"),he(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){he(e.length!==0,"internal-error");const n=Yx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(he(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await BV(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new wo;return r&&(he(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(he(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(he(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new wo,this.toJSON())}_performRefresh(){return mr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kr(t,e){he(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Rn{constructor({uid:e,auth:n,stsTokenManager:r,...s}){this.providerId="firebase",this.proactiveRefresh=new FV(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new zp(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Jo(this,this.stsTokenManager.getToken(this.auth,e));return he(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return MV(this,e)}reload(){return UV(this)}_assign(e){this!==e&&(he(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Rn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){he(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ld(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Kt(this.auth.app))return Promise.reject(yr(this.auth));const e=await this.getIdToken();return await Jo(this,OV(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const r=n.displayName??void 0,s=n.email??void 0,i=n.phoneNumber??void 0,o=n.photoURL??void 0,a=n.tenantId??void 0,c=n._redirectEventId??void 0,d=n.createdAt??void 0,h=n.lastLoginAt??void 0,{uid:m,emailVerified:g,isAnonymous:x,providerData:A,stsTokenManager:C}=n;he(m&&C,e,"internal-error");const R=wo.fromJSON(this.name,C);he(typeof m=="string",e,"internal-error"),Kr(r,e.name),Kr(s,e.name),he(typeof g=="boolean",e,"internal-error"),he(typeof x=="boolean",e,"internal-error"),Kr(i,e.name),Kr(o,e.name),Kr(a,e.name),Kr(c,e.name),Kr(d,e.name),Kr(h,e.name);const I=new Rn({uid:m,auth:e,email:s,emailVerified:g,displayName:r,isAnonymous:x,photoURL:o,phoneNumber:i,tenantId:a,stsTokenManager:R,createdAt:d,lastLoginAt:h});return A&&Array.isArray(A)&&(I.providerData=A.map(v=>({...v}))),c&&(I._redirectEventId=c),I}static async _fromIdTokenResponse(e,n,r=!1){const s=new wo;s.updateFromServerResponse(n);const i=new Rn({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Ld(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];he(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Zb(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new wo;a.updateFromIdToken(r);const c=new Rn({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new zp(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,d),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jx=new Map;function pr(t){Cr(t instanceof Function,"Expected a class definition");let e=Jx.get(t);return e?(Cr(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Jx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}eS.type="NONE";const Xx=eS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t,e,n){return`firebase:${t}:${e}:${n}`}class Eo{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Fu(this.userKey,s.apiKey,i),this.fullPersistenceKey=Fu("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Md(this.auth,{idToken:e}).catch(()=>{});return n?Rn._fromGetAccountInfoResponse(this.auth,n,e):null}return Rn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Eo(pr(Xx),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||pr(Xx);const o=Fu(r,e.config.apiKey,e.name);let a=null;for(const d of n)try{const h=await d._get(o);if(h){let m;if(typeof h=="string"){const g=await Md(e,{idToken:h}).catch(()=>{});if(!g)break;m=await Rn._fromGetAccountInfoResponse(e,g,h)}else m=Rn._fromJSON(e,h);d!==i&&(a=m),i=d;break}}catch{}const c=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Eo(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Eo(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(sS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(tS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oS(e))return"Blackberry";if(aS(e))return"Webos";if(nS(e))return"Safari";if((e.includes("chrome/")||rS(e))&&!e.includes("edge/"))return"Chrome";if(iS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function tS(t=mt()){return/firefox\//i.test(t)}function nS(t=mt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function rS(t=mt()){return/crios\//i.test(t)}function sS(t=mt()){return/iemobile/i.test(t)}function iS(t=mt()){return/android/i.test(t)}function oS(t=mt()){return/blackberry/i.test(t)}function aS(t=mt()){return/webos/i.test(t)}function Wy(t=mt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function qV(t=mt()){var e;return Wy(t)&&!!((e=window.navigator)!=null&&e.standalone)}function HV(){return kk()&&document.documentMode===10}function lS(t=mt()){return Wy(t)||iS(t)||aS(t)||oS(t)||/windows phone/i.test(t)||sS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cS(t,e=[]){let n;switch(t){case"Browser":n=Zx(mt());break;case"Worker":n=`${Zx(mt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Pi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KV(t,e={}){return or(t,"GET","/v2/passwordPolicy",Vr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WV=6;class QV{constructor(e){var r;const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??WV,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=((r=e.allowedNonAlphanumericCharacters)==null?void 0:r.join(""))??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ew(this),this.idTokenSubscription=new ew(this),this.beforeStateQueue=new GV(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wb,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=pr(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Eo.create(this,e),(r=this._resolvePersistenceManagerAvailable)==null||r.call(this),!this._deleted)){if((s=this._popupRedirectResolver)!=null&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)==null?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Md(this,{idToken:e}),r=await Rn._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var i;if(Kt(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(i=this.redirectUser)==null?void 0:i._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return he(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ld(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=NV()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Kt(this.app))return Promise.reject(yr(this));const n=e?De(e):null;return n&&he(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&he(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Kt(this.app)?Promise.reject(yr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Kt(this.app)?Promise.reject(yr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(pr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await KV(this),n=new QV(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ac("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await $V(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)==null?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&pr(e)||this._popupRedirectResolver;he(n,this,"argument-error"),this.redirectPersistenceManager=await Eo.create(this,[pr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)==null?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)==null?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=((n=this.currentUser)==null?void 0:n.uid)??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(he(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return he(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=cS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var s;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await((s=this.heartbeatServiceProvider.getImmediate({optional:!0}))==null?void 0:s.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){var n;if(Kt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await((n=this.appCheckServiceProvider.getImmediate({optional:!0}))==null?void 0:n.getToken());return e!=null&&e.error&&bV(`Error while retrieving App Check token: ${e.error}`),e==null?void 0:e.token}}function Ls(t){return De(t)}class ew{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ok(n=>this.observer=n)}get next(){return he(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function JV(t){Fh=t}function uS(t){return Fh.loadJS(t)}function XV(){return Fh.recaptchaEnterpriseScript}function ZV(){return Fh.gapiScript}function eO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class tO{constructor(){this.enterprise=new nO}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class nO{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const rO="recaptcha-enterprise",dS="NO_RECAPTCHA";class sO{constructor(e){this.type=rO,this.auth=Ls(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{VV(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const d=new jV(c);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;Qx(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(dS)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new tO().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&Qx(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=XV();c.length!==0&&(c+=a),uS(c).then(()=>{s(a,i,o)}).catch(d=>{o(d)})}}).catch(a=>{o(a)})})}}async function tw(t,e,n,r=!1,s=!1){const i=new sO(t);let o;if(s)o=dS;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const a={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in a){const c=a.phoneEnrollmentInfo.phoneNumber,d=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const c=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Fd(t,e,n,r,s){var i;if((i=t._getRecaptchaConfig())!=null&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await tw(t,e,n,n==="getOobCode");return r(t,o)}else return r(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await tw(t,e,n,n==="getOobCode");return r(t,a)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iO(t,e){const n=cc(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(vi(i,e??{}))return s;On(s,"already-initialized")}return n.initialize({options:e})}function oO(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(pr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function aO(t,e,n){const r=Ls(t);he(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=hS(e),{host:o,port:a}=lO(e),c=a===null?"":`:${a}`,d={url:`${i}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){he(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),he(vi(d,r.config.emulator)&&vi(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,ir(o)?(uh(`${i}//${o}${c}`),zg("Auth",!0)):cO()}function hS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function lO(t){const e=hS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:nw(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:nw(o)}}}function nw(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function cO(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return mr("not implemented")}_getIdTokenResponse(e){return mr("not implemented")}_linkToIdToken(e,n){return mr("not implemented")}_getReauthenticationResolver(e){return mr("not implemented")}}async function uO(t,e){return or(t,"POST","/v1/accounts:update",e)}async function dO(t,e){return or(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hO(t,e){return wc(t,"POST","/v1/accounts:signInWithPassword",Vr(t,e))}async function fO(t,e){return or(t,"POST","/v1/accounts:sendOobCode",Vr(t,e))}async function mO(t,e){return fO(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pO(t,e){return wc(t,"POST","/v1/accounts:signInWithEmailLink",Vr(t,e))}async function gO(t,e){return wc(t,"POST","/v1/accounts:signInWithEmailLink",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec extends Qy{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new ec(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new ec(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Fd(e,n,"signInWithPassword",hO);case"emailLink":return pO(e,{email:this._email,oobCode:this._password});default:On(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Fd(e,r,"signUpPassword",dO);case"emailLink":return gO(e,{idToken:n,email:this._email,oobCode:this._password});default:On(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Io(t,e){return wc(t,"POST","/v1/accounts:signInWithIdp",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yO="http://localhost";class Ai extends Qy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ai(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):On("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,...i}=n;if(!r||!s)return null;const o=new Ai(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Io(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Io(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Io(e,n)}buildRequest(){const e={requestUri:yO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=lc(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _O(t){const e=Ga(Ka(t)).link,n=e?Ga(Ka(e)).deep_link_id:null,r=Ga(Ka(t)).deep_link_id;return(r?Ga(Ka(r)).link:null)||r||n||e||t}class Yy{constructor(e){const n=Ga(Ka(e)),r=n.apiKey??null,s=n.oobCode??null,i=vO(n.mode??null);he(r&&s&&i,"argument-error"),this.apiKey=r,this.operation=i,this.code=s,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=_O(e);try{return new Yy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(){this.providerId=ji.PROVIDER_ID}static credential(e,n){return ec._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Yy.parseLink(n);return he(r,"argument-error"),ec._fromEmailAndCode(e,r.code,r.tenantId)}}ji.PROVIDER_ID="password";ji.EMAIL_PASSWORD_SIGN_IN_METHOD="password";ji.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec extends fS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class es extends Ec{constructor(){super("facebook.com")}static credential(e){return Ai._fromParams({providerId:es.PROVIDER_ID,signInMethod:es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return es.credentialFromTaggedObject(e)}static credentialFromError(e){return es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return es.credential(e.oauthAccessToken)}catch{return null}}}es.FACEBOOK_SIGN_IN_METHOD="facebook.com";es.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends Ec{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ai._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return ts.credential(n,r)}catch{return null}}}ts.GOOGLE_SIGN_IN_METHOD="google.com";ts.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends Ec{constructor(){super("github.com")}static credential(e){return Ai._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ns.credential(e.oauthAccessToken)}catch{return null}}}ns.GITHUB_SIGN_IN_METHOD="github.com";ns.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends Ec{constructor(){super("twitter.com")}static credential(e,n){return Ai._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return rs.credential(n,r)}catch{return null}}}rs.TWITTER_SIGN_IN_METHOD="twitter.com";rs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xO(t,e){return wc(t,"POST","/v1/accounts:signUp",Vr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Rn._fromIdTokenResponse(e,r,s),o=rw(r);return new Ni({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=rw(r);return new Ni({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function rw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud extends Mn{constructor(e,n,r,s){super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Ud.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Ud(e,n,r,s)}}function mS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Ud._fromErrorAndOperation(t,i,e,r):i})}async function wO(t,e,n=!1){const r=await Jo(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Ni._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pS(t,e,n=!1){const{auth:r}=t;if(Kt(r.app))return Promise.reject(yr(r));const s="reauthenticate";try{const i=await Jo(t,mS(r,s,e,t),n);he(i.idToken,r,"internal-error");const o=Ky(i.idToken);he(o,r,"internal-error");const{sub:a}=o;return he(t.uid===a,r,"user-mismatch"),Ni._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&On(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gS(t,e,n=!1){if(Kt(t.app))return Promise.reject(yr(t));const r="signIn",s=await mS(t,r,e),i=await Ni._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function EO(t,e){return gS(Ls(t),e)}async function IO(t,e){return pS(De(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yS(t){const e=Ls(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function vS(t,e,n){const r=Ls(t);await Fd(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",mO)}async function TO(t,e,n){if(Kt(t.app))return Promise.reject(yr(t));const r=Ls(t),o=await Fd(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",xO).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&yS(t),c}),a=await Ni._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function bO(t,e,n){return Kt(t.app)?Promise.reject(yr(t)):EO(De(t),ji.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&yS(t),r})}function SO(t,e){return AO(De(t),null,e)}async function AO(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};n&&(i.password=n);const o=await Jo(t,uO(r,i));await t._updateTokensIfNecessary(o,!0)}function NO(t,e,n,r){return De(t).onIdTokenChanged(e,n,r)}function CO(t,e,n){return De(t).beforeAuthStateChanged(e,n)}function kO(t,e,n,r){return De(t).onAuthStateChanged(e,n,r)}function RO(t){return De(t).signOut()}const zd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(zd,"1"),this.storage.removeItem(zd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PO=1e3,DO=10;class xS extends _S{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=lS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);HV()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,DO):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},PO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}xS.type="LOCAL";const jO=xS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wS extends _S{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}wS.type="SESSION";const ES=wS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VO(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Uh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async d=>d(n.origin,i)),c=await VO(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Uh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const d=Jy("",20);s.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(m){const g=m;if(g.data.eventId===d)switch(g.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(g.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(){return window}function MO(t){rr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IS(){return typeof rr().WorkerGlobalScope<"u"&&typeof rr().importScripts=="function"}async function LO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function FO(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)==null?void 0:t.controller)||null}function UO(){return IS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS="firebaseLocalStorageDb",zO=1,Bd="firebaseLocalStorage",bS="fbase_key";class Ic{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function zh(t,e){return t.transaction([Bd],e?"readwrite":"readonly").objectStore(Bd)}function BO(){const t=indexedDB.deleteDatabase(TS);return new Ic(t).toPromise()}function Bp(){const t=indexedDB.open(TS,zO);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Bd,{keyPath:bS})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Bd)?e(r):(r.close(),await BO(),e(await Bp()))})})}async function sw(t,e,n){const r=zh(t,!0).put({[bS]:e,value:n});return new Ic(r).toPromise()}async function $O(t,e){const n=zh(t,!1).get(e),r=await new Ic(n).toPromise();return r===void 0?null:r.value}function iw(t,e){const n=zh(t,!0).delete(e);return new Ic(n).toPromise()}const qO=800,HO=3;class SS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bp(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>HO)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return IS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Uh._getInstance(UO()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var n,r;if(this.activeServiceWorker=await LO(),!this.activeServiceWorker)return;this.sender=new OO(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&(n=e[0])!=null&&n.fulfilled&&(r=e[0])!=null&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||FO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bp();return await sw(e,zd,"1"),await iw(e,zd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>sw(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>$O(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>iw(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=zh(s,!1).getAll();return new Ic(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),qO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}SS.type="LOCAL";const GO=SS;new xc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(t,e){return e?pr(e):(he(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xy extends Qy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Io(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Io(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Io(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function WO(t){return gS(t.auth,new Xy(t),t.bypassAuthState)}function QO(t){const{auth:e,user:n}=t;return he(n,e,"internal-error"),pS(n,new Xy(t),t.bypassAuthState)}async function YO(t){const{auth:e,user:n}=t;return he(n,e,"internal-error"),wO(n,new Xy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AS{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return WO;case"linkViaPopup":case"linkViaRedirect":return YO;case"reauthViaPopup":case"reauthViaRedirect":return QO;default:On(this.auth,"internal-error")}}resolve(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JO=new xc(2e3,1e4);class ho extends AS{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ho.currentPopupAction&&ho.currentPopupAction.cancel(),ho.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return he(e,this.auth,"internal-error"),e}async onExecution(){Cr(this.filter.length===1,"Popup operations only handle one event");const e=Jy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(nr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)==null?void 0:e.associatedEvent)||null}cancel(){this.reject(nr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ho.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if((r=(n=this.authWindow)==null?void 0:n.window)!=null&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,JO.get())};e()}}ho.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO="pendingRedirect",Uu=new Map;class ZO extends AS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Uu.get(this.auth._key());if(!e){try{const r=await e4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Uu.set(this.auth._key(),e)}return this.bypassAuthState||Uu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function e4(t,e){const n=r4(e),r=n4(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function t4(t,e){Uu.set(t._key(),e)}function n4(t){return pr(t._redirectPersistence)}function r4(t){return Fu(XO,t.config.apiKey,t.name)}async function s4(t,e,n=!1){if(Kt(t.app))return Promise.reject(yr(t));const r=Ls(t),s=KO(r,e),o=await new ZO(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i4=10*60*1e3;class o4{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!a4(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!NS(e)){const s=((r=e.error.code)==null?void 0:r.split("auth/")[1])||"internal-error";n.onError(nr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=i4&&this.cachedEventUids.clear(),this.cachedEventUids.has(ow(e))}saveEventToCache(e){this.cachedEventUids.add(ow(e)),this.lastProcessedEventTime=Date.now()}}function ow(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function NS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function a4(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return NS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function l4(t,e={}){return or(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,u4=/^https?/;async function d4(t){if(t.config.emulator)return;const{authorizedDomains:e}=await l4(t);for(const n of e)try{if(h4(n))return}catch{}On(t,"unauthorized-domain")}function h4(t){const e=Up(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!u4.test(n))return!1;if(c4.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f4=new xc(3e4,6e4);function aw(){const t=rr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function m4(t){return new Promise((e,n)=>{var s,i,o;function r(){aw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{aw(),n(nr(t,"network-request-failed"))},timeout:f4.get()})}if((i=(s=rr().gapi)==null?void 0:s.iframes)!=null&&i.Iframe)e(gapi.iframes.getContext());else if((o=rr().gapi)!=null&&o.load)r();else{const a=eO("iframefcb");return rr()[a]=()=>{gapi.load?r():n(nr(t,"network-request-failed"))},uS(`${ZV()}?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw zu=null,e})}let zu=null;function p4(t){return zu=zu||m4(t),zu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g4=new xc(5e3,15e3),y4="__/auth/iframe",v4="emulator/auth/iframe",_4={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},x4=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function w4(t){const e=t.config;he(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Gy(e,v4):`https://${t.config.authDomain}/${y4}`,r={apiKey:e.apiKey,appName:t.name,v:Pi},s=x4.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${lc(r).slice(1)}`}async function E4(t){const e=await p4(t),n=rr().gapi;return he(n,t,"internal-error"),e.open({where:document.body,url:w4(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:_4,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=nr(t,"network-request-failed"),a=rr().setTimeout(()=>{i(o)},g4.get());function c(){rr().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},T4=500,b4=600,S4="_blank",A4="http://localhost";class lw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function N4(t,e,n,r=T4,s=b4){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...I4,width:r.toString(),height:s.toString(),top:i,left:o},d=mt().toLowerCase();n&&(a=rS(d)?S4:n),tS(d)&&(e=e||A4,c.scrollbars="yes");const h=Object.entries(c).reduce((g,[x,A])=>`${g}${x}=${A},`,"");if(qV(d)&&a!=="_self")return C4(e||"",a),new lw(null);const m=window.open(e||"",a,h);he(m,t,"popup-blocked");try{m.focus()}catch{}return new lw(m)}function C4(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k4="__/auth/handler",R4="emulator/auth/handler",P4=encodeURIComponent("fac");async function cw(t,e,n,r,s,i){he(t.config.authDomain,t,"auth-domain-config-required"),he(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Pi,eventId:s};if(e instanceof fS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Vk(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,m]of Object.entries({}))o[h]=m}if(e instanceof Ec){const h=e.getScopes().filter(m=>m!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const c=await t._getAppCheckToken(),d=c?`#${P4}=${encodeURIComponent(c)}`:"";return`${D4(t)}?${lc(a).slice(1)}${d}`}function D4({config:t}){return t.emulator?Gy(t,R4):`https://${t.authDomain}/${k4}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qf="webStorageSupport";class j4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ES,this._completeRedirectFn=s4,this._overrideRedirectResult=t4}async _openPopup(e,n,r,s){var o;Cr((o=this.eventManagers[e._key()])==null?void 0:o.manager,"_initialize() not called before _openPopup()");const i=await cw(e,n,r,Up(),s);return N4(e,i,Jy())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await cw(e,n,r,Up(),s);return MO(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Cr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await E4(e),r=new o4(e);return n.register("authEvent",s=>(he(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Qf,{type:Qf},s=>{var o;const i=(o=s==null?void 0:s[0])==null?void 0:o[Qf];i!==void 0&&n(!!i),On(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=d4(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return lS()||nS()||Wy()}}const V4=j4;var uw="@firebase/auth",dw="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)==null?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){he(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function L4(t){bs(new Ir("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;he(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:cS(t)},d=new YV(r,s,i,c);return oO(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),bs(new Ir("auth-internal",e=>{const n=Ls(e.getProvider("auth").getImmediate());return(r=>new O4(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),In(uw,dw,M4(t)),In(uw,dw,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4=5*60,U4=i1("authIdTokenMaxAge")||F4;let hw=null;const z4=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>U4)return;const s=n==null?void 0:n.token;hw!==s&&(hw=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function B4(t=qg()){const e=cc(t,"auth");if(e.isInitialized())return e.getImmediate();const n=iO(t,{popupRedirectResolver:V4,persistence:[GO,jO,ES]}),r=i1("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=z4(i.toString());CO(n,o,()=>o(n.currentUser)),NO(n,a=>o(a))}}const s=n1("auth");return s&&aO(n,`http://${s}`),n}function $4(){var t;return((t=document.getElementsByTagName("head"))==null?void 0:t[0])??document}JV({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=nr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",$4().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});L4("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q4="type.googleapis.com/google.protobuf.Int64Value",H4="type.googleapis.com/google.protobuf.UInt64Value";function CS(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function $d(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>$d(e));if(typeof t=="function"||typeof t=="object")return CS(t,e=>$d(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Xo(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case q4:case H4:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Xo(e)):typeof t=="function"||typeof t=="object"?CS(t,e=>Xo(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zy="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fw={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Jt extends Mn{constructor(e,n,r){super(`${Zy}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,Jt.prototype)}}function G4(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function qd(t,e){let n=G4(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!fw[o])return new Jt("internal","internal");n=fw[o],r=o}const a=i.message;typeof a=="string"&&(r=a),s=i.details,s!==void 0&&(s=Xo(s))}}catch{}return n==="ok"?null:new Jt(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Kt(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $p="us-central1",W4=/^data: (.*?)(?:\n|$)/;function Q4(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new Jt("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class Y4{constructor(e,n,r,s,i=$p,o=(...a)=>fetch(...a)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new K4(e,n,r,s),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin+(a.pathname==="/"?"":a.pathname),this.region=$p}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function J4(t,e,n){const r=ir(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(uh(t.emulatorOrigin+"/backends"),zg("Functions",!0))}function X4(t,e,n){const r=s=>eM(t,e,s,{});return r.stream=(s,i)=>nM(t,e,s,i),r}function kS(t){return t.emulatorOrigin&&ir(t.emulatorOrigin)?"include":void 0}async function Z4(t,e,n,r,s){n["Content-Type"]="application/json";let i;try{i=await r(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:kS(s)})}catch{return{status:0,json:null}}let o=null;try{o=await i.json()}catch{}return{status:i.status,json:o}}async function RS(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function eM(t,e,n,r){const s=t._url(e);return tM(t,s,n,r)}async function tM(t,e,n,r){n=$d(n);const s={data:n},i=await RS(t,r),o=r.timeout||7e4,a=Q4(o),c=await Promise.race([Z4(e,s,i,t.fetchImpl,t),a.promise,t.cancelAllRequests]);if(a.cancel(),!c)throw new Jt("cancelled","Firebase Functions instance was deleted.");const d=qd(c.status,c.json);if(d)throw d;if(!c.json)throw new Jt("internal","Response is not valid JSON object.");let h=c.json.data;if(typeof h>"u"&&(h=c.json.result),typeof h>"u")throw new Jt("internal","Response is missing data field.");return{data:Xo(h)}}function nM(t,e,n,r){const s=t._url(e);return rM(t,s,n,r||{})}async function rM(t,e,n,r){var g;n=$d(n);const s={data:n},i=await RS(t,r);i["Content-Type"]="application/json",i.Accept="text/event-stream";let o;try{o=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:i,signal:r==null?void 0:r.signal,credentials:kS(t)})}catch(x){if(x instanceof Error&&x.name==="AbortError"){const C=new Jt("cancelled","Request was cancelled.");return{data:Promise.reject(C),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(C)}}}}}}const A=qd(0,null);return{data:Promise.reject(A),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(A)}}}}}}let a,c;const d=new Promise((x,A)=>{a=x,c=A});(g=r==null?void 0:r.signal)==null||g.addEventListener("abort",()=>{const x=new Jt("cancelled","Request was cancelled.");c(x)});const h=o.body.getReader(),m=sM(h,a,c,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const x=m.getReader();return{async next(){const{value:A,done:C}=await x.read();return{value:A,done:C}},async return(){return await x.cancel(),{done:!0,value:void 0}}}}},data:d}}function sM(t,e,n,r){const s=(o,a)=>{const c=o.match(W4);if(!c)return;const d=c[1];try{const h=JSON.parse(d);if("result"in h){e(Xo(h.result));return}if("message"in h){a.enqueue(Xo(h.message));return}if("error"in h){const m=qd(0,h);a.error(m),n(m);return}}catch(h){if(h instanceof Jt){a.error(h),n(h);return}}},i=new TextDecoder;return new ReadableStream({start(o){let a="";return c();async function c(){if(r!=null&&r.aborted){const d=new Jt("cancelled","Request was cancelled");return o.error(d),n(d),Promise.resolve()}try{const{value:d,done:h}=await t.read();if(h){a.trim()&&s(a.trim(),o),o.close();return}if(r!=null&&r.aborted){const g=new Jt("cancelled","Request was cancelled");o.error(g),n(g),await t.cancel();return}a+=i.decode(d,{stream:!0});const m=a.split(`
`);a=m.pop()||"";for(const g of m)g.trim()&&s(g.trim(),o);return c()}catch(d){const h=d instanceof Jt?d:qd(0,null);o.error(h),n(h)}}},cancel(){return t.cancel()}})}const mw="@firebase/functions",pw="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iM="auth-internal",oM="app-check-internal",aM="messaging-internal";function lM(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(iM),o=n.getProvider(aM),a=n.getProvider(oM);return new Y4(s,i,o,a,r)};bs(new Ir(Zy,e,"PUBLIC").setMultipleInstances(!0)),In(mw,pw,t),In(mw,pw,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(t=qg(),e=$p){const r=cc(De(t),Zy).getImmediate({identifier:e}),s=r1("functions");return s&&uM(r,...s),r}function uM(t,e,n){J4(De(t),e,n)}function PS(t,e,n){return X4(De(t),e)}lM();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS="firebasestorage.googleapis.com",jS="storageBucket",dM=2*60*1e3,hM=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et extends Mn{constructor(e,n,r=0){super(Yf(e),`Firebase Storage: ${n} (${Yf(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,et.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Yf(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ze;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ze||(Ze={}));function Yf(t){return"storage/"+t}function ev(){const t="An unknown error occurred, please check the error payload for server response.";return new et(Ze.UNKNOWN,t)}function fM(t){return new et(Ze.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function mM(t){return new et(Ze.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function pM(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new et(Ze.UNAUTHENTICATED,t)}function gM(){return new et(Ze.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function yM(t){return new et(Ze.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function vM(){return new et(Ze.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function _M(){return new et(Ze.CANCELED,"User canceled the upload/download.")}function xM(t){return new et(Ze.INVALID_URL,"Invalid URL '"+t+"'.")}function wM(t){return new et(Ze.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function EM(){return new et(Ze.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+jS+"' property when initializing the app?")}function IM(){return new et(Ze.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function TM(){return new et(Ze.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function bM(t){return new et(Ze.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function qp(t){return new et(Ze.INVALID_ARGUMENT,t)}function VS(){return new et(Ze.APP_DELETED,"The Firebase app was deleted.")}function SM(t){return new et(Ze.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function El(t,e){return new et(Ze.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function La(t){throw new et(Ze.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ln.makeFromUrl(e,n)}catch{return new ln(e,"")}if(r.path==="")return r;throw wM(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function d(D){D.path_=decodeURIComponent(D.path)}const h="v[A-Za-z0-9_]+",m=n.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",x=new RegExp(`^https?://${m}/${h}/b/${s}/o${g}`,"i"),A={bucket:1,path:3},C=n===DS?"(?:storage.googleapis.com|storage.cloud.google.com)":n,R="([^?#]*)",I=new RegExp(`^https?://${C}/${s}/${R}`,"i"),T=[{regex:a,indices:c,postModify:i},{regex:x,indices:A,postModify:d},{regex:I,indices:{bucket:1,path:2},postModify:d}];for(let D=0;D<T.length;D++){const O=T[D],U=O.regex.exec(e);if(U){const E=U[O.indices.bucket];let y=U[O.indices.path];y||(y=""),r=new ln(E,y),O.postModify(r);break}}if(r==null)throw xM(e);return r}}class AM{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NM(t,e,n){let r=1,s=null,i=null,o=!1,a=0;function c(){return a===2}let d=!1;function h(...R){d||(d=!0,e.apply(null,R))}function m(R){s=setTimeout(()=>{s=null,t(x,c())},R)}function g(){i&&clearTimeout(i)}function x(R,...I){if(d){g();return}if(R){g(),h.call(null,R,...I);return}if(c()||o){g(),h.call(null,R,...I);return}r<64&&(r*=2);let T;a===1?(a=2,T=0):T=(r+Math.random())*1e3,m(T)}let A=!1;function C(R){A||(A=!0,g(),!d&&(s!==null?(R||(a=2),clearTimeout(s),m(0)):R||(a=1)))}return m(0),i=setTimeout(()=>{o=!0,C(!0)},n),C}function CM(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kM(t){return t!==void 0}function RM(t){return typeof t=="object"&&!Array.isArray(t)}function tv(t){return typeof t=="string"||t instanceof String}function gw(t){return nv()&&t instanceof Blob}function nv(){return typeof Blob<"u"}function yw(t,e,n,r){if(r<e)throw qp(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw qp(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bh(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function OS(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var hi;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(hi||(hi={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PM(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e,n,r,s,i,o,a,c,d,h,m,g=!0,x=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=m,this.retry=g,this.isUsingEmulator=x,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((A,C)=>{this.resolve_=A,this.reject_=C,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new lu(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,d=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===hi.NO_ERROR,c=i.getStatus();if(!a||PM(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===hi.ABORT;r(!1,new lu(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new lu(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());kM(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=ev();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(s.canceled){const c=this.appDelete_?VS():_M();o(c)}else{const c=vM();o(c)}};this.canceled_?n(!1,new lu(!1,null,!0)):this.backoffId_=NM(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&CM(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class lu{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function jM(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function VM(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OM(t,e){e&&(t["X-Firebase-GMPID"]=e)}function MM(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function LM(t,e,n,r,s,i,o=!0,a=!1){const c=OS(t.urlParams),d=t.url+c,h=Object.assign({},t.headers);return OM(h,e),jM(h,n),VM(h,i),MM(h,r),new DM(d,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FM(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function UM(...t){const e=FM();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(nv())return new Blob(t);throw new et(Ze.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function zM(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BM(t){if(typeof atob>"u")throw bM("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Jf{constructor(e,n){this.data=e,this.contentType=n||null}}function $M(t,e){switch(t){case Jn.RAW:return new Jf(MS(e));case Jn.BASE64:case Jn.BASE64URL:return new Jf(LS(t,e));case Jn.DATA_URL:return new Jf(HM(e),GM(e))}throw ev()}function MS(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function qM(t){let e;try{e=decodeURIComponent(t)}catch{throw El(Jn.DATA_URL,"Malformed data URL.")}return MS(e)}function LS(t,e){switch(t){case Jn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw El(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Jn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw El(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=BM(e)}catch(s){throw s.message.includes("polyfill")?s:El(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class FS{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw El(Jn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=KM(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function HM(t){const e=new FS(t);return e.base64?LS(Jn.BASE64,e.rest):qM(e.rest)}function GM(t){return new FS(t).contentType}function KM(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss{constructor(e,n){let r=0,s="";gw(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(gw(this.data_)){const r=this.data_,s=zM(r,e,n);return s===null?null:new ss(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ss(r,!0)}}static getBlob(...e){if(nv()){const n=e.map(r=>r instanceof ss?r.data_:r);return new ss(UM.apply(null,n))}else{const n=e.map(o=>tv(o)?$M(Jn.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new ss(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(t){let e;try{e=JSON.parse(t)}catch{return null}return RM(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WM(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function QM(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function zS(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YM(t,e){return e}class Ut{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||YM}}let cu=null;function JM(t){return!tv(t)||t.length<2?t:zS(t)}function BS(){if(cu)return cu;const t=[];t.push(new Ut("bucket")),t.push(new Ut("generation")),t.push(new Ut("metageneration")),t.push(new Ut("name","fullPath",!0));function e(i,o){return JM(o)}const n=new Ut("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Ut("size");return s.xform=r,t.push(s),t.push(new Ut("timeCreated")),t.push(new Ut("updated")),t.push(new Ut("md5Hash",null,!0)),t.push(new Ut("cacheControl",null,!0)),t.push(new Ut("contentDisposition",null,!0)),t.push(new Ut("contentEncoding",null,!0)),t.push(new Ut("contentLanguage",null,!0)),t.push(new Ut("contentType",null,!0)),t.push(new Ut("metadata","customMetadata",!0)),cu=t,cu}function XM(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new ln(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function ZM(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return XM(r,t),r}function $S(t,e,n){const r=US(e);return r===null?null:ZM(t,r,n)}function eL(t,e,n,r){const s=US(e);if(s===null||!tv(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,m=t.fullPath,g="/b/"+o(h)+"/o/"+o(m),x=Bh(g,n,r),A=OS({alt:"media",token:d});return x+A})[0]}function tL(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class rv{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(t){if(!t)throw ev()}function nL(t,e){function n(r,s){const i=$S(t,s,e);return qS(i!==null),i}return n}function rL(t,e){function n(r,s){const i=$S(t,s,e);return qS(i!==null),eL(i,s,t.host,t._protocol)}return n}function HS(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=gM():s=pM():n.getStatus()===402?s=mM(t.bucket):n.getStatus()===403?s=yM(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function GS(t){const e=HS(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=fM(t.path)),i.serverResponse=s.serverResponse,i}return n}function sL(t,e,n){const r=e.fullServerUrl(),s=Bh(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new rv(s,i,rL(t,n),o);return a.errorHandler=GS(e),a}function iL(t,e){const n=e.fullServerUrl(),r=Bh(n,t.host,t._protocol),s="DELETE",i=t.maxOperationRetryTime;function o(c,d){}const a=new rv(r,s,o,i);return a.successCodes=[200,204],a.errorHandler=GS(e),a}function oL(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function aL(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=oL(null,e)),r}function lL(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let T="";for(let D=0;D<2;D++)T=T+Math.random().toString().slice(2);return T}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const d=aL(e,r,s),h=tL(d,n),m="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,g=`\r
--`+c+"--",x=ss.getBlob(m,r,g);if(x===null)throw IM();const A={name:d.fullPath},C=Bh(i,t.host,t._protocol),R="POST",I=t.maxUploadRetryTime,v=new rv(C,R,nL(t,n),I);return v.urlParams=A,v.headers=o,v.body=x.uploadData(),v.errorHandler=HS(e),v}class cL{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=hi.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=hi.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=hi.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw La("cannot .send() more than once");if(ir(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw La("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw La("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw La("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw La("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class uL extends cL{initXhr(){this.xhr_.responseType="text"}}function sv(){return new uL}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ci{constructor(e,n){this._service=e,n instanceof ln?this._location=n:this._location=ln.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ci(e,n)}get root(){const e=new ln(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return zS(this._location.path)}get storage(){return this._service}get parent(){const e=WM(this._location.path);if(e===null)return null;const n=new ln(this._location.bucket,e);return new Ci(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw SM(e)}}function dL(t,e,n){t._throwIfRoot("uploadBytes");const r=lL(t.storage,t._location,BS(),new ss(e,!0),n);return t.storage.makeRequestWithTokens(r,sv).then(s=>({metadata:s,ref:t}))}function hL(t){t._throwIfRoot("getDownloadURL");const e=sL(t.storage,t._location,BS());return t.storage.makeRequestWithTokens(e,sv).then(n=>{if(n===null)throw TM();return n})}function fL(t){t._throwIfRoot("deleteObject");const e=iL(t.storage,t._location);return t.storage.makeRequestWithTokens(e,sv)}function mL(t,e){const n=QM(t._location.path,e),r=new ln(t._location.bucket,n);return new Ci(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(t){return/^[A-Za-z]+:\/\//.test(t)}function gL(t,e){return new Ci(t,e)}function KS(t,e){if(t instanceof iv){const n=t;if(n._bucket==null)throw EM();const r=new Ci(n,n._bucket);return e!=null?KS(r,e):r}else return e!==void 0?mL(t,e):t}function yL(t,e){if(e&&pL(e)){if(t instanceof iv)return gL(t,e);throw qp("To use ref(service, url), the first argument must be a Storage instance.")}else return KS(t,e)}function vw(t,e){const n=e==null?void 0:e[jS];return n==null?null:ln.makeFromBucketSpec(n,t)}function vL(t,e,n,r={}){t.host=`${e}:${n}`;const s=ir(e);s&&(uh(`https://${t.host}/b`),zg("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Ik(i,t.app.options.projectId))}class iv{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=DS,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=dM,this._maxUploadRetryTime=hM,this._requests=new Set,s!=null?this._bucket=ln.makeFromBucketSpec(s,this._host):this._bucket=vw(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ln.makeFromBucketSpec(this._url,e):this._bucket=vw(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){yw("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){yw("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Kt(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ci(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new AM(VS());{const o=LM(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const _w="@firebase/storage",xw="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WS="storage";function _L(t,e,n){return t=De(t),dL(t,e,n)}function xL(t){return t=De(t),hL(t)}function ww(t){return t=De(t),fL(t)}function Xf(t,e){return t=De(t),yL(t,e)}function wL(t=qg(),e){t=De(t);const r=cc(t,WS).getImmediate({identifier:e}),s=r1("storage");return s&&EL(r,...s),r}function EL(t,e,n,r={}){vL(t,e,n,r)}function IL(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new iv(n,r,s,e,Pi)}function TL(){bs(new Ir(WS,IL,"PUBLIC").setMultipleInstances(!0)),In(_w,xw,""),In(_w,xw,"esm2020")}TL();const QS={apiKey:"AIzaSyBqe7srBIViRiHmZlIQzMywDhiop5q7OXI",authDomain:"colegio-verdy.firebaseapp.com",projectId:"colegio-verdy",storageBucket:"colegio-verdy.firebasestorage.app",messagingSenderId:"602481785882",appId:"1:602481785882:web:0f873bf9968992e5af65a3"},Ew=Object.entries(QS).filter(([,t])=>!t).map(([t])=>t),Za=Ew.length?`Configurao Firebase incompleta. Defina: ${Ew.join(", ")}.`:null;function bL(t){if(!t)return null;try{return zx(t,{localCache:Sj({tabManager:kj()})})}catch{return zx(t,{localCache:bj()})}}const kr=Za?null:h1(QS),It=kr?B4(kr):null,J=bL(kr),YS=kr?cM(kr):null,Fa=kr?wL(kr):null,SL=["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],AL=["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],NL={Administrativos:"bg-primary",Acadmicos:"bg-blue-500",Feriado:"bg-red-400",Recesso:"bg-amber-500"},CL=t=>NL[t]||"bg-slate-500",kL=t=>(t||"").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim(),ov=({embedded:t=!1})=>{const[e,n]=P.useState(new Date),[r,s]=P.useState(null),[i,o]=P.useState([]),[a,c]=P.useState(!0),[d,h]=P.useState(!1);P.useEffect(()=>{if(!J)return c(!1),()=>{};const D=ft(Le(J,"events"),O=>{const U=O.docs.map(E=>{const y=E.data();return{id:E.id,title:y.titulo||"Sem ttulo",date:y.data||"",time:y.diaTodo?"Dia todo":y.horario||"",location:y.local||"Local no informado",type:y.tipo||"Administrativos",color:CL(y.tipo),description:kL(y.descricao||""),diaTodo:!!y.diaTodo}}).sort((E,y)=>{const S=`${E.date||""} ${E.time||""}`,N=`${y.date||""} ${y.time||""}`;return S.localeCompare(N)});o(U),c(!1)},()=>{o([]),c(!1)});return()=>D()},[]);const m=P.useMemo(()=>i.reduce((D,O)=>(O.date&&(D[O.date]||(D[O.date]=[]),D[O.date].push(O)),D),{}),[i]),g=r?m[r]||[]:[],x=new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),A=new Date(e.getFullYear(),e.getMonth(),1).getDay(),C=()=>n(new Date(e.getFullYear(),e.getMonth()-1,1)),R=()=>n(new Date(e.getFullYear(),e.getMonth()+1,1)),I=D=>{s(D),h(!0)},v=()=>{const D=[],O=new Date().toISOString().split("T")[0];for(let U=0;U<A;U++)D.push(u.jsx("div",{className:"h-10 lg:h-24 bg-slate-50/50 rounded-xl border border-transparent"},`empty-${U}`));for(let U=1;U<=x;U++){const E=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(U).padStart(2,"0")}`,y=m[E]||[],S=E===O,N=r===E;D.push(u.jsxs("div",{onClick:()=>I(E),className:`relative h-12 lg:h-24 p-1 lg:p-2 rounded-xl border transition-all cursor-pointer flex flex-col items-center lg:items-start ${N?"border-primary ring-2 ring-primary/20 bg-primary/5":"border-slate-100 hover:border-primary/40 bg-white shadow-sm"}`,children:[u.jsx("span",{className:`text-[13px] lg:text-sm font-semibold w-7 h-7 flex items-center justify-center rounded-full ${S?"bg-primary text-white":"text-slate-700"}`,children:U}),u.jsx("div",{className:"flex lg:hidden gap-1 mt-1",children:y.slice(0,3).map(w=>u.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${w.color}`},w.id))}),u.jsxs("div",{className:"hidden lg:flex flex-col gap-1 mt-1 w-full overflow-hidden",children:[y.slice(0,2).map(w=>u.jsxs("div",{className:`text-[10px] text-white font-medium px-1.5 py-0.5 rounded truncate ${w.color}`,children:[w.diaTodo?"Dia todo":w.time," - ",w.title]},w.id)),y.length>2&&u.jsxs("div",{className:"text-[10px] text-slate-500 font-medium px-1",children:["+ ",y.length-2," mais"]})]})]},U))}return D},T=r?r.split("-").reverse().join("/"):"";return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`${t?"w-full":"max-w-7xl mx-auto h-full"}`,children:u.jsxs("div",{className:"flex flex-col bg-white rounded-2xl border border-slate-200 shadow-sm p-4 lg:p-6 h-fit shrink-0",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsxs("h2",{className:"text-xl lg:text-2xl font-bold text-slate-800 flex items-center gap-3",children:[u.jsx(sp,{className:"text-primary hidden sm:block",size:24}),SL[e.getMonth()]," ",e.getFullYear()]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:C,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-600 transition-colors",children:u.jsx(KI,{size:20})}),u.jsx("button",{onClick:R,className:"w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-100 text-slate-600 transition-colors",children:u.jsx(ah,{size:20})})]})]}),u.jsx("div",{className:"grid grid-cols-7 gap-2 mb-2 lg:mb-4",children:AL.map(D=>u.jsx("div",{className:"text-center text-[11px] lg:text-xs font-bold text-slate-400 uppercase tracking-wider",children:D},D))}),u.jsx("div",{className:"grid grid-cols-7 gap-1 lg:gap-2",children:v()}),a&&u.jsx("div",{className:"text-sm text-slate-500 mt-3",children:"Carregando eventos..."})]})}),d&&u.jsxs("div",{className:"fixed inset-0 z-50 flex items-end sm:items-center justify-center",children:[u.jsx("button",{className:"absolute inset-0 bg-slate-900/45",onClick:()=>h(!1),"aria-label":"Fechar modal"}),u.jsxs("div",{className:"relative w-full sm:max-w-2xl max-h-[85vh] bg-white rounded-t-2xl sm:rounded-2xl border border-slate-200 shadow-xl p-4 sm:p-5 overflow-hidden",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("h3",{className:"text-lg font-bold text-slate-800",children:["Eventos de ",T]}),u.jsx("button",{onClick:()=>h(!1),className:"w-9 h-9 rounded-lg border border-slate-200 text-slate-500 hover:bg-slate-50 inline-flex items-center justify-center",children:u.jsx(Er,{size:16})})]}),u.jsx("div",{className:"overflow-y-auto max-h-[68vh] flex flex-col gap-3 pr-1",children:g.length===0?u.jsx("div",{className:"text-sm text-slate-500 bg-slate-50 rounded-xl border border-slate-100 p-4",children:"Nenhum evento cadastrado para este dia."}):g.map(D=>u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white p-3 relative overflow-hidden",children:[u.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1 ${D.color}`}),u.jsxs("div",{className:"pl-2",children:[u.jsxs("div",{className:"flex items-center justify-between gap-3 mb-1",children:[u.jsx("h4",{className:"font-semibold text-slate-800",children:D.title}),u.jsx("span",{className:`text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide text-white ${D.color}`,children:D.type})]}),D.description&&u.jsx("p",{className:"text-sm text-slate-500 mb-2",children:D.description}),u.jsxs("div",{className:"flex flex-col gap-1.5",children:[u.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-600",children:[u.jsx(Ug,{size:14,className:"text-slate-400"})," ",D.time||"Horrio no informado"]}),u.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-600",children:[u.jsx(ak,{size:14,className:"text-slate-400"})," ",D.location]})]})]})]},D.id))})]})]})]})},Iw=()=>u.jsx(ov,{}),Tw=({onOpenTurma:t,turmas:e=[],studentsStatus:n={},carregando:r=!1})=>u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("h2",{className:"text-2xl lg:text-3xl font-bold text-slate-800 mb-4",children:["Minhas Turmas ",e.length>0?`(${e.length})`:""]}),r?u.jsx("p",{className:"text-slate-500",children:"Carregando turmas..."}):e.length>0?u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.map(s=>{const i=Object.values(n).filter(c=>c.turmaId===s.id),o=i.length,a=i.filter(c=>c.status==="sent"||c.status==="absent").length;return u.jsxs("div",{onClick:()=>t(s),className:"p-4 rounded-lg border-2 border-slate-200 hover:border-primary/50 bg-white cursor-pointer transition-all hover:shadow-md",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h3",{className:"font-semibold text-slate-800",children:s.nome}),u.jsx(ah,{size:18,className:"text-slate-400"})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("p",{className:"text-sm text-slate-600",children:s.periodo}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("div",{className:"flex items-center justify-between text-xs",children:[u.jsx("span",{className:"text-slate-600",children:"Cadernetas preenchidas"}),u.jsxs("span",{className:"font-semibold text-primary",children:[a,"/",o]})]}),u.jsx("div",{className:"w-full bg-slate-200 rounded-full h-2",children:u.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:`${o>0?a/o*100:0}%`}})})]})]})]},s.id)})}):u.jsx("p",{className:"text-slate-500",children:"Nenhuma turma atribuda"})]}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-slate-800 mb-4",children:"Calendrio Escolar"}),u.jsx(ov,{embedded:!0})]})]}),RL=({turma:t,onBack:e,onOpenStudent:n,studentsStatus:r})=>{const[s,i]=P.useState(""),a=Object.values(r).filter(d=>d.turmaId===t.id).filter(d=>d.name.toLowerCase().includes(s.toLowerCase())),c=d=>{switch(d){case"sent":return{icon:tk,color:"text-primary",bg:"bg-primary/10",label:"Enviado"};case"draft":return{icon:Ug,color:"text-accent",bg:"bg-accent/10",label:"Pendente (Rascunho)"};case"absent":return{icon:hd,color:"text-red-500",bg:"bg-red-50",label:"Faltou"};default:return{icon:rk,color:"text-slate-300",bg:"bg-slate-50",label:"No iniciado"}}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto h-full",children:[u.jsxs("div",{className:"flex items-center gap-4 mb-2 lg:mb-6 flex-wrap",children:[u.jsx("button",{onClick:e,className:"w-10 h-10 rounded-full bg-white border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary hover:border-primary transition-all shadow-sm shrink-0",children:u.jsx(Fg,{size:20})}),u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-slate-800 truncate",children:"Dirio de Classe"}),u.jsxs("p",{className:"text-sm font-medium text-primary mt-1",children:[t.nome," (",t.periodo,")"]})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 pl-3.5 flex items-center pointer-events-none",children:u.jsx(dk,{size:18,className:"text-slate-400"})}),u.jsx("input",{type:"text",placeholder:"Buscar aluno na turma...",className:"form-control !pl-10 !py-3 bg-white shadow-sm border-transparent",value:s,onChange:d=>i(d.target.value)})]}),u.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden flex-1 flex flex-col",children:[u.jsxs("div",{className:"bg-slate-50 px-6 py-3 border-b border-slate-200 flex justify-between items-center text-xs font-semibold text-slate-500 uppercase tracking-wider",children:[u.jsxs("span",{children:[a.length," Alunos"]}),u.jsx("span",{children:"Status de Envio"})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto divide-y divide-slate-100",children:[a.map(d=>{const h=c(d.status),m=h.icon;return u.jsxs("div",{onClick:()=>n(d.id),className:"flex items-center justify-between p-4 px-6 hover:bg-slate-50 cursor-pointer transition-colors group",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-200 shrink-0 relative",children:u.jsx("img",{src:d.avatar,alt:d.name,className:`w-full h-full rounded-full object-cover ${d.status==="absent"?"grayscale opacity-60":""}`})}),u.jsxs("div",{children:[u.jsx("h4",{className:`font-semibold text-[15px] ${d.status==="absent"?"text-slate-500 line-through":"text-slate-800"}`,children:d.name}),u.jsx("span",{className:"text-xs text-slate-400",children:"Ver dirio"})]})]}),u.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg ${h.bg}`,children:[u.jsx(m,{size:16,className:h.color}),u.jsx("span",{className:`text-xs font-semibold ${h.color}`,children:h.label})]})]},d.id)}),a.length===0&&u.jsxs("div",{className:"p-10 flex flex-col items-center justify-center text-slate-400 text-center",children:[u.jsx(hd,{size:48,className:"mb-4 text-slate-300"}),"Nenhum aluno encontrado correspondente  busca."]})]})]})]})},uu=({options:t,active:e,onChange:n})=>u.jsx("div",{className:"flex bg-slate-100/50 p-0.5 rounded-xl w-full",children:t.map(r=>u.jsx("button",{className:`segment-btn ${e===r?"active":""}`,onClick:()=>n(r),children:r},r))}),bw={meals:{"Lanche Manh":null,Almoo:null,"Lanche Tarde":null,Jantar:null},rest:{"Sono Manh":null,"Sono Tarde":null},activities:{Manh:null,Tarde:null},evacuation:{Manh:null,Tarde:null},obs:""},PL=({student:t,turma:e,onBack:n,onUpdateStatus:r})=>{const[s,i]=P.useState(bw),[o,a]=P.useState(!1),[c,d]=P.useState(!1),[h,m]=P.useState(!0),g=()=>new Date().toISOString().split("T")[0];P.useEffect(()=>{(async()=>{try{if(!J||!t.id){m(!1);return}const I=g(),v=Ot(Le(J,"cadernetaEntries"),ot("studentId","==",t.id),ot("date","==",I)),T=await Mp(v);if(!T.empty){const D=T.docs[0].data();i(D.data||bw),a(D.isAbsent||!1)}m(!1)}catch(I){console.error("Erro ao carregar caderneta:",I),m(!1)}})()},[t.id]);const x=(R,I,v)=>{if(o)return;const T={...s,[R]:{...s[R],[I]:v}};R==="obs"&&(T.obs=v),i(T),t.status!=="sent"&&r("draft")},A=()=>{o?(a(!1),r("pending")):(a(!0),r("absent"))},C=async()=>{try{if(d(!0),!J){ou.error("Erro de conexo. Tente novamente."),d(!1);return}const R=g(),I={studentId:t.id,studentName:t.name,turmaId:e.id,turmaName:e.nome,date:R,data:s,isAbsent:o,status:o?"absent":"sent",createdAt:Oe(),updatedAt:Oe()},v=Ot(Le(J,"cadernetaEntries"),ot("studentId","==",t.id),ot("date","==",R)),T=await Mp(v);if(T.empty)await Vh(Le(J,"cadernetaEntries"),I);else{const D=T.docs[0].id;await xl(ht(J,"cadernetaEntries",D),{...I,createdAt:T.docs[0].data().createdAt})}o?ou.success(`Falta de ${t.name} registrada!`):ou.success(`Caderneta de ${t.name} enviada!`),r(o?"absent":"sent"),d(!1),n()}catch(R){console.error("Erro ao salvar caderneta:",R),ou.error("Erro ao salvar. Tente novamente."),d(!1)}};return u.jsxs("div",{className:"flex flex-col gap-0 max-w-4xl mx-auto",children:[u.jsxs("div",{className:`flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4 mb-2 lg:mb-6 glass-panel !p-4 transition-colors ${o?"bg-red-50/80 border-red-200":""}`,children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary transition-colors bg-white",children:u.jsx(Fg,{size:20})}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"w-12 h-12 rounded-full p-0.5 bg-slate-200",children:u.jsx("img",{src:t.avatar,alt:"Avatar",className:`w-full h-full rounded-full object-cover ${o?"grayscale":""}`})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-widest",children:e==null?void 0:e.nome}),u.jsx("div",{className:`font-bold text-lg ${o?"text-red-700 line-through":"text-slate-800"}`,children:t.name})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:A,className:`px-4 py-2.5 rounded-xl font-semibold text-sm transition-all flex items-center gap-1.5 ${o?"bg-red-500 text-white shadow-md":"bg-red-50 text-red-500 hover:bg-red-100"}`,children:[u.jsx(hd,{size:18})," ",o?"Marcado como Falta":"Indicar Falta"]}),u.jsxs("button",{className:`btn-primary px-5 py-2.5 ${c?"opacity-50 pointer-events-none":""}`,onClick:C,disabled:c,children:[u.jsx(hk,{size:18})," ",o?"Confirmar Falta":"Enviar"]})]})]}),u.jsxs("div",{className:`grid grid-cols-1 lg:grid-cols-2 gap-6 transition-opacity duration-300 ${o?"opacity-30 pointer-events-none":"opacity-100"}`,children:[u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(WI,{className:"text-primary",size:20})," Refeies"]}),u.jsx("div",{className:"flex flex-col gap-3",children:Object.keys(s.meals).map(R=>u.jsxs("div",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:R}),u.jsx("div",{className:"w-full lg:w-[320px]",children:u.jsx(uu,{options:["Total","Suficiente","Insuficiente","Recusou"],active:s.meals[R],onChange:I=>x("meals",R,I)})})]},R))})]}),u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(YI,{className:"text-primary",size:20})," Descanso"]}),u.jsx("div",{className:"flex flex-col gap-3",children:Object.keys(s.rest).map(R=>u.jsxs("div",{className:"flex flex-col lg:flex-row justify-between lg:items-center gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:R}),u.jsx("div",{className:"w-full lg:w-[180px]",children:u.jsx(uu,{options:["Sim","No"],active:s.rest[R],onChange:I=>x("rest",R,I)})})]},R))})]}),u.jsxs("div",{className:"glass-panel lg:col-span-full flex flex-col lg:flex-row gap-8 lg:gap-12",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(HI,{className:"text-primary",size:20})," Atividades"]}),u.jsx("div",{className:"flex flex-col gap-3",children:["Manh","Tarde"].map(R=>u.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:R}),u.jsx(uu,{options:["Ativa","Parcial","Sem Participao"],active:s.activities[R],onChange:I=>x("activities",R,I)})]},R))})]}),u.jsx("div",{className:"hidden lg:block w-px bg-slate-200"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(GI,{className:"text-primary",size:20})," Evacuao"]}),u.jsx("div",{className:"flex flex-col gap-3",children:["Manh","Tarde"].map(R=>u.jsxs("div",{className:"flex flex-col justify-between gap-3",children:[u.jsx("span",{className:"font-medium text-slate-700 text-sm",children:R}),u.jsx(uu,{options:["Normal","Alterado","No houve"],active:s.evacuation[R],onChange:I=>x("evacuation",R,I)})]},R))})]})]}),u.jsxs("div",{className:"glass-panel lg:col-span-full",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(ip,{className:"text-primary",size:20})," Observaes e Recados"]}),u.jsx("textarea",{className:"form-control min-h-[120px] resize-none",placeholder:`Escreva notas importantes sobre o dia de ${t==null?void 0:t.name.split(" ")[0]}...`,value:s.obs,onChange:R=>x("obs",null,R.target.value)})]})]})]})},Sw=[{id:"1",type:"broadcast",name:"Comunicados Gerais",role:"Escola",lastMessage:"Lembrando que amanh no haver aula na educao infantil.",time:"14:30",unread:0},{id:"2",type:"direct",name:"Me do Joo Pedro",role:"Famlia",lastMessage:"Ele est melhor da gripe, amanh ir.",time:"10:15",unread:2},{id:"3",type:"direct",name:"Pai do Lucas T.",role:"Famlia",lastMessage:"Hoje a av vai buscar o Lucas s 17h, ok?",time:"Ontem",unread:0},{id:"4",type:"direct",name:"Me da Maria Clara",role:"Famlia",lastMessage:"Obrigada pelo cuidado de sempre!",time:"Segunda",unread:0}],Aw=()=>{const[t,e]=P.useState(Sw[1]),[n,r]=P.useState("all"),[s,i]=P.useState("");return Sw.filter(o=>n==="all"?!0:o.type===n),u.jsx("div",{className:"flex h-[calc(100vh-140px)] lg:h-[calc(100vh-160px)] gap-0 lg:gap-6 antialiased -mx-4 lg:mx-0",children:u.jsx("div",{className:"w-full flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:u.jsx(QI,{size:32,className:"text-slate-400"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Mensagens"}),u.jsx("p",{className:"text-slate-500",children:"Esta funcionalidade est em desenvolvimento."}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Em breve voc poder se comunicar diretamente com pais, professore e direo."})]})})})},JS=P.createContext(),$h=()=>P.useContext(JS),Nw=new Set(["teacher","parent","admin"]),Ua=t=>((t||"").split("@")[0]||"Usuario").replace(/[._-]+/g," ").trim()||"Usuario",du=t=>`https://ui-avatars.com/api/?name=${encodeURIComponent(t||"Usuario")}&background=e2e8f0&color=0f172a`,DL=({children:t})=>{const[e,n]=P.useState(null),[r,s]=P.useState(null),[i,o]=P.useState(null),[a,c]=P.useState(!0);P.useEffect(()=>It?kO(It,async A=>{if(A)try{const C=ht(J,"users",A.uid),R=await Pj(C);if(R.exists()){const I=R.data(),v=I.role,T=I.nome||Ua(A.email||I.email||""),D={uid:A.uid,email:I.email||A.email||null,role:Nw.has(v)?v:"parent",nome:T,telefone:I.telefone||"",disciplina:I.disciplina||"",avatarUrl:I.avatarUrl||du(T)};I.avatarUrl||await xl(C,{avatarUrl:D.avatarUrl,updatedAt:Oe()},{merge:!0}),o(D),s(Nw.has(v)?v:"parent")}else{const I=Ua(A.email||""),v={uid:A.uid,email:A.email??null,role:"parent",nome:I,telefone:"",disciplina:"",avatarUrl:du(I)};await xl(C,{...v,createdAt:Oe(),updatedAt:Oe()}),o(v),s("parent")}}catch(C){console.log("Erro ao buscar role, backend no configurado ok. "+C),o({uid:A.uid,email:A.email||null,role:"parent",nome:Ua(A.email||""),telefone:"",disciplina:"",avatarUrl:du(Ua(A.email||""))}),s("parent")}else o(null),s(null);n(A),c(!1)}):(c(!1),()=>{}),[]);const g={currentUser:e,userRole:r,userProfile:i,login:(x,A)=>It?bO(It,x,A):Promise.reject({code:"auth/configuration-not-found",message:Za}),register:async(x,A)=>{if(!It)return Promise.reject({code:"auth/configuration-not-found",message:Za});if(!J)return Promise.reject({code:"auth/configuration-not-found",message:Za});const C=await TO(It,x,A),R=Ua(C.user.email??x);return await xl(ht(J,"users",C.user.uid),{uid:C.user.uid,email:C.user.email??x,role:"parent",nome:R,avatarUrl:du(R),createdAt:Oe(),updatedAt:Oe()}),C},logout:()=>It?RO(It):Promise.resolve(),authError:Za};return u.jsx(JS.Provider,{value:g,children:!a&&t})},jL=()=>{const[t,e]=P.useState(!0),[n,r]=P.useState(""),[s,i]=P.useState(""),[o,a]=P.useState(""),[c,d]=P.useState(!1),{login:h,register:m,authError:g}=$h(),x=async A=>{A.preventDefault();try{a(""),d(!0),t?await h(n,s):await m(n,s)}catch(C){console.error(C),C.code==="auth/user-not-found"||C.code==="auth/invalid-credential"?a("E-mail ou senha invlidos. Verifique se voc j tem cadastro."):C.code==="auth/email-already-in-use"?a("Este e-mail j est cadastrado no sistema."):C.code==="auth/weak-password"?a("A senha deve ter pelo menos 6 caracteres."):C.code==="auth/configuration-not-found"?a(C.message||"Firebase no configurado para autenticao."):a("Ocorreu um erro ao comunicar com o servidor!")}finally{d(!1)}};return u.jsx("div",{className:"min-h-screen bg-slate-50 flex flex-col justify-center items-center p-4",children:u.jsxs("div",{className:"w-full max-w-md",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"w-16 h-16 mx-auto rounded-2xl bg-gradient-to-br from-primary to-primary-light flex items-center justify-center text-white font-bold text-3xl shadow-[0_4px_10px_rgba(16,185,129,0.3)] mb-4",children:"V"}),u.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Colgio Verdy"}),u.jsx("p",{className:"text-slate-500 mt-2",children:t?"Acesse o portal da escola":"Crie seu acesso inicial"})]}),u.jsxs("div",{className:"bg-white rounded-3xl p-8 border border-slate-200 shadow-xl shadow-slate-200/50",children:[g&&u.jsxs("div",{className:"bg-amber-50 text-amber-700 p-4 rounded-xl mb-6 flex items-start gap-3 text-sm",children:[u.jsx(l0,{className:"shrink-0 mt-0.5",size:18}),u.jsx("span",{children:g})]}),o&&u.jsxs("div",{className:"bg-red-50 text-red-600 p-4 rounded-xl mb-6 flex items-start gap-3 text-sm",children:[u.jsx(l0,{className:"shrink-0 mt-0.5",size:18}),u.jsx("span",{children:o})]}),u.jsxs("form",{onSubmit:x,className:"flex flex-col gap-5",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"E-mail"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"email",value:n,onChange:A=>r(A.target.value),placeholder:"Seu email de acesso",className:"w-full form-control !pl-10 !py-3",required:!0}),u.jsx(ok,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2",children:"Senha"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:"password",value:s,onChange:A=>i(A.target.value),placeholder:"",className:"w-full form-control !pl-10 !py-3",required:!0,minLength:6}),u.jsx(sk,{className:"absolute left-3.5 top-3.5 text-slate-400",size:18})]})]}),u.jsxs("button",{type:"submit",disabled:c,className:`btn-primary w-full justify-center !py-3.5 mt-2 text-base ${c?"opacity-70 cursor-not-allowed":""}`,children:[c?"Processando...":t?"Entrar no Sistema":"Criar Cadastro",t?u.jsx(ik,{size:20}):u.jsx(mk,{size:20})]})]}),u.jsx("div",{className:"mt-8 text-center text-sm text-slate-500 border-t border-slate-100 pt-6",children:u.jsxs("p",{children:[t?"Primeiro acesso? ":"J possui uma conta? ",u.jsx("button",{onClick:()=>{e(!t),a("")},className:"font-bold text-primary hover:text-primary-dark transition-colors",type:"button",children:t?"Cadastre-se aqui":"Faa Login"})]})})]})]})})},VL=({value:t})=>t?u.jsx("span",{className:"text-xs font-semibold px-2.5 py-1 rounded-full bg-primary/10 text-primary border border-primary/20",children:t}):u.jsx("span",{className:"text-xs text-slate-400 italic",children:""}),Zf=({icon:t,title:e,children:n})=>u.jsxs("div",{className:"glass-panel",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(t,{className:"text-primary",size:20})," ",e]}),n]}),hu=({label:t,value:e})=>u.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-slate-100 last:border-0",children:[u.jsx("span",{className:"text-sm font-medium text-slate-600",children:t}),u.jsx(VL,{value:e})]}),Cw=t=>{if(!t)return"";const[e,n,r]=t.split("-").map(Number);return new Date(e,n-1,r).toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"short",year:"numeric"})},kw=t=>t===new Date().toISOString().split("T")[0],OL=({student:t,turmaNome:e,onBack:n})=>{var A,C;const[r,s]=P.useState([]),[i,o]=P.useState(0),[a,c]=P.useState(!0);P.useEffect(()=>{if(!J||!(t!=null&&t.id)){c(!1);return}(async()=>{try{const I=(await Mp(Ot(Le(J,"cadernetaEntries"),ot("studentId","==",t.id),Ob("date","desc")))).docs.map(T=>({id:T.id,...T.data()}));s(I);const v=I.findIndex(T=>kw(T.date));o(v>=0?v:0)}catch{s([])}finally{c(!1)}})()},[t==null?void 0:t.id]);const d=r[i]??null,h=(d==null?void 0:d.data)??null,m=(d==null?void 0:d.isAbsent)??!1,g=i<r.length-1,x=i>0;return u.jsxs("div",{className:"flex flex-col gap-4 max-w-4xl mx-auto p-4 lg:p-8",children:[u.jsxs("div",{className:"glass-panel !p-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:n,className:"w-10 h-10 rounded-full border border-slate-200 flex items-center justify-center text-slate-500 hover:text-primary transition-colors bg-white shrink-0",children:u.jsx(Fg,{size:20})}),u.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-200 overflow-hidden shrink-0 flex items-center justify-center",children:t.fotoUrl?u.jsx("img",{src:t.fotoUrl,alt:t.nome,className:"w-full h-full object-cover"}):u.jsx("span",{className:"text-lg font-bold text-slate-400",children:(C=(A=t.nome)==null?void 0:A.charAt(0))==null?void 0:C.toUpperCase()})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs font-medium text-slate-500 uppercase tracking-widest",children:e}),u.jsx("div",{className:"font-bold text-lg text-slate-800",children:t.nome})]})]}),!a&&u.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-xl px-3 py-2",children:[u.jsx("button",{onClick:()=>o(R=>R+1),disabled:!g,className:"w-8 h-8 rounded-lg flex items-center justify-center text-slate-500 hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":"Data anterior",children:u.jsx(KI,{size:18})}),u.jsx("span",{className:"text-sm font-semibold text-slate-700 min-w-[160px] text-center",children:d?kw(d.date)?"Hoje  "+Cw(d.date):Cw(d.date):"Nenhuma entrada"}),u.jsx("button",{onClick:()=>o(R=>R-1),disabled:!x,className:"w-8 h-8 rounded-lg flex items-center justify-center text-slate-500 hover:bg-slate-200 disabled:opacity-30 disabled:cursor-not-allowed transition-colors","aria-label":"Prxima data",children:u.jsx(ah,{size:18})})]})]}),a&&u.jsx("div",{className:"flex flex-col gap-4",children:[1,2,3].map(R=>u.jsx("div",{className:"glass-panel animate-pulse h-24"},R))}),!a&&r.length===0&&u.jsxs("div",{className:"glass-panel p-10 text-center",children:[u.jsx(ip,{size:36,className:"mx-auto text-slate-300 mb-3"}),u.jsx("p",{className:"font-semibold text-slate-600",children:"Nenhuma caderneta registrada"}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"As cadernetas aparecero aqui aps serem enviadas pela escola."})]}),!a&&d&&m&&u.jsxs("div",{className:"glass-panel bg-red-50/80 border-red-200 flex items-center gap-4 p-6",children:[u.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 border border-red-200 flex items-center justify-center",children:u.jsx(hd,{size:24,className:"text-red-500"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-bold text-red-700",children:"Falta registrada"}),u.jsxs("p",{className:"text-sm text-red-500 mt-0.5",children:[t.nome," no compareceu neste dia."]})]})]}),!a&&d&&!m&&h&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[u.jsx(Zf,{icon:WI,title:"Refeies",children:Object.entries(h.meals??{}).map(([R,I])=>u.jsx(hu,{label:R,value:I},R))}),u.jsx(Zf,{icon:YI,title:"Descanso",children:Object.entries(h.rest??{}).map(([R,I])=>u.jsx(hu,{label:R,value:I},R))}),u.jsxs("div",{className:"glass-panel lg:col-span-full flex flex-col lg:flex-row gap-8 lg:gap-12",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(HI,{className:"text-primary",size:20})," Atividades"]}),["Manh","Tarde"].map(R=>{var I;return u.jsx(hu,{label:R,value:(I=h.activities)==null?void 0:I[R]},R)})]}),u.jsx("div",{className:"hidden lg:block w-px bg-slate-200"}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-2 text-[17px] font-semibold text-primary-dark mb-4",children:[u.jsx(GI,{className:"text-primary",size:20})," Evacuao"]}),["Manh","Tarde"].map(R=>{var I;return u.jsx(hu,{label:R,value:(I=h.evacuation)==null?void 0:I[R]},R)})]})]}),h.obs&&u.jsx(Zf,{icon:ip,title:"Observaes e Recados",children:u.jsx("p",{className:"text-sm text-slate-600 whitespace-pre-wrap leading-relaxed",children:h.obs})})]})]})},Rw={sent:{label:"Enviada hoje",className:"bg-emerald-50 text-emerald-700 border-emerald-200"},absent:{label:"Falta registrada",className:"bg-red-50 text-red-600 border-red-200"},pending:{label:"Aguardando",className:"bg-slate-50 text-slate-500 border-slate-200"}},ML=({student:t,turmaNome:e,cadernetaStatus:n,onClick:r})=>{var i,o;const s=Rw[n]??Rw.pending;return u.jsxs("button",{onClick:r,className:"w-full bg-white rounded-2xl border border-slate-200 shadow-sm p-4 flex items-center gap-4 hover:border-primary/40 hover:shadow-md transition-all text-left",children:[u.jsx("div",{className:"w-14 h-14 rounded-full bg-slate-100 border border-slate-200 overflow-hidden shrink-0 flex items-center justify-center",children:t.fotoUrl?u.jsx("img",{src:t.fotoUrl,alt:t.nome,className:"w-full h-full object-cover"}):u.jsx("span",{className:"text-lg font-bold text-slate-400",children:(o=(i=t.nome)==null?void 0:i.charAt(0))==null?void 0:o.toUpperCase()})}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-semibold text-slate-800 truncate",children:t.nome}),u.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:e||"Turma no informada"})]}),u.jsxs("div",{className:"flex items-center gap-2 shrink-0",children:[u.jsx("span",{className:`text-xs font-semibold px-2.5 py-1 rounded-full border ${s.className}`,children:s.label}),u.jsx(ah,{size:16,className:"text-slate-400"})]})]})},LL=()=>{var A;const{currentUser:t,userProfile:e}=$h(),[n,r]=P.useState([]),[s,i]=P.useState({}),[o,a]=P.useState({}),[c,d]=P.useState(!0),[h,m]=P.useState(null),g=t==null?void 0:t.uid;P.useEffect(()=>{if(!J||!g){d(!1);return}const C=Ot(Le(J,"students"),ot("responsaveisIds","array-contains",g),ot("status","==","ativo"));return ft(C,I=>{r(I.docs.map(v=>({id:v.id,...v.data()}))),d(!1)},()=>d(!1))},[g]),P.useEffect(()=>{if(!J||n.length===0){i({});return}const C=[...new Set(n.map(v=>v.turmaId).filter(Boolean))];if(C.length===0)return;const R=Ot(Le(J,"classrooms"),ot("__name__","in",C));return ft(R,v=>{const T={};v.docs.forEach(D=>{T[D.id]=D.data().nome||"Turma"}),i(T)},()=>{})},[n]),P.useEffect(()=>{if(!J||n.length===0){a({});return}const C=new Date().toISOString().split("T")[0],R=n.map(T=>T.id),I=[];for(let T=0;T<R.length;T+=30)I.push(R.slice(T,T+30));const v=I.map(T=>{const D=Ot(Le(J,"cadernetaEntries"),ot("studentId","in",T),ot("date","==",C));return ft(D,O=>{a(U=>{const E={...U};return O.docs.forEach(y=>{const S=y.data();E[S.studentId]=S.status||"pending"}),E})},()=>{})});return()=>v.forEach(T=>T())},[n]);const x=((A=e==null?void 0:e.nome)==null?void 0:A.split(" ")[0])||"Responsvel";return h?u.jsx(OL,{student:h,turmaNome:s[h.turmaId],onBack:()=>m(null)}):u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto p-4 lg:p-8",children:[u.jsx("div",{children:u.jsxs("h1",{className:"text-2xl font-bold text-slate-800",children:["Ol, ",x,"!"]})}),u.jsxs("section",{children:[u.jsx("div",{className:"flex items-center gap-2 mb-3",children:u.jsx("h2",{className:"text-base font-semibold text-slate-700",children:"Calendrio Escolar"})}),u.jsx(ov,{embedded:!0})]}),u.jsxs("section",{children:[u.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[u.jsx(cl,{size:18,className:"text-primary"}),u.jsx("h2",{className:"text-base font-semibold text-slate-700",children:"Meus Filhos"})]}),c?u.jsx("div",{className:"flex flex-col gap-3",children:[1,2].map(C=>u.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 p-4 flex items-center gap-4 animate-pulse",children:[u.jsx("div",{className:"w-14 h-14 rounded-2xl bg-slate-100"}),u.jsxs("div",{className:"flex-1 space-y-2",children:[u.jsx("div",{className:"h-4 bg-slate-100 rounded w-1/3"}),u.jsx("div",{className:"h-3 bg-slate-100 rounded w-1/4"})]})]},C))}):n.length===0?u.jsxs("div",{className:"bg-white rounded-2xl border border-dashed border-slate-200 p-8 text-center",children:[u.jsx(Ug,{size:36,className:"mx-auto text-slate-300 mb-3"}),u.jsx("p",{className:"font-semibold text-slate-600",children:"Nenhum aluno vinculado"}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Entre em contato com a escola para vincular seu filho  sua conta."})]}):u.jsx("div",{className:"flex flex-col gap-3",children:n.map(C=>u.jsx(ML,{student:C,turmaNome:s[C.turmaId],cadernetaStatus:o[C.id]||"pending",onClick:()=>m(C)},C.id))})]})]})};function FL(){const[t,e]=P.useState(null),[n,r]=P.useState(null),[s,i]=P.useState([]),[o,a]=P.useState(!0);P.useEffect(()=>{if(!J)return()=>{};const h=[];return h.push(ft(Le(J,"students"),m=>{e(m.size)},()=>{e(0)})),h.push(ft(Ot(Le(J,"classrooms"),ot("status","==","ativa")),m=>{r(m.size)},()=>{r(0)})),h.push(ft(Ot(Le(J,"events"),ot("data",">=",new Date().toISOString().split("T")[0]),Ob("data","asc"),Ej(5)),m=>{const g=m.docs.map(x=>{const A=x.data();return{id:x.id,titulo:A.titulo||"Sem ttulo",tipo:A.tipo||"Administrativos",data:A.data||"",local:A.local||"",diaTodo:!!A.diaTodo,horario:A.horario||"",anexoUrl:A.anexoUrl||"",anexoNome:A.anexoNome||""}});i(g),a(!1)},()=>{i([]),a(!1)})),()=>h.forEach(m=>m())},[]);const c=h=>{if(!h)return{dia:"--",mes:"---"};const[m,g,x]=h.split("-");if(!m||!g||!x)return{dia:"--",mes:"---"};const A=new Date(Number(m),Number(g)-1,Number(x));return{dia:String(A.getDate()).padStart(2,"0"),mes:A.toLocaleDateString("pt-BR",{month:"short"}).replace(".","").toUpperCase()}},d=P.useMemo(()=>[{id:"i1",label:"Total de Alunos",valor:t,icon:Ul,color:"text-primary bg-primary/10"},{id:"i2",label:"Turmas Ativas",valor:n,icon:JI,color:"text-primary bg-primary/10"},{id:"i3",label:"Calendrio",valor:s.length,icon:rp,color:"text-primary bg-primary/10"},{id:"i4",label:"Comunicados",valor:"-",icon:ck,color:"text-primary bg-primary/10"}],[t,n,s.length]);return u.jsxs("div",{className:"flex flex-col gap-6 max-w-6xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Dashboard da Administrao"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Viso consolidada da operao escolar."})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:d.map(h=>u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60 flex items-center gap-3",children:[u.jsx("div",{className:`w-11 h-11 rounded-xl flex items-center justify-center ${h.color}`,children:u.jsx(h.icon,{size:20})}),u.jsxs("div",{children:[u.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wide",children:h.label}),u.jsx("div",{className:"text-2xl font-bold text-slate-800",children:h.valor??""})]})]},h.id))}),u.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(rp,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Prximos eventos"})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[o&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando eventos..."}),!o&&s.map(h=>{const m=c(h.data);return u.jsxs("div",{className:"rounded-xl border border-slate-200 bg-white/80 p-3 flex items-center gap-3",children:[u.jsxs("div",{className:"w-14 h-14 rounded-lg bg-slate-100 border border-slate-200 flex flex-col items-center justify-center",children:[u.jsx("span",{className:"text-base font-bold text-slate-800 leading-none",children:m.dia}),u.jsx("span",{className:"text-[10px] font-semibold text-slate-500",children:m.mes})]}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"font-semibold text-slate-800 truncate",children:h.titulo}),u.jsx("div",{className:"text-sm text-slate-500",children:h.diaTodo?"Dia todo":h.horario}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:h.tipo}),h.local&&u.jsx("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:h.local}),h.anexoUrl&&u.jsx("a",{href:h.anexoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-primary hover:underline mt-0.5 inline-block truncate",children:h.anexoNome||"Ver anexo"})]})]},h.id)}),!o&&s.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhum evento cadastrado."})]})]}),u.jsx("div",{className:"glass-panel p-5 border border-slate-200/60",children:u.jsx("div",{className:"flex flex-col gap-3",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 flex items-center justify-center mx-auto mb-4",children:u.jsx(QI,{size:32,className:"text-slate-400"})}),u.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Mensagens"}),u.jsx("p",{className:"text-slate-500",children:"Esta funcionalidade est em desenvolvimento."}),u.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Em breve voc poder se comunicar diretamente com pais, professore e direo."})]})})})]})]})}const UL=["Administrativos","Acadmicos","Feriado","Recesso"],em=5,tm={titulo:"",tipo:"Administrativos",data:"",local:"",descricao:"",diaTodo:!1,horario:"",anexoUrl:"",anexoNome:"",anexoMimeType:"",anexoPath:""};function zL(){const[t,e]=P.useState([]),[n,r]=P.useState(!0),[s,i]=P.useState(!1),[o,a]=P.useState(null),[c,d]=P.useState(tm),[h,m]=P.useState(!1),[g,x]=P.useState(null),[A,C]=P.useState(1),R=P.useRef(null);P.useEffect(()=>{if(!J)return()=>{};const w=ft(Le(J,"events"),k=>{const b=k.docs.map(se=>{const ae=se.data();return{id:se.id,titulo:ae.titulo||"Sem ttulo",tipo:ae.tipo||"Administrativos",data:ae.data||"",local:ae.local||"",descricao:ae.descricao||"",diaTodo:!!ae.diaTodo,horario:ae.horario||"",anexoUrl:ae.anexoUrl||"",anexoNome:ae.anexoNome||"",anexoMimeType:ae.anexoMimeType||"",anexoPath:ae.anexoPath||""}}).sort((se,ae)=>{const K=`${se.data||""} ${se.horario||""}`;return`${ae.data||""} ${ae.horario||""}`.localeCompare(K)});e(b),r(!1)},()=>{e([]),r(!1)});return()=>w()},[]);const I=w=>{if(!w)return{dia:"--",mes:"---"};const[k,b,se]=w.split("-");if(!k||!b||!se)return{dia:"--",mes:"---"};const ae=new Date(Number(k),Number(b)-1,Number(se));return{dia:String(ae.getDate()).padStart(2,"0"),mes:ae.toLocaleDateString("pt-BR",{month:"short"}).replace(".","").toUpperCase()}},v=()=>{a(null),d(tm),x(null),i(!0)},T=w=>{a(w.id),d({titulo:w.titulo||"",tipo:w.tipo||"Administrativos",data:w.data||"",local:w.local||"",descricao:w.descricao||"",diaTodo:!!w.diaTodo,horario:w.horario||"",anexoUrl:w.anexoUrl||"",anexoNome:w.anexoNome||"",anexoMimeType:w.anexoMimeType||"",anexoPath:w.anexoPath||""}),x(null),i(!0)},D=()=>{a(null),d(tm),x(null),i(!1)};P.useEffect(()=>{!s||!R.current||(R.current.innerHTML=c.descricao||"")},[s,o]);const O=w=>{document.execCommand(w,!1),R.current&&d(k=>({...k,descricao:R.current.innerHTML}))},U=P.useMemo(()=>Math.max(1,Math.ceil(t.length/em)),[t.length]),E=Math.min(A,U),y=P.useMemo(()=>t.slice((E-1)*em,E*em),[t,E]),S=async w=>{w.preventDefault();const k=c.titulo.trim(),b=c.tipo,se=c.data,ae=c.local.trim(),K=(c.descricao||"").trim(),we=!!c.diaTodo,$=c.horario;if(!(!k||!b||!se||!we&&!$||!J))try{m(!0);let L=c.anexoUrl||"",G=c.anexoNome||"",Y=c.anexoMimeType||"",W=c.anexoPath||"";if(g&&Fa){const ue=g.name.replace(/\s+/g,"_"),Se=`events/${Date.now()}-${ue}`,_e=Xf(Fa,Se);if(await _L(_e,g),L=await xL(_e),G=g.name,Y=g.type||"",c.anexoPath)try{await ww(Xf(Fa,c.anexoPath))}catch{}W=Se}const me={titulo:k,tipo:b,data:se,local:ae,descricao:K,diaTodo:we,horario:we?"":$,anexoUrl:L,anexoNome:G,anexoMimeType:Y,anexoPath:W,updatedAt:Oe()};o?await an(ht(J,"events",o),me):await Vh(Le(J,"events"),{...me,createdAt:Oe()}),C(1),D()}finally{m(!1)}},N=async w=>{if(!J)return;const k=t.find(b=>b.id===w);if(await Dj(ht(J,"events",w)),k!=null&&k.anexoPath&&Fa)try{await ww(Xf(Fa,k.anexoPath))}catch{}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-6xl mx-auto",children:[u.jsxs("div",{className:"flex items-start justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Calendrio Escolar"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Gerencie os eventos e compromissos da escola."})]}),u.jsxs("button",{onClick:s?D:v,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center gap-1",children:[s?u.jsx(Er,{size:14}):u.jsx(oc,{size:14}),s?"Cancelar":"Novo evento"]})]}),s&&u.jsxs("form",{onSubmit:S,className:"rounded-xl border border-slate-200 p-3 bg-white/80 grid grid-cols-1 md:grid-cols-6 gap-2 items-end",children:[u.jsxs("label",{className:"md:col-span-2 text-sm text-slate-600 flex flex-col gap-1",children:["Ttulo",u.jsx("input",{value:c.titulo,onChange:w=>d(k=>({...k,titulo:w.target.value})),className:"form-control !py-2.5",placeholder:"Ttulo do evento",required:!0})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Tipo",u.jsx("select",{value:c.tipo,onChange:w=>d(k=>({...k,tipo:w.target.value})),className:"form-control !py-2.5",required:!0,children:UL.map(w=>u.jsx("option",{value:w,children:w},w))})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Data",u.jsx("input",{type:"date",value:c.data,onChange:w=>d(k=>({...k,data:w.target.value})),className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Local",u.jsx("input",{value:c.local,onChange:w=>d(k=>({...k,local:w.target.value})),className:"form-control !py-2.5",placeholder:"Ex.: Auditrio"})]}),u.jsxs("div",{className:"text-sm text-slate-600 flex flex-col gap-1",children:[u.jsx("span",{children:"Perodo"}),u.jsx("div",{className:"h-[42px] flex items-center",children:u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:c.diaTodo,onChange:w=>d(k=>({...k,diaTodo:w.target.checked,horario:w.target.checked?"":k.horario}))}),"Dia todo"]})})]}),u.jsxs("label",{className:"text-sm text-slate-600 flex flex-col gap-1",children:["Horrio",u.jsx("input",{type:"time",value:c.horario,onChange:w=>d(k=>({...k,horario:w.target.value})),className:"form-control !py-2.5",required:!c.diaTodo,disabled:c.diaTodo})]}),u.jsxs("label",{className:"md:col-span-2 text-sm text-slate-600 flex flex-col gap-1",children:["Anexo (PDF ou imagem)",u.jsx("input",{type:"file",accept:"application/pdf,image/*",onChange:w=>{var k;return x(((k=w.target.files)==null?void 0:k[0])||null)},className:"form-control !py-2.5"}),!g&&c.anexoUrl&&u.jsxs("a",{href:c.anexoUrl,target:"_blank",rel:"noreferrer",className:"text-xs text-primary hover:underline truncate",children:["Anexo atual: ",c.anexoNome||"Visualizar arquivo"]})]}),u.jsxs("div",{className:"md:col-span-6 flex flex-col gap-2 text-sm text-slate-600",children:[u.jsx("span",{children:"Descrio"}),u.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 bg-white px-2 py-1 w-fit",children:[u.jsx("button",{type:"button",onMouseDown:w=>w.preventDefault(),onClick:()=>O("bold"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 font-semibold",children:"B"}),u.jsx("button",{type:"button",onMouseDown:w=>w.preventDefault(),onClick:()=>O("italic"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 italic",children:"I"}),u.jsx("button",{type:"button",onMouseDown:w=>w.preventDefault(),onClick:()=>O("underline"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100 underline",children:"U"}),u.jsx("button",{type:"button",onMouseDown:w=>w.preventDefault(),onClick:()=>O("insertUnorderedList"),className:"h-7 w-7 rounded-md text-slate-700 hover:bg-slate-100",children:""})]}),u.jsx("div",{ref:R,contentEditable:!0,suppressContentEditableWarning:!0,onInput:w=>{const k=w.currentTarget.innerHTML;d(b=>({...b,descricao:k}))},className:"min-h-[120px] rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700 focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),u.jsx("div",{className:"md:col-span-6 flex justify-end",children:u.jsx("button",{type:"submit",disabled:h,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-60",children:o?"Salvar edio":"Salvar evento"})})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[u.jsx(rp,{size:18,className:"text-slate-500"}),u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Eventos"})]}),u.jsxs("div",{className:"flex flex-col gap-3",children:[n&&u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando eventos..."}),!n&&y.map(w=>{const k=I(w.data);return u.jsxs("div",{className:"mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 border-l-8 border-l-slate-500",children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"hidden md:flex items-center gap-2 flex-wrap p-2",children:[u.jsxs("button",{onClick:()=>T(w),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>N(w.id),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-red-600 bg-red-50 border border-red-200 hover:bg-red-100 transition-colors flex flex-col items-center gap-1",children:[u.jsx(d0,{}),"Excluir"]})]}),u.jsx("div",{className:"md:grow min-w-0 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsxs("div",{className:"w-14 h-14 rounded-full bg-slate-200 border border-slate-500 flex flex-col items-center justify-center shrink-0",children:[u.jsx("span",{className:"text-base font-bold text-slate-500 leading-none",children:k.dia}),u.jsx("span",{className:"text-[10px] font-semibold text-slate-500",children:k.mes})]}),u.jsxs("div",{className:"min-w-0 md:grow",children:[u.jsxs("div",{className:"font-semibold text-slate-800 truncate",children:[w.titulo,u.jsxs("span",{className:`inline-flex items-center ${w.anexoUrl?"":"hidden"}`,children:["",u.jsx(uk,{size:14})]})]}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5",children:w.tipo}),u.jsx("div",{className:"md:hidden text-xs text-slate-500",children:w.diaTodo?"Dia todo":w.horario}),u.jsx("div",{className:"md:hidden text-xs text-slate-500 mt-0.5 truncate",children:w.local})]}),u.jsxs("div",{className:"hidden md:block md:w-32",children:[u.jsx("div",{className:"text-sm text-slate-500",children:w.diaTodo?"Dia todo":w.horario}),u.jsx("div",{className:"text-xs text-slate-500 mt-0.5 truncate",children:w.local})]})]})})]}),u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>T(w),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{size:14})}),u.jsx("button",{onClick:()=>N(w.id),className:"h-8 px-2 rounded-e-lg text-xs font-medium text-red-600 border border-primary border-l-0 inline-flex justify-center items-center gap-1",children:u.jsx(d0,{size:14})})]})]},w.id)}),!n&&t.length===0&&u.jsx("div",{className:"text-sm text-slate-500",children:"Nenhum evento cadastrado."}),!n&&t.length>0&&u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",E," de ",U]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:E===1,onClick:()=>C(w=>Math.max(1,w-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:E===U,onClick:()=>C(w=>Math.min(U,w+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})]})}const nm=5,rm={nome:"",turmaId:"",fotoUrl:""},za={responsavelId:"",parentesco:"",podeBuscar:!0,contatoEmergencia:!1};function BL(t){return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=e2e8f0&color=0f172a`}async function $L(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function qL(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function Pw(){const[t,e]=P.useState([]),[n,r]=P.useState([]),[s,i]=P.useState([]),[o,a]=P.useState(!1),[c,d]=P.useState(null),[h,m]=P.useState(rm),[g,x]=P.useState(""),[A,C]=P.useState("todos"),[R,I]=P.useState("todas"),[v,T]=P.useState(!1),[D,O]=P.useState(1),[U,E]=P.useState(!1),[y,S]=P.useState(!0),[N,w]=P.useState(!1),[k,b]=P.useState({tipo:"",mensagem:""}),[se,ae]=P.useState(!1),[K,we]=P.useState(null),[$,L]=P.useState(""),[G,Y]=P.useState(za);P.useEffect(()=>J?ft(Le(J,"students"),Z=>{const te=Z.docs.map(de=>{const pe=de.data();return{id:de.id,nome:pe.nome||"Sem nome",turmaId:pe.turmaId||"",status:pe.status||"ativo",fotoUrl:pe.fotoUrl||"",responsaveis:Array.isArray(pe.responsaveis)?pe.responsaveis:[]}}).sort((de,pe)=>de.nome.localeCompare(pe.nome,"pt-BR"));e(te),S(!1)},Z=>{S(!1),b({tipo:"erro",mensagem:(Z==null?void 0:Z.message)||"No foi possvel carregar os alunos do banco."})}):(S(!1),b({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{}),[]),P.useEffect(()=>{if(!J)return()=>{};const F=Ot(Le(J,"users"),ot("role","==","parent"));return ft(F,te=>{const de=te.docs.map(pe=>{const Lt=pe.data();return{id:pe.id,nome:Lt.nome||"Sem nome",email:Lt.email||"",telefone:Lt.telefone||"",avatarUrl:Lt.avatarUrl||"",status:Lt.status||"ativo"}}).sort((pe,Lt)=>pe.nome.localeCompare(Lt.nome,"pt-BR"));i(de)})},[]),P.useEffect(()=>J?ft(Le(J,"classrooms"),Z=>{const te=Z.docs.map(de=>{const pe=de.data();return{id:de.id,nome:pe.nome||"Sem nome",periodo:pe.periodo||"",status:pe.status||"ativa"}}).sort((de,pe)=>de.nome.localeCompare(pe.nome,"pt-BR"));r(te)}):()=>{},[]);const W=P.useMemo(()=>t.filter(F=>{const Z=F.nome.toLowerCase().includes(g.toLowerCase()),te=A==="todos"?!0:F.status===A,de=R==="todas"?!0:F.turmaId===R;return Z&&te&&de}),[t,g,A,R]),me=Math.max(1,Math.ceil(W.length/nm)),ue=Math.min(D,me),Se=W.slice((ue-1)*nm,ue*nm),_e=F=>{var Z;return((Z=n.find(te=>te.id===F))==null?void 0:Z.nome)||"Sem turma"},Ne=()=>{d(null),m(rm),a(!0)},je=F=>{d(F.id),m({nome:F.nome,turmaId:F.turmaId||"",fotoUrl:F.fotoUrl||""}),a(!0)},St=()=>{a(!1),d(null),m(rm)},Ln=async F=>{var te;const Z=(te=F.target.files)==null?void 0:te[0];if(Z)try{const de=await $L(Z),pe=await qL(de);m(Lt=>({...Lt,fotoUrl:pe}))}catch(de){b({tipo:"erro",mensagem:(de==null?void 0:de.message)||"No foi possvel carregar a foto."})}finally{F.target.value=""}},Vi=async F=>{F.preventDefault(),b({tipo:"",mensagem:""}),E(!0);const Z=h.nome.trim(),te=h.turmaId;if(!Z||!te){E(!1);return}const de=h.fotoUrl.trim()||BL(Z);try{if(!J)throw new Error("Banco de dados no configurado.");c?(await an(ht(J,"students",c),{nome:Z,turmaId:te,fotoUrl:de,updatedAt:Oe()}),b({tipo:"sucesso",mensagem:"Dados do aluno atualizados com sucesso."})):(await Vh(Le(J,"students"),{nome:Z,turmaId:te,fotoUrl:de,status:"ativo",createdAt:Oe(),updatedAt:Oe()}),b({tipo:"sucesso",mensagem:"Aluno cadastrado com sucesso."})),O(1),St()}catch(pe){b({tipo:"erro",mensagem:(pe==null?void 0:pe.message)||"No foi possvel salvar o aluno."})}finally{E(!1)}},Or=F=>{(async()=>{if(!J)throw new Error("Banco de dados no configurado.");const te=t.find(de=>de.id===F);te&&await an(ht(J,"students",F),{status:te.status==="ativo"?"inativo":"ativo",updatedAt:Oe()})})().catch(te=>{b({tipo:"erro",mensagem:(te==null?void 0:te.message)||"No foi possvel atualizar o status do aluno."})})},Fn=F=>{we(F),ae(!0),L(""),Y(za)},Oi=()=>{ae(!1),we(null),L(""),Y(za)},gt=K?t.find(F=>F.id===K.id)||K:null,Un=(gt==null?void 0:gt.responsaveis)||[],Fs=P.useMemo(()=>{const F=$.trim().toLowerCase();return s.filter(Z=>Z.status==="ativo").filter(Z=>!F||Z.nome.toLowerCase().includes(F))},[s,$]),Mi=async F=>{if(F.preventDefault(),!J||!gt)return;const Z=s.find(de=>de.id===G.responsavelId),te=G.parentesco.trim();if(!(!Z||!te))try{w(!0),b({tipo:"",mensagem:""});const de=Array.isArray(gt.responsaveis)?gt.responsaveis:[],pe={responsavelId:Z.id,nome:Z.nome,email:Z.email||"",telefone:Z.telefone||"",avatarUrl:Z.avatarUrl||"",parentesco:te,podeBuscar:!!G.podeBuscar,contatoEmergencia:!!G.contatoEmergencia},Lt=de.findIndex(gn=>gn.responsavelId===Z.id);let ar=[];Lt>=0?ar=de.map((gn,qh)=>qh===Lt?pe:gn):ar=[...de,pe],pe.contatoEmergencia&&(ar=ar.map(gn=>({...gn,contatoEmergencia:gn.responsavelId===pe.responsavelId}))),await an(ht(J,"students",gt.id),{responsaveis:ar,responsaveisIds:ar.map(gn=>gn.responsavelId),updatedAt:Oe()}),Y(za),b({tipo:"sucesso",mensagem:"Vnculo de responsvel salvo com sucesso."})}catch(de){b({tipo:"erro",mensagem:(de==null?void 0:de.message)||"No foi possvel salvar o vnculo do responsvel."})}finally{w(!1)}},B=F=>{Y({responsavelId:F.responsavelId||"",parentesco:F.parentesco||"",podeBuscar:!!F.podeBuscar,contatoEmergencia:!!F.contatoEmergencia})},le=async F=>{if(!(!J||!gt))try{w(!0),b({tipo:"",mensagem:""});const te=(Array.isArray(gt.responsaveis)?gt.responsaveis:[]).filter(de=>de.responsavelId!==F);await an(ht(J,"students",gt.id),{responsaveis:te,responsaveisIds:te.map(de=>de.responsavelId),updatedAt:Oe()}),G.responsavelId===F&&Y(za),b({tipo:"sucesso",mensagem:"Vnculo removido com sucesso."})}catch(Z){b({tipo:"erro",mensagem:(Z==null?void 0:Z.message)||"No foi possvel remover o vnculo do responsvel."})}finally{w(!1)}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Alunos"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro, edio e status dos alunos."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Alunos"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>T(F=>!F),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${v?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(lh,{size:16})}),u.jsx("button",{onClick:o?St:Ne,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar aluno",children:o?u.jsx(Er,{size:16}):u.jsx(oc,{size:16})}),u.jsx("button",{onClick:o?St:Ne,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:o?"Cancelar":"Adicionar aluno"})]})]}),o&&u.jsxs("form",{onSubmit:Vi,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload da foto",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32 rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:h.fotoUrl?u.jsx("img",{src:h.fotoUrl,alt:"Avatar do aluno",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem foto"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:Ln,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:h.nome,onChange:F=>m(Z=>({...Z,nome:F.target.value})),placeholder:"Nome do aluno",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Turma",u.jsxs("select",{value:h.turmaId,onChange:F=>m(Z=>({...Z,turmaId:F.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione a turma"}),n.map(F=>u.jsx("option",{value:F.id,children:F.nome},F.id))]})]})]})})]}),u.jsx("button",{type:"submit",disabled:U,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:c?"Salvar edio":"Salvar aluno"})]}),k.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${k.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:k.mensagem}),u.jsxs("div",{className:`${v?"flex":"hidden"} flex-col gap-3 mb-4 md:flex md:flex-row`,children:[u.jsx("input",{value:g,onChange:F=>{x(F.target.value),O(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:A,onChange:F=>{C(F.target.value),O(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]}),u.jsxs("select",{value:R,onChange:F=>{I(F.target.value),O(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todas",children:"Todas as turmas"}),n.map(F=>u.jsx("option",{value:F.id,children:F.nome},F.id))]})]}),y&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando alunos..."}),!y&&Se.map(F=>u.jsx("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${F.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:(()=>{const Z=(F.responsaveis||[]).filter(te=>te.contatoEmergencia);return u.jsxs("div",{children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>je(F),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>Fn(F),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-primary bg-primary/15 border border-primary/30 hover:bg-primary/35 transition-colors flex flex-col items-center gap-1",children:[u.jsx(Ul,{}),"Resp."]}),u.jsxs("button",{onClick:()=>Or(F.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${F.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[F.status==="ativo"?u.jsx(Ts,{}):u.jsx(Is,{}),F.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:F.fotoUrl?u.jsx("img",{src:F.fotoUrl,alt:F.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:F.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:_e(F.turmaId)})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:Z.map(te=>u.jsxs("div",{children:[u.jsx("div",{className:"font-bold",children:te.nome||"Responsvel"}),u.jsxs("div",{children:[te.parentesco||"Parentesco no informado"," - ",te.telefone||"Sem telefone"]})]}))})})]}),u.jsxs("div",{className:"grid grid-cols-3 md:hidden p-1",children:[u.jsx("button",{onClick:()=>je(F),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>Fn(F),className:"h-8 px-2 text-xs font-medium text-primary border border-primary inline-flex justify-center items-center gap-1",children:u.jsx(Ul,{})}),u.jsx("button",{onClick:()=>Or(F.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${F.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:F.status==="ativo"?u.jsx(Ts,{}):u.jsx(Is,{})})]})]},F.id)})()},F.id)),se&&gt&&u.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-2xl rounded-xl border border-slate-200 bg-white shadow-xl p-4 md:p-5",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h4",{className:"text-base font-bold text-slate-800",children:["Responsveis de ",gt.nome]}),u.jsx("button",{onClick:Oi,className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),u.jsxs("form",{onSubmit:Mi,className:"rounded-lg border border-slate-200 p-3 mb-3 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Responsvel",u.jsxs("select",{value:G.responsavelId,onChange:F=>Y(Z=>({...Z,responsavelId:F.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione"}),Fs.map(F=>u.jsx("option",{value:F.id,children:F.nome},F.id))]})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Parentesco",u.jsx("input",{value:G.parentesco,onChange:F=>Y(Z=>({...Z,parentesco:F.target.value})),placeholder:"Ex.: Me, Pai, Av, Tio",className:"form-control !py-2.5",required:!0})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:G.podeBuscar,onChange:F=>Y(Z=>({...Z,podeBuscar:F.target.checked}))}),"Pode buscar o aluno"]}),u.jsxs("label",{className:"inline-flex items-center gap-2 text-sm text-slate-600",children:[u.jsx("input",{type:"checkbox",checked:G.contatoEmergencia,onChange:F=>Y(Z=>({...Z,contatoEmergencia:F.target.checked}))}),"Contato de emergncia"]})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",disabled:N,className:"h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors disabled:opacity-60",children:N?"Salvando...":"Salvar vnculo"})})]}),u.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:["Vnculos atuais (",Un.length,")"]}),u.jsxs("div",{className:"flex flex-col gap-2 max-h-60 overflow-y-auto",children:[Un.map(F=>u.jsxs("div",{className:`rounded-lg border px-3 py-2 ${F.contatoEmergencia?"bg-amber-50 border-amber-500":""}`,children:[u.jsxs("div",{className:"flex items-center justify-start gap-2",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 py-2",children:[u.jsxs("button",{onClick:()=>B(F),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>le(F.responsavelId),className:"w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 bg-red-50 text-red-600 hover:bg-red-100 border border-red-700",children:[u.jsx(fk,{}),"Excluir"]})]}),u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:u.jsx("img",{src:F.avatarUrl,alt:F.nome,className:"w-full h-full object-cover"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:F.nome||"Responsvel"}),u.jsxs("div",{className:"text-sm text-slate-500 truncate",children:[F.parentesco||"Sem parentesco","  ",F.podeBuscar?"Pode buscar":"No pode buscar",F.contatoEmergencia?"  Emergncia":""]})]})]})]}),u.jsx("div",{className:"w-full md:hidden",children:u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>B(F),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>le(F.responsavelId),className:"h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1",children:u.jsx(Er,{})})]})})]},F.responsavelId)),Un.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum responsvel vinculado."})]})]})]})}),!y&&Se.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum aluno encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",ue," de ",me]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{disabled:ue===1,onClick:()=>O(F=>Math.max(1,F-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Anterior"}),u.jsx("button",{disabled:ue===me,onClick:()=>O(F=>Math.min(me,F+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 hover:bg-slate-200 disabled:opacity-40 disabled:cursor-not-allowed",children:"Prxima"})]})]})]})]})}const sm=5,im={nome:"",disciplina:"",email:"",telefone:"",avatarUrl:""};async function HL(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function GL(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function KL(){const[t,e]=P.useState([]),[n,r]=P.useState(!1),[s,i]=P.useState(null),[o,a]=P.useState(im),[c,d]=P.useState(""),[h,m]=P.useState("todos"),[g,x]=P.useState("todas"),[A,C]=P.useState(!1),[R,I]=P.useState(1),[v,T]=P.useState(!1),[D,O]=P.useState(!0),[U,E]=P.useState({tipo:"",mensagem:""});P.useEffect(()=>{if(!J)return O(!1),E({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{};const L=Ot(Le(J,"users"),ot("role","==","teacher"));return ft(L,Y=>{const W=Y.docs.map(me=>{const ue=me.data();return{id:me.id,nome:ue.nome||"Sem nome",disciplina:ue.disciplina||"",email:ue.email||"",telefone:ue.telefone||"",avatarUrl:ue.avatarUrl||"",status:ue.status||"ativo"}}).sort((me,ue)=>me.nome.localeCompare(ue.nome,"pt-BR"));e(W),O(!1)},Y=>{O(!1),E({tipo:"erro",mensagem:(Y==null?void 0:Y.message)||"No foi possvel carregar os professores do banco."})})},[]);const y=P.useMemo(()=>[...new Set(t.map(L=>L.disciplina).filter(Boolean))].sort(),[t]),S=P.useMemo(()=>t.filter(L=>{const G=L.nome.toLowerCase().includes(c.toLowerCase()),Y=h==="todos"?!0:L.status===h,W=g==="todas"?!0:L.disciplina===g;return G&&Y&&W}),[t,c,h,g]),N=Math.max(1,Math.ceil(S.length/sm)),w=Math.min(R,N),k=S.slice((w-1)*sm,w*sm),b=()=>{i(null),a(im),r(!0)},se=L=>{i(L.id),a({nome:L.nome,disciplina:L.disciplina,email:L.email||"",telefone:L.telefone||"",avatarUrl:L.avatarUrl||""}),r(!0)},ae=()=>{i(null),a(im),r(!1)},K=L=>{L.preventDefault(),(async()=>{var _e;E({tipo:"",mensagem:""}),T(!0);const Y=o.nome.trim(),W=o.disciplina.trim(),me=o.email.trim().toLowerCase(),ue=o.telefone.trim(),Se=o.avatarUrl.trim();if(!Y||!me){T(!1);return}try{if(s){if(!J)throw new Error("Banco de dados no configurado.");await an(ht(J,"users",s),{nome:Y,disciplina:W||null,telefone:ue||null,avatarUrl:Se||null,updatedAt:Oe()}),E({tipo:"sucesso",mensagem:"Dados do professor atualizados com sucesso."})}else{if(!kr||!It)throw new Error("Firebase no configurado para cadastro de professor.");const je=await PS(YS,"createTeacherAccount")({nome:Y,email:me,disciplina:W,telefone:ue,avatarUrl:Se}),St=((_e=je==null?void 0:je.data)==null?void 0:_e.email)||me;await vS(It,St),E({tipo:"sucesso",mensagem:"Professor cadastrado e link para criao de senha enviado por e-mail."})}I(1),ae()}catch(Ne){const je=(Ne==null?void 0:Ne.message)||"No foi possvel salvar o professor.";E({tipo:"erro",mensagem:je})}finally{T(!1)}})()},we=L=>{(async()=>{if(!J)throw new Error("Banco de dados no configurado.");const Y=t.find(W=>W.id===L);Y&&await an(ht(J,"users",L),{status:Y.status==="ativo"?"inativo":"ativo",updatedAt:Oe()})})().catch(Y=>{E({tipo:"erro",mensagem:(Y==null?void 0:Y.message)||"No foi possvel atualizar o status do professor."})})},$=async L=>{var Y;const G=(Y=L.target.files)==null?void 0:Y[0];if(G)try{const W=await HL(G),me=await GL(W);a(ue=>({...ue,avatarUrl:me}))}catch(W){E({tipo:"erro",mensagem:(W==null?void 0:W.message)||"No foi possvel carregar o avatar."})}finally{L.target.value=""}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Professores"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro, edio e status do quadro docente."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Professores"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>C(L=>!L),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${A?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(lh,{size:16})}),u.jsx("button",{onClick:n?ae:b,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar professor",children:n?u.jsx(Er,{size:16}):u.jsx(oc,{size:16})}),u.jsx("button",{onClick:n?ae:b,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:n?"Cancelar":"Adicionar professor"})]})]}),n&&u.jsxs("form",{onSubmit:K,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload de avatar",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32  rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar do professor",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem avatar"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:$,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:o.nome,onChange:L=>a(G=>({...G,nome:L.target.value})),placeholder:"Nome completo",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2 text-sm text-slate-600",children:["E-mail",u.jsx("input",{type:"email",value:o.email,onChange:L=>a(G=>({...G,email:L.target.value})),placeholder:"E-mail",className:"form-control !py-2.5",required:!0,disabled:!!s})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Disciplina",u.jsx("input",{value:o.disciplina,onChange:L=>a(G=>({...G,disciplina:L.target.value})),placeholder:"Disciplina (opcional)",className:"form-control !py-2.5"})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Telefone",u.jsx("input",{value:o.telefone,onChange:L=>a(G=>({...G,telefone:L.target.value})),placeholder:"Telefone (opcional)",className:"form-control !py-2.5"})]})]})})]}),u.jsx("button",{type:"submit",disabled:v,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:s?"Salvar edio":"Salvar professor"})]}),U.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${U.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:U.mensagem}),u.jsxs("div",{className:`${A?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:c,onChange:L=>{d(L.target.value),I(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:h,onChange:L=>{m(L.target.value),I(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]}),u.jsxs("select",{value:g,onChange:L=>{x(L.target.value),I(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todas",children:"Todas as disciplinas"}),y.map(L=>u.jsx("option",{value:L,children:L},L))]})]}),D&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando professores..."}),!D&&k.map(L=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${L.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>se(L),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>we(L.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${L.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[L.status==="ativo"?u.jsx(Ts,{}):u.jsx(Is,{}),L.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:L.avatarUrl?u.jsx("img",{src:L.avatarUrl,alt:L.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{className:"",children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:L.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:L.disciplina||"Sem disciplina"}),u.jsx("div",{className:"md:hidden text-sm text-slate-500 truncate",children:L.email})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:L.email})})]}),u.jsx("div",{children:u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>se(L),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>we(L.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${L.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:L.status==="ativo"?u.jsx(Ts,{}):u.jsx(Is,{})})]})})]},L.id)),!D&&k.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum professor encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",w," de ",N]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:w===1,onClick:()=>I(L=>Math.max(1,L-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:w===N,onClick:()=>I(L=>Math.min(N,L+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}const om=5,am={nome:"",email:"",telefone:"",avatarUrl:""};async function WL(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}async function QL(t){const e=await new Promise((c,d)=>{const h=new Image;h.onload=()=>c(h),h.onerror=()=>d(new Error("Falha ao processar imagem.")),h.src=t}),n=512,r=document.createElement("canvas"),s=r.getContext("2d");if(!s)return t;const i=Math.min(n/e.width,n/e.height,1),o=Math.max(1,Math.round(e.width*i)),a=Math.max(1,Math.round(e.height*i));return r.width=o,r.height=a,s.drawImage(e,0,0,o,a),r.toDataURL("image/jpeg",.85)}function YL(){const[t,e]=P.useState([]),[n,r]=P.useState(!1),[s,i]=P.useState(null),[o,a]=P.useState(am),[c,d]=P.useState(""),[h,m]=P.useState("todos"),[g,x]=P.useState(!1),[A,C]=P.useState(1),[R,I]=P.useState(!1),[v,T]=P.useState(!0),[D,O]=P.useState({tipo:"",mensagem:""});P.useEffect(()=>{if(!J)return T(!1),O({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{};const K=Ot(Le(J,"users"),ot("role","==","parent"));return ft(K,$=>{const L=$.docs.map(G=>{const Y=G.data();return{id:G.id,nome:Y.nome||"Sem nome",email:Y.email||"",telefone:Y.telefone||"",avatarUrl:Y.avatarUrl||"",status:Y.status||"ativo"}}).sort((G,Y)=>G.nome.localeCompare(Y.nome,"pt-BR"));e(L),T(!1)},$=>{T(!1),O({tipo:"erro",mensagem:($==null?void 0:$.message)||"No foi possvel carregar os responsveis do banco."})})},[]);const U=P.useMemo(()=>t.filter(K=>{const we=K.nome.toLowerCase().includes(c.toLowerCase()),$=h==="todos"?!0:K.status===h;return we&&$}),[t,c,h]),E=Math.max(1,Math.ceil(U.length/om)),y=Math.min(A,E),S=U.slice((y-1)*om,y*om),N=()=>{i(null),a(am),r(!0)},w=K=>{i(K.id),a({nome:K.nome,email:K.email||"",telefone:K.telefone||"",avatarUrl:K.avatarUrl||""}),r(!0)},k=()=>{i(null),a(am),r(!1)},b=K=>{K.preventDefault(),(async()=>{var W;O({tipo:"",mensagem:""}),I(!0);const $=o.nome.trim(),L=o.email.trim().toLowerCase(),G=o.telefone.trim(),Y=o.avatarUrl.trim();if(!$||!L){I(!1);return}try{if(s){if(!J)throw new Error("Banco de dados no configurado.");await an(ht(J,"users",s),{nome:$,telefone:G||null,avatarUrl:Y||null,updatedAt:Oe()}),O({tipo:"sucesso",mensagem:"Dados do responsvel atualizados com sucesso."})}else{if(!kr||!It)throw new Error("Firebase no configurado para cadastro de responsvel.");const ue=await PS(YS,"createParentAccount")({nome:$,email:L,telefone:G,avatarUrl:Y}),Se=((W=ue==null?void 0:ue.data)==null?void 0:W.email)||L;await vS(It,Se),O({tipo:"sucesso",mensagem:"Responsvel cadastrado e link para criao de senha enviado por e-mail."})}C(1),k()}catch(me){const ue=(me==null?void 0:me.message)||"No foi possvel salvar o responsvel.";O({tipo:"erro",mensagem:ue})}finally{I(!1)}})()},se=K=>{(async()=>{if(!J)throw new Error("Banco de dados no configurado.");const $=t.find(L=>L.id===K);$&&await an(ht(J,"users",K),{status:$.status==="ativo"?"inativo":"ativo",updatedAt:Oe()})})().catch($=>{O({tipo:"erro",mensagem:($==null?void 0:$.message)||"No foi possvel atualizar o status do responsvel."})})},ae=async K=>{var $;const we=($=K.target.files)==null?void 0:$[0];if(we)try{const L=await WL(we),G=await QL(L);a(Y=>({...Y,avatarUrl:G}))}catch(L){O({tipo:"erro",mensagem:(L==null?void 0:L.message)||"No foi possvel carregar o avatar."})}finally{K.target.value=""}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Responsveis"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Cadastro e acompanhamento dos responsveis dos alunos."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Responsveis"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>x(K=>!K),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${g?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(lh,{size:16})}),u.jsx("button",{onClick:n?k:N,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar responsvel",children:n?u.jsx(Er,{size:16}):u.jsx(oc,{size:16})}),u.jsx("button",{onClick:n?k:N,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:n?"Cancelar":"Adicionar responsvel"})]})]}),n&&u.jsxs("form",{onSubmit:b,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-8 gap-3 items-center",children:[u.jsx("div",{className:"col-span-3",children:u.jsx("div",{className:"grid grid-cols-1 gap-3 items-center",children:u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Upload de avatar",u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 ",children:u.jsx("div",{className:"mx-auto w-32 h-32 rounded-full overflow-hidden border border-slate-200 bg-slate-100",children:o.avatarUrl?u.jsx("img",{src:o.avatarUrl,alt:"Avatar do responsvel",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-400",children:"Sem avatar"})})}),u.jsx("input",{type:"file",accept:"image/*",onChange:ae,className:"form-control !py-2"})]})})}),u.jsx("div",{className:"col-span-5",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome completo",u.jsx("input",{value:o.nome,onChange:K=>a(we=>({...we,nome:K.target.value})),placeholder:"Nome completo",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 md:col-span-2 text-sm text-slate-600",children:["E-mail",u.jsx("input",{type:"email",value:o.email,onChange:K=>a(we=>({...we,email:K.target.value})),placeholder:"E-mail",className:"form-control !py-2.5",required:!0,disabled:!!s})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Telefone",u.jsx("input",{value:o.telefone,onChange:K=>a(we=>({...we,telefone:K.target.value})),placeholder:"Telefone (opcional)",className:"form-control !py-2.5"})]})]})})]}),u.jsx("button",{type:"submit",disabled:R,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:s?"Salvar edio":"Salvar responsvel"})]}),D.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${D.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:D.mensagem}),u.jsxs("div",{className:`${g?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:c,onChange:K=>{d(K.target.value),C(1)},placeholder:"Buscar por nome",className:"form-control !py-2.5"}),u.jsxs("select",{value:h,onChange:K=>{m(K.target.value),C(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativo",children:"Ativo"}),u.jsx("option",{value:"inativo",children:"Inativo"})]})]}),v&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando responsveis..."}),!v&&S.map(K=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${K.status==="ativo"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>w(K),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>se(K.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${K.status==="ativo"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[K.status==="ativo"?u.jsx(Ts,{}):u.jsx(Is,{}),K.status==="ativo"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2 flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:K.avatarUrl?u.jsx("img",{src:K.avatarUrl,alt:K.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-[10px] text-slate-400",children:"Sem"})}),u.jsxs("div",{children:[u.jsx("div",{className:"font-medium text-slate-800 truncate",children:K.nome}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:K.email}),u.jsx("div",{className:"md:hidden text-sm text-slate-500 truncate",children:K.telefone||"Sem telefone"})]})]})}),u.jsx("div",{className:"md:col-span-3 md:w-[300px] hidden md:flex",children:u.jsx("div",{className:"text-sm text-slate-500 truncate",children:K.telefone||"Sem telefone"})})]}),u.jsxs("div",{className:"grid grid-cols-2 md:hidden p-1",children:[u.jsx("button",{onClick:()=>w(K),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>se(K.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${K.status==="ativo"?"text-red-600":"text-emerald-700"}`,children:K.status==="ativo"?u.jsx(Ts,{}):u.jsx(Is,{})})]})]},K.id)),!v&&S.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhum responsvel encontrado."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",y," de ",E]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:y===1,onClick:()=>C(K=>Math.max(1,K-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:y===E,onClick:()=>C(K=>Math.min(E,K+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}const lm=5,cm={nome:"",periodo:"Integral",professorId:""};function JL(){const[t,e]=P.useState([]),[n,r]=P.useState([]),[s,i]=P.useState([]),[o,a]=P.useState(!1),[c,d]=P.useState(null),[h,m]=P.useState(cm),[g,x]=P.useState(""),[A,C]=P.useState("todos"),[R,I]=P.useState("todos"),[v,T]=P.useState(!1),[D,O]=P.useState(1),[U,E]=P.useState(!1),[y,S]=P.useState(!1),[N,w]=P.useState(!0),[k,b]=P.useState(!0),[se,ae]=P.useState({tipo:"",mensagem:""}),[K,we]=P.useState(null),[$,L]=P.useState(!1),[G,Y]=P.useState("");P.useEffect(()=>J?ft(Le(J,"classrooms"),le=>{const F=le.docs.map(Z=>{const te=Z.data();return{id:Z.id,nome:te.nome||"Sem nome",periodo:te.periodo||"",professorId:te.professorId||"",professorNome:te.professorNome||"",status:te.status||"ativa"}}).sort((Z,te)=>Z.nome.localeCompare(te.nome,"pt-BR"));e(F),w(!1)},le=>{w(!1),ae({tipo:"erro",mensagem:(le==null?void 0:le.message)||"No foi possvel carregar as turmas do banco."})}):(w(!1),ae({tipo:"erro",mensagem:"Banco de dados no configurado."}),()=>{}),[]),P.useEffect(()=>{if(!J)return()=>{};const B=Ot(Le(J,"users"),ot("role","==","teacher"));return ft(B,F=>{const Z=F.docs.map(te=>{const de=te.data();return{id:te.id,nome:de.nome||"Sem nome",status:de.status||"ativo"}}).sort((te,de)=>te.nome.localeCompare(de.nome,"pt-BR"));i(Z)})},[]),P.useEffect(()=>J?ft(Ot(Le(J,"students")),le=>{const F=le.docs.map(Z=>{const te=Z.data();return{id:Z.id,nome:te.nome||"Sem nome",turmaId:te.turmaId||"",status:te.status||"ativo",fotoUrl:te.fotoUrl||""}}).sort((Z,te)=>Z.nome.localeCompare(te.nome,"pt-BR"));r(F),b(!1)},()=>{b(!1)}):(b(!1),()=>{}),[]);const W=P.useMemo(()=>[...new Set(t.map(B=>B.periodo).filter(Boolean))],[t]),me=P.useMemo(()=>{const B=["Matutino","Vespertino","Integral"];return[...new Set([...B,...W])]},[W]),ue=P.useMemo(()=>t.filter(B=>{const le=B.nome.toLowerCase().includes(g.toLowerCase()),F=A==="todos"?!0:B.status===A,Z=R==="todos"?!0:B.periodo===R;return le&&F&&Z}),[t,g,A,R]),Se=Math.max(1,Math.ceil(ue.length/lm)),_e=Math.min(D,Se),Ne=ue.slice((_e-1)*lm,_e*lm),je=t.find(B=>B.id===K)||null,St=P.useMemo(()=>K?n.filter(B=>B.turmaId===K):[],[n,K]),Ln=P.useMemo(()=>{if(!K)return[];const B=G.trim().toLowerCase();return B?n.filter(le=>le.nome.toLowerCase().includes(B)).slice(0,20):[]},[n,K,G]),Vi=()=>{d(null),m(cm),a(!0)},Or=B=>{d(B.id),m({nome:B.nome,periodo:B.periodo||"",professorId:B.professorId||""}),a(!0)},Fn=()=>{d(null),m(cm),a(!1)},Oi=B=>{B.preventDefault(),(async()=>{ae({tipo:"",mensagem:""}),E(!0);const F=h.nome.trim(),Z=h.periodo.trim(),te=h.professorId,de=s.find(pe=>pe.id===te);if(!F||!Z||!te||!de){E(!1);return}try{if(!J)throw new Error("Banco de dados no configurado.");c?(await an(ht(J,"classrooms",c),{nome:F,periodo:Z,professorId:te,professorNome:de.nome,updatedAt:Oe()}),ae({tipo:"sucesso",mensagem:"Dados da turma atualizados com sucesso."})):(await Vh(Le(J,"classrooms"),{nome:F,periodo:Z,professorId:te,professorNome:de.nome,status:"ativa",createdAt:Oe(),updatedAt:Oe()}),ae({tipo:"sucesso",mensagem:"Turma cadastrada com sucesso."})),O(1),Fn()}catch(pe){ae({tipo:"erro",mensagem:(pe==null?void 0:pe.message)||"No foi possvel salvar a turma."})}finally{E(!1)}})()},gt=B=>{(async()=>{if(!J)throw new Error("Banco de dados no configurado.");const F=t.find(Z=>Z.id===B);F&&await an(ht(J,"classrooms",B),{status:F.status==="ativa"?"inativa":"ativa",updatedAt:Oe()})})().catch(F=>{ae({tipo:"erro",mensagem:(F==null?void 0:F.message)||"No foi possvel atualizar o status da turma."})})},Un=B=>{we(le=>le===B?null:B),L(!1),Y("")},Fs=async B=>{try{if(!J||!K)throw new Error("Selecione uma turma para vincular alunos.");S(!0),ae({tipo:"",mensagem:""}),await an(ht(J,"students",B.id),{turmaId:K,updatedAt:Oe()}),ae({tipo:"sucesso",mensagem:B.turmaId&&B.turmaId!==K?"Aluno transferido para a turma com sucesso.":"Aluno vinculado  turma com sucesso."})}catch(le){ae({tipo:"erro",mensagem:(le==null?void 0:le.message)||"No foi possvel vincular o aluno."})}finally{S(!1)}},Mi=async B=>{try{if(!J)throw new Error("Dados no disponveis para remover aluno.");S(!0),ae({tipo:"",mensagem:""}),await an(ht(J,"students",B),{turmaId:null,updatedAt:Oe()}),ae({tipo:"sucesso",mensagem:"Aluno removido da turma com sucesso."})}catch(le){ae({tipo:"erro",mensagem:(le==null?void 0:le.message)||"No foi possvel remover o aluno da turma."})}finally{S(!1)}};return u.jsxs("div",{className:"flex flex-col gap-4 max-w-5xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Gesto de Turmas"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Organizao das turmas e perodos da escola."})]}),u.jsxs("div",{className:"glass-panel p-5 border border-slate-200/60",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Turmas"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>T(B=>!B),className:`md:hidden h-9 w-9 rounded-lg border transition-colors inline-flex items-center justify-center ${v?"bg-primary text-white border-primary":"bg-slate-100 text-slate-700 border-slate-200 hover:bg-slate-200"}`,"aria-label":"Filtros",children:u.jsx(lh,{size:16})}),u.jsx("button",{onClick:o?Fn:Vi,className:"md:hidden h-9 w-9 rounded-lg text-white bg-primary hover:bg-primary-dark transition-colors inline-flex items-center justify-center","aria-label":"Adicionar turma",children:o?u.jsx(Er,{size:16}):u.jsx(oc,{size:16})}),u.jsx("button",{onClick:o?Fn:Vi,className:"hidden md:inline-flex h-9 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors items-center",children:o?"Cancelar":"Adicionar turma"})]})]}),o&&u.jsxs("form",{onSubmit:Oi,className:"mb-5 rounded-xl border border-slate-200 p-4 bg-white/80 flex flex-col gap-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:[u.jsxs("label",{className:"flex flex-col md:col-span-2 gap-1 text-sm text-slate-600",children:["Nome da turma",u.jsx("input",{value:h.nome,onChange:B=>m(le=>({...le,nome:B.target.value})),placeholder:"Nome da turma",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Perodo",u.jsx("select",{value:h.periodo,onChange:B=>m(le=>({...le,periodo:B.target.value})),className:"form-control !py-2.5",children:me.map(B=>u.jsx("option",{value:B,children:B},B))})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Professor responsvel",u.jsxs("select",{value:h.professorId,onChange:B=>m(le=>({...le,professorId:B.target.value})),className:"form-control !py-2.5",required:!0,children:[u.jsx("option",{value:"",children:"Selecione"}),s.filter(B=>B.status==="ativo"||B.id===h.professorId).map(B=>u.jsx("option",{value:B.id,children:B.nome},B.id))]})]})]}),u.jsx("button",{type:"submit",disabled:U,className:"h-10 px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:c?"Salvar edio":"Salvar turma"})]}),se.mensagem&&u.jsx("div",{className:`mb-4 rounded-lg border px-3 py-2 text-sm ${se.tipo==="erro"?"bg-red-50 border-red-200 text-red-700":"bg-emerald-50 border-emerald-200 text-emerald-700"}`,children:se.mensagem}),u.jsxs("div",{className:`${v?"flex":"hidden"} flex-col md:flex md:flex-row gap-3 mb-4`,children:[u.jsx("input",{value:g,onChange:B=>{x(B.target.value),O(1)},placeholder:"Buscar por turma",className:"form-control !py-2.5"}),u.jsxs("select",{value:A,onChange:B=>{C(B.target.value),O(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os status"}),u.jsx("option",{value:"ativa",children:"Ativa"}),u.jsx("option",{value:"inativa",children:"Inativa"})]}),u.jsxs("select",{value:R,onChange:B=>{I(B.target.value),O(1)},className:"form-control !py-2.5",children:[u.jsx("option",{value:"todos",children:"Todos os perodos"}),W.map(B=>u.jsx("option",{value:B,children:B},B))]})]}),je&&u.jsxs("div",{className:"mt-5 rounded-xl border border-slate-200 bg-white/80 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("h4",{className:"text-base font-bold text-slate-800",children:["Gerenciar alunos da turma: ",je.nome]}),u.jsx("button",{onClick:()=>we(null),className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),k?u.jsx("div",{className:"text-sm text-slate-500",children:"Carregando alunos..."}):u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx("div",{className:"flex items-center justify-end",children:u.jsx("button",{onClick:()=>L(!0),className:"h-9 w-full md:w-auto px-3 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors",children:"Buscar e vincular aluno"})}),u.jsxs("div",{className:"rounded-lg border border-slate-200 p-3",children:[u.jsxs("div",{className:"text-sm font-semibold text-slate-700 mb-2",children:["Alunos da turma: ",St.length]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:[St.map(B=>{var le,F;return u.jsxs("div",{className:"flex items-center justify-between bg-slate-100 gap-3 rounded-lg border shadown-md border-slate-300 px-3 py-2",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-9 h-9 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:B.fotoUrl?u.jsx("img",{src:B.fotoUrl,alt:B.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-500 font-semibold",children:((F=(le=B.nome)==null?void 0:le.charAt(0))==null?void 0:F.toUpperCase())||"?"})}),u.jsx("span",{className:"text-sm text-slate-700 truncate",children:B.nome})]}),u.jsx("button",{disabled:y,onClick:()=>Mi(B.id),className:"h-7 px-2 rounded-md text-xs font-medium text-red-600 bg-red-50 hover:bg-red-100 disabled:opacity-50",children:"Remover"})]},B.id)}),St.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum aluno vinculado."})]})]}),u.jsx("div",{className:"text-xs text-slate-500",children:"Use Buscar e vincular aluno para localizar por nome e incluir na turma."})]})]}),$&&je&&u.jsx("div",{className:"fixed inset-0 z-50 bg-slate-900/40 backdrop-blur-sm flex items-center justify-center p-4",children:u.jsxs("div",{className:"w-full max-w-2xl rounded-xl border border-slate-200 bg-white shadow-xl p-4 md:p-5",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-base font-bold text-slate-800",children:je.nome}),u.jsx("button",{onClick:()=>{L(!1),Y("")},className:"h-8 px-3 rounded-lg text-xs font-medium text-slate-600 bg-slate-100 hover:bg-slate-200",children:"Fechar"})]}),u.jsx("input",{value:G,onChange:B=>Y(B.target.value),placeholder:"Digite o nome do aluno",className:"form-control !py-2.5 mb-3"}),!G.trim()&&u.jsx("div",{className:"text-sm text-slate-500 py-4",children:"Digite um nome para buscar alunos."}),G.trim()&&u.jsxs("div",{className:"flex flex-col gap-2 max-h-96 overflow-y-auto",children:[Ln.map(B=>{var Z,te;const le=B.turmaId===K,F=B.turmaId&&!le;return u.jsxs("div",{className:"flex items-center justify-between gap-3 rounded-lg border border-slate-200 px-3 py-2",children:[u.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[u.jsx("div",{className:"w-10 h-10 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:B.fotoUrl?u.jsx("img",{src:B.fotoUrl,alt:B.nome,className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-xs text-slate-500 font-semibold",children:((te=(Z=B.nome)==null?void 0:Z.charAt(0))==null?void 0:te.toUpperCase())||"?"})}),u.jsxs("div",{className:"min-w-0",children:[u.jsx("div",{className:"text-sm font-medium text-slate-700 truncate",children:B.nome}),le&&u.jsx("div",{className:"text-xs text-emerald-700",children:"J est nesta turma"}),F&&u.jsx("div",{className:"text-xs text-amber-700",children:"Est em outra turma"})]})]}),u.jsx("button",{disabled:y||le,onClick:()=>Fs(B),className:"h-8 px-2 rounded-lg text-xs font-medium text-emerald-700 bg-emerald-50 hover:bg-emerald-100 disabled:opacity-50",children:le?"Vinculado":F?"Transferir":"Vincular"})]},B.id)}),Ln.length===0&&u.jsx("div",{className:"text-sm text-slate-400",children:"Nenhum aluno encontrado."})]})]})}),N&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Carregando turmas..."}),!N&&Ne.map(B=>u.jsxs("div",{className:`mb-2 rounded-lg bg-slate-100 border border-slate-200 shadow-md text-slate-700 ${B.status==="ativa"?"border-l-8 border-l-emerald-500":"border-l-8 border-l-red-500"}`,children:[u.jsxs("div",{className:"flex gap-3 md:items-center md:gap-3",children:[u.jsxs("div",{className:"flex hidden md:flex items-center gap-2 flex-wrap col-span-2 p-2",children:[u.jsxs("button",{onClick:()=>Or(B),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-slate-700 bg-slate-200 border border-slate-300 hover:bg-slate-200 transition-colors flex flex-col items-center gap-1",children:[u.jsx(wn,{}),"Editar"]}),u.jsxs("button",{onClick:()=>Un(B.id),className:"w-16 px-2 rounded-md p-1 text-xs font-medium text-primary bg-primary/15 border border-primary/30 hover:bg-primary/35 transition-colors flex flex-col items-center gap-1",children:[u.jsx(cl,{}),"Alunos"]}),u.jsxs("button",{onClick:()=>gt(B.id),className:`w-16 px-2 rounded-md p-1 text-xs font-medium transition-colors flex flex-col items-center gap-1 ${B.status==="ativa"?"bg-red-50 text-red-600 hover:bg-red-100 border border-red-700":"bg-emerald-50 text-emerald-700 hover:bg-emerald-100 border border-emerald-700"}`,children:[B.status==="ativa"?u.jsx(Ts,{}):u.jsx(Is,{}),B.status==="ativa"?"Inativar":"Ativar"]})]}),u.jsx("div",{className:"md:grow min-w-0 md:col-span-6 gap-3 my-3",children:u.jsxs("div",{className:"ps-2",children:[u.jsxs("div",{className:"font-medium text-slate-800 truncate",children:[B.nome," - ",B.periodo||"Sem perodo"]}),u.jsx("div",{className:"text-sm text-slate-500 truncate",children:B.professorNome||"No definido"})]})})]}),u.jsxs("div",{className:"grid grid-cols-3 md:hidden p-1",children:[u.jsx("button",{onClick:()=>Or(B),className:"h-8 px-2 rounded-s-md text-xs font-medium text-primary border border-primary border-r-0 inline-flex justify-center items-center gap-1",children:u.jsx(wn,{})}),u.jsx("button",{onClick:()=>Un(B.id),className:"h-8 px-2 text-xs font-medium text-slate-700 border border-primary justify-center inline-flex items-center gap-1",children:u.jsx(Ul,{})}),u.jsx("button",{onClick:()=>gt(B.id),className:`h-8 px-2 rounded-e-lg text-xs font-medium border border-primary border-l-0 inline-flex justify-center items-center gap-1 ${B.status==="ativa"?"text-red-600":"text-emerald-700"}`,children:B.status==="ativa"?u.jsx(Ts,{}):u.jsx(Is,{})})]})]},B.id)),!N&&Ne.length===0&&u.jsx("div",{className:"py-6 text-sm text-slate-500",children:"Nenhuma turma encontrada."}),u.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[u.jsxs("span",{className:"text-sm text-slate-500",children:["Pgina ",_e," de ",Se]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{disabled:_e===1,onClick:()=>O(B=>Math.max(1,B-1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Anterior"}),u.jsx("button",{disabled:_e===Se,onClick:()=>O(B=>Math.min(Se,B+1)),className:"h-9 px-3 rounded-lg text-sm font-medium text-slate-600 bg-slate-100 disabled:opacity-40",children:"Prxima"})]})]})]})]})}async function XL(t){return new Promise((e,n)=>{const r=new FileReader;r.onload=()=>e(String(r.result||"")),r.onerror=()=>n(new Error("Falha ao ler arquivo de imagem.")),r.readAsDataURL(t)})}function ZL(){const{currentUser:t,userProfile:e}=$h(),[n,r]=P.useState(""),[s,i]=P.useState(""),[o,a]=P.useState(""),[c,d]=P.useState(""),[h,m]=P.useState(""),[g,x]=P.useState(""),[A,C]=P.useState(!1),[R,I]=P.useState(!1),[v,T]=P.useState(""),[D,O]=P.useState(""),[U,E]=P.useState(""),[y,S]=P.useState("");P.useEffect(()=>{r((e==null?void 0:e.nome)||""),i((e==null?void 0:e.telefone)||""),a((e==null?void 0:e.avatarUrl)||"")},[e]);const N=async b=>{var ae;const se=(ae=b.target.files)==null?void 0:ae[0];if(se)try{const K=await XL(se);a(K)}catch(K){O((K==null?void 0:K.message)||"No foi possvel carregar a imagem.")}finally{b.target.value=""}},w=async b=>{if(b.preventDefault(),!(!t||!J)){T(""),O(""),C(!0);try{await xl(ht(J,"users",t.uid),{nome:n.trim(),telefone:s.trim(),avatarUrl:o||null,updatedAt:Oe()},{merge:!0}),T("Perfil atualizado com sucesso.")}catch(se){O((se==null?void 0:se.message)||"No foi possvel atualizar o perfil.")}finally{C(!1)}}},k=async b=>{if(b.preventDefault(),!(!(t!=null&&t.email)||!(It!=null&&It.currentUser))){if(E(""),S(""),!c.trim()){S("Informe sua senha atual.");return}if(h.length<6){S("A nova senha deve ter pelo menos 6 caracteres.");return}if(h!==g){S("A confirmao da senha no confere.");return}I(!0);try{const se=ji.credential(t.email,c);await IO(It.currentUser,se),await SO(It.currentUser,h),d(""),m(""),x(""),E("Senha atualizada com sucesso.")}catch(se){(se==null?void 0:se.code)==="auth/wrong-password"||(se==null?void 0:se.code)==="auth/invalid-credential"?S("Senha atual invlida."):S((se==null?void 0:se.message)||"No foi possvel alterar a senha.")}finally{I(!1)}}};return u.jsxs("div",{className:"flex flex-col gap-6 max-w-4xl mx-auto",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-800",children:"Meu Perfil"}),u.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Atualize suas informaes e sua senha de acesso."})]}),u.jsxs("form",{onSubmit:w,className:"glass-panel p-5 border border-slate-200/60 flex flex-col gap-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Dados pessoais"}),D&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:D}),v&&u.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:v}),u.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:items-center",children:[u.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden border border-slate-200 bg-slate-100 shrink-0",children:o?u.jsx("img",{src:o,alt:"Avatar do usurio",className:"w-full h-full object-cover"}):u.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-400 text-sm",children:"Sem avatar"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"text-sm font-medium text-slate-600",children:"Avatar"}),u.jsx("input",{type:"file",accept:"image/*",onChange:N,className:"form-control !py-2 mt-1"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Nome",u.jsx("input",{value:n,onChange:b=>r(b.target.value),placeholder:"Nome",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["E-mail",u.jsx("input",{value:(e==null?void 0:e.email)||(t==null?void 0:t.email)||"",disabled:!0,className:"form-control !py-2.5 bg-slate-100 text-slate-500"})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600 md:col-span-2",children:["Telefone",u.jsx("input",{value:s,onChange:b=>i(b.target.value),placeholder:"Telefone",className:"form-control !py-2.5"})]})]}),u.jsx("button",{type:"submit",disabled:A,className:"h-10 px-4 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:"Salvar perfil"})]}),u.jsxs("form",{onSubmit:k,className:"glass-panel p-5 border border-slate-200/60 flex flex-col gap-4",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Alterar senha"}),y&&u.jsx("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-700",children:y}),U&&u.jsx("div",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-sm text-emerald-700",children:U}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Senha atual",u.jsx("input",{type:"password",value:c,onChange:b=>d(b.target.value),placeholder:"Senha atual",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Nova senha",u.jsx("input",{type:"password",value:h,onChange:b=>m(b.target.value),placeholder:"Nova senha",className:"form-control !py-2.5",required:!0})]}),u.jsxs("label",{className:"flex flex-col gap-1 text-sm text-slate-600",children:["Confirmar nova senha",u.jsx("input",{type:"password",value:g,onChange:b=>x(b.target.value),placeholder:"Confirmar nova senha",className:"form-control !py-2.5",required:!0})]})]}),u.jsx("button",{type:"submit",disabled:R,className:"h-10 px-4 rounded-lg text-sm font-medium text-white bg-primary hover:bg-primary-dark transition-colors self-end disabled:opacity-60",children:"Alterar senha"})]})]})}function e3(){const{currentUser:t,userRole:e,userProfile:n,logout:r}=$h(),[s,i]=P.useState("caderneta"),[o,a]=P.useState("dashboard"),[c,d]=P.useState(null),[h,m]=P.useState(null),[g,x]=P.useState(null),[A,C]=P.useState([]),[R,I]=P.useState(!0),[v,T]=P.useState(!1),[D,O]=P.useState(!1),[U,E]=P.useState(()=>navigator.onLine?"online":"offline"),y=P.useRef(null);if(P.useEffect(()=>{e==="admin"&&!s.startsWith("admin-")&&s!=="perfil"&&i("admin-dashboard"),e==="parent"&&!["parent-inicio","calendario","comunicacao","perfil"].includes(s)&&i("parent-inicio")},[e,s]),P.useEffect(()=>{if(!J||e!=="teacher"||!(t!=null&&t.uid))return e!=="teacher"&&(C([]),x({})),I(!1),()=>{};I(!0);const W=Ot(Le(J,"classrooms"),ot("professorId","==",t.uid)),me=ft(W,ue=>{const Se=ue.docs.map(_e=>{const Ne=_e.data();return{id:_e.id,nome:Ne.nome||"Sem nome",periodo:Ne.periodo||""}}).sort((_e,Ne)=>_e.nome.localeCompare(Ne.nome,"pt-BR"));C(Se)},()=>{C([])});return()=>{me()}},[e,t==null?void 0:t.uid]),P.useEffect(()=>{if(!J||e!=="teacher"||A.length===0)return x({}),I(!1),()=>{};const W=A.map(Se=>Se.id),me=Ot(Le(J,"students"),ot("turmaId","in",W)),ue=ft(me,Se=>{const _e={};Se.docs.forEach(Ne=>{const je=Ne.data();_e[Ne.id]={id:Ne.id,turmaId:je.turmaId||"",name:je.nome||"Sem nome",status:"pending",avatar:je.fotoUrl||`https://ui-avatars.com/api/?name=${encodeURIComponent(je.nome||"Aluno")}&background=e2e8f0&color=0f172a`}}),x(_e),I(!1)},Se=>{x({}),I(!1)});return()=>{ue()}},[e,A,J]),P.useEffect(()=>{if(!J||e!=="teacher"||A.length===0)return()=>{};const W=A.map(_e=>_e.id),me=new Date().toISOString().split("T")[0],ue=Ot(Le(J,"cadernetaEntries"),ot("turmaId","in",W),ot("date","==",me)),Se=ft(ue,_e=>{x(Ne=>{const je={...Ne};return Object.keys(je).forEach(St=>{je[St].status="pending"}),_e.docs.forEach(St=>{const Ln=St.data();je[Ln.studentId]&&(je[Ln.studentId].status=Ln.status||"sent")}),je})});return()=>{Se()}},[e,A,J]),P.useEffect(()=>{const W=()=>{E("syncing"),y.current&&clearTimeout(y.current),y.current=setTimeout(()=>{E("online")},1500)},me=()=>{y.current&&clearTimeout(y.current),E("offline")};return window.addEventListener("online",W),window.addEventListener("offline",me),()=>{window.removeEventListener("online",W),window.removeEventListener("offline",me),y.current&&clearTimeout(y.current)}},[]),!t)return u.jsx(jL,{});const S=W=>{d(W),a("diario")},N=W=>{m(W),a("aluno")},w=(W,me)=>{x(ue=>({...ue,[W]:{...ue[W],status:me}}))},k=()=>o==="dashboard"?u.jsx(Tw,{onOpenTurma:S,turmas:A,studentsStatus:g,carregando:R}):o==="diario"&&c?u.jsx(RL,{turma:c,studentsStatus:g,onBack:()=>a("dashboard"),onOpenStudent:N}):o==="aluno"&&h?u.jsx(PL,{student:g[h],turma:c,onBack:()=>a("diario"),onUpdateStatus:W=>w(h,W)}):u.jsx(Tw,{onOpenTurma:S,turmas:A,studentsStatus:g,carregando:R}),b=()=>{if(s==="perfil")return u.jsx(ZL,{});if(e==="admin")return s==="admin-dashboard"?u.jsx(FL,{}):s==="admin-calendar"?u.jsx(zL,{}):s==="admin-professores"?u.jsx(KL,{}):s==="admin-responsaveis"?u.jsx(YL,{}):s==="admin-alunos"?u.jsx(Pw,{}):s==="admin-turmas"?u.jsx(JL,{}):u.jsx(Pw,{});if(e==="parent")return s==="calendario"?u.jsx(Iw,{}):s==="comunicacao"?u.jsx(Aw,{}):u.jsx(LL,{});switch(s){case"caderneta":return k();case"calendario":return u.jsx(Iw,{});case"comunicacao":return u.jsx(Aw,{});default:return k()}},se=W=>{i(W),T(!1),O(!1),W==="caderneta"&&a("dashboard")},ae=()=>{i("perfil"),T(!1),O(!1)},K=()=>e==="admin"?"Viso Geral":e==="parent"?"Incio":"Dashboard",we=e==="admin"?[{id:"admin-dashboard",label:"Dashboard",icon:sp},{id:"admin-calendar",label:"Calendrio",icon:sp},{id:"admin-professores",label:"Professores",icon:Ra},{id:"admin-turmas",label:"Turmas",icon:JI},{id:"admin-responsaveis",label:"Responsveis",icon:Ul},{id:"admin-alunos",label:"Alunos",icon:cl}]:e==="parent"?[{id:"parent-inicio",label:K(),icon:cl},{id:"comunicacao",label:"Mensagens",icon:u0}]:[{id:"caderneta",label:K(),icon:cl},{id:"comunicacao",label:"Mensagens",icon:u0}],$=(n==null?void 0:n.nome)||(t==null?void 0:t.displayName)||"Usurio",L=(n==null?void 0:n.email)||(t==null?void 0:t.email)||"",G=(n==null?void 0:n.avatarUrl)||"",Y=U==="offline"?{label:"Offline",className:"bg-red-50 text-red-600 border-red-200",dotClassName:"bg-red-500"}:U==="syncing"?{label:"Sincronizando...",className:"bg-amber-50 text-amber-700 border-amber-200",dotClassName:"bg-amber-500"}:{label:"Online",className:"bg-emerald-50 text-emerald-700 border-emerald-200",dotClassName:"bg-emerald-500"};return u.jsxs("div",{className:"flex h-screen overflow-hidden bg-bg-app",children:[u.jsx(wV,{position:"top-right"}),v&&u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>T(!1)}),u.jsxs("div",{className:"lg:hidden fixed top-0 w-full h-16 bg-white border-b border-slate-200 flex items-center justify-between px-4 z-50",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>O(W=>!W),className:"w-9 h-9 rounded-lg border border-slate-200 bg-white text-slate-600 inline-flex items-center justify-center","aria-label":D?"Fechar menu":"Abrir menu",children:D?u.jsx(Er,{size:18}):u.jsx(lk,{size:18})}),u.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-primary to-primary-light flex items-center justify-center text-white font-bold text-sm shadow-[0_2px_8px_rgba(16,185,129,0.3)]",children:"V"}),u.jsx("span",{className:"font-bold text-slate-800 tracking-tight",children:"Verdy"})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsxs("div",{className:`hidden sm:inline-flex items-center gap-1.5 px-2 py-1 rounded-full border text-[11px] font-medium ${Y.className}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${Y.dotClassName}`}),Y.label]}),u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:()=>T(W=>!W),className:"w-9 h-9 rounded-full bg-slate-100 border border-slate-200 overflow-hidden flex items-center justify-center text-slate-500",children:G?u.jsx("img",{src:G,alt:$,className:"w-full h-full object-cover"}):u.jsx(Ra,{size:18})}),v&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-56 rounded-xl border border-slate-200 bg-white shadow-lg p-2 z-20",children:[u.jsxs("div",{className:"px-3 py-2 border-b border-slate-100 mb-1",children:[u.jsx("div",{className:"text-xs font-semibold text-slate-800 truncate",children:$}),u.jsx("div",{className:"text-[11px] text-slate-500 truncate",children:L||"Conta ativa"})]}),u.jsxs("button",{onClick:()=>{T(!1),ae()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-700 hover:bg-slate-50",children:[u.jsx(Ra,{size:16}),"Meu perfil"]}),u.jsxs("button",{onClick:()=>{T(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50",children:[u.jsx(c0,{size:16}),"Sair do sistema"]})]})]})]})]}),D&&u.jsxs("div",{className:"lg:hidden fixed inset-0 z-40",children:[u.jsx("button",{onClick:()=>O(!1),className:"absolute inset-0 bg-slate-900/40","aria-label":"Fechar menu"}),u.jsxs("aside",{className:"absolute left-0 top-0 h-full w-full bg-white border-r border-slate-200 p-5 flex flex-col",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-primary to-primary-light flex items-center justify-center text-white font-bold text-sm",children:"V"}),u.jsx("span",{className:"font-bold text-slate-800 tracking-tight",children:"Verdy"})]}),u.jsx("button",{onClick:()=>O(!1),className:"w-8 h-8 rounded-lg border border-slate-200 text-slate-600 inline-flex items-center justify-center","aria-label":"Fechar menu",children:u.jsx(Er,{size:16})})]}),u.jsx("nav",{className:"flex flex-col gap-2",children:we.map(W=>u.jsxs("button",{onClick:()=>se(W.id),className:`flex items-center gap-3 w-full text-left px-3 py-2.5 rounded-lg text-sm font-medium transition-colors ${s===W.id?"bg-primary text-white":"text-slate-600 hover:bg-slate-50"}`,children:[u.jsx(W.icon,{size:18}),W.label]},W.id))})]})]}),u.jsxs("aside",{className:"hidden lg:flex w-[280px] bg-white border-r border-slate-200 flex-col p-6 z-10 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-10 mt-2",children:[u.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-primary to-primary-light flex items-center justify-center text-white font-bold text-xl shadow-[0_4px_10px_rgba(16,185,129,0.3)]",children:"V"}),u.jsx("h2",{className:"font-bold text-2xl text-slate-800 tracking-tight",children:"Colgio Verdy"})]}),u.jsx("nav",{className:"flex flex-col gap-2 flex-1 mt-4",children:we.map(W=>u.jsxs("button",{onClick:()=>se(W.id),className:`flex items-center gap-3 w-full text-left px-4 py-3.5 rounded-xl font-medium text-[15px] transition-all ${s===W.id?"bg-primary text-white shadow-md":"text-slate-500 hover:bg-slate-50 hover:text-primary"}`,children:[u.jsx(W.icon,{size:20}),W.label]},W.id))})]}),u.jsxs("main",{className:"flex-1 flex flex-col pt-16 lg:pt-0 overflow-hidden relative",children:[u.jsx("header",{className:"hidden lg:flex h-20 items-center justify-between px-8 bg-white border-b border-slate-200 shrink-0",children:u.jsxs("div",{className:"flex ml-auto items-center gap-6",children:[u.jsxs("div",{className:`inline-flex items-center gap-1.5 px-2.5 py-1 rounded-full border text-xs font-medium ${Y.className}`,children:[u.jsx("span",{className:`w-2 h-2 rounded-full ${Y.dotClassName}`}),Y.label]}),u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>T(W=>!W),className:"flex items-center gap-3 select-none hover:bg-slate-50 rounded-xl px-2 py-1.5 transition-colors",children:[u.jsx("div",{className:"w-11 h-11 rounded-full bg-slate-100 border-2 border-white shadow-sm overflow-hidden flex items-center justify-center text-slate-500",children:G?u.jsx("img",{src:G,alt:$,className:"w-full h-full object-cover"}):u.jsx(Ra,{size:20})}),u.jsxs("div",{className:"flex flex-col text-left",children:[u.jsx("span",{className:"font-semibold text-sm text-slate-800 uppercase",children:$}),u.jsx("span",{className:"text-xs text-slate-500 truncate max-w-[180px]",children:L||"Conta ativa"})]}),u.jsx(nk,{size:16,className:`text-slate-400 transition-transform ${v?"rotate-180":""}`})]}),v&&u.jsxs("div",{className:"absolute right-0 top-[calc(100%+8px)] w-56 rounded-xl border border-slate-200 bg-white shadow-lg p-2 z-20",children:[u.jsxs("button",{onClick:()=>{T(!1),ae()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-slate-700 hover:bg-slate-50",children:[u.jsx(Ra,{size:16}),"Meu perfil"]}),u.jsxs("button",{onClick:()=>{T(!1),r()},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50",children:[u.jsx(c0,{size:16}),"Sair do sistema"]})]})]})]})}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 lg:p-8 pb-8",children:b()})]})]})}function t3(){return u.jsx(DL,{children:u.jsx(e3,{})})}XC({immediate:!0});um.createRoot(document.getElementById("root")).render(u.jsx(MA.StrictMode,{children:u.jsx(t3,{})}));
